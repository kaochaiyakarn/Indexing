optimizing spatio temporal filters improving brain computer interfacing guido benjamin matthias florian gabriel klaus robert ller fraunhofer ida str 
berlin germany campus benjamin franklin university medicine berlin berlin germany 
university potsdam august str 
germany klaus fhg de florian philip gabriel de brain computer interface bci systems create novel communication channel brain output device bypassing conventional motor output pathways nerves muscles 
provide new communication control option patients 
modern bci technology essentially techniques classification single trial brain signals 
novel technique allows simultaneous optimization spatial spectral filter enhancing discriminability multi channel eeg single trials 
evaluation experiments involving different subjects demonstrates superiority proposed algorithm 
apart enhanced classification spatial spectral filter determined algorithm analysis data source localization respective brain rhythms 
brain computer interface bci research aims development system allows direct control computer application solely human intentions reflected suitable brain signals cf 

focussing noninvasive eeg bci systems 
devices tools communication disabled healthy subjects interested exploring new path man machine interfacing say playing bci operated computer games 
classical approach establish eeg control set system controlled specific eeg feature known susceptible conditioning subjects learn voluntary control feature 
contrast berlin brain computer interface uses established motor competences control paradigms machine learning approach extract subject specific discriminability patterns high dimensional features 
approach advantage long subject training needed operant conditioning approach replaced short calibration measurement minutes machine training minute 
machine adapts specific characteristics brain signals subject accounting high inter subject variability 
respect topographic patterns brain rhythm modulations common spatial patterns csp see algorithm proven useful extract subject specific discriminative spatial filters 
hand frequency band csp algorithm operates selected manually set broad band filter cf 

obviously simultaneous optimization frequency filter spatial filter highly desirable 
algorithm simple frequency filters delay tap channel optimized spatial filters 
results showed improvement algorithm csp flexibility frequency filters limited 
method allows simultaneously optimize arbitrary fir filter csp analysis 
proposed algorithm outperforms csp average cases separation discriminative rhythm dominating non discriminative rhythms importance considerable increase classification accuracy achieved 
experimental setup investigate data eeg experiments different subjects 
experiments included called training sessions train subject specific classifiers 
experiments included feedback sessions subject steer cursor play computer game brain pong bci control 
data feedback sessions posteriori study depend intricate interaction subject original classification algorithm 
experimental sessions study labeled trials brain signals recorded way subjects sitting comfortable chair arms lying relaxed 
seconds different visual stimuli indicated seconds mental task subject accomplish period 
investigated mental tasks imagined movements left hand right hand foot 
brain activity recorded scalp multi channel eeg amplifiers resp 
channels 
eeg channels recorded emg leg horizontal vertical eog eyes 
emg eog channels exclusively sure subjects performed real limb eye movements correlated mental tasks directly artifacts indirectly afferent signals muscles joint receptors reflected eeg channels detected classifier operates eeg signals 
trials class recorded 
study investigate binary classifications results expected safely transfer multi class case 
neurophysiological background established model called described part human body exists corresponding region motor somatosensory area neocortex 
mapping body respective brain areas preserves big parts topography neighboring parts body represented neighboring parts cortex 
region feet located center vertex left hand represented right hemisphere right hand left hemisphere 
brain activity rest describable different rhythms located different brain areas 
rhythms reflect functional states different neuronal cortical networks brain computer interfacing 
rhythms blocked movements independent active passive reflexive origin 
blocking effects visible bilaterally pronounced cortical area corresponds moved limb 
attenuation brain rhythms db pz cz plot shows spectra subject left hand light line foot dark line motor imagery hz scalp positions pz cz 
central channels peaks hz hz visible 
channel value measures discriminability added 
indicates second peak contains discriminative information 
termed event related desynchronization erd see 
sensorimotor cortex called idle rhythm measured scalp eeg 
common frequency band rhythm hz rhythm 
jasper described strictly local called beta rhythm hz human motor cortex recordings 
scalp eeg recording find rhythm motor areas mixed superimposed hz activity 
context rhythm interpreted cortical faster activity 
brain rhythms described cortical origin role cortical discussed description eeg berger point discussion 
lopes da silva showed cortico cortical coherence larger cortical 
focal erd motor sensory cortex observed subject imagining movement sensation specific limb feature bci control 
discrimination imagination movements left hand vs right hand vs foot topography attenuation rhythm 
problems erd features bci control strength sensorimotor idle rhythms measured scalp eeg known vary strongly subjects 
introduces high variability accuracy erd bci system works 
feature independent erd reflecting imagined intended movements movement related potentials mrp denoting negative dc shift eeg signals respective cortical regions 
see investigation feature exploited bci combined erd feature 
combination strategy able greatly enhance classification performance offline studies 
focus improving erd classification improvements combined algorithm 
rhythm superimposed stronger posterior rhythm idle rhythm visual system 
best articulated eyes closed awake attentive subjects see fig 
channel pz 
due volume conduction posterior rhythm interferes rhythm eeg channels motor cortex 
power classifier susceptible modulations posterior rhythm occur due fatigue change attentional focus performing tasks changing demands visual processing 
rhythms different spectral peaks fig 
channels cz suitable frequency filter help weaken interference 
optimization filter integrated csp algorithm addressed 
spatial filter csp algorithm common spatial pattern csp algorithm useful calculating spatial filters detecting erd effects erd see extended multi class problems 
distributions high dimensional space supervised csp algorithm finds directions spatial filters maximize variance class time minimize variance class 
having band pass filtered eeg signals rhythms interest high variance reflects strong rhythm low variance weak attenuated rhythm 
take example discriminating left hand vs right hand imagery 
sec 
spatial filter focusses area left hand characterized strong motor rhythm imagination right hand movements left hand idle state attenuated motor rhythm left hand imagination 
criterion exactly csp algorithm optimizes maximizing variance class right hand trials time minimizing variance left hand trials 
furthermore csp algorithm calculates dual filter focus area right hand calculate filters optimizations considering orthogonal subspaces 
csp algorithm trained labeled data set trials si trial consists channels rows time points columns 
spatial filter ir channels projects trials signal si si channel 
idea csp find spatial filter projected signal high variance class low variance 
words maximize variance class sum variances classes remains constant expressed optimization problem max var si trial class var si var variance vector 
formulation formed second class 
definition variance simplify problem max covariance matrix trial concatenated matrix dimension channels concatenated time points belonging respective class 
formulating dual problem find problem solved calculating matrix diagonal matrix elements choosing highest lowest eigenvalue 
equation accomplished way 
whiten matrix determine matrix possible due positive definiteness 
define yp calculate orthogonal matrix diagonal spectral theory rdr satisfies 
projection th row matrix relative variance th element trials class relative variance trials class 
near filter th row maximizes variance class near minimizes variance class 
typically retain projections corresponding highest eigenvalues csps class corresponding lowest eigenvalues csps class 
spectral filter discussed sec 
content discriminative information different frequency bands highly subject dependent 
example subject spectra visualized fig 
shows highly discriminative peak hz peak hz show discrimination 
lower frequency peak stronger better performance classification expected reduce influence lower frequency peak subject 
subjects situation looks differently classification fail exclude information 
desirable optimize spectral filter better discriminability 
approaches task 

suggested si signal defined signal si delayed timepoints 
usual csp approach applied concatenation si channel dimension delayed signals treated new channels 
concatenation step ability neglect emphasize specific frequency bands achieved strongly depends choice accomplished validation approach training set 
complex frequency filters concatenating delayed eeg signals delays 
concluded typical bci situations small training sets available choice delay tap effective 
increased flexibility frequency filter delay taps trade increased complexity optimization problem 

idea new algorithm learn complete global filter spirit csp 
digital frequency filter consists sequences length na nb signal filtered nb nb na na restrict fir finite impulse response filters defining na 
furthermore define fix length 
restriction resign flexibility frequency filter allows find suitable solution way looking real valued sequence trials si si classified better way 
equation solve problem max simplified max max var si trial class var si 
si trial class correlation signal timepoints delayed signal 
calculate optimal usual csp techniques see equation dimensional problem remains solve usual line search optimization techniques large 
consequently get class frequency band filter pattern similar csp pattern choosing eigenvectors 
increasing complexity frequency filter controlled order avoid overfitting 
control achieved introducing regularization term magnitude db frequency hz db cz hz plot left shows learned frequency filter subject spectra shown fig 

plot right resulting spectra visualized applying frequency filter left 
technique classification error reduced 
way max max 
non negative regularization constant chosen crossvalidation 
sparse solution desired norm formulation 
higher get sparser solutions point usual csp approach remains 
call approach common sparse spectral spatial pattern algorithm 
feature extraction classification validation feature extraction choosing channels eog emg outermost channels cap apply causal band pass filter hz data encompasses rhythm 
classification extract interval ms visual stimulus 
trials apply original csp algorithm see sec 
extended proposed algorithm see sec 

choose best leave cross validation training set 
results different regularization constants fixed 
patterns class leads dimensional output signal 
measure amplitude specified frequency band calculate logarithm variances spatio temporally filtered output signals feature vectors 
classification validation preprocessing reduces dimensionality feature vectors 
samples class data set need regularization linear classifiers 
testing non linear classification methods features observe statistically significant gain experimental setup compared linear discriminant analysis lda see 
choose lda classification 
validation purposes chronologically half data training second half test data 
results fig 
shows chosen frequency filter subject spectra shown fig 
remaining spectrum filter 
expected filter detects csp vs vs plots shows validation error algorithm row csp axis vs axis row axis vs axis 
columns regularization parameter varied 
plot cross diagonal marks dataset outperforms algorithm 
high discrimination frequencies hz low discrimination frequency band hz 
lower frequency peak predominant subject having high discrimination power filter learned drastically decreases amplitude band full power hz retained 
applied datasets pairwise class combinations datasets get results shown fig 

results datasets displayed classification accuracy exceeds classifier 
obvious small choice regularization constant problematic algorithm tends overfit 
high values tends csp performance frequency filters punished hard 
range better csp 
furthermore datasets gain huge 
compared situation similar outperforms cases average cases better 
open issue choice parameter choose constant datasets shows typically outperform csp 
compared cases appear better vice versa 
refined way choose individually dataset 
way accomplish choice perform cross validations set possible values select minimum cross validation error 
done example dataset spectra shown fig 

training set value chosen 
classification error csp classification error 
concluding discussion past bci research csp algorithm proven determining spatial filters extract discriminative brain rhythms 
performance suffer non discriminative brain rhythm overlapping frequency range interferes 
algorithm successful solves problematic situations optimizing simultaneously spatial filters spectral filter 
trade flexibility estimated frequency filter danger overfitting accounted sparsity constraint weighted regularization constant 
proposed algorithm compared original csp algorithm demonstrated corpus eeg data sets recorded different subjects 
acknowledgments helpful discussions 
studies supported bmbf deutsche forschungsgemeinschaft dfg pascal network excellence eu 
mcfarland pfurtscheller vaughan brain computer interfaces communication control clin 
neurophysiol 
curran stokes learning control brain activity review production control eeg components driving brain computer interface bci systems brain cogn 
kaiser brain computer communication unlocking locked psychol 
bull 
hinterberger flor spelling device nature 
pfurtscheller schl gl current trends graz brain computer interface bci ieee trans 

eng 

ller classifying single trial eeg brain computer interfacing becker ghahramani eds advances neural inf 
proc 
systems nips vol 

wheeler jorgensen matthews matthews krupka multimodal interface development ieee trans 
neural sys 

eng 
parra tang pearlmutter yeung osman linear spatial integration single trial detection neuroimage 
penny roberts curran stokes eeg communication pattern recognition approach ieee trans 

eng 
ller pfurtscheller optimal spatial filtering single trial eeg imagined hand movement ieee trans 

eng 

ller spatio spectral filters improved classification single trial eeg ieee trans 
biomed 
eng 
jasper man effects voluntary movement electrical activity gyrus arch 


pfurtscheller da silva event related eeg meg synchronization desynchronization basic principles clin 
neurophysiol 
jasper andrews normal differentiation occipital regions man arch 


chicago 
berger ber das des arch 


da silva van van leeuwen organization thalamic cortical alpha rhythm spectra 
clin 
neurophysiol 

ller combining features bci becker thrun obermayer eds advances neural inf 
proc 
systems nips vol 


ller increase information transfer rates bci csp extension multi class thrun saul sch lkopf eds advances neural information processing systems vol 
mit press cambridge ma 
fukunaga statistical pattern recognition academic press san diego nd edn 
eeg source localization implementing spatio temporal decomposition approach 
clin 
neurophysiol 

ller boosting bit rates non invasive eeg classifications feature combination multi class paradigms ieee trans 
biomed 
eng 

ller anderson birch linear non linear methods brain computer interfaces ieee trans 
neural sys 

eng 
sch fer kohlmorgen 
ller boosting bit rates error detection classification fast paced motor commands single trial eeg analysis ieee trans 
neural sys 

eng 
