advanced nonrigid registration algorithms image fusion simon warfield alexandre roche aditya tei jan juan ruiz carl fredrik westin steven allen tannenbaum jolesz ron kikinis medical images brought spatial correspondence aligned registration algorithms 
nonrigid registration refers set techniques allow alignment datasets mismatched nonrigid nonuniform manner 
misalignments result physical deformation processes result morphological variability 
example physical deformation brain occur neurosurgery result factors fluid csf loss intervention 
non rigid deformation characteristic organs soft tissues abdomen pelvis 
chapter appeared brain mapping methods second edition chapter pages published academic press san diego usa 
addition nonrigid morphological differences arise comparisons image datasets acquired different individuals 
changes result normal anatomical variability product pathological processes 
gross structure brain essentially similar humans related species factors described tend produce local nonrigid shape differences 
nonrigid brain registration techniques numerous applications 
align scans different brains permitting characterization normal pathological mor variation brain mapping 
align anatomical templates specific datasets facilitating segmentation segmentation registration 
techniques capture changes occur neurosurgery 
ongoing development robust algorithms advanced hardware platforms applications surgical visualization enhanced functional image analysis inevitable 
exciting application nonrigid registration algorithms automatic registration multimodal image data 
rigid registration multimodal data greatly facilitated framework provided mutual information mi 
mi strategies effec tively capture large nonrigid shape differences explored 
alternate approach normalize multimodality images reduce problem match 
section nonrigid registration method uses intensity transform allows single intensity modality mapped intensities 
method iterative combining iteration intensity correction geometric trans form intensity similarity criteria 
method applied cases promising results 
section turn attention issue image registration fusion dur ing neurosurgery 
common desire align preoperative data images patient acquired neurosurgery 
widely acknowledged opera tions nonrigid changes shape brain occur result intervention due reactive physiological changes 
deformations brain shift difficult relate preoperative image data intraoperative anatomy patient 
preoperative imaging subject time constraints limitations tissue contrast selection methods intraoperative imaging major goal develop robust nonrigid tion algorithms matching preoperative image data intraoperative image data 
biomechanical modeling algorithm capture nonrigid deformations surface changes infer volumetric deformation finite element discretization 
describe early prospective experience method cases provide examples enhanced visualizations produced 
third section build theme physics models presenting novel inhomogeneous elasticity model uses local similarity measure obtain initial sparse estimate deformation field 
method includes automatic feature point extraction ing nonlinear diffusion filter 
correspondence detection achieved maximizing local normalized cross correlation 
sparse estimates deformation field calculated feature points introduced external forces restricting registration process deformation field fixed points 
advantage method feature points correspondences established automatically 
segmentation manual identification correspondences required 
fourth section discuss registration diffusion tensor mri data introduce framework nonrigid registration tensor data including special case vector data 
approach multiresolution template matching scheme followed lation sparse displacement field kriging interpolator 
warping data tensors locally information deformation gradient displacement 
fifth section novel method producing area preserving surface de formations general mass preserving area volume deformations minimization functional monge kantorovich type 
theory op mass transport problem minimizing cost redistributing certain amount mass distributions priori 
cost function distance bit material moved weighted mass problem optimal transport classical appeared econometrics fluid dynamics automatic control transportation statistical physics shape optimization expert systems meteorology 
show resulting low order differential equations may image registration 
challenge nonrigid registration remains outstanding open problems medical image analysis 
new algorithm developments targeted specific clinical applications helped identify unsolved issues 
chapter provides overview nonrigid registration algorithms pursued today surgical planning laboratory 
inter modality multi contrast images automatic registration techniques brain images developed main trends registration multimodal images low intermediate degree transforma tions parameters registration images high dimensional volumetric maps elastic fluid deformations hundreds thousands parameters 
category mainly addresses fusion complementary information obtained different imaging modalities 
second category predominant purpose evaluation anatomical evolution process particular subject anatomical variations different subjects 
despite promising early dense transformation field multimodal registration far remained relatively 
research multimodal registration culminated concept mutual information mi viola wells wells viola wells maes leading new class rigid affine registration algorithms 
framework registration images performed maximizing mi respect trans formation space 
significant reason success mi similarity measure resides generality prior information relationship intensities images 
instance mi assume linear relationship typically case standard optical flow techniques 
earlier approaches mi require identification corresponding features images registered 
significant done establishing applicability mi nonrigid regis maintz meyer barillot rueckert 
authors improved robustness approach modifying original mi measure including prior information joint intensity distribution maintz higher order definitions mi incorporate spatial information rueckert 
approach described stems observation number multimodal rigid registration problems solved practice similarity measures mi correlation ratio cr roche 
cr constrained mi assumes functional non linear relationship image intensities 
words assumes image similar simple intensity remapping 
cr method amounts adaptive estimation strategy image alternately corrected intensity geometry progressively match 
combinations medical images functional dependence assumption gener ally valid majority anatomical structures 
problem turn critical rigid affine registration context observe may seriously hamper estimation high dimensional transformation 
propose ex tension functional dependence model call model achieve better intensity corrections 
model realistic functional remains strongly constrained enables conditioning multimodal non rigid registration problem 
method registration algorithm described iterative iteration consists parts 
part transforms intensities anatomical structures source image match intensities corresponding structures target image second part concerned registration intensity transformation optical flow algorithm 
intensity transformation intensity correction process starts defining set intensity pairs correspond ing voxels set defined number voxels images 
correspond intensity value th voxel respectively adopting customary convention consider ing images dimensional arrays 
shall show perform intensity correction assume single intensity value exactly corresponding inten sity value dependence corresponding intensity values dependence 
dependence assumption goal characterize mapping voxel intensities knowing elements erroneous perfectly matched 
assume intensity function intensity corrupted additive stationary gaussian white noise unknown function estimated 
exactly model employed roche 
roche leads correlation ratio measure maximized registration 
approach transformation seeks function best describes terms maximum likelihood context function squares ls fit terms major difference respective problems seek high dimensional geometrical transformation 
opposed affine registration transformation gov majority matches elastic deformations may computed mainly local information gradients local averages 
expect displace ments structure correct bad ones certain voxel moved properly iteration 
geometrical transformation intensity similarity precise intensity transformation required 
consequently performing standard ls regression opted robust linear regression estimator remove outlying elements estimation intensity transformation 
estimate trimmed squares lts method followed binary reweighted squares rls estimation rousseeuw leroy 
combination methods provides robust regression technique outlier detection ensuring maximum pertinent voxel pairs taken account 
different types functions model polynomial functions 
intensity correspondences defined ps needs estimated degree polynomial function 
model adequate register images vast range intensities restricted polynomial degree imposes intensity space constraints correspondences mapping simi lar intensities similar intensities case labeled image neighboring intensities usually correspond different structures 
intensity space constraint longer required 
modeled piecewise constant function label mapped lts rls estimate intensities corresponding label dependence assumption functional dependence expressed implies structures having similar intensity ranges similar intensity ranges combinations images crude approximation 
example csf bones generally give similar intensity values weighted images appear distinct values pd weighted scans 
conversely csf gray matter contrasted weighted images correspond similar intensities pd weighted scans 
circumvent difficulty developed strategy enables mapping intensity value possible intensity values method natural extension previous section 
computing single function maps intensities functions estimated mapping weighted sum functions 
start assumption point intensity corresponding point intensity normally distributed possible values depending statistical terms means drawn mixture gaussian distribution mixing proportions depend intensity source image represents variance noise target image 
consistent functional relationship restrict polynomial intensity functions ps ps intuitive way interpret modeling state voxel binary selector variable tell observed functions serves map knowledge best intensity correction apply minimum variance sense weighted sum functions weights correspond probability point mapped second function 
estimate functions employ sequential strategy performs successive lts rls regressions case 
details parameters determined 
geometrical transformation having completed intensity transformation stage intensity corrected version source image denoted case case may assume roughly modality sense corresponding anatomical structures similar intensities geometrical transformation problem may treated registration context 
algorithms developed deform brain shape matches maintz viergever toga 
procedure influenced variety optical flow methods primarily demons algorithm thirion thirion 
iteration voxel displaced vector vn match corresponding anatomical location scheme vn vn hn hn hn hn gaussian filter isotropic variance denotes convolution denotes composition gradient operator transformation hn related displacement hn vn common registration methods multilevel techniques accelerate convergence 
details number levels iterations filter implementation issues addressed section 
show method related registration methods minimization sum squared difference ssd criterion optical flow demons algorithm 
relation ssd minimization ssd minimization framework searches transformation minimizes sum squared differences transformed source image target image 
ssd defined ssd minimization may performed gradient descent algorithm 
differ equation get ssd gradient descent consists iterative scheme form vn vn hn hn step length 
set constant value method corresponds order gradient descent algorithm 
comparing see method sets hn hn applies gaussian filter provide smooth displacement field 

pennec shown closely relates second order gradient descent ssd criterion iteration sets hn minimum ssd quadratic approximation hn 
refer reader articles technical discussion subject 
relation optical flow considered successive time samples image sequence represented computed constraining brightness brain structures constant time voxel position image time 
displacements di dt known sufficient provide unique displacement voxel 
fact constraint leads xi xi component displacement direction brightness gradient horn schunck 
constraints need added obtain displacement components directions 
methods proposed fulfill purpose regularize resulting vector field barron 
computed efficiently proposed thirion thirion description demons registration method complete grid demons 
consists smoothing dimension vector field gaussian filter 
proposed add denominator numerical stability xi close zero term serves purpose original optical flow formulation horn schunck horn schunck 
bro nielsen bro nielsen kind regularization approximates linear elasticity transformation model 
mind displacement maps voxel position position iterative method vn vn xi xi spatial derivatives may computed ways horn schunck brandt simoncelli 
observed practical experience method forms best computed resampled source image current iteration 
shown section agreement ssd minimization 
temporal deriva tives obtained subtracting target images resampled source image current iteration 
considerations relate 
reader note major difference method optical flow strategies regularization formed calculation displacements gradient direction explicit regularization term minimization framework 
relation demons algorithm algorithm small variation demons method thirion thirion complete grid demons closely related optical flow described previous section 
demons algorithm finds displacements formula vn vn hn hn comparing apparent difference formulation demon method derivatives computed resampled source image current iteration 
modification performed observations minimization ssd criterion 
results discussion section registration results involving images obtained mul tiple modalities 
show typical example dependence assumed registration atlas collins weighted image 
example dependence may assumed registration pd weighted image weighted image 
images section resolution mm respect neurological convention coronal slices patient left left side image 
registration images affinely registered correlation ratio method roche 
multilevel process performed resolution levels mm mm mm voxel 
displacement fields level initialized result pre vious level 
initial displacement field set zero 
iterations performed mm voxel mm voxel mm voxel 
twice number iterations registration images conventional demons algorithm 
making better stopping criterion difference ssd values iterations probably improve results shown 
aspect presently investigation 
gaussian filter smooth displacement field stan dard deviation voxel regardless resolution 
models stronger constraints deformation field registration process correct gross displacements weaker constraints near fine displacements sought 
resampling pro cess trilinear interpolation case atlas nearest neighbor interpolation 
computation time obtain results minutes mhz pc mb ram minutes mm minutes mm minutes mm 
time devoted intensity correction part optimized version program 
taken standard registration code stable optimized 
dependence result registering atlas weighted image 
typical example dependence intensities images register atlas generate realistic images safe assume functional depen dence intensity atlas weighted image 
source image labeled image function modeled piecewise constant function 
case intensity level corresponds region estimate constant function 
result registration 
image shows slice atlas 
second corresponding slice weighted image 
third fourth images figures result registering atlas weighted image algorithm 
shows result intensity transformation simply applied atlas geometrical transformation resulting registration procedure 
shows image resulting reg process 
shape weighted image intensities transformed intensity correction 
facilitate visual assessment reg accuracy contours obtained canny deriche edge detector weighted image overlaid image 
shows joint histogram intensities registration 
values com pressed logarithmically normalized depicted color scale 
histogram color coded ranges dark red representing high point densities light yellow depict ing low point densities 
values piecewise constant function overlaid white dots 
dependence registering images different modalities dependence may nec assumed 
section example registration pd weighted images 
main problem case csf gm intensity pd image needs mapped different intensities weighted scan 
solve problem applied method described section register pd weighted images polynomial functions degree estimated 
polynomial degree set arbitrarily relatively high value allow significant intensity transformations 
shown csf white pd weighted image black weighted image registered 
intensity trans formation adequate 
comments apply gm white pd weighted image gray weighted image 
presents joint histogram images registration 
functions registration process superimposed blue line corresponds green 
line width intensity proportional value corresponding observed polynomial functions fit high density clusters joint histogram 
particular see csf gm intensity values pd weighted image values get mapped different intensity values weighted scan 
mapping represents gm red mapping represents csf blue polynomial 
note registration atlas weighted image pd weighted image selected source image best constrast structures 
simply algorithm permits structures source image mapped single intensity 
single intensity source image mapped intensities target image 
better image greater number visible structures source image 
original method perform non rigid registration multimodal images 
iterative algorithm composed steps intensity transformation transformation 
intensity transformation models described assume dependence intensity values images matched 
models built robust estimators enable precise accurate transformation solutions 
intensities intensities background csf gray matter white matter fat muscle skin skin skull matter connective atlas pd intensities results registration 
registration atlas weighted image atlas source 
weighted image target 
atlas intensity correction registration 
atlas intensity correction registration 
joint histogram atlas weighted image registration values range dark red representing high point densities light yellow depicting low point densities white dots correspond intensity transformation registering atlas weighted image assuming dependence piecewise constant function 
registration pd weighted weighted image pd weighted image source 
weighted image target 
pd weighted image intensity correction registration weighted image 
pd weighted image intensity correction registration weighted image 
joint histogram pd weighted image weighted registration blue line corresponds green line width intensity value corresponds value corresponding contours obtained canny deriche edge detector targets overlaid images better assess quality registration 
joint histograms values compressed logarithmically normalized depicted color scale 
image fusion neurosurgery biomechanical model brain deformation critical goal neurosurgery accurately locate access remove intracranial lesions damaging healthy brain tissue 
overriding goal preserve neurological function 
requires precise delineation functional anatomy morphology patient brain lesion margins 
similar visual appearance healthy diseased brain tissue tumors inability surgeon see critical structures beneath brain surface pose difficulties operation 
critical structures white matter fiber tracts may visible 
difficulty perceiving lesion tumor boundaries complete resection extremely difficult jolesz 
decade advances image guided neurosurgery techniques con tributed growth minimally invasive neurosurgery 
procedures carried operating rooms specially equipped imaging systems 
systems acquire images necessitated procedure 
improved vi deep structures improved contrast lesion healthy tissue depending modality allow surgeon plan execute procedure greater precision 
largely visualization driven task 
past possible quantitative assessments intraoperative imaging data physicians relied qualitative judgments 
order create rich visualization environment maximizes information available surgeon previous concerned image acquisition registration display 
algorithm development computer aided focussed improving imaging quality speed 
major focus develop sophisticated multimodality image registration fusion techniques enable fusion preoperative intraoperative images 
clinical experience involving deep brain structures revealed limitations existing rigid registration approaches 
motivates search nonrigid techniques rapidly faithfully capture morphological changes occur surgery 
computer aided surgical planning include dimensional models information multiple imaging modalities registered patient frame 
intraoperative imaging navigation fully integrated 
various imaging modalities image guidance 
include oth ers digital subtraction angiography dsa computed tomography ct ultrasound intraoperative magnetic resonance imaging 
represents significant advantage modalities high spatial resolution superior soft tissue contrast 
advanced intraoperative imaging systems provide image resolution tissue contrast selection features preoperative imaging systems 
intraoperative imaging systems necessity limited amount time available imaging 
multimodality registration allow preoperative data acquired nuclear medicine scans spect pet functional mri fmri angiography mra visualized alongside intraoperative data 
nonrigid registration operations changes occur anatomical position brain structures adjacent lesions 
leakage fluid csf opening hyper ventilation administration agents retraction resection tissue contribute shifting brain 
information acquired images unreliable 
loss correspondence pre images increases substantially procedure continues 
changes shape brain widely recognized nonrigid deformations called brain shift see 
suitable approaches capture shape changes create integrated visualizations preoperative data configuration deformed brain currently active development 
previous aimed capturing brain deformations neurosurgery grouped categories 
approaches form biomechanical model examples include duncan 
second category approaches phenomenological methods relying image related criteria examples include hill 
purely image matching may able achieve visually pleasing alignment issues noise intensity artifact accounted 
intraoperative matching favor physics models ultimately may expanded incorporate important material properties inhomogeneity anisotropy brain determined 
physics models exist spectrum approaches usually involving trade physical plausibility speed 
fast surgery simulation method described bro nielsen 
high computational speeds obtained converting volumetric finite element model model surface nodes 
goal achieve high graphics speeds consistent interactive computation display 
achieved cost simulation accuracy 
type model best suited computer graphics oriented display high frame rates needed 
sophisticated finite element biomechanical model dimensional brain de formation simulation proposed 
correspon dences established manual interaction 
elements finite element model pixels dimensional image 
manual determination correspondences time consuming subject human error 
methods generalized dimensions number points identified large 
due realities clinical practice dimensional results practical 
dimensional discretization approach theoretically possible extremely expensive computational standpoint considering parallel implementation number voxels typical intraoperative mri dataset leading large number equations solve voxels corresponds displacements deter mine 
downsampling lead fewer voxels leads loss detail 
edwards 
edwards dimensional component model tracking intraoperative deformation 
simplified material model 
initial multigrid implementation required minutes run sun microsystems sparc may limit feasibility routine 

duncan interesting system capturing real time intraoperative brain shift epilepsy surgery 
context brain shift occurs slowly 
simplified homogeneous brain tissue material model adopted 
description surface tracking intraoperative mri driving linear elastic biomechanical model new imple mentation system linear elastic model surface tracking goal eventually stereoscopic cameras obtain ative surface data capture intraoperative brain deformation 


developed sophisticated finite element model simulate brain deformation 
model interesting incorporates simulations forces associated tumor tissue resulting retraction resection 
limitation existing approach preoperative segmentation tetrahedral finite element mesh generation currently require hours operator time 
approach holds promise pre brain deformation 
real time needs surgery dictate algorithm prospective image match ing rapidly reliably accurately capture nonrigid shape changes brain occur surgery 
approach construct unstructured grid representing geom etry key structures image dataset 
technique allows finite element discretization faithfully models key characteristics important regions reducing number equations solve mesh elements span multiple voxels regions 
algorithm allows projection preoperative images intraoperative images allowing fusion images multiple modalities spanning different contrast mecha nisms 
parallel hardware parallel algorithm design efficient implementations achieve rapid execution times compatible neurosurgery 
method overview illustrating image analysis steps intraoperative image registration 
critical image processing tasks include segmentation identification anatomical structures registration 
segmentation data preoperative plan ning create intraoperative segmentations 
segmentation data calculate initial affine transformation rotation translation scaling rigidly registers images initializing data nonrigid matching biomechanical simulation 
biomechanical model volumetric deformation inferred mechanical simulation boundary conditions established surface matching 
sophisticated deformation model solved neurosurgery providing enhanced intraoperative visualization 
image analysis image guided neurosurgery preoperative data intraoperative mri surface matching tissue segmentation biomechanical simulation initial registration visualization neurosurgery progresses schematic illustrating image analysis tasks carried neurosurgery 
preoperative data acquisition processing time available image processing surgery extremely limited compared available 
consequently preoperative data acquisition sive extensive image analysis example segmentation performed 
variety manual semi automated kikinis yezzi automated warfield warfield segmentation approaches available 
select accurate robust approach preoperative data particular critical structures 
matching experiments described anatomical atlas preoperative data magnetic resonance angiography diffusion tensor images ultimately 
atlas constructed high resolution scan single patient structures segmented kikinis combination automated interactive techniques 
surgery especially interested tract region white matter difficult impossible directly observe conventional mri preserved 
previously shown project tract atlas patient scans preoperative surgical planning 
intraoperative image processing intraoperative image processing consists 
acquiring intraoperative ric data sets 
constructing segmentation intraoperative acquisition 
computing affine registration preoperative data new acquisition 
identifying cor key surfaces preoperative intraoperative data 
solving biomechanical model infer volumetric deformation field 
applying deformation preoperative data constructing new visualization merging critical structures preoperative data intraoperative data 
segmentation intraoperative volumetric images experiments conducted rapid segmentation brain ventricles ob tained binary curvature driven evolution algorithm yezzi 
region identified brain ventricle interactively corrected remove misclassified tissue software described 

approach allows surgeon inspect interactively edit segmentation data increasing accuracy 
alternatively experimented automated intraoperative segmentation warfield warfield utilizing tissue classification multi channel feature space model expected anatomy initial template 
automated approaches preferable validated 
unstructured mesh generation surface representation implemented mesh generator optimized biomedical structures building previously described techniques schroeder geiger 
mesh generation extract explicit representation surface brain ventricles preoperative segmentation 
create volumetric unstructured mesh multiresolution version marching tetrahedra algorithm 
begins image cubes divided tetrahedra alternating split pattern prevents diagonal crossings shared faces 
mesh iteratively refined region complex boundaries marching tetrahedra approach applied multiresolution mesh 
cell final mesh label value vertex checked different tetrahedron divided edge having different node labels 
detailed description 
meshing process extremely robust allowing generate tetrahedral meshes brain ventricles rapid segmentations volumetric intraoperative acquisition carried surgery 
facilitates intraoperative matching volumetric acquisition 
affine registration preoperative intraoperative image datasets affine registration rotation translation scaling fast parallel implementation robust algorithm aligning segmented image data rapidly converging multiresolution search strategy warfield 
applying resulting transform segmentations greyscale data preoperative intraoperative scans rigidly registered 
volumetric biomechanical simulation brain deformation procedure brain undergoes nonrigid shape changes reasons described 
surgeon able acquire new volumetric mri wishes review current configuration entire brain 
volumetric deformation field relating earlier acquisitions new scan computed matching surfaces earlier acquisition current acquisition calculating volumetric displacements surface displacements boundary conditions 
critical concept forces applied volumetric model produce surface displacements obtained surface matching 
biomechanical model compute volumetric deformation map 
establishing surface correspondences surfaces brain lateral ventricles iteratively deformed dual active surface algorithm 
image derived forces applied iteratively elastic membrane surface model early scan deforming match boundary current acquisition 
derived forces decreasing function image intensity gradients minimized edges objects volume 
included prior knowledge expected gray level gradients objects matched increase convergence rate process 
algorithm fully described 
biomechanical simulation volumetric brain deformation treat brain homo linearly elastic material 
deformation energy elastic body initial stresses strains subject externally applied forces described model taylor variables terms stress vector strain vector forces applied elastic body forces unit volume surface forces forces con nodes mesh vector field wish compute 
linear elasticity framework assume small deformations 
strain vector displacement written linear operator 
relation stresses strains expressed generalized hooke law xy yz zx assuming isotropic material properties point obtain symmetric elasticity matrix form physical parameters young modulus poisson ratio 
see taylor full details 
discretization finite element method applied volumetric image domain total potential energy written sum potential energies nnodes element ee ue mesh composed tetrahedral elements element defined mesh nodes 
continuous displacement field element mesh defined function displacement element nodes weighted element interpolating functions nnodes ui linear interpolating functions define displacement field inside element 
interpolating function node tetrahedral element defined ae cei dez computation volume element interpolation coefficients detailed taylor pages 
volumetric deformation brain solving displacement field minimizes deformation energy described equation 
element approach described nnodes ui nnodes vi ui vi wi independent defining matrix nnodes nnodes wi ln node element yields equation db element stiffness matrix db 
assembly equations elements leads global linear system equations solved displacements resulting forces applied body displacements boundary surface nodes fixed match generated active surface model 
vector representing displacement imposed boundary nodes 
elements rows stiffness matrix corresponding nodes displacement imposed set zero diagonal elements rows set 
force vector set equal displacement vector boundary nodes taylor 
way solving equation unknown displacements produce deformation field entire volumetric mesh matches prescribed displacements boundary surfaces 
hardware implementation volumetric deformation brain computed solving displacement field minimizes energy described equation fixing displacements surface match generated active surface model 
variables representing displacements determined element finite element mesh 
variable gives rise row column global matrix 
rows matrix divided equally cpus available computation global matrix assembled parallel 
cpu assembles local matrix element subdomain 
cpu equal number rows process connectivity mesh irregular cpus may 
matrix assembly boundary conditions determined surface matching applied 
global matrix adjusted rows associated variables determined consist single non zero entry unit magnitude diagonal 
volumetric biomechanical brain model system equations active surface membrane model equations solved portable extensible toolkit scientific computation petsc package generalized minimal residual gmres solver block jacobi preconditioning 
neurosurgery system equations solved sun microsystems symmetric multi processor machine mhz ultrasparc iii mb cpus gb ram 
architecture gives sufficient compute capacity execute intraoperative image pro cessing neurosurgery 
intraoperative visualization volumetric deformation field computed applied earlier data warp current configuration patient anatomy 
imaging data displayed texture mapping flat planes facilitate comparisons current data prior scans 
triangle models segmented structures registered volumetric data display surface renderings critical anatomical structures overlaid intraoperative image data 
allows ready appreciation anatomy segmented structures imaging data form planes passing triangle models 
augments sur open configuration magnetic resonance scanner neurosurgery 
geon ability see critical structures preserved tract better appreciate lesion relationship structures 
shows open configuration magnetic resonance scanner optimized imaging surgical procedures jolesz black 
image constructed lcd increased information available surgeon operation progressed 
results discussion image registration strategy described applied cases 
illustrative results demonstrate ability algorithm capture intraoperative brain deformations 
enhancement provided intraoperative nonrigid registration surgical tion environment shown matching tract prepared anatomical atlas initial subsequent intraoperative scans subject 
matching shows tract anatomical atlas blue projected shape brain subject shown 
carried neurosurgery demonstrating practical value approach ability meet real time constraints surgery 
conducted parallel scaling experiments yielded encouraging results 
entire image analysis process completed minutes adequate dis play information surgeon 
interestingly computationally intensive task biomechanical simulation optimized fastest step 
anticipate segmentation techniques requiring user interaction result significant improvements speed 
biomechanical simulation volumetric brain deformation shows tract anatomical atlas projected shape brain subject 
visualization helps surgeon better appreciate relationship essential structure lesion regions brain 
tract readily observed acquisitions 
single slice early scan 
matched slice volume simulation brain deformation 
corresponding slice scan showing significant brain shift occurred 
visualization magnitude deformation field computed matching image image 
dimensional slices dimensional data showing match simulated deformation initial brain actual deformed brain 
quality match significantly better obtained rigid registration 
typical case illustrating amount brain deformation occur neurosurgery effectiveness algorithm capturing shift neurosurgery 
shown quality match significantly better obtained rigid registration 
early experience shown intraoperative biomechanical simulation brain deformation robust reliable method capturing changes brain shape occur neurosurgery 
registration algorithm requires user interaction parallel implementation sufficiently fast 
intend incorporate patient specific preoperative data place anatomical atlas increase surgical value intraoperative updates 
refine approach expect appreciate performance gains au segmentation methods optimized parallel implementations address load imbalances 
improvements accuracy match result model material properties brain accurate modeling cerebral lateral ventricles 
sophisticated imaging methods diffusion tensor mri enable preoperative imaging inhomogeneous white matter structure incorporated material model 
ultimately prediction brain deformation opposed capture observed deformation described require nonlinear material model extensive monitoring physiological data 
prediction indicate new intraoperative imaging necessary appropriately update simulation model surgeon understanding brain shape 
nonrigid changes brain morphology occur neurosurgery limit usefulness preoperative imaging intra treatment planning surgical navigation 
intraoperative non rigid registration add significantly value intraoperative imaging 
provides quantitative monitoring therapy application including ability quantitative com defined treatment plan enables preoperative image data aligned current configuration brain patient 
shown relatively complex biomechanical model initialized solved neurosurgery providing enhanced surgical visualization 
ultimately approaches may provide truly integrated multimodality environment surgical navigation planning 
physics regularization empirical model anatomical variability important issue nonrigid registration computer assisted neurology neurosurgery generation deformation fields reflect transformation image realistic way respect anatomy 
due lack image structure noise intensity artifacts computational complexity restricted time frame surgery feasible measure directly deformation occuring voxel 
leads estimates deformation field sparse locations interpolated image 
physics elastic viscous fluid models nonrigid registration come popular bajcsy kovacic potential constrain lying deformation plausible manner 
viscous fluid models lester wang staib chosen carefully allow large deformations 
suitable medical applications concerning brain 
furthermore viscous fluid models driven alignment similar gray values may allow anatomically incorrect matches different adjacent structures mechanism large deformation matches permitted 
example gyrus may flow source brain match different gyri target brain producing anatomically incorrect match 
terms physics elastic models davatzikos proposed active surface algorithm computed boundary regarded structure initial estimate deformation field introduced volumetric elastic model infer deformation inside outside surface 
drawback method shown accurate close object boundary away boundaries solution accurate 
wang staib represents improvement statistical shape information set images manually identified boundary points included additional matching criterion 
methods promising specific brain structures robust shape representation brain remains difficult achieve 
collins nonrigid registration algorithm proposed itera tive refinement local similarity measure simplex optimization 
approach deformation field constrained smoothing correspondence estimation accurate specific regions brain 
achieve better results method improved introducing various gyri sulci brain geometric landmarks collins 
order obtain realistic deformations propose physics elastic model 
method require segmentation drawback initial esti mates deformation generated boundary considered structure 
estimates calculated template matching approach local similarity measure 
furthermore incorporated model inhomogeneous algorithm 
discretization underlying equation done finite element technique popular method medical imaging applications see bro nielsen 
method process registration described optimization problem minimizes deformation energy template image 
assuming images represent physical object deformation aligns related theorem minimum potential energy 
idea registration process described follows set points extracted image described initial sparse estimate deformation field local normalized cross correlation 
step nonrigid registration performed elastic model constrained sparse estimates computed previous step 
feature point extraction denote domain volume voxel positions 
step set feature points extracted image 
purpose calculate gradient magnitude blurred image intensities 
order obtain suitable feature points initial sparse estimate deformation field voxel higher standard deviations mean magnitude gradient correspon dence detection 
shows process slice magnetic resonance scan brain 
overcome poor edge preserving properties linear low pass filters nonlin ear diffusion filter 
filtered version volume described solution partial differential equation pde div neumann boundary conditions original image initial state weickert 
diffusion function reduce noise depends magnitude gradient smoothed image intensities computed convolving gaussian kernel standard deviation 
idea diffusion function filtering process regions high gradients edges image provide value close zero 
method diffusion function proposed weickert weickert exp parameter separates regions low contrast high contrast 
values greater filtering reduced values equal stronger smooth ing applied 
constant weickert proposes gives visually results gives flux expected behavior increasing values decreasing values 
priori determination difficult contrast parameter set interactively volume approach 
furthermore parallel additive operator splitting scheme computational efficiency 
see weickert details 
illustration feature point extraction 
better visual impression detail image shown 
slice scan slice applying nonlinear diffusion filter magnitude gradient blurred image thresholding 
correspondence detection extracting feature points correspondences image tem plate image computed points 
common way minimize distance regions volumes consists finding global optimum function measures similarity 
expressed cost function optimized voxel regions terms transformation 
search space restricted set parameter vectors approach uses local normalized cross correlation ncc maximized voxel brute force search 
assume window size voxel image compute maximal ncc shifting window similar size template image 
equation window de scribed local neighborhood voxel defined search space method restricted translations transformations rotations scaling higher computational complexity 
fur thermore ncc computed voxels high gradient magnitudes calculated blurred image intensities described section 
better performance large data sets optimization solved parallel 
interpolation sparse displacement estimates sparse deformation estimates obtained feature points computed local normalized cross correlation introduced external forces elastic model 
similar energy term described section finite element method discretization 
seek deformation minimizes equation repeated convenience underlying idea restrict registration process resulting deformation field priori fixed estimates points 
volume voxels linear system equations obtain approximately unknowns solved parallel portable extensible toolkit scientific computation petsc package 
execution time registration process usually minutes cluster cpus see section details 
inferring empirically observed anatomical variability order describe mechanical behavior tissue undergoing deformation relation stress strain expressed elasticity matrix generated matrix assembly 
isotropic material parameters needed young modulus measure stiffness poisson ratio measure incompressibility 
typically elasticity parameters set arbitrarily homogeneously bajcsy kovacic rough approximation underlying tissue 
lester 
lester applied inhomogeneous viscous fluid model brain neck registration 
manual segmentations bone region high stiffness 
davatzikos 
davatzikos applied inhomogeneities brain warping setting elasticity parameters brain times higher value ventricles 
approach differs inhomogeneous elasticity parameters derived em estimate anatomical variability discrete element obtain ma properties matrix assembly 
set scans brain segmented white matter grey matter fluid csf background em statistical classification algorithm wells 
step head scan aligned arbitrarily selected scan database global affine transformations warfield nonrigid registration method 
shows result tissue classes nonrigid registration averaged scans 
order generate model inhomogeneous entropy measure voxel 
image averaged volume different tissue classes nonrigid registration 
dark regions imply slight overlapping 
background csf gray matter white matter 
define joint entropy si si ln si represents sum scans different segmented tissue classes certain voxel 
results elasticity parameters computed voxel 
choose linear mapping computed joint entropy identified brain tissues poisson ratio scaled range young elasticity modulus range background set low stiffness incompressibility parameter 
shows slice computed model associated values 
model empirically observed variability 
slice model entropy computation 
dark regions imply low entropy value computed incompressibility parameter poisson ratio voxel slice 
dark regions imply low value 
illustration nonrigid registration homogeneous order demonstrate behavior deformation model homogeneous algorithm applied register scans brain young adults 
scan globally registered arbitrarily chosen dataset affine transformation warfield 
nonrigid registration homogeneous inhomogeneous applied aligned data 
shows results matching process averaging scans 
performing tion different subjects global affine transformation normally able align template image properly 
leads blurred average image 
alignment elastic model shown homogeneous inhomogeneous 
case homogeneous young elasticity modulus poisson ratio 

analysis summed squared differences showed improvement homogeneous 
small effect due setting feature points experiments 
seen large regions white matter small range anatomical variability 
words large number fixed deformation estimates constrains interpolation done elastic model 
research investigate new approximation schemes address 
results global affine nonrigid registration applied subjects 
slice volume result registration averaging scans global affine registration nonrigid registration homogeneous nonrigid registration inhomogeneous 
registration diffusion tensor images large amount research done decades registration med ical images provided different imaging modalities resulting proliferation algorithms solid theoretical background 
non scalar imaging modalities emerging radiology 
example phase contrast angiography mri pca mri provides description speed direction blood flow diffusion tensor mri dt mri han basser provides diffusion tensors describing local mobility water molecules tissue 
increasing clinical relevance image modalities prompted research focused registration methods supporting 
theory chapter general valid data dimensions arbitrary tensor data including special case vectors driving exam ple section registration dt mri data 
dt mri relatively imaging modality relating image intensities relative mobility endogenous tissue water molecules 
dt mri tensor describing local water diffusion calculated voxel measurements diffusion directions 
measure diffusion tanner imaging sequence tanner 
sequence uses strong gradient pulses symmetrically positioned pulse allowing controlled diffusion weighting 
dt mri shown clinical value early assessment brain stroke showing decreased ability affected tissues diffuse water hajnal sorensen 
mri methods general obtain macroscopic measure microscopic quantity necessarily entails averaging voxel dimensions influence measured diffusion tensor location brain 
factors affecting shape apparent diffusion tensor shape diffusion ellipsoid white matter include density fibers degree average fiber diameter directional similarity fibers voxel 
direction maximum described eigenvector corresponding largest eigenvalue 
descriptive orientation white matter fiber tracts central nervous system 
due restricted diffusion caused presence tightly packed surrounding axons basser peled 
postprocessing algo rithms suited dt mri arisen years 
example westin 
westin describes anisotropy analysis filtering dt mri data ruiz 
ruiz describes approach point landmark detection tensor data 
ability visualizing automatically tracing white matter tracts expected play major role basic neurosciences understanding neurological disorders especially sociated white matter aging brain development weinstein westin 
approach stems ruiz ruiz ruiz template matching locally optimizing similarity function sect 

local structure detector generic tensor fields sect 
allows constrain matching highly structured areas 
order obtain dense deformation field sparse estimates template matching lated 
approach embedded multiresolution scheme gaussian pyramid order deal moderate deformations decrease influence false optima 
sect 
illustrative results carried synthetic clinical data 
registration dt mri data addition ruiz ruiz previous diffusion tensor registration includes efforts alexander coworkers der alexander gee 
extend multiresolution elastic matching paradigm bajcsy kovacic gee bajcsy tensor data 
tensor included regularization term tensors iteration estimated displacement field 
strategies estimate tensor tation displacement field investigated 
state problem registration mapping anatomy depicted signal sr deformed represented signal sd equation describes model characterize relationship signals models deformation applied signal noise model inter scan differences 
sd sr deformation represents space variant shift system response signal displacement field 
regard differences systems generating images signals consider non memory pos space variant system depending set hp unknown parameters noise spatially white zero mean 
simplifications defining sr model reduces sd goal registration find displacement field best match sr sd 
template matching schemes estimate displacement field 
pri ori probabilistic information signal noise characterization squares moon stirling approach natural choice 
required suitable defi nition inner product induced norm 
note scalar vector tensor fields applications real domain euclidean vector spaces allows define inner product fields means integral domain inner products values 
consider functional set real domain euclidean space 
inner product defined dx weighting function inner product 
note inner product left hand side defined fields right hand side inside integral defined values field 
squares estimator obtained minimizing cost function consists squared norm estimation error 
sd sr dependency unknown parameters removed estimating ing constrained squares schemes 
example parameters assumed constant spatial domain squares estimation obtained sd sr substituted obtain new cost function de see ruiz details optimization order obtain displacement field daunting task requires additional constraints feasible 
template matching trades accuracy computational burden approximate solution optimization problem 
essentially consists defining template neighborhood point deformed dataset 
templates compared matched neighborhoods tentatively correspondent points dataset similarity measure obtained 
tentative point neighborhood provides biggest similarity selected corresponding current point deformed dataset displacement points obtained 
fundamental trade considered design neighborhoods non local large size terms sd space frequencies avoid ill posedness arising lack discriminant structure aperture problem poggio local small size terms unknown displacement field spatial frequencies guarantee validity local deformation model 
adaptive templates different sizes weights help deal problem 
window function centered generic point deformed dataset designed previous remarks 
template matching assumptions transform holds point deformed dataset 
sd equation intuitive interpretation neighborhood deformed dataset point defined window function dataset defined window function corresponds neighborhood warped deformation field 
template matching assumes model chosen displacement field parameters transformation neighborhood point registered 
example deformation field model may constrain template just shift coordinate axes translation undergo rigid motions allowing rota tions may allow stretch twist 
case model local deformation depends parameters order search computationally feasible 
respect parameters common choice assume constant neighborhood 
template matching splits complex global optimization problem coupled search ing displacements simple local ones searching independently displacement point template matching case 
example com mon case displacement field assumed constant inside template cost function reduces set cost functions sd sr refers point deformed dataset 
main characteristics template matching absence global regularization constrains local variability estimated deformation field 
prevents getting trapped false optima far absolute optimum global optimization methods prone noise produce high frequency artifacts estimated deformation 
refinement solution may advisable depending application estimated deformation initial solution global optimization scheme 
similarity functions similarity function monotonic function cost sf leaves locations optima unchanged remains invariant respect unknown parameters 
local nature template matching method necessary define similarity function sf point deformed dataset matched monotonic function applied 
section squares method referred obtain suitable local similarity functions template matching generic tensor fields 
consider identity mapping displacement field constant inside template 
direct leads sd sr corresponds known sum squared differences similarity function 
extending inner products assuming sr constant possible leads alternative similarity function corresponds correlation measure 
sfc sd sr consider space invariant affine transformation intensity 
case sd sr bt refers tensor function components equal 
cost turns sd asr similarity function invariant obtained replacing coefficients squares estimation minimizing resulting cost 
details ruiz 
resulting similarity function absolute value generalized version known correlation coefficient sf sd sr application equations requires proper definition inner product induced norm dx si dx si assume tensors cartesian defined respect orthonormal basis einstein notation sums repetition index entails summing index 
note implementation relies sampled data integrals sums 
warped vectors tensors vector tensor data linked body inspection warping supporting tissue lead consequent warping data 
warping domain expressed transformation stands points dataset points deformed 
transformation assumed differentiable neighborhoods correspondent points related dx dx deformation gradient easily recognized jacobian matrix transformation equation simply states far transformation differentiable linear mapping relates local neighborhoods points 
finite size neighborhoods deformation gradient corresponds linear approximation taylor expansion clearly shows 
assumed linear approximation valid function data vectors tensors related infinitesimal properties tissue 
consequently vectors locally related second order diffusion tensors considered associated quadratic forms related pj equation provides theoretical way estimate alteration diffusion tensors due deformation field 
clear dt mri data modified model specially areas high anisotropy white matter fiber tracts data relevant 
idea shape diffusion tensor preserved transformation effect local rotation shear 
essentially means deformation field affects directional properties diffusion strength principal axes 
example frame intrinsic fiber tract diffusion remain invariant respect deformation 
motivated search tensor transformations maintain shape include effect local rotation shear 
early experiments topic begun sierra 
ad hoc solution problem scale resulting tensor applied example preserve ellipsoid volume normalize largest eigenvalue 
possibility modify deformation gradient avoid undesirable effects scaling alexander 
research needed clarify appropriate tensor transformation 
mathematical tool deal problem polar decomposition theorem see example theory non linear elasticity 
allows deal infinitesimal finite deformations 
theorem states non singular square matrix deformation gradient unique symmetric positive definite matrices unique orthonormal matrix leads important geometric interpretations geometric mapping 
example notice sphere stretched mapping directions eigenvectors rotated transformation locally said pure strain said rigid rotation point 
mentioned sect 
matching approach data registration relies model local displacement field inside template 
order perform matching vectors tensors inside template hypothesized model 
note simple model just shifting template coordinate axes adopted assuming constant displacement field points inside vectors tensors 
similarly model rigid motion stretching vectors tensors considered 
practical point view performed matching constant displacement field assumed inside template 
limitation long local rotation small fact accepted conventional template matching scalar data 
calculated displacement field gradient estimated 
structure measures matching constrained areas local high discriminant structure 
depending dataset approach lead sparse control points estimate deformation field 
applicability method ultimately depends characteristics deformation field obvious deformation field large spatial variability sparse displacement field estimated detected points suffer spectral aliasing 
incre sampling density accepting low structure points possible depending noise characteristics data unacceptable allow noise provide nant information drives template matching 
possible provide points frequency properties deformation field necessary resort regularized schemes elastic models dataset 
alternatively applications additional channel data customarily provided 
case example dt mri epi sequences additional weighted images provided 
possible estimate different sparse displacement fields dt mri combine order estimate displacement field providing constraints structural images diffusion tensors white matter fiber tracts 
order identify areas high structure measure ruiz ruiz ruiz generalizes locally averaged outer product correlation matrix gradient field rohr frequently scalar case 
results section results synthetic real data 
real imaging data acquired ge signa tesla horizon scanner line scan diffusion technique parameters averaging effective tr te ms mm fov cm voxel size mm khz readout bandwidth acquisition matrix 
shows clusters points detected highly structured dt mri sagittal image overlayed corresponding weighted mri image fig 
shows clusters portion corresponding highlighted square 
re call matching performed clusters isolated landmarks 
notice diagonal components tensor field provide stronger structured signals diagonal ones structure detector finds thin structures images 
recalled cooperation components provides result 
order obtain clusters normalized tensor field components fit interval weaker components reach extrema values 
estimations gradient generalized correlation matrices neighborhoods 
dif presenting illustrative results volume data figures motivated report experiment single dt mri slice tensors 
method essentially dimensional directly applied volumes data parameters just adding dimension definition neighborhoods 
high structure clusters overlayed mri detail clusters inside square order assess performance nonrigid registration method fig 
shows sagittal mri slice corpus callosum deformed synthetic gaussian field depicted fig 

order estimate deformation gaussian pyramid decomposition obtained performing template matching structured areas level interpolating kriging ruiz ruiz 
fig 
shows result reconstructing original image deformation field estimated approach kriging estimator exponential 
synthetic deformation original mri deformed reconstructed original estimated deformation field shows slice dt mri dataset corpus callosum princi pal eigenvector directions represented color coding ranging blue plane projection red orthogonal plane peled 
approach applied warp dataset corresponding different individual shown fig 
levels gaussian pyramid exponential kriging interpolator limited take account closest samples 
shows zoomed version right hand side corresponding corpus callosum estimated deformation field 
dt mri warping 
dt mri different individuals 
zoomed posterior corpus estimated deformation described framework non rigid registration scalar vector tensor medical data 
approach local template matching resorts tion implementation gaussian pyramid order provide coarse fine approxima tion solution 
allows method handle moderate deformations avoids false local solutions 
method assume global priori regularization avoids computational burden associated approaches 
monge kantorovich problem image registration section method producing area preserving surface deformations general mass preserving area volume deformations minimization functional monge kantorovich type 
theory problem minimizing cost redistributing certain amount mass distributions priori 
cost function distance bit material moved weighted mass show resulting low order differential equations may registration 
monge kantorovich problem method image warping elastic registration classical problem optimal mass transport 
mass transport problem formulated monge concerned finding optimal way sense minimal transportation cost moving pile soil site 
problem modern kantorovich kantorovich known monge kantorovich problem 
type problem appeared econometrics fluid dynamics automatic control transportation statistical physics shape optimization expert systems meteorology 
method introduce section designed elastic registration optimization problem built monge kantorovich distance taken similarity measure 
constraint put transformations considered obey mass preservation property 
assume rigid non elastic registration process applied applying scheme 
method differential equations sense may thought class optical flow elastic deformation model approaches registration 
see davatzikos lester representative examples methods 
method strong connection computational fluid dynamics area previously successfully applied brain registration problems christensen 
method number distinguishing characteristics 
parameter free 
utilizes grayscale data images places images equal footing 
symmetrical optimal mapping image image inverse optimal mapping require landmarks specified 
minimizer distance functional involved unique local minimizers 
functional heart method corresponding differential equations governing minimization low order 
specifically designed take account changes density result changes area volume 
believe type elastic warping methodology quite natural medical context density key measure similarity 
occurs functional imaging may want compare degree activity various features deforming time obtain corresponding elastic registration map 
special case problem occurs application volume area preserving mappings considered 
formulation problem give modern formulation monge kantorovich problem 
assume priori subdomains smooth boundaries pair positive density functions defined respectively 
assume total mass associated consider map density sense call mass preservation mp property write mp equation called jacobian equation 
denotes determinant jacobian map denotes composition functions 
particular equation implies small region mapped larger region corresponding decrease density order mass preserved 
may mappings want pick optimal sense 
accordingly define squared monge kantorovich distance follows inf mp dx optimal mp map map minimizes integral satisfying constraint 
monge kantorovich functional seen place penalty distance map moves bit material weighted material mass fundamental theoretical result mccann unique optimal mp transporting characterized gradient convex function theory translates practical advantage means non global minima stall solution process 
computing transport map number algorithms considered computing optimal transport map 
example methods proposed linear programming lagrangian mechanics closely related ideas study fluid dynam ics 
interesting geometric method formulated cullen cullen 
follow closely tannenbaum tannenbaum 
initial mapping mass preserving mp property 
inspired consider family mp mappings form varies mp mappings try find yields curl monge kantorovich mapping respect 
removing curl known polar factorization method assumes initial mp mapping done general domains method moser moser dacorogna moser simpler domains type histogram specification 
initial mp need apply process remove curl 
easy show composition mass preserving mp mappings mp mapping inverse mp mapping mp mapping 
mp mapping mp mapping ds particular constant equation requires area volume preserving 
assume function time determine st decrease monge kantorovich functional 
give evolution equation turn equation important implementation 
differentiating respect time find differentiating respect time yields st div st see st forms st vector field div denotes normal boundary 
condition ensures remains mapping preventing flow st crossing boundary means range consider problem minimizing monge kantorovich functional dx derivative respect time helmholtz decomposition div find mt order decrease take corresponding formulas st provided div remains show decompose gradient descent solution neumann type boundary problem div set easily seen satisfies necessary requirements 
evolution equation div order non local scheme count minus derivatives 
note flow consistent respect monge kantorovich theory sense 
optimal case div div gradient descent situation somewhat simpler case due fact divergence free vector field general written scalar function represents rotation deg dirichlet boundary condition derive evolution equation generalizations hy hx case solve laplace equation div note define generalized monge kantorovich functional positive strictly convex cost function identity map particular monge kantorovich problem described corresponds cost function define analysis similar shows mt form mt st divergence free vector field 
analysis yields evolution equation form div understood laplacian inverted respect appropriate boundary con ditions 
purely local flow equation minimization monge kantorovich func tional may obtained setting straightforward check case div div mt curl corresponding second order local evolution equation div shows optimality curl function defining warping map typically elastic registration wants see explicit warping smoothly deforms image 
easily done solution monge kantorovich problem 
assume applied gradient descent process described converged monge kantorovich optimal mapping shown flow defined solution closely related minimization problem fluid mechanics provides appro priate justification define continuous warping map densities 
see mccann applications detailed analysis properties displacement interpolation 
implementation examples note non local method requires laplacian inverted iteration problem set specifically allow standard fast numerical solvers fft type methods operate rectangular grids press 
illustrate methods pair examples 
show brain de formation sequence 
slice data sets acquired brigham women hospital 
data set pre operative second acquired surgery opening 
pre processed remove skull 
monge mapping evolution equation intensity values densities scaled slightly sum intensities images 
process took roughly minutes single processor sun ultra 
full volumetric data set take hours process 
displacement interpolation intensities find continuous deformation time 
image upper left shows planar axial slice time 
bot tom right axial slice time images represent input algorithm 
upper right lower left images represent computed interpolation time respectively 
second example shows application method surface warping 
shows portion white matter surface obtained segmenting mri scan 
cut surface flattened plane conformal mapping technique shown left 
known surface non zero gaussian curvature flattened means distortion 
conformal mapping attempt preserve appearance surface preservation angles 
conformal mapping similarity small features surface appear similar flattened representation scaling factor 
conformal flattening maps calculated simply solving systems linear equations 
triangulated surface triangles takes minutes single processor computer 
parallelization achieved freely available numerical linear algebra software 
applications desirable able preserve areas angles sizes surface structures accurately represented plane 
monge kantorovich approach allows find area correct flattening 
idea conformal flattening altered moving points little possible 
conformally flattened surface define density jacobian inverse flattening map set constant 
monge kantorovich optimal mapping area correcting 
resulting map took just minutes calculate 
detail conformal surface flattening area corrected flattening shown 
corrected area surface structures clearly discernible 
curl free nature monge kantorovich mapping avoids distortion effects associated area preserving maps 
section natural method image registration surface warping classical problem optimal mass transportation 
applied monge kantorovich problem method enforce mass preservation constraint general shown section applications 
example weighted linear combination monge kantorovich functional standard energy functional matching functional 
ideas current area research 
brain deformation sequence 
upper left time lower right input algorithm 
upper right lower left represent interpolation monge kantorovich displacement map enforcing preservation mass white matter surface conformal left area preserving right mappings acknowledgments authors william wells iii helpful comments dis preparation chapter 
funded part spanish government de cul ture visiting research fellowship fpu pri european sion spanish government cicyt joint research fd new concept award center integration medicine innovative technology nih rr ca ca rr 
alexander gee 

elastic matching diffusion tensor images 
computer vision image understanding 
alexander gee bajcsy 

strategies data non rigid transformations diffusion tensor images 
taylor colchester editors lecture notes computer science 
medical image computing computer assisted miccai volume pages cambridge uk 
springer verlag 
tannenbaum kikinis 

laplace beltrami operator brain surface flattening 
ieee trans 
medical imaging 
tannenbaum kikinis 

area preserving maps minimal distortion 
editors system theory modeling analysis control pages 
kluwer holland 
bajcsy kovacic 

multiresolution elastic matching 
computer vision graph ics image processing 
gropp smith 

efficient management parallelism object oriented numerical software libraries 
arge editors modern software tools scientific computing pages 
birkhauser press 
gropp smith 

petsc users manual 
technical report anl revision argonne national laboratory 
gropp smith 

petsc home page 
www mcs anl gov petsc 
barron fleet beauchemin 

performance optical flow tech niques 
international journal computer vision 
basser 

estimation effective self diffusion tensor nmr spin echo 
journal magnetic resonance 



computational fluid mechanics solution monge kantorovich mass transfer problem 
numerische mathematik 
black moriarty alexander gleason martin kikinis schwartz jolesz 

development implementation intraoperative mri applications 
neurosurgery 
brandt 

improved accuracy gradient optical flow estimation 
interna tional journal computer vision 


polar factorization monotone rearrangement vector valued functions 
com 
pure appl 
math 
bro nielsen 

surgery simulation fast finite elements 
visualization biomedical computing pages 
bro nielsen 

finite element modeling medical vr 
proceedings ieee special issue virtual augmented reality medicine 
bro nielsen 

fast fluid registration medical images 
hne kikinis editors proceedings th international conference biomedical computing vbc held hamburg germany september volume lecture notes computer science pages 
springer verlag 
pennec ayache 

fast non rigid matching gradient descent study improvements demons algorithm 
technical report institut national de recherche en informatique en automatique 
www inria fr rr html 
christensen rabbit miller 

deformable templates large deformation kinematics 
ieee trans 
medical imag 
collins 

model segmentation individual brain structures magnetic resonance imaging data 
phd thesis montreal neurological institute 
collins evans 

non linear cerebral registration sulcal constraints 
miccai pages cambridge ma usa 
collins sled holmes evans 

design construction realistic digital brain phantom 
ieee transactions medical imaging 
cullen 

extended lagrangian theory 
atmos 
sci 
dacorogna moser 

partial differential equation involving jacobian determinant 
ann 
inst 
poincar anal 
non lin aire 
davatzikos 

spatial transformation registration brain images cally deformable models 
comp 
vis 
image understanding special issue medical imaging 
souza walker wagle 

dimensional phase contrast angiography 
magnetic resonance medicine 
edwards hill little hawkes 

deformation image guided interventions component tissue model 
ipmi pages 


multi object segmentation brain struc tures mri computerized atlas 
spie medical imaging volume pages 
warfield 

deformable modeling characterizing biomedical shape changes 
borgefors nystr di editors discrete geometry computer imagery dec uppsala sweden volume lecture notes computer science pages heidelberg germany 
springer 
warfield jolesz kikinis 

image matching finite element elastic deformation model 
taylor colchester editors miccai second international conference medical image computing computer assisted intervention sep cam bridge england pages heidelberg germany 
springer verlag 
warfield kikinis 

registration intraoperative images brain finite element biomechanical model 
delp editors miccai third international conference medical robotics imaging computer assisted surgery oct pittsburgh usa pages heidelberg germany 
springer verlag 
maes suetens 

non rigid multimodal image registration mutual information 
proceedings international con ference medical image computing computer assisted intervention miccai conference held cambridge ma usa october volume lecture notes computer science pages 
springer verlag 


elementary proof polar factorization vector valued functions 
arch 
rational mechanics anal 
mccann 

geometry optimal transportation 
acta math 
gee bajcsy 

brain warping chapter elastic matching continuum cal probabilistic analysis pages 
academic press 
geiger 

dimensional modeling human organs application sis surgical planning 
technical report inria 
kikinis grimson everett jolesz wells 

integrated visualization system surgical planning guidance image fusion interventional imaging 
miccai proceedings second international conference medical image computing computer assisted tion pages 
springer verlag 
kikinis donnell grimson jolesz black wells iii 

integrated visualization system surgical planning guidance image fusion open magn reson imaging 
roche ayache meunier 

dimensional multimodal brain warping demons algorithm adaptive intensity corrections 
ieee trans actions medical imaging 
rohr 

biomechanical modeling human head physically non rigid image registration 
ieee transactions medical imaging 
hajnal 

advanced imaging techniques chapter clinical uses diffusion weighted imaging 
martin tannenbaum 

optimal transport image registration 
submitted publication ieee trans 
image processing 
tannenbaum 

optimal transport image registration 
ieee workshop variational level set methods computer vision iccv 


rigid deformable medical image registration image guided surgery 
phd thesis university tokyo 
wells warfield kikinis black jolesz 

dimensional optical flow method measurement volumetric brain deformation intraoperative images 
comput assist 
wells halle nakajima viola kikinis jolesz 

image guided microscopic surgery system mutual information registration 
visualization biomedical computing pages 
barillot 

multimodal non rigid warping correction distortions functional mri 
third international conference medical image computing computer assisted intervention miccai volume lecture notes computer science pages pittsburgh 
springer verlag 
hotel faugeras 

variational approach multi modal image matching 
technical report institut national de recherche en infor en automatique 
hill maurer barwise fitzpatrick wang 

mea intraoperative brain surface deformation 
neurosurgery 
horn schunck 

determining optical flow 
artificial intelligence 
jolesz 

image guided procedures operating room 
radiology 
kantorovich 

problem monge 
mat 
nauk 
wells jolesz kikinis warfield 

simulation tract displacement patients brain tu 
delp editors miccai third international con ference medical robotics imaging computer assisted surgery oct pittsburgh usa pages heidelberg germany 
springer verlag 
warfield black jolesz nis 

segmentation mri low grade 
taylor colchester editors miccai second international conference cal image computing computer assisted intervention sep cambridge england pages heidelberg germany 
springer verlag 
kikinis gerig martin anderson cline jolesz 

routine quan analysis brain fluid spaces imaging 
journal magnetic resonance imaging 
kikinis jolesz 

digital brain atlas surgical planning model driven segmentation teaching 
ieee transactions visualization computer graphics 
breton laval 

imaging incoherent motions applications diffusion perfusion disorders 
radiology 
lester hajnal 

non linear registration variable viscosity fluid algorithm 
ipmi pages 


hierarchical approach elastic registration mutual information 
image vision computing 
maes collignon marchal suetens 

multimodality image registration maximization mutual information 
ieee transactions medical imaging 
maintz viergever 

general multimodal elastic registration mutual information 
hanson editor medical imaging image processing mi conference held san diego ca usa volume spie proceedings pages bellingham wa usa 
internation society optical engineering 
maintz viergever 

survey medical image registration 
medical image analysis 
mccann 

convexity principle interacting gases 
adv 
math 
meyer kim 

probabilistic brain atlas construc tion thin plate spline warping maximization mutual information 
proceed ings second international conference medical image computing computer assisted intervention miccai conference held cambridge england september volume lecture notes computer science pages cam bridge uk 
springer verlag 
roberts 

vivo quantification homogeneous brain deformation model updating preoperative images surgery 
ieee transactions medical imaging 
roberts kennedy 

modeling retraction resection intraoperative updating images 
neurosurgery 
moon stirling 

mathematical methods algorithms signal processing 
prentice hall nj usa 
moser 

volume elements manifold 
trans 
amer 
math 
soc 
black westin mehta jr warfield schwartz rd kikinis jolesz 

serial intraoperative magnetic resonance imaging brain shift 
neurosurgery 
kennedy roberts 

com putational model tracking subsurface tissue deformation neu 
ieee transactions medical imaging 
peled westin kikinis jolesz 

magnetic resonance imaging shows orientation asymmetry white matter fiber tracts 
brain research 
pennec ayache 

understanding demon algorithm non rigid registration gradient descent 
editor proceedings second inter national conference medical image computing computer assisted intervention miccai conference held cambridge england september volume lecture notes computer science page springer verlag 
basser barnett 

diffusion tensor imaging human brain 
radiology 
poggio torre koch 

computational vision regularization theory 
nature 
clark bloch 

inferring brain connectivity diffusion tensor data 
wells colchester delp editors lecture notes computer science 
medical image computing computer assisted intervention miccai volume pages cambridge uk 
springer verlag 
regis bloch 

regularization diffusion tensor maps tracking brain white matter bundles 
wells colchester delp editors lecture notes computer science 
medical image computing computer assisted intervention miccai volume pages cambridge ma usa 
springer verlag 
press teukolsky vetterling flannery 

numerical recipes art scientific computing 
cambridge university press 
sorensen 

diffusion weighted imaging acute stroke considerations clinical applications 
american journal 


mass transportation problems vols ii 
springer new york 
roche malandain ayache 

unifying maximum likelihood approaches medical image registration 
international journal imaging systems technology 
roche malandain pennec ayache 

correlation ratio new similarity measure multimodal image registration 
wells colchester delp editors proceedings international conference medical image computing computer assisted intervention miccai conference held cambridge ma usa october volume lecture notes computer science pages 
springer verlag 
www inria fr rr html 
rohr 

differential operators detecting point landmarks 
image vision com puting 
rousseeuw leroy 

robust regression outlier detection 
wiley series probability mathematical statistics 
john wiley sons 
rueckert clarkson hill hawkes 

non rigid registration higher order mutual information 
medical imaging volume spie proceedings pages san diego 
internation society optical engineering 
ruiz kikinis westin 

detection point landmarks multi dimensional tensor data 
signal processing press 
ruiz westin warfield maier kikinis 

nonrigid registration tensor medical data 
medical image analysis 
press 
ruiz westin warfield kikinis 

nonrigid registration scalar vector tensor medical data 
delp editors lecture notes computer science 
medical image computing computer assisted intervention 
miccai volume pages pittsburgh pa usa 
springer verlag 
schroeder martin lorensen 

visualization toolkit object oriented approach graphics 
prentice hall ptr new jersey 


mathematics applied continuum mechanics 
dover new york usa 
sierra 

nonrigid registration diffusion tensor images 
master thesis zurich switzerland swiss federal institute technology 
simoncelli 

design multi dimensional derivative filters 
international con ference image processing austin usa 
ieee 
duncan 

real time brain shift compensation 
ipmi pages 
duncan 

steps stereo camera guided biomechanical model brain shift compensation 
proceedings interna tional conference information processing medical imaging pages 
tanner 

spin diffusion measurements spin echoes presence time dependent field gradient 
journal chemical physics 
thirion 

fast non rigid matching medical images 
technical report institut national de recherche en informatique en automatique sophia antipolis 
www inria fr rr html 
thirion 

image matching diffusion process analogy maxwell demons 
medical image analysis 
toga 

brain warping 
academic press 
viola wells 

alignment maximization mutual information 
fifth intl 
conf 
computer vision iccv pages 
ieee press 
viola wells 

alignment maximization mutual information 
inter national journal computer vision 
wang staib 

physical model non rigid registration incorporating sta tistical shape information 
medical image analysis 
warfield jolesz kikinis 

high performance computing approach registration medical imaging data 
parallel computing 
warfield jolesz kikinis 

real time image segmentation image guided surgery 
sc high performance networking computing con ference nov orlando usa pages 
ieee 
warfield jolesz kikinis 

adaptive template ated spatially varying statistical classification 
med image anal 
warfield jolesz kikinis 

image processing strategy quantification visualization exercise induced muscle mri signal enhancement 
magn reson imaging 
weickert 

anisotropic diffusion image processing 
teubner verlag stuttgart 
weickert ter haar romeny viergever 

efficient reliable schemes nonlinear diffusion filtering 
ieee trans 
image processing 
weinstein 

advection diffusion propagation diffusion tensor fields 
ebert gross hamann editors ieee visualization pages san francisco 
wells kikinis grimson jolesz 

adaptive segmentation mri data 
ieee transactions medical imaging 
wells viola nakajima kikinis 

multi modal volume registration maximization mutual information 
medical image analysis 
westin maier jolesz kikinis 

processing visualization diffusion tensor mri 
medical image analysis 
press 
yezzi tsai willsky 

medical image segmentation coupled curve evo lution equations global constraints 
mathematical methods biomedical image analysis pages 
taylor 

finite element method basic formulation linear problems 
mcgraw hill book new york th edition 

