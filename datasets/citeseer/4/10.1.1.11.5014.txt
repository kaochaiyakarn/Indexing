technical report lab information decision systems mit workshop coding theory statistical physics trieste italy may tree reparameterization framework analysis belief propagation related algorithms martin wainwright tommi jaakkola alan willsky mit edu tommi ai mit edu willsky mit edu lab information decision systems lab arti cial intelligence electrical engineering cs electrical engineering cs mit cambridge ma mit cambridge ma original version may revision june tree reparameterization framework provides new conceptual view large class algorithms computing approximate marginals graphs cycles 
class includes belief propagation sum product algorithm rich set variations extensions belief propagation :10.1.1.73.8252:10.1.1.115.4360
algorithms class formulated sequence reparameterization updates entails re factorizing portion distribution corresponding acyclic subgraph tree 
ultimate goal obtain alternative equivalent factorization functions represent exact approximate marginal distributions cliques graph 
framework highlights important property bp entire class reparameterization algorithms distribution full graph changed 
perspective tree updates gives rise simple intuitive characterization xed points terms tree consistency 
develop interpretations results terms information geometry 
invariance distribution conjunction xed point characterization enables derive exact relation exact marginals arbitrary graph cycles approximations provided belief propagation broadly algorithm minimizes bethe free energy 
develop bounds approximation error illuminate conditions govern accuracy 
show reparameterization perspective extends naturally structured approximations kikuchi variants operate higher order cliques :10.1.1.73.8252
keywords graphical models belief propagation sum product algorithm information geometry approximate inference bethe kikuchi free energies statistical inference iterative decoding 
stochastic processes de ned graphs arise variety elds including coding theory arti cial intelligence statistical physics image processing computer vision :10.1.1.73.8252
graphical model important problem computing marginal distributions variables node graph 
acyclic graphs trees standard highly ecient algorithms exist task 
contrast exact solutions prohibitively complex mw supported part fellowship natural sciences engineering research council canada mw aw tj supported part muri daad army research oce oce naval research air force oce scienti research :10.1.1.73.8252
general graphs substantial size 
result considerable interest ort aimed developing approximate inference algorithms large graphs cycles 
belief propagation algorithm known sum product algorithm coding applications important method computing approximate marginals :10.1.1.73.8252
interest algorithm fueled part elds arti cial intelligence computer vision success turbo codes compound codes decoding algorithm particular instantiation belief propagation :10.1.1.73.8252
various equivalent forms belief propagation best known formulation refer bp algorithm entails exchange statistical information neighboring nodes message passing :10.1.1.73.8252
graph tree resulting algorithm shown produce exact solutions nite number iterations 
message passing formulation equivalent techniques optimal inference trees involve global ecient computational procedures 
hand graph contains cycles local message passing algorithm generally applicable 
known resulting algorithm may converge converge quality resulting approximations varies substantially 
yielded insight dynamics convergence properties bp 
example researchers analyzed single cycle case belief propagation reformulated matrix powering method :10.1.1.73.8252
gaussian processes arbitrary graphs groups independent methods shown bp converges conditional means exact error covariances generally incorrect 
special case graphs corresponding turbo codes richardson developed geometric approach able establish existence xed points give conditions stability 
yedidia showed bp viewed performing constrained minimization called bethe free energy associated graphical distribution inspired researchers develop sophisticated algorithms minimizing bethe free energy 
yedidia proposed extensions bp cluster variational methods related extensions higher order structures proposed minka :10.1.1.73.8252
advances notwithstanding remains understood behavior algorithm generally superior approximation algorithms 
important area constitutes focus 
particular framework provides new conceptual view large class iterative algorithms including bp rich set variations extensions 
key idea graphical models representation probability distribution product factors involves variables subset nodes corresponding clique graph 
factorized representations far unique suggests goal seeking reparameterization distribution consisting factors correspond exactly approximately desired marginal distributions 
graph cycle free tree exists unique reparameterization speci ed exact marginal distributions cliques 
parameterization cornerstone junction tree representation :10.1.1.73.8252
graph cycles hand exact factorizations exposing marginals generally exist 
possible certain portions factorized representation subset factors corresponding cycle free subgraph original graph 
led consider iterative reparameterization di erent subsets corresponding acyclic subgraph 
show synchronous form bp interpreted exactly manner reparameterization takes place extremely researchers investigated utility bethe tree approximations graphical models refer reader :10.1.1.73.8252
simple tree consisting pair neighboring nodes 
interpretation applies broader class updates reparameterization performed arbitrary cycle free subgraphs 
vehicle studying concept reparameterization bulk focus updates spanning trees refer tree reparameterization trp 
class reparameterization algorithms broad including trp sum product bp variants thereof various generalizations :10.1.1.73.8252
demonstration generality discuss section reparameterization performed hypertrees graph making connections generalized belief propagation 
level just bp message passing reformulated particular sequence reparameterization updates global updates trp equivalent schedule messagepassing spanning trees 
nd tree updates lead faster convergence converge problems synchronous bp fails 
level reparameterization perspective provides conceptual insight nature belief propagation related algorithms 
particular fact highlighted reparameterization obvious traditional message passing viewpoint distribution graph cycles altered algorithms 
perspective tree updates arises simple intuitive characterization bp xed points broadly constrained minimum bethe free energy terms consistency trees graph 
invariance distribution tree consistency xed points applied conjunction allow characterize approximation error arbitrary graph cycles 
section introduce background notation underlies development 
process illustrate distributions trees cycle free subgraphs reparameterized terms local marginal distributions 
section introduce notion tree reparameterization graphs cycles :10.1.1.73.8252
context convenient represent distributions exponential form overcomplete basis 
choice overcomplete basis unorthodox idea reparameterization transparent easily stated 
section show equivalent formulation bp sequence local 
experimental results illustrating bene ts global tree updates include greater range problems convergence obtained typically faster convergence 
section contains analysis geometry trp updates nature xed points 
formalizing de ning characteristic reparameterization algorithms change distribution graph cycles simply yield alternative factorization 
geometric terms invariance means successive iterates con ned linear subspace exponential parameters manifold terms information geometry :10.1.1.73.8252
show trp update viewed projection manifold formed constraints associated tree projection speci ed cost function approximation kullback leibler divergence 
prove pythagorean result links trp iterates establishes interesting links tree reparameterization successive projection algorithms constrained minimization bregman distances 
pythagorean result enables show xed points trp algorithm satisfy necessary conditions constrained local minimum making contact yedidia 
speci cally show cost function minimized trp algorithm bethe free energy trp xed points coincide extremal points bethe free energy xed points bp 
important bene formulation new intuitive characterization xed points particular xed point bp trp consistent suitable sense de ned respect singly connected subgraph xed point type guaranteed exist 
adapting invariance xed point characterization gaussian opposed discrete case obtain short elementary proof exactness means bp trp converges :10.1.1.73.8252
turn analysis approximation error arising application trp bp 
previous results error obtained certain special cases 
single cycle weiss derived relation exact marginals bp approximations binary processes showed local corrections applied compute exact marginals 
empirically observed certain cases approximation accuracy correlated convergence rate bp 
context turbo decoding richardson provided heuristic analysis associated error 
despite encouraging results deep broadly applicable understanding approximation error remains challenging important problem 
characterization trp bp xed points conjunction invariance property allows contribute goal analyzing approximation error arbitrary graphs 
particular development section begins derivation exact relation correct marginals approximate marginals computed trp bp 
generally analysis applies error approximation minimizing bethe free energy 
exploit exact relation derive upper lower bounds approximation error 
interpretation bounds provides understanding conditions govern performance approximation techniques trp bp 
section demonstrate notion reparameterization applies generalizations bp operate higher order cliques :10.1.1.73.8252
particular consider analogs trp updates perform reparameterization hypertrees graph 
analysis trp extends natural way general updates 
concludes section summary open questions associated reparameterization framework 
background section provides background necessary subsequent developments 
basics graphical models including necessary preliminaries graph theory 
see background graph theory 
graphical models variety di erent formalisms including directed bayesian networks factor graphs markov random elds :10.1.1.73.8252
caveats di erent representations essentially equivalent 
formalism markov random elds de ned undirected graphs 
details graphical models books :10.1.1.114.4996
discuss problem inference graphical models refers computing marginal distributions 
discuss methods exact inference trees including message passing updates belief propagation 
show exact inference trees interpreted reparameterization motivates subsequent analysis graphs cycles 
basics graphical models undirected graph consists set nodes vertices ng joined set edges cycle sequence distinct edges forming path node back 
tree connected graph cycles 
order de ne undirected graphical model place node random variable values space 
bulk focus random variables take values discrete alphabet example directed graph converted undirected graph structure may lost process :10.1.1.73.8252

case vector takes values set vectors symbols 
interest distributions constrained graph structure constraints correspond set markov properties associated undirected graph 
subsets vertex set say set separates modi ed graph removed paths nodes sets see 
words cutset graph ajb represent collection random variables conditioned notion graph separation core de nition de nition markov random eld 
random vector markov respect graph ajb cjb conditionally independent separates 
illustration relation conditional independence graph separation 
set nodes separates ajb cjb conditionally independent 
graph strongly constrains distribution vector respects markov properties :10.1.1.73.8252
express constraints introduce notion graph clique fully connected subset clique maximal properly contained clique 
compatibility function clique map depends subvector fx cg 
hammersley cli ord theorem guarantees distribution markov process graph expressed product compatibility functions cliques theorem hammersley cli ord 
graph set cliques suppose distribution formed normalized product compatibility functions cliques partition function 
underlying process markov respect graph 
conversely distribution markov random eld strictly positive represented factorized form 
bulk shall assume maximal cliques graph cardinality assumption implicit standard message passing form bp section 
singleton pairwise cliques clique index set ranges edges singleton cliques fsg 
case compatibility functions st strictly speaking probability mass function discrete random variables distribution mean thing :10.1.1.73.8252
section shall consider general markov random elds may include higher order cliques 
denote real valued functions respectively 
minor abuse notation notation refer vectors matrices respectively 
particular state discrete process quantity st thought matrix element st jk equal function value st fx kg 
similarly single node functions thought vector th component equals value fx jg 
estimation graphical models applications random vector observed noisy observations nodes basis draw inferences example context error correction coding collection fy represents bits received noisy channel vector represents transmitted codeword :10.1.1.73.8252
similarly image processing computer vision vector represents noisy observations image pixels features :10.1.1.116.8559
standard inference problem central interest computation marginal distributions node task called optimal estimation inference np hard requires summations involving exponentially terms 
indicated previously tree structured graphs exist direct algorithms optimal estimation 
graphs cycles suboptimal algorithms bp attempt compute approximations desired marginals 
section elaborate topics 
proceeding note individual node forms singleton clique factors may involve functions individual variable 
consequence bayes rule implies ect including measurements transformation prior distribution conditional distribution simply modify singleton factors equation 
result suppress explicit mention measurements problem computing marginals identical structure complexity 
exact inference trees reparameterization algorithms optimal inference trees appeared literature various elds including coding theory arti cial intelligence system theory :10.1.1.73.8252:10.1.1.73.8252
broad overview algorithms consist recursive series updates messages passed node node 
ecient implementation algorithms follows pass form rst sweeping upwards leaves node designated root downwards root leaves computational complexity 
worth noting tree inference algorithms principle applied graph clustering nodes form called junction tree :10.1.1.73.8252
junction tree procedure discussed detail section 
cases interest aggregated nodes junction tree exponentially large state cardinalities meaning applying tree algorithms prohibitively complex 
explosion state cardinality demonstration intrinsic complexity exact computations graphs cycles 
important observation arises junction tree perspective exact algorithm optimal inference trees computes marginal distributions pairs neighboring nodes :10.1.1.73.8252
doing produces alternative factorization distribution st marginal distribution variable st joint marginal illustration shows simple example tree structured distribution speci ed terms compatibility functions st factorization equation 
shows tree structured distribution reparameterized terms local marginal distributions st representation equation deduced general factorization result junction trees :10.1.1.73.8252
arrive alternative :10.1.1.73.8252
simple example tree structured graphical model 
original parameterization distribution st 
alternative parameterization st xs ps xs terms marginal distributions st interpretation exact inference trees entails computing reparameterized factorization distribution explicitly exposes local marginal distributions require additional normalization partition function 
belief propagation graphs cycles indicated message passing form bp addition exact application trees yields iterative message passing algorithm graphs cycles 
section summarize equations governing bp dynamics 
message passed alternatively equation seen symmetrized generalization known factorization markov chains 
example variables nodes form simple markov chain meaning joint distribution written equality precisely form equation 
note nal line removes asymmetry precede resulted factorization node opposed node 
node node denoted st vector element st gives value ft set neighbors notation message iteration updated messages previous iteration follows st st jk denotes normalization constant :10.1.1.73.8252
iteration beliefs approximations marginal distributions tree reparameterization framework section introduce class tree reparameterization trp updates :10.1.1.73.8252
key trp concept tree structured subgraph arbitrary graph cycles tree formed removing edges graph 
spanning tree acyclic subgraph connects vertices original graph 
illustrates de nitions panel shows nearest :10.1.1.73.8252
graph cycles typically large number spanning trees 
original graph nearest neighbor grid 
panels show spanning trees graph :10.1.1.73.8252
neighbor grid panel illustrates embedded spanning tree 
course panel just example spanning tree embedded original graph 
graph generally large number spanning trees exploit fact 
speci cally suppose corresponding edge sets set spanning trees graph distribution factored includes factors equation corresponding cliques absorbs remaining terms corresponding edges removed form tree reparameterization operation equation applied tree structured distribution order obtain alternative factorization distribution refer arbitrary normalization constant de nition may change line line 
cases easy determine local calculations 
general number spanning trees computed matrix tree theorem 

full graph distribution operation simply speci es alternative choice compatibility functions give rise distribution 
subsequent update new set functions choosing di erent tree write includes compatibility functions cliques perform reparameterization repeat process choosing step iteration 
basic steps procedure illustrated simple graph 
panel shows original parameterization terms compatibility functions st equation 
spanning tree formed removing edges shown panel case 
tree distribution corresponding :10.1.1.73.8252
illustration tree reparameterization update 
original parameterization terms compatibility functions st 
isolate terms corresponding tree 
tree structured component distribution terms tree marginals ft st 
new parameterization full distribution single iteration 
product compatibility functions reparameterized terms marginals st computed tree shown panel 
note quantities ft st exact marginals tree represent approximations true marginals fp st full graph cycles 
graph compatibility functions rst update shown panel 
subsequent update di erent tree chosen reparameterization performed 
level sequence updates just described equivalent particular tree schedule message passing 
particular tree update consists xing messages edges tree updating messages tree edges convergence 
thinking reparameterization message passing highlights fundamental property step algorithm entails specifying alternative factorization distribution leaves full distribution intact 
formalize basic idea section introduce particular parameterization distributions iterations type just described represented explicit functional updates 
parameters 
show synchronous bp interpreted performing reparameterization updates especially simple non spanning trees experimental results illustrating potential advantages tree updates synchronous bp 
exponential families distributions central exponential representation distribution graph exp log expf log partition function serves normalize distribution :10.1.1.73.8252
equation de nes family gibbs distributions graph speci ed terms set functions vector parameters exponential families distributions studied extensively statistics applied probability theory :10.1.1.73.8252
log partition function number useful properties exploit subsequent analysis 
particular straightforward calculations obtain cov denotes expectation taken respect distribution 
note quantity element fisher information matrix log 
hessian positive semi de nite convex function 
addition exponential parameterization equation induces certain form kullback leibler kl divergence useful sequel 
parameter vectors denote kl divergence distributions 
divergence written form note de nition entails minor abuse notation divergence applies distributions parameters 
remains specify choice functions indices parameterizing nodes graph indices run possible states discrete random variables 
take index set denoted set pairs tuples described form updates sequel analyze suitably relaxed formulation 
st jk choose potentials indicator functions take indicated value values indicated node pair nodes 
st jk indicator delta function equal node takes state value 
choice length mn jej jej number edges choice potentials note exponential representation related compatibility functions equation relation log similar relation st jk st typical choose linearly independent collection functions gives rise called minimal representation 
context exponential parameterization equation unorthodox overcomplete linear relations functions 
example edge linear dependence 
important consequence existence distinct parameter vectors induce distribution 
correspondence parameters distributions paramount importance analysis permits reparameterization operations leave distribution unchanged 
basic operators distribution de ned graph quantities wish compute elements dimensional marginal probability vector fp elements marginal probability vector st jk corresponding single node joint pairwise marginals respectively :10.1.1.73.8252
denote vector values fp mg de ne vector st analogous way 
vectors viewed alternative set parameters graphical distribution 
precisely quantities dual set parameters related legendre transform applied log partition function see 
frequently need consider mappings parameterizations 
particular computation marginals expressed compactly map acting parameter vector note range denoted ra highly constrained set vectors 
ra belong unit hypercube secondly normalization constraints single node joint marginal probabilities sum marginalization constraints pairwise joint distributions marginalized consistent single node marginals 
ra st jk graph tree local consistency conditions de ning guarantee existence unique distribution globally consistent local consistency implies global consistency trees see 
fact tree exists unique distribution ra graph cycles contrast exist elements realized marginals distribution see ra strictly contained strict containment re ects fact graph cycles local consistency longer sucient guarantee existence globally consistent distribution 
general graph cycles course computation equation dicult 
algorithms bp trp formulated iteratively generating approximations 
sharp distinction exact marginal vectors ra symbol denote 
mapping de ned log log st jk st jk st jk st jk quantity viewed exponential parameter vector indexes distribution graph fact consider marginal vector ra :10.1.1.73.8252
tree computation simple guaranteed indexes graphical distribution corresponding marginal vector equality simply restatement factorization equation tree structured distribution terms single node joint pairwise marginals 
cycles general marginal distributions need agree original marginals equality equation hold 
fact determining exponential parameters corresponding graph cycles dicult computation equation 
composition operators mapping marginal vector identity trees general graphs 
alternatively consider composing order de nes mapping exponential parameter vector 
general graph operator alter distribution 
tree structured graph identity mapping leave probability distribution unchanged applying corresponds shifting original parameterization tree distribution terms new exponential parameter corresponds directly factorization equation 
result application trees operator idempotent 
tree reparameterization updates basic idea trp perform reparameterization updates set spanning trees succession :10.1.1.73.8252
assume edge graph belongs spanning tree collection ft update spanning tree involves subset st jk elements 
move back forth parameter vectors full graph spanning tree de ne projection injection operators denote operators analogous equations respectively de ned trp update acts full dimensional vector changes lower dimensional subvector reason convenient notation de ne operators type instance projects exponential parameter vector spanning tree computes corresponding marginal vector distribution induced tree injects back higher dimensional space inserting zeroes elements edges indices :10.1.1.73.8252
analogous de ne constraint set imposing marginalization constraints edges spanning tree equation replaced 
note edge included spanning tree notation operation performing tree reparameterization spanning tree written compactly transforming parameter vector new vector identity operator 
terms equation parallel decomposition equation operator performs reparameterization distribution operator corresponds leaving residual term unchanged 
equation precise statement spanning tree update illustrated speci ed terms exponential parameter 
parameter vector computing straightforward involves operations spanning tree tree reparameterization algorithm generates sequence parameter vectors successive application operators sequence initialized original set compatibility functions st follows log log st jk st jk iteration choose spanning tree index update operator spanning tree initializations possible 
generally chosen exponential parameter induces distribution original compatibility functions sg st sequel consider relaxed iteration involving step size iteration recovers version :10.1.1.73.8252
restriction impose set spanning trees edge full graph included spanning tree 
necessary specify order apply spanning trees choose index 
obvious choice interest cyclic ordering set mod 
generally ordering possibly random spanning tree occurs nitely acceptable 
variety possible orderings successive projection algorithms discussed 
belief propagation reparameterization section show reformulate synchronous bp message free manner sequence local global reparameterization operations :10.1.1.73.8252
speci cally step new compatibility functions determined performing exact calculations extremely simple non spanning trees formed nodes corresponding edge joining 
denote st vector corresponding chosen initialization messages choice vector ones initialization strictly positive components permissible 
message free version bp iteratively updates approximations collection exact marginals fp st initial values ft st determined initial messages st original compatibility functions graphical model follows st jk st jk ut denotes normalization factor 
iteration updated recursions st jk st jk st jk st jk 
st jk 
update equation especially noteworthy corresponds performing optimal estimation simple node tree formed edge 
illustration shows decomposition single cycle graph node trees 
simple reparameterization algorithm operates performing optimal estimation set non spanning trees edge graph equation 
single node marginals tree merged equation 
claim reparameterization algorithm equivalent belief propagation summarizing result follows :10.1.1.73.8252
toy example original graph 
node trees updates message free version belief propagation 
computations performed exactly node tree formed single edge associated observation potentials equation 
node marginals node tree merged equation 
proposition 
reparameterization algorithm speci ed equations equivalent message passing form bp equations :10.1.1.73.8252
particular iteration initial message vector st relations st st st jk denotes normalization factor :10.1.1.73.8252
proof 
equations established induction iteration bp equations reparameterization equations :10.1.1.73.8252
empirical comparisons local versus tree updates spanning tree reaches node graph expect tree updates trp convergence properties superior local updates synchronous bp :10.1.1.73.8252
stated previously single trp update spanning tree performed xing messages edges tree updating messages edges tree convergence 
tree message updating schedules certain applications bp turbo decoding natural choices trees perform updates :10.1.1.73.8252:10.1.1.115.4360
section provide experimental evidence supporting claim tree updates superior convergence properties problems 
interesting open question raised experiments optimize choice trees necessarily spanning perform updates 
convergence rates section report results experiments convergence rates trp bp graphs single cycle nodes nearest neighbor grid larger grid :10.1.1.73.8252
rst sight global nature trp suggest trp iteration complex computationally corresponding bp iteration 
fact opposite statement true 
trp update corresponds solve tree problem exactly requires operations 
contrast iteration synchronous bp requires jej operations jej number edges graph 
order comparisons fair terms actual computation required iteration numbers report rescaled terms relative cost graph trp iterations rescaled ratio jej 
cases updates bp trp 
graph performed simulations conditions edge potentials repulsive encourage neighboring nodes take opposite values attractive encourage neighbors take value mixed potentials attractive repulsive 
experimental conditions run involved random selection initial parameter vector de ning distribution 
experiments reported generated single node parameters follows node sample set 
generate edge potential components st jk began sampling st edge jk denoting kronecker delta set edge potential components ways depending experimental condition 
repulsive condition set st jk jk jb st attractive condition st jk jk jb st mixed condition st jk jk st experimental condition performed total trials single cycle grid comparing performance trp bp 
run algorithm deemed converge mean di erence successive node elements reached threshold run algorithm failed reach graph single cycle grid bp trp table :10.1.1.73.8252
comparison convergence behavior trp versus bp single cycle nodes grid 
potentials chosen randomly conditions repulsive potentials attractive potentials mixed potentials 
second numbers box denote number convergent runs mean number iterations rescaled relative cost computed runs trp bp converged respectively 
threshold iterations classi ed failure converge :10.1.1.73.8252
condition report total number convergent trials mean number iterations required converge rescaled ratio jej trials trp bp converged 
table shows summary statistics graphs experiments 
single cycle implemented trp spanning trees spanning trees grid 
algorithms converged trials single cycle rate trp convergence signi cantly roughly times faster :10.1.1.73.8252
grid algorithm behavior depends experimental condition 
repulsive attractive conditions relatively easy dicult bp failed converge roughly trials contrast perfect convergence percentage trp 
terms mean convergence rates trp converged twice quickly bp 
mixed condition dicult suitably strong edge potentials grid case algorithms failed converge half fact tree problem solved eciently pass sweep exactly messages passed edge graph 
notation denotes zero mean gaussian variance trials trp converged frequently bp 
runs algorithms converged trp mean rate convergence roughly times faster bp 
mean convergence rates faster nd individual problems grid version trp trees converged slowly bp 
possibility take advantage optimize choice trees adaptive manner 
iteration distance fixed point bp trp iteration bp trp iteration bp trp :10.1.1.73.8252
convergence rates trp versus bp grid 
plotted log scale distance current iterate xed point versus iteration number cases bp trp converge xed point 
repulsive potentials 
mixed potentials 
particular choice mixed potentials causes diculty trp 
examined convergence behavior grid nodes version trp updates spanning trees 
provides illustration convergence behavior algorithms 
plotted log scale distance single node elements iteration xed point common bp trp versus iteration number 
trp iteration rescaled cost relative bp iterations jej large grid close 
panel illustrates case repulsive potentials trp updates converge quite bit faster bp updates 
examples attractive condition show similar convergence behavior 
panels show di erent examples mixed set potentials 
mixed condition grid especially dicult due possibility con icting frustrated interactions nodes 
problem spanning trees particular version trp choice lead faster convergence 
potentials problem contrast cause diculties pair spanning trees note erratic convergence behavior trp 
trp update ignores local interactions corresponding edges removed form spanning tree 
edges covered spanning trees set remains open question choose trees maximize rate convergence 
context imagine hybrid algorithm pure synchronous bp iterations interspersed iterations global structures trees necessarily spanning 
exploration issues remains research 
domain convergence tree updates converge wider range potentials synchronous bp :10.1.1.73.8252
simple node graph shown serves illustrate phenomenon 
simulated binary process range potential strengths ranging :10.1.1.73.8252
explicitly value deterministic assignment potential edge graph st jk jk 
potential strength conducted trials trial single node potentials set randomly sampling setting 
trial convergence algorithm assessed section :10.1.1.73.8252
plotted percentage successfully converged trials versus potential strength convergence trp bp 
simple node graph 
comparison bp trp convergence percentages versus function potential strength graph 
plotted abscissa measure potential strength multi information 
trp bp exhibit threshold phenomenon trp converging wider range potentials 
potential strength trp bp 
algorithms exhibit type threshold behavior converge success certain potential strength performance degrades rapidly 
tree updates extend ective range convergence 
fair proposed alternatives bp minimizing bethe free energy entail greater computational cost updates considered guaranteed converge stationary point 
analysis geometry xed points section number results related geometry xed points reparameterization algorithms trp bp 
de ning characteristic reparameterization algorithm original distribution altered 
accordingly section formal statement property terms exponential parameters establish validity general class relaxed updates 
develop geometric interpretation result iterates con ned linear subspace exponential parameters manifold information geometry :10.1.1.73.8252
motivated geometric view show trp update viewed projection tree constraint set projection de ned particular cost function de ned section arises approximation kullback leibler kl divergence 
section show successive trp iterates satisfy pythagorean relation respect cost function :10.1.1.73.8252
result independent interest establishes links successive projection techniques constrained minimization bregman distances 
section pythagorean relation prove xed points trp algorithm satisfy necessary conditions constrained minimum cost function 
combining results yedidia conclude xed points trp algorithm coincide bp 
pythagorean result allows formulate set sucient conditions convergence trp case spanning trees result dependent symmetry problem induced choice edge potentials instance results similar edge potentials perturbed nominal strengths small random quantities 
brie discuss section 
section provide elementary proof result originally developed concerning behavior bp jointly gaussian distributions 
geometry invariance trp updates highlighted informal set section fundamental property reparameterization algorithms trp bp change original distribution graph cycles :10.1.1.73.8252
section formalize notion invariance show holds general class relaxed updates equation 
basis invariance provide illustration trp updates terms information geometry 
geometric perspective provides intuition guides subsequent analysis reparameterization algorithms xed points 
perspective reparameterization crucial feature exponential parameterization de ned equation 
reason xed exponential parameter interesting consider subset denotes length de ned equation 
set seen closed submanifold particular note inverse image point continuous mapping 

order understand structure need link overcomplete parameterization minimal parameterization speci ed linearly independent collection functions 
illustrate basic intuition special case binary valued nodes 
case indicator functions representation expressed linear combinations functions example binary case minimal parameterization exp st model known boltzmann machine ising model 
ideas extended readily discrete processes states 
general graph pairwise cliques seen collection functions constitute minimal representation fx fx binary case illustrated parameter vector weights functions 
contrast overcomplete case minimal representation induces correspondence parameter vectors distributions 
associated distribution unique vector 
dimension exponential family see length denote :10.1.1.73.8252
equation see dimension jej jej number edges graph 
basis equivalent representations set characterized follows lemma 
set equation linear submanifold dimension 
form ja appropriately de ned matrix constraints 

geometry tree reparameterization updates exponential domain 
iterates con ned linear manifold 
curved lines correspond intersection particular spanning tree constraint set update entails moving line point xed point belongs intersection 
proof 
see appendix lemma provide geometric statement proof invariance trp updates theorem invariance distribution 
consider sequence trp iterates generated relaxed updates distribution full graph cycles invariant updates belongs set limit point sequence belongs 
addition statements hold reparameterization form bp section :10.1.1.73.8252
proof 
previously described trp update equation leave distribution unchanged 
relaxed update equation convex combination exponential vectors parameterize distribution recourse lemma proof rst statement complete 
noted earlier closed submanifold limit point sequence belong 
inductive argument establishes reparameterization form bp leaves invariant distribution full graph 
results lead geometric understanding trp updates exponential domain terms parameter vector 
order describe geometry de ning exponential analog constraint set follows vector belongs set satisfy certain nonlinear convex constraints log exp log exp st jk 
spanning tree constraint set de ne set analogous manner 
note updated guaranteed belong set algorithm ensures illustrates geometry trp updates 
sequence iterates remains linear manifold 
terms information geometry manifold linear exponential parameters :10.1.1.73.8252
note de ned linear constraints terms pseudo marginal manifolds 
set de ned equation image constraint set curved manifold terms exponential parameters 
intersection forms curved line illustrated 
update consists moving straight line current iterate point obtained applying tree reparameterization operator construction vector belongs constraint set ultimate goal reparameterization algorithm obtain point intersection tree constraint sets 
approximation kullback leibler divergence geometric view illustrated trp update corresponds moving point constraint set 
show operation corresponds type projection formulated nding point closest distance measured cost function de ned 
particular cost function central analysis arises approximation kl divergence exact tree 
vector parameter vector original graph cycles 
building blocks de ning full cost function de ne functions node edge follows st st st st jk log st jk st jk st jk st jk log de ne cost function st st st cost function equivalent bethe free energy belongs constraint set distinct vectors satisfy marginalization constraints de ning membership see related kl divergence de ned equation consider analogous function de ned spanning tree vector st st st exponential parameter vectors marginal vectors respectively de ned exponential parameterization equation applied tree indices result function related kl divergence follows establishing equivalence fact partition function factorization equation unity corresponding log partition function zero :10.1.1.73.8252
aside additive constant independent quantity viewed function equivalent kl divergence 
consider problem minimizing kl divergence function subject constraint kl divergence equation assumes minimum value zero vector correct marginals spanning tree equivalence shown equation minimizing function yield minimizing argument original graph cycles cost function equation equivalent kl divergence :10.1.1.73.8252
argument leading equation applied general graph cycles :10.1.1.73.8252
cost function lies core analysis trp 
show section trp algorithm viewed successive projection technique constrained minimization cost function reparameterization update spanning tree equation corresponds projection constraint set agrees bethe free energy constraint set allows establish equivalence trp xed points bp :10.1.1.73.8252
tree reparameterization updates projections linear subspace vector known projection euclidean norm arg min kx yk characterized orthogonality condition equivalently pythagorean relation :10.1.1.73.8252
main result section show similar geometric picture holds trp updates respect cost function consequence iteration trp viewed projecting current iterate constraint set plays role squared distance function proposition pythagorean relation 
assume sequence generated equation step sizes remains bounded 
tree index iteration de ned equation :10.1.1.73.8252
proof 
see appendix important special case proposition update case equation simpli es result analogous equation holds minimum bregman distance linear constraint set :10.1.1.73.8252
known examples bregman distances include euclidean norm kullback leibler kl divergence 
choosing kl divergence bregman distance leads projection information geometry 

illustration geometry proposition 
vector projected linear constraint set yields point minimizes cost function constraint set distance euclidean norm results form equation called pythagorean function plays role loose sense squared euclidean distance :10.1.1.73.8252
geometric interpretation illustrated 
updates guaranteed existence :10.1.1.73.8252
points analogous vertices right triangle drawn 
project point constraint set function serves distance measure 
projection yields point depicted relation arbitrary worthwhile comparing represent geometry di erent ordinate systems 
gives picture single trp update terms vectors ordinate system constraint set linear illustrated plane 
provides similar picture terms exponential parameters 
nonlinear mapping transforms constraint set analog exponential domain 
consequence non linearity sets represented curved lines exponential ordinates 
single trp update corresponds moving straight line exponential parameters point belongs 
conversely update represented moving curved line 
characterization xed points returning euclidean projection example start section consider problem projecting linear constraint set suppose constraint set decomposed intersection may dicult compute directly projection performing projections larger linear constraint sets easier :10.1.1.73.8252
scenario possible strategy nding optimal projection start image unit hypercube map example log ts :10.1.1.73.8252
updates producing iterates seen inverse image point non empty soon edge updated 
perform series projections constraint sets fl succession :10.1.1.73.8252
fact sequence projections guaranteed converge optimal approximation generally wide class algorithms formulated successive projection techniques minimizing bregman distance set formed intersection linear constraints 
example involves bregman distance euclidean norm generalized iterative scaling algorithm compute projections involving kullback leibler divergence 
pythagorean relation analogous equation instrumental establishing convergence techniques :10.1.1.73.8252
problem interest similar interested nding point belonging constraint set formed intersection linear constraint sets 
function certainly bregman distance instance assume negative values 
pythagorean result proposition allows show xed point trp algorithm satis es necessary conditions local minimum constraint set result extends orderings concreteness state cyclic ordering spanning trees tree index iteration chosen modl 
theorem characterization xed points :10.1.1.73.8252
xed point sequence iterates generated equation cyclic tree ordering step sizes 
point xed tree operators 
indices 
xed point associated unique vector 
vector satis es necessary conditions local minimum constraint set constraint set 
fixed points trp algorithm exist coincide bp 
proof 
see appendix remarks theorem order :10.1.1.73.8252
clarify result stated unique vector associated constructed explicitly follows 
arbitrary index pick spanning tree de ne value single node pairwise marginal tree distribution speci ed 
note consistent de nition condition part means spanning tree indices construction ensures satisfy normalization marginalization constraints associated node edge 
illustrates characterization xed points terms shown panel example graph cycles parameterized approximate marginals st consider set edges removed order form tree instance shows tree obtained removing edges :10.1.1.73.8252
illustration xed point consistency condition 
fixed point ft st original distribution full graph cycles 
tree edge set formed removing edges 
corresponding tree structured distribution formed removing reparameterized functions 
subset ft ft st consistent set marginals tree structured distribution 
graph 
suppose remove functions st sit non tree edges remaining functions form tree structured distribution follows st edge set tree consistency condition theorem guarantees subcollection ft ft st exact marginals tree structured distribution :10.1.1.73.8252
say vector tree consistent respect tree fact tree consistency holds acyclic substructure embedded full graph cycles just spanning trees implement algorithm 
theorem provides alternative intuitive view bp trp algorithms attempt distribution graph cycles consistent respect tree :10.1.1.73.8252
regard part theorem noteworthy guarantees positive distribution graph reparameterized terms satis es tree consistency condition part :10.1.1.73.8252
existence reparameterization known trees means obvious arbitrary graph cycles 
context theorem equivalence trp bp xed points follows bethe free energy coincide constraint set possible establish equivalence constructive manner :10.1.1.73.8252
particular xed point fm st message updates equation transformed vector ft st follows st jk st jk ut message xed point condition equation guarantees corresponding ft st satisfy marginalization constraints necessary membership constraint set elements locally consistent respect simple node trees formed single edges illustrated :10.1.1.73.8252
junction tree perspective know local consistency marginals edges equivalent global consistency trees :10.1.1.73.8252
local consistency edges de ning membership implies vector consistent singly connected substructure embedded consequence collection speci ed message xed point satis es tree consistency condition part illustrated 
generally similar line reasoning establishes constrained local minimum bethe free energy obtained trp bp alternative minimization technique identi ed vector satisfying condition theorem :10.1.1.73.8252
sucient conditions convergence spanning trees proposition derive set conditions sucient guarantee convergence case spanning trees 
convey intuition underlying result suppose possible interpret cost function distance function 
suppose arbitrary element apply proposition index equation show distance arbitrary element measured decreases iteration :10.1.1.73.8252
proofs convergence successive projection techniques bregman distances property allow establish convergence algorithm 
course problems type distance necessarily non negative possible 
respect rst issue able show general appropriate choice step size ensure non negativity 
derive sucient conditions including assuming second problem arise trp trajectories convergence case spanning trees 
detailed statement proof result thesis 
implications continuous variables focus point random vectors discrete values idea reparameterization applied continuous variables 
particular extension gaussian case obtain elementary proof result means computed bp converges correct 
establish result consider gaussian analog trp 
simplicity notation treat case scalar gaussian random variables node ideas extend easily vector case 
scalar gaussian case approximate marginal distribution node parameterized mean variance similarly approximate joint distribution st parameterized mean vector st st st covariance matrix 
iteration edge labeled edge function st st st st st dx marginal distribution induced st edge function parameterized mean vector st quadratic form st st st st st 
set proposition :10.1.1.73.8252
consider gaussian analog trp bp suppose converges 
computed means exact general error covariances incorrect 
proof 
original problem speci cation log inverse covariance constant independent correct means graph cycles :10.1.1.73.8252
noting gaussian analog theorem guarantees distribution remain invariant reparameterization updates trp bp 
iteration distribution reparameterized terms edge functions follows log st st st st st st st note vector ft st need consistent example st need equal :10.1.1.73.8252
suppose trp bp converges quantities equal particular implies st 
means parameterizing edge functions agree means node marginals 
case equations alternative representations quadratic form node means computed trp bp exact :10.1.1.73.8252
contrast means reason expect error covariances graph cycles need exact 
worth remarking exist highly ecient techniques numerical linear algebra conjugate gradient computing means linear gaussian problem graph 
trp bp compute correct means converge little reason apply practice 
remains interesting problem computing correct error covariances node refer reader description embedded spanning tree method eciently computes means error covariances linear gaussian problem graph cycles :10.1.1.20.127
analysis approximation error important dicult problem analysis error bp approximation di erence exact marginals bp approximate marginals 
discussed section results error obtained special cases single cycle graphs turbo codes 
general understanding error desirable assessing accuracy bp approximation 
section contribution problem deriving exact expression error bp approximation arbitrary graph 
analysis bp approximation error fundamental properties xed point invariance stated theorem distribution induced xed point equivalent original distribution 
secondly part theorem dictates arbitrary spanning tree single node elements log correspond exact marginal distributions spanning tree :10.1.1.73.8252
quantities ft xg distinct interpretations bp trp approximations exact marginals graph cycles 
exact single node marginals distribution de ned spanning tree basic intuition captured 
panel shows original distribution graph cycles reparameterized alternative equivalent manner set ft st consequence possible perform exact computations distribution illustrated result desired exact marginals original distribution 
hand tree shown suppose form tree structured distribution equation removing functions st non tree edges :10.1.1.73.8252
tree consistency condition theorem ensures quantities consistent set single node marginals :10.1.1.73.8252
exact marginals graph cycles related approximations relatively simply perturbation removing functions edges form spanning tree 
analysis follows basic intuition precise 
exact expression treatment begins slightly general level specializing case marginal distributions bp trp approximations 
consider function distributions 
suppose wish express expectation terms expectation distribution 
exponential representation equation straightforward show exp note change measure formula exponentiated quantity viewed radon nikodym derivative :10.1.1.73.8252
specializing equation problem hand denote true single node marginal graph cycles assert equality invariance property theorem :10.1.1.73.8252
assume bp trp converges exponential parameter associated vector case theorem guarantees single node elements interpreted expectations assignments equation re arrange obtain exp ana fact :10.1.1.73.8252
equation exact expression error terms expectation tree structured distribution 
note equation holds spanning tree indices 
tree consistency condition theorem ensures xs independent choice spanning tree index :10.1.1.73.8252
error bounds important observe equation conceptually interesting impossible compute 
primary problem stems presence term expf ana expectation right hand side 
problems computation tractable involves potential functions edges removed form spanning tree computation equation easy particular graph imply compute exact marginals obviating need approximate algorithm bp trp 
intractability motivates idea bounding approximation error 
order considering problem distributions function give bound expectation terms quantities computed distribution 
linearity expectation allows assume loss generality function covariance de ned cov ff de nitions result lemma :10.1.1.73.8252
arbitrary parameter vectors 
function interval 
bound holds exp cov ff proof 
see appendix lemma deriving bounds approximation error single node marginals 
order state bounds convenient de ne quantity spanning tree measures di erence exact node marginal corresponding approximation corresponding tree structured distribution 
recall set ana corresponds set potentials removed full graph order form spanning tree accordingly de ne quantity 
sum potentials removed form tree distribution ana cov de nition error bounds approximation error theorem error bounds 
xed point trp bp giving rise approximate single node marginals true marginal distributions graph cycles 
spanning tree index error log log bounded follows log log exp proof 
rst identi cations set choice satis es assumptions lemma 
equation follows applying lemma followed algebraic manipulation 
lower bound follows argument applied satis es hypotheses lemma 
conceptual side theorem highlights factors control accuracy trp bp approximation 
sake concreteness consider upper bound equation covariance terms de ning 
re ect strength interaction measured tree distribution delta function clique potential 
removed clique potential interacts weakly delta function covariance term small little ect 
parameter amount weight placed clique potential removed form spanning tree 
kl divergence measures discrepancy tree structured distribution distribution graph cycles 
small distribution approximated tree 
presence term re ects empirical nding bp performs graphs approximately tree graphs fairly long cycles 
practical side caveat associated computation upper lower bounds theorem 
hand summations appearing equations tractable 
particular covariances calculated expectations treestructured distributions weighted summation simpler 
hand kl divergence log partition function associated graph cycles 
general computing quantity costly performing inference original graph 
required order compute expressions theorem upper bounds log partition function 
class upper bounds available ising model related developed new technique upper bounding partition function arbitrary undirected graphical model 
methods allow upper bounds expressions theorem computed 
illustrative examples bounds tightness bounds theorem varies depending number factors including choice spanning tree graph topology strength type clique potentials :10.1.1.73.8252
section provide examples illustrate role factors 
purposes illustration convenient display bounds error bounds log error theorem 
straightforward transform results theorem form exp exp di erence marginal probabilities error belongs interval 
attractive feature upper lower bounds con ned interval 
primary goal section illustrative bounds displayed computed exact value 
choice spanning tree note bound error form theorem equation holds subgraph embedded graph just spanning trees implement algorithm :10.1.1.73.8252
allows choose tightest spanning tree bounds index 
provide simple example demonstrating ect tree choice quality bounds 
node number actual error upper lower bounds node number error marginal actual error upper lower bounds :10.1.1.73.8252
ect spanning tree choice bounds theorem 
panel shows error versus node number complete graph nodes 
upper lower bounds error computed maximum weight spanning tree 
error bounds problem computed minimum weight spanning tree 
note di erence vertical scales 
binary distribution complete graph nodes chose spanning trees heuristic 
rst computed minimal exponential parameter equation corresponding overcomplete parameter st weight edge computed maximum minimum weight spanning trees kruskal algorithm :10.1.1.73.8252
panels show upper lower bounds error obtained equations maximum minimum weight spanning trees respectively 
disparity sets bounds striking 
examine principled techniques optimizing choice spanning tree obtain tightest possible error bounds particular node 
graph topology quality bounds varies depending graph topology speci cally depending close graph tree :10.1.1.73.8252
illustrate behavior bounds problems single cycle nodes nearest neighbor grid fully connected graph graph simulated binary process minimal exponential parameter equation :10.1.1.73.8252
graphs edge chose edge weight st randomly equal probability node 
randomly chosen spanning tree computed bounds equation 
results experiments displayed 
panel shows single cycle case error bp trp approximation bounds error small 
high degree accuracy expected single cycle close tree 
grid node number actual error upper lower bounds node number actual error upper lower bounds node number actual error upper lower bounds :10.1.1.73.8252
ect varying graph topology tightness bounds 
single cycle nodes 
bp approximation bounds quite tight 
nearest neighbor grid bp approximation bounds looser :10.1.1.73.8252
fully connected graph bp approximation bounds considerably looser 
shown panel accuracy bp approximation degraded tightness bounds 
fully connected shown bp approximation quite poor bounds correspondingly looser 
varying potentials third xed graph bounds depend strength type potentials :10.1.1.73.8252
examine behavior bounds binary variables attractive repulsive mixed potentials see section relevant de nitions :10.1.1.73.8252
illustrates behavior binary valued process grid various conditions :10.1.1.73.8252
panel shows error randomly chosen subset nodes lower upper bounds error equation 
panel corresponds problem weak mixed potentials bp approximation corresponding bounds tight 
contrast panel shows case strong repulsive potentials bp approximation poor 
error bounds correspondingly weaker track general trend error 
panels show cases attractive potentials medium strength strong 
bp approximation mediocre bounds relatively loose 
strong potentials bp approximation heavily skewed lower bound nearly met equality nodes 
uses error analysis preceding examples serve illustrate general behavior bounds theorem variety problems :10.1.1.73.8252
re iterate bounds computed exact value general necessary upper bound quantity see tend weaken bounds 
possibility suciently strong potentials large graphs bounds may remain quantitatively useful upper lower bounds equation tend respectively 
error analysis provides useful information 
direction explore possibility exact error analysis derive correction terms bp approximation 
instance term 
de ned equation computable rst order correction term bp approximation 
understanding corrections useful interesting open problem 
goal obtaining better approximations various researchers proposed node number error marginal actual error upper lower bounds node number actual error upper lower bounds node number error marginal actual error upper lower bounds node number actual error upper lower bounds :10.1.1.73.8252
behavior bounds theorem various types problem grid 
panel shows error bp approximation versus node index randomly chosen subset nodes 
weak potentials bp approximation excellent bounds quite tight 
strong repulsive potentials bp approximation poor error bounds considerably looser track error 
medium strength attractive potentials approximation mediocre bounds relatively loose 
strong attractive potentials bp approximation poor lower bound error quite 
extensions bp 
sketch section extensions analyzed reparameterization perspective error bounds derived 
intractable partition function original model regardless approximation plays role relative error accuracy di erent approximations 
bounds useful assessing structured approximation generalized belief propagation yields accurate results 
extensions tree reparameterization number researchers proposed extensions belief propagation involve operating higher order cliques 
extensions include generalized belief propagation gbp updates yedidia expectation propagation updates minka :10.1.1.73.8252
section describe extensions belief propagation interpreted performing reparameterization 
reviewing junction tree representation distributions role triangulated graphs :10.1.1.73.8252
details junction tree concept books 
introduce concept hypergraphs represent generalization ordinary graphs provide useful framework introduce extensions tree reparameterization 
important point correspondence hypertrees acyclic hypergraphs triangulated graphs 
equipped background describe perform reparameterization updates hypertrees correspond higher level analog spanning trees 
illustration show gbp updates kikuchi clusters grid understood reparameterization hypertrees 
reparameterization perspective allows earlier analysis including geometry characterization xed points error analysis extended generalizations bp natural way 
junction tree representation heart trp updates factorization tree structured distribution terms marginals speci ed equation 
fact representation special case general junction tree theorem describe :10.1.1.73.8252
graph natural consider clustering nodes form tree running standard tree algorithm 
approach successful tree formed clustering nodes satis es certain property subject junction tree representation 
formally clique tree acyclic graph formed cliques calligraphic refer clique example shows single cycle maximal cliques formed edges 
possible clique tree graph shown panel ovals denote cliques rectangles denote intersections adjacent cliques known separator sets 
say clique tree running intersection property :10.1.1.73.8252
illustration junction tree property 
single cycle nodes 
possible clique tree graph fails running intersection property 
triangulated version graph 
junction tree associated graph 
cliques nodes unique path joining contain intersection clique tree property known junction tree 
note clique tree satisfy running intersection property node belongs cliques cliques path joining :10.1.1.73.8252
graph triangulated cycle length greater chord edge non consecutive vertices cycle 
important result graph theory asserts graph junction tree triangulated :10.1.1.73.8252
observe single cycle triangulated cycle lacks chord 
basis correspondence triangulated graphs junction trees associate junction tree graph rst forming triangulated version forming junction tree basis simple illustration shows triangulated version cycle panel obtained adding chord :10.1.1.73.8252
associated junction tree maximal cliques ellipses separator sets intersections adjacent maximal cliques rectangles shown panel 
consider distribution formed product compatibility functions cliques equation 
signi cance junction tree concept gives rise alternative factorization terms marginal distributions associated junction tree :10.1.1.73.8252
denote set maximal cliques denote set separator sets junction tree 
junction tree representation denote marginal distributions maximal clique separator set respectively 
junction tree representation forms basis method principle perform exact inference compute marginals arbitrary graph 
graph rst step add edges triangulate construct junction tree 
applying tree algorithm exact inference recover factorization terms local marginals equation 
running intersection property inherent de nition junction tree necessary ensure consistency copies random variable see 
unfortunately cost applying junction tree algorithm scales exponentially size maximal cliques junction tree alternatively stated treewidth graph 
graphs suciently large treewidth prevent direct application junction tree method 
hypergraphs hypertrees order describe generalizations tree reparameterization convenient introduce formalism hypergraphs hypertrees background book tutorial :10.1.1.73.8252
hypergraph consists vertex set ng set hyperedges hyperedge subset element power set 
hyperedges say covers shall assume hyperedge set contains contains hyperedges covered hyperedge maximal contained hyperedge 
note ordinary graph special case hypergraph maximal hyperedges consist pairs vertices 
graph suppose cliques de ne set hyperedges 
hypergraph de ned way known clique hypergraph associated example graph maximal cliques size 
associated clique hypergraph hyperedges size ranging triangles vertices 
particular interest acyclic hypergraphs hypergraph analog trees acyclic graphs 
hypergraph acyclic represented junction tree maximal hyperedges play role maximal cliques junction tree satisfy running intersection property 
width acyclic hypergraph size maximal hyperedge minus term hypertree refer acyclic hypergraph width single connected component 
example spanning tree ordinary graph hypertree 
example provided panel shows acyclic hypergraph embedded clique hypergraph shown panel 
acyclic nature hypergraph veri ed constructing associated junction tree shown 
concept clique hypergraph leads alternative interpretation factorization equation product compatibility functions hyperedges clique hypergraph 
clique hypergraph acyclic hypertree :10.1.1.73.8252
illustration hypergraphs hypertrees 
graph cliques induces clique hypergraph maximal hyperedges size :10.1.1.73.8252
hypertree embedded clique hypergraph 
junction tree representation hypertree 
correspondence hypertrees junction trees know junction tree representation terms marginals maximal cliques separator sets equation 
junction tree form convenient purposes alternative equivalent factorization directly hypertree structure 
state factorization rst de ne hyperedge function de nition factorization hypertree structured distribution simple note product taken hyperedges just maximal ones hypertree 
illustrate equation suppose rst hypertree ordinary tree case hyperedge set consists union vertex set ordinary edge set 
vertex st st edge 
special case equation reduces tree factorization equation 
second example provided hypertree shown maximal hyperedges explicit computation veri ed equation reduces cancelling terms simplifying :10.1.1.73.8252
nding agrees junction tree representation equation applied junction tree shown 
reparameterization hypertrees set ready describe extension reparameterization hypertrees :10.1.1.73.8252
starting point hypergraph upper bound size maximal hyperedges 
associated hypergraph distribution formed product compatibility functions hyperedges 
implicit assumption suciently small exact inference performed hypertrees width 
idea perform sequence reparameterization updates entirely analogous trp updates collection hypertrees width embedded hypergraph 
updates involve collection ft hyperedges hypergraph :10.1.1.73.8252
iteration collection speci es particular parameterization original distribution analogous hypertree factorization equation 
see appendix details parameterization 
hypertree distribution decomposed product terms includes factors corresponding hyperedges hypertree absorbs remaining terms corresponding hyperedges removed form hypertree 
hypertree distribution reparameterized terms collection hyperedges equation 
ordinary tree reparameterization operation simply speci es alternative equivalent choice compatibility functions hyperedges hypertree 
subsequent update entails choosing di erent hypertree performing reparameterization 
iterate set hypertrees covers hyperedges hypergraph 
:10.1.1.73.8252
kikuchi clustering grid 
original grid 
cluster choice 
associated clique hypergraph maximal hyperedges size 
acyclic hypergraph width spanning embedded 
speci choices clique hypergraph hypertrees shown xed points hypertree reparameterization equivalent xed points certain forms generalized belief propagation gbp :10.1.1.73.8252
illustration consider nearest neighbor grid shown 
illustrated panel particular grouping nodes known kikuchi clustering statistical physics 
hypergraph perspective clustering amounts forming clique hypergraph shown panel largest hyperedges size clusters nodes 
acyclic hypergraph obtained removing hyperedge hyperedges covers shown panel 
hypertree updates entail performing reparameterization collection hypertrees cover clique hypergraph 
show detail appendix doing yields xed points equivalent gbp kikuchi approximation shown panel 
hypertree updates natural generalization trp updates inherit important properties trp including fact original distribution altered 
xed points specify alternative parameterization consistent hypertree width embedded graph 
invariance xed point characterization possible derive exact expression bounds di erence exact marginals approximate marginals computed hypertree reparameterization algorithm 
details class reparameterization algorithms thesis 
precisely trees equivalent hypertrees width 
discussion developed new conceptual framework understanding belief propagation related algorithms interpretation performing sequence reparameterization updates :10.1.1.73.8252
step reparameterization entails specifying new set compatibility functions acyclic subgraph tree full graph 
key property algorithms original distribution changed simply reparameterized 
ultimate goal obtain new factorization functions cliques required satisfy certain local consistency conditions represent approximations exact marginals 
particular computed tree reparameterization algorithm consistent tree embedded graph cycles strongly constrains nature approximation 
important feature reparameterization view insight provides nature approximation error associated bp broadly algorithm minimizes bethe free energy 
particular error arises reparameterized functions sitting edges removed order form spanning tree 
intuition derived exact expression approximation error arbitrary graph cycles 
developed upper lower bounds approximation error provided illustrations behavior 
computing bounds large problems requires upper bound log partition function 
class algorithms interpreted performing reparameterization rich including trp bp various extensions bp generalized belief propagation expectation propagation :10.1.1.73.8252
algorithm reparameterization interpretation basic intuition applicable exist results analogous xed points approximation error see 
interesting nd related concept reparameterization gives insight behavior closely related max product algorithm 
proof lemma expressing delta function linear combination monomials set de ned equation follows decomposition extended readily pairwise delta functions de ned products particular written linear combinations elements sets de ned equation equation respectively 
suppose log log construction lhs rhs linear combination elements 
equating coecients terms yields set jej linear equations 
write equations compactly matrix form establishes necessity linear manifold constraints 
establish suciency need check linear constraints ensure constant terms log log respectively equal 
straightforward veri cation 
proof proposition preliminary de nitions lemmas :10.1.1.73.8252
closed convex set say algebraic interior point exists exterior point 
lemma characterizes nature constrained local minimum lemma :10.1.1.73.8252
function closed convex nonempty set 
suppose local minimum rf algebraic interior point rf proof 
see proof rst statement 
prove second statement assume algebraic interior point arbitrary write 
rf rf rf rf establishes rf rf 
lemma 
arbitrary 
bounded proof 
established section point minimizing argument function de ned equation linear convex set point exterior point element equal zero possibility prevented assumption bounded :10.1.1.73.8252
algebraic interior point meaning apply lemma conclude remains calculate necessary partial derivatives decomposition st st st st de ned equation :10.1.1.73.8252
calculate st jk st jk st jk substituting quantities equation evaluated obtain st jk st jk st jk st jk de nition belong st jk st jk result constants equation vanish sums fj kg left desired statement equation :10.1.1.73.8252
equipped lemmas establish equation writing fact bounded assumption apply lemma conclude establishing equation identi cations :10.1.1.73.8252
extend result de nition equation write obtained nal line equation 
proof theorem action trp algorithm ensures xed point satis es :10.1.1.73.8252
construct unique 
arbitrary index pick spanning tree possible construction 
de ne consistent de nition spanning tree indices construction clear 
arbitrary 
applying proposition repeatedly obtain 
part parameter induces unique vector apply equation fact construction obtain substituting result back equation nd prove satis es necessary conditions local minimum note sequence steps similar proof proposition 
cost function bounded constraint set non empty problem minimum 
point satisfy necessary conditions local minimum part 
establish equivalence bp xed points recall cost function agrees bethe free energy constraint set 
yedidia shown bp xed points correspond points satisfy lagrangian conditions extremum bethe free energy constraint sets linear existence lagrange multipliers guaranteed local minimum 
recourse farkas lemma lagrangian conditions equivalent condition stated 
conclude trp xed points exist coincide bp 
proof lemma consider function log exp seen log partition function corresponding distribution exp convex 
parameter vectors convexity allows write partial derivative calculated 
observe relation log 
substituting relations equation rearranging exponentials yields bound equation 
hypergraph parameterization appendix gives details hypergraph parameterization 
suppose hyperedge hypergraph just maximal ones 
hyperedge covered de ne xg induced note assuming collection fully consistent 
example cover hyperedge need equal quantities equal de ned hyperedge hypertree reparameterization updates converge consistency conditions hold 
hyperedge de ne quantity quantity viewed function addition note hyperedge quantity agree recursive de nition equation 
de nitions collection speci es alternative parameterization original distribution full hypergraph includes cycles general follows illustration clique hypergraph arises ordinary graph pairwise maximal cliques hyperedges consist ordinary edges vertices 
ordinary edge st st st st st vertex 
special case parameterization equation equivalent ft st parameterization updated trp bp 
hypertrees kikuchi approximation appendix show gbp kikuchi approximation interpreted type hypertree parameterization 
clique hypergraph maximal hyperedges size :10.1.1.73.8252
hyperedge set consists hyperedges smaller hyperedges covered 
collection hyperedge set original distribution new parameterization equation 
update entails choosing hypertree corresponding hypertree distribution 
example shows hypertree spanning obtained removing maximal hyperedge hyperedges covered :10.1.1.73.8252
order form hypertree distribution remove set terms suppose perform reparameterization set hypertrees cover hypergraph :10.1.1.73.8252
updates converge xed point hypertree consistent respect hypertrees 
hypertrees cover hypergraph pair guaranteed consistency condition de ned equation 
hyperedge consistency conditions expand simplify reparameterization follows jhj nal line follows algebra terms common numerator denominator cancel :10.1.1.73.8252
cancelling terms consistency conditions satis ed described 
expected log factorization approximation entropy agrees associated kikuchi approximation problem :10.1.1.73.8252
aji horn mceliece 
convergence iterative decoding graphs single cycle 
proceedings ieee intl 
symp 
information theory page cambridge ma 
aji mceliece 
generalized distributive law 
ieee trans 
info 
theory march :10.1.1.73.8252
amari :10.1.1.73.8252
di erential geometry curved exponential families curvatures information loss 
annals statistics :10.1.1.73.8252
amari 
information geometry boltzmann machines 
ieee trans 
neural networks :10.1.1.73.8252
anderson 
map decoders 
ieee sel 
areas comm february :10.1.1.73.8252
nielson 
information exponential families 
wiley chichester 
basseville benveniste chou golden willsky 
modeling estimation multiresolution stochastic processes 
ieee transactions information theory march :10.1.1.73.8252
baxter 
exactly solved models statistical mechanics 
academic press new york 
berge 
hypergraphs 
north holland publishing amsterdam 
bertsekas 
nonlinear programming 
athena scienti belmont ma 
besag 
spatial interaction statistical analysis lattice systems 
roy 
stat 
soc 
series :10.1.1.73.8252
biggs 
algebraic graph theory 
cambridge university press cambridge :10.1.1.73.8252
bodlaender :10.1.1.73.8252
tourist guide treewidth 
acta cybernetica :10.1.1.73.8252
bollob 
modern graph theory 
springer verlag new york 
censor zenios 
parallel optimization theory algorithms applications 
numerical mathematics scienti computation 
oxford university press 

statistical decision rules optimal inference volume translations mathematical monographs :10.1.1.73.8252
american mathematical society 
cooper 
computational complexity probabilistic inference bayesian belief networks 
arti cial intelligence :10.1.1.73.8252
cover thomas 
elements information theory 
john wiley sons new york 
cowell dawid lauritzen spiegelhalter 
probablistic networks expert systems 
statistics engineering information science 
springer verlag 
csisz ar 
divergence geometry probability distributions minimization problems 
annals probability feb :10.1.1.73.8252
darroch ratcli generalized iterative scaling log linear models 
annals mathematical statistics :10.1.1.73.8252
freeman pasztor :10.1.1.73.8252:10.1.1.116.8559
learning low level vision 
intl 
computer vision 
gallager :10.1.1.73.8252
low density parity check codes 
mit press cambridge ma :10.1.1.73.8252
grimmett 
theorem random elds 
bulletin london mathematical society :10.1.1.73.8252
gupta editor 
di erential geometry statistical inference volume lecture notes monograph series 
institute mathematical statistics hayward ca 
jaakkola jordan 
recursive algorithms approximating probabilities graphical models 
nips 
jensen 
bayesian networks 
ucl press london 
jordan 
learning graphical models 
mit press cambridge ma 
jordan ghahramani jaakkola saul 
variational methods graphical models 
learning graphical models pages 
mit press 
forney jr kschischang marcus :10.1.1.73.8252
iterative decoding tail biting connections symbolic dynamics 
codes systems graphical models pages :10.1.1.73.8252
springer 
:10.1.1.73.8252
graphs networks algorithms 
springer new york 
kikuchi :10.1.1.73.8252
theory cooperative phenomena 
physical review :10.1.1.73.8252
kschischang frey :10.1.1.73.8252
iterative decoding compound codes probability propagation graphical models 
ieee sel 
areas comm february :10.1.1.73.8252
lauritzen :10.1.1.73.8252
graphical models 
oxford university press oxford 
lauritzen spiegelhalter :10.1.1.73.8252
local computations probabilities graphical structures application expert systems discussion 
journal royal statistical society january 
mceliece mckay cheng :10.1.1.73.8252:10.1.1.115.4360
turbo decoding instance pearl belief propagation algorithm 
ieee jour 
sel 
communication february 
minka :10.1.1.73.8252
family algorithms approximate bayesian inference 
phd thesis mit january 
murphy weiss jordan :10.1.1.73.8252
loopy belief propagation approximate inference empirical study 
uncertainty arti cial intelligence volume 
pearl :10.1.1.73.8252
probabilistic reasoning intelligent systems 
morgan kaufman san mateo 
richardson 
geometry turbo decoding dynamics 
ieee trans 
info 
theory january :10.1.1.73.8252
rockafellar 
convex analysis 
princeton university press princeton 
van roy 
analysis turbo decoding gaussian densities 
nips pages 
mit press 
tanaka morita :10.1.1.73.8252
cluster variation method image restoration problem 
physics letters :10.1.1.73.8252
wainwright jaakkola willsky 
new class upper bounds log partition function 
uai volume august 
wainwright jaakkola willsky 
tree consistency bounds max product algorithm generalizations 
lids tech 
report mit june 
wainwright sudderth willsky :10.1.1.20.127
tree modeling estimation gaussian processes graphs cycles 
nips pages :10.1.1.73.8252
mit press 
wainwright 
stochastic processes graphs cycles geometric variational approaches 
phd thesis mit january 
weiss 
correctness local probability propagation graphical models loops 
neural computation 
weiss freeman 
correctness belief propagation gaussian graphical models arbitrary topology 
nips pages :10.1.1.73.8252
mit press 
welling teh 
belief optimization stable alternative loopy belief propagation 
uncertainty arti cial intelligence july 
wu peter 
tree approximations markov random elds 
ieee trans 
pami april :10.1.1.73.8252
yedidia freeman weiss 
generalized belief propagation 
nips pages :10.1.1.73.8252
mit press 
yedidia freeman weiss :10.1.1.73.8252
understanding belief propagation generalizations 
technical report tr mitsubishi electric research labs january 
yuille 
double loop algorithm minimize bethe kikuchi free energies 
neural computation appear 

