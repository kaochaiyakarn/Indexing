martingale pricing measures incomplete markets stochastic programming duality dual alan king ibm com mathematical sciences department ibm watson research center yorktown heights ny lisa korf korf math washington edu department mathematics university washington seattle wa 
propose new framework analyzing pricing theory incomplete markets contingent claims conjugate duality optimization theory 
various statements literature fundamental theorem asset pricing give conditions essentially arbitrage free market equivalent existence equivalent martingale measure formula fair price contingent claim expectation respect measure 
setting incomplete markets fair price attainable particular expectation supremum infinite set equivalent martingale measures 
consider problem stochastic program derive pricing results quite general discrete time processes 
shown general form martingale pricing measure attainable permitted finitely additive 
setup gives rise natural way analyzing models risk preferences spreads margin constraints problem variants 
consider discrete time multi stage infinite probability space setting derive basic results arbitrage pricing framework 
keywords arbitrage pricing conjugate duality contingent claims martingales stochastic program relatively complete recourse singular multipliers finitely additive measures ams classification date september 
nobel prize winning black scholes merton developed arbitrage pricing formula options attention devoted understanding generalizing applying pricing model variants 
techniques today involved stochastic differential equations particular relying assumption market price process continuous time behaves geometric brownian motion 
setting unique fair option price obtained form linear pricing rule 
different perspectives emerged need model market price processes necessarily conform diffusion processes amenable stochastic differential equations framework types options related financial instruments situations unique price range fair prices exist 
dominant new mathematical perspectives harrison kreps studied black scholes formula results functional analytic setting involving representation martingales 
harrison kreps saw results generalized new setting relatively general assumption market prices square integrable 
take care note original black scholes type models derive price explicitly partial differential equation exactly challenged development general framework new framework offer means obtaining option price explicitly 
come new approach known fundamental theorem asset pricing depends concept arbitrage guaranteed profit risk condition automatically satisfied geometric brownian motion setting 
theorem gives conditions market essentially arbitrage free equivalent probability measure price process martingale 
measure unique fair price determined expectation respect 
shown harrison black scholes model martingale measure exists unique leading unique price true general seen 
contrast continuous time stochastic differential equation framework new functional analytic approach come variations generalizations late problems incomplete markets transaction costs spreads margins important variations 
kinds issues unmanageable left relatively untouched stochastic differential equations setting 
extended fundamental theorem asset pricing functional analytic setting include incomplete markets setting semi martingale price processes ultimately providing supremum formula pricing martingale measures 
indicates pricing measure may attainable general incomplete markets 
convexity duality heart functional analytic pricing results cf 

pricing problems closely related portfolio optimization problems naturally cast optimization setting proposal analyze perspective conjugate duality optimization 
leads modeling pricing problems related portfolio optimization problems stochastic programs offering rich natural framework real problem descriptions inclusion additional variables include additional possibility power production contracts energy market constraints problem variations welcome stochastic programming setting appear unnatural purely functional analytic framework appear stochastic differential equations framework 
additionally significantly stochastic programming framework provides ideal avenue eventual computation way get hands fair prices general setting 
duality stochastic programming infinite dimensional spaces appeared eisner olsen wets 
eisner olsen proposed lp lq duality framework stochastic linear programs specific structure obtaining theorems type min min max indicates solution attainable 
time wets similar contribution duality setting stochastic linear programs general structure random recourse matrix 
late rockafellar wets joined forces produce series seminal papers stochastic programming duality general convex problems setting cf 

reason choice spaces deal tricky constraint qualifications general lp spaces problems special structure 
came significance notion relatively complete recourse constraints implicit constraints induced past decision variables obtaining strong duality results form inf maxd general setting possibly unbounded constraint sets 
additionally considered duality settings pairing continuous functions measures useful variety applications strong duality theorems inf maxd obtained setting singular linear functionals play role 
concept arrive general results 
back proposed different duality framework continuous time models pairing spaces functions bounded variation class measures applying pricing problems 
attempt authors aware consider arbitrage pricing infinite dimensional stochastic programming duality setting 
king takes step goal casting pricing problems contingent claims optimization setting analyzing arbitrage arbitrage pricing mean discrete time finite probability space incomplete market pricing model may cast linear program 
associated dual problem analyzed linear programming duality leading derivation generalized pricing results comparable harrison kreps harrison finite optimization setting 
addition observes boundedness portfolio optimization problem associated contingent claim equivalent arbitrage condition 
demonstrated naturally add risk preferences utilities spreads margins variations problem derive compute associated modified pricing results simply analyzing solving new dual problems obtained 
significant aspect measure yielding fair price dual attainable discrete time probability space setting 
goal stochastic programming duality type set natural framework arbitrage arbitrage pricing incomplete markets includes attainment pricing measures 
approach taken generalize discrete time optimal portfolio pricing models king apply general finite probability spaces derive arbitrage pricing results incomplete markets multi stage discrete time stochastic programming duality setting 
section introduces requisite terminology mathematical finance 
main problems introduced introduce portfolio optimization problem seller writer contingent claim option 
pass writer fair price model feasibility problem associated portfolio optimization problem 
section reviews conjugate duality optimization 
section stochastic programming duality type applied main problems obtain relationships optimal values original problems optimal values duals 
turn leads equivalent expressions boundedness optimization problems terms feasibility duals 
section shown unboundedness writer portfolio optimization problem equivalent condition call free lunch limit closely related slightly weaker implied free lunch characterization arbitrage 
closely related concept free lunch vanishing risk described slightly intuitive investor perspective 
section introduces necessary concepts probability theory culminating definition equivalent finitely additive martingale measure stochastic process 
results previous sections analysis dual portfolio optimization problems obtained section shown section free limit exists equivalent finitely additive martingale measure market price process establishing fundamental theorem asset pricing setting 
shown examination solutions dual pricing optimization problem solutions exist fair writer price expectation respect solution considered absolutely continuous finitely additive martingale measure market price process 
case dual variables determine associated martingale measures sense measures broken parts corresponding constraints primal problem 
induced constraints play role warrants investigation 
subsequent develop continuous time stochastic programming models trades occur finite number unspecified trading dates simple predictable processes key generalization 

writer problems mathematical overview necessary financial terminology 
underlying considerations market mean collection traded assets indexed asset initial market price time market prices times prices described nonnegative vector sj ir initial known market prices nonnegative valued random vectors st ir market prices underlying probability space complete sigma algebra generated filtration ft ft assumed asset price vectors risk free sense strictly positive 
call riskless asset proceed immediately normalize values assets value obtain new discounted price vectors zt st value identically price prices measured 
assumed prices cash flows similarly adjusted reflect normalization 
prices price vector zt assumed ft measurable essentially bounded ess sup henceforth assume variables 
defined measure zero particular zt ft ir technical consideration generalizable square integrable price vectors keeping results harrison kreps case diffusion processes won concern generalization 
market meaningless possibility trading buying selling 
may hold portfolio shares assets described vector investor generally initial wealth invest may change portfolio time decision assets hold portfolio depend market 
trading strategy describes investment decisions possible outcomes market 
describes trading strategy time market prices known described vector ir market prices ft measurable functions ir ft measurable describes portfolio time allowed take negative values corresponds borrowing 
class possible strategies limited essentially bounded ess sup trading strategy new money required generated create 
expressed zt zt convenient adopt notation indicate trading obviously ft measurable 
turn definition contingent claim 
contingent claim type contract contingent underlying market 
precisely setting promise pay ft ir time ft measurable 
example contingent claim european option offers buyer option buy certain asset iota fixed times certain strike price asset market price time strike price buyer exercise option price immediately sell asset current price dollars 
asset market price time strike price buyer exercise option gain 
option contingent claim described formally ft zt model consider fixed consider case date unknown case american options 
leave subsequent investigation 
assume ft ft measurable essentially bounded 
take negative values case futures contracts obligated buy sell asset specified date specified price 
writer seller contingent claim price claim fair price consideration fact able invest earnings sale market 
assuming price fixed version writer portfolio optimization problem maximize zt subject zt ft zt pw dp denotes expectation 
words writer wants maximize expected terminal wealth investing initial endowment subject conditions cover requisite ft profits trades zt terminal wealth surely nonnegative 
statement problem particular version general statement maximize zt subject zt ft pu particular instance pw utility function takes form uw requirement writer lose money hedge modeled effective domain denoted dom utility function case set 
bringing constraints objective function way standard practice powerful analytical tool modern convex variational analysis cf 

generic assumptions utility function ir ir concave strictly increasing upper semi continuous particular means continuous function interior domain dom continuous right boundary dom addition domain dom ir semi infinite interval containing closed open depending behavior asv approaches boundary dom right 
canonical utility functions analyses apply function uw described logarithm function ul 
fits assumptions easily handled framework convex analysis 
domains respectively dom uw dom ul 
boundary domains origin 
logarithm value defined making function closed 
associated problem pw problem determines writer fair price minimum price pw feasible 
corresponds writer pricing problem minimize subject zt ft zt 
pricing problem general statement pu nearly modification reflects domain writer utility feasibility conditions minimize subject zt ft zt cl dom 
pup analysis follow concerned establishing conditions problems pu pup formulated conditions imply problems bounded feasible tools techniques conjugate duality convex analysis 
economic meaning formedness pu straightforward 
boundedness problem pu corresponds existence feasible solutions certain dual problem du formulated section 
famous theorem connecting arbitrage existence certain martingale measure arise examination feasibility region dual 
feasibility problem pu corresponds initial payment large optimal value pricing problem pup 
duality value optimal value problem dual pup shown natural relationship dual problem du pricing martingale measures 
dual solutions corresponds feasible martingale measures exist equal predicted value 

duality optimization turn review underlying theory duality optimization 
key results sequel 
details proofs results section consult rockafellar concise book conjugate duality optimization 
real linear topological space closed convex subset ir convex lsc lower semi continuous fi ui continuous convex functions values linear spaces ui partial ordering respect closed convex cone ei selected sake concreteness applicability identify nonpositive orthant ui ei equivalent ui 
consider primal optimization problem minimize subject fi 
convention stick setting minimization easy convert maximization problem minimization problem simply changing sign objective 
may apply duality minimization setting convert back maximization 
linear space function ir convex function satisfying fi 
defines family parameterized problems original optimization problem may full objective function common choice defined ui fi ui 
choice clearly convex satisfies valid perturbation function 
linear space associated dual linear space bilinear form ir 
topology compatible pairing locally convex topology linear functionals continuous continuous linear functional represented form similarly topology compatible pairing locally convex topology linear functionals continuous continuous linear functional represented form assumed equipped compatible topologies respect bilinear form 
useful legendre fenchel transform 
lsc function ir legendre fenchel conjugate convex sense function ir sup 
conjugate concave sense just replaces sup inf define lagrangian function ir inf 
note negative conjugate evaluated perturbation function fi yi refers componentwise dual partial ordering induced closed convex cones polar ei lagrangian function closed concave satisfies fi sup supremum lagrangian function yields original problem leads definition problem dual defined maximize infl 
concave function closed cf 

properties relating intimately tied convex optimal value function ir defined inff 
due fact inf optimal value sup optimal value equal lim assuming feasible designated topology 
duality results form inf reduce lim 
particular theorem 
theorem theorem 
suppose feasible lim 
inf 
attainment dual solutions equivalent subgradient nonempty 
condition ensures continuity 
theorem provides conditions imply continuity existence dual solutions 
theorem 
suppose exists fi int ei inf maxd exists solving 
condition exists fi int ei strict feasibility condition 
setting corresponds existence fi surely stochastic programming duality involves particular choice allows description evolving probabilistic information problem laid section 

stochastic programming duality applied writer problems prepared derive duality theorems problems section yield existence attainment finitely additive martingale measure market price process formula fair price contingent claim terms measure 
stochastic programming duality scheme considered inspired 
return writer problem pu 
keeping duality discussion solution space denoted convenience ir ft ir equipped strong product topology 
perturbation space defined ut ir ut ft ir 
dual linear space yt ir yt yt ft ir compatible topologies strong product topology weak product topology useful understand elements behave 
element may uniquely decomposed component singular component singular exists sets surely 
problem turn dual pu minimize ft eu yt subject zt zt yt zt ft ir eu ir ir functional defined eu du eu conjugate eu concave sense defined ir cf 

means yt surely ft ir theorem 
pu du primal dual problems associated lagrangian ir zt zt zt ft 
proof 
straightforward see obtain primal problem pu thinking pu minimization problem mentally changing sign objective 
sup zt zt ft yields problem minimized 
converting sign objective maximization problem yields pu 
dual problem du inf ft inf zt yt zt zt inf zt zt yt zt 
fixed inf zt yt zt zt zt yt zt zt ft ir 
inf zt zt yt zt eu yt 
putting reindexing changing signs reflect minimization dual yields dual problem du 
derive duality theorem relating pu du 
theorem 
suppose pu strictly feasible 
sup pu 
proof 
strict feasibility pu implies exists zt ft zt cl dom assumptions theorem satisfied ei nonpositive orthant immediately obtain result sup pu translating setting maximization 
note pu bounded sup pu min du du feasible 
fact section obtain fundamental theorem asset pricing theorem 
turn writer pricing problem pup recalling feasibility problem pu 
solution space contains addition sothat ir ir ft ir equipped strong product topology 
perturbation space ut st ir ut ft ir st cft ir 
dual linear space yt xt ir yt yt ft ir xt xt ft ir compatible topologies strong product topology weak product topology problem turn dual pup tt ft xt subject zt zt yt zt ft ir yt xt dup inf dom surely 
theorem 
pup dup primal dual problems associated lagrangian ir vy zt zt ft zt xt zt xt 
proof 
obtaining primal problem pup straightforward 
zt ft zt cl dom sup yields pup 
dual problem dup inf ft xt vy inf zt yt zt zt inf zt yt xt zt zt inf vy 
fixed inf zt yt zt zt inf zt yt zt zt ft ir 
zt yt xt zt zt yt xt putting reindexing yields dual problem dup 
derive duality theorem relating pup dup 
theorem 
pup strictly feasible inf pup 

proof 
strict feasibility pup due fact pup feasibility problem pu 
ess sup ft strictly feasible point satisfies zt ft zt ft ess sup ft cl dom assumptions theorem satisfied ei nonpositive orthant immediately obtain result inf pup 

free lunch limit important concept arbitrage market loosely ability generate positive wealth risk concern 
market said admit free self financing trading strategies zero initial wealth nonnegative terminal wealth positive probability strictly positive terminal wealth 
mathematically may write concept free lunch concisely zt zt zt refers expectation random variable respect measure slightly stronger free lunch condition extensively obtain asset pricing theorems concept free lunch vanishing risk 
condition says sequence negative parts tend zero uniformly final zt zt tends surely nonnegative valued random variable strictly positive positive probability 
put concisely sequence trading strategies satisfying zt zt lim zt 
propose third concept closely related intuitive investor perspective 
free lunch limit means sequence trading strategies satisfying zt zt lim zt difference concept terminal wealth sequence required converge random variable somewhat artificial requirement 
theorem demonstrates relationship concepts 
theorem 
implies implies free 
proof 
implies showing free lunch vanishing risk implies existence free lunch limit 
assuming existence free lunch vanishing risk sequence trading strategies satisfying zt zt lim zt 
fatou lemma lim inf zt lim inf zt subsequence trading strategy free lunch limit 
show implies free showing free lunch implies existence free lunch vanishing risk 
suppose exists free lunch trading strategy satisfies zt zt zt 

creates desired free lunch vanishing risk completes proof 
theorem equates boundedness particular writer portfolio optimization problem pw significant feature comes approach 
optimization problems consideration strictly feasible problems feasible inequality constraints including implicit constraints governed dom modified stricter factor 
theorem 
suppose pw strictly feasible ess inf ft pw 
equivalent 
pw bounded market admits 
proof 
show contrapositive 
suppose hold pw unbounded feasible assumption 
sequence trading strategies satisfying zt ft zt zt 
note ess inf ft assumption 
note particular 
ess inf ft zt 
ess inf tt ft zt ess inf ft self financing condition holds ess inf ft 
zt zt zt 
negative part terminal wealth sequence converges uniformly zt zt ess inf ft zt zt ess inf ft ft expected terminal wealth positive limit zt zt ess inf ft ft ft ess inf ft lim inf zt 
subsequence free lunch limit establishing 
market admit free lunch limit sequence 
strict feasibility pw large problem maximize zt subject zt ft zt feasible feasible point 
feasible pw zt zt zt ft zt zt zt zt zt zt zt zt 
lim zt lim zt 
shown sup pw pw unbounded establishing 
possible equate boundedness general pu free lunch conditions may assumptions utility theorem 
suppose utility function ir ir satisfies 
suppose pu strictly feasible inf dom ess inf ft pu 
equivalent 
pu bounded market admits 
proof 
proceed theorem 
suppose pu unbounded sequence trading strategies satisfying zt ft zt zt 
zt zt jensen inequality 
zt subsequence zt assumption strictly increasing 
appealing proof theorem argument yields free lunch limit establishing 
market admit free lunch limit sequence 
strict feasibility pu large problem maximize zt subject zt ft zt cl dom feasible feasible point 
feasible pu zt zt zt ft lim zt zt zt zt zt zt dom zt zt zt zt 
lim zt 
exists assumption implies strictly increasing zt zt zt zt zt lim zt follows lim lim fork ir 
observe 
lim lim 
shown sup pu pu unbounded 

martingale measures section reviews definition martingale equivalent representations martingales 
part section extends notion martingale measures include finitely additive measures 
definition 
probability space ft filtration respect vector process zt measurable 
zt martingale equivalently zt ft zt zt dp ft way representing martingale useful sections follow 
proposition 
zt vector process defined ft associated filtration 
zt martingale respect probability measure zt zt ft ir proof 
suppose zt martingale fixed ft ir fixed zt ft zt ft zt zt zt 
suppose zt zt ft ir ft ei represent ft measurable coordinate vector th position fixed ei definition zt martingale definition 
probability measure said absolutely continuous respect denoted onf implies said equivalent denoted onf measure sets 
definition 
say probability measure martingale measure vector process zt pand zt martingale martingale measure addition probability measure absolutely continuous respect equivalent representation radon nikodym derivative function ir 
fact may translate space absolutely continuous probability measures space identification may express martingale condition terms equivalent representation 
radon nikodym derivative absolutely continuous probability measure ft 
proposition 
probability measure martingale measure zt vector process martingale equivalently ft zt yt zt yt dp ft equivalent martingale measure addition 
proof 
immediate definition 
considerations may extended space finitely additive probability measures 
definition 
finitely additive probability measure satisfies finite additivity en disjoint sets necessarily countable additivity countable additivity property satisfied standard probability measures 
note countably additive probability measure finitely additive 
conditional expectations finitely additive probability measures defined properties 
finitely additive measures countably additive behaved standard probability measures avoided 
ignored arise natural contexts demonstrating 
stated probability measure equivalent representation radon nikodym derivative function ir 
similarly finitely additive probability measure equivalent representation set function arising function ir identification 
finitely additive probability measure denote expectation respect measure defined viewed respect representation 
avoid technical considerations definition finitely additive martingale take parallels representation proposition 
definition 
zt vector process defined ft associated filtration 
zt martingale respect finitely additive probability measure eq zt eq zt ft ir definition 
finitely additive probability measure said absolutely continuous respect finitely countably additive probability measure denoted onf implies said equivalent denoted onf zero measure sets 
definition 
underlying probability space countably additive probability measure 
say finitely additive probability measure martingale measure vector process zt zt martingale martingale measure addition recall element may uniquely decomposed component singular component 
associated finitely additive measure decomposes uniquely countably additive part called purely finitely additive part corresponding singular component 
underlying probability space unique decomposition equivalent representation finitely additive probability measure unique singular component ft measurable yt ft andy satisfies ft proposition 
finitely additive probability measure pis finitely additive martingale measure zt zt zt yt zt ft ir equivalent finitely additive martingale measure addition 
proof 
straightforward application definition finitely additive martingale measure observing eq zt zt eq zt zt yt zt get equivalence set positive measure mean 
ey surely 
means ey 
terms greater equal follows ey 
fact surely true ey surely surely 
fundamental theorem asset pricing proceed apply results preceding sections pricing theory contingent claims incomplete markets 
lemma 
du feasible exists finitely additive equivalent martingale measure 
proof 
yt feasible du 
satisfies constraints du zt zt yt zt ft ir yt dom eu 
showing yt surely 
suppose contrary ft yt surely 
lete associated sets ft surely 
choose large 
dom wt ec 
eu yt ft ir wt yt wt eu wt wt yt wt eu wt yt ec strictly increasing 
eu yt means yt dom eu contradicting choice feasible point du 
surely claimed 
vt vt vt vt yt yt 
proceed show set function ft defined vt ft equivalent finitely additive martingale measure 
finite additivity immediate induced yt 
requirement follows normalization vt vt yt yt yt 
equivalent follows vt 
remains show martingale unique singular measure price process 
vt vt ft component ft measurable satisfies vt ft constraints du fact vt yt yt andv yt 
observe constraints du fort ft ir eq zt zt zt zt vt zt eq zt equivalent finitely additive martingale measure 
suppose exists equivalent finitely additive martingale measure ft ir representation ft ir yt ft unique ft measurable singular component ft yt feasible solution du proof 
theorem 
market admits free limit exists equivalent finitely additive martingale measure 
proof 
consider writer portfolio optimization problem pw strictly feasible satisfying ess inf ft theorem equivalent boundedness pw 
equivalent feasibility du strong duality result theorem utility function 
lemma gives equivalence feasibility du existence equivalent finitely additive martingale measure 
theorem 
suppose market admits free limit 
writer fair price max eq ft denotes space finitely additive martingale measures 
proof 
writer fair price optimal value pup 
duality result theorem inf pup 
feasible region defined dup argument proof lemma set yt ir represents absolutely continuous finitely additive martingale measures identification yt yt yt 
probability measure follows constraint dup 
maximum theorem stated supremum respect set equivalent finitely additive martingale measures dense space absolutely continuous martingale measures 
fact attainable pricing measure guaranteed absolutely continuous respect underlying measure laid natural duality framework types pricing problems variants lie 
usual attempts literature obtain countably additive pricing measure radon nikodym derivative simple problem formulations ill 
reason shown natural attainable pricing measure includes purely finitely additive singular component may represented naturally dual special cases singular component may taken pricing measure countably additive radon nikodym derivative guaranteed 
vague possible interpretation dual pricing measure particular singular components 
stochastic programming duality setting relying notion induced constraints shows fact singular multipliers sense multipliers implicit constraints time period induced constraints 
interesting fact interpretation setting pricing problems warrants topic exploration 
similarly extension results stochastic programming model allows descriptions price processes trading strategies continuous time obvious step taken 
back 
shadow price information continuous time decision problems 
stochastics 
black scholes 
pricing options corporate liabilities 
journal political economy 

convex duality constrained portfolio optimization 
annals applied probability 

representing martingale measures asset prices continuous bounded 
mathematical finance 

general version fundamental theorem asset pricing 
mathematische annalen 
eisner olsen 
duality stochastic programming interpreted lp space 
siam journal applied mathematics 
harrison kreps 
martingales arbitrage multiperiod securities markets 
journal economic theory 
harrison 
martingales stochastic integrals theory continuous trading 
stochastic processes applications 

arbitrage securities markets short sales constraints 
mathematical finance 

martingales arbitrage securities markets transaction costs 
journal economic theory 
king 
duality martingales mathematical programming perspective contingent claims 
ibm technical report watson research center yorktown heights ny 
merton 
theory rational option pricing 
bell econom 
management sci 

finitely additive conditional probabilities 
rend sem mat fis 
milano 
rockafellar 
conjugate duality optimization 
siam 
rockafellar wets 
martingales stochastic optimization problems 
mathematical programming study 
rockafellar wets 
stochastic convex programming basic duality 
pacific journal mathematics 
rockafellar wets 
stochastic convex programming relatively complete recourse induced feasibility 
siam control optimization 
rockafellar wets 
stochastic convex programming singular multipliers extended duality singular multipliers duality 
pacific journal mathematics 
rockafellar wets 
optimal recourse problem discrete time multipliers inequality constraints 
siam control optimization 
rockafellar wets 
variational analysis 
springer verlag 
wets 
probl mes en programmation 
comptes rendus acad mie des sciences de paris 

functional analysis 
springer verlag berlin 

