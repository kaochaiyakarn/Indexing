control engineering practice survey industrial model predictive control technology joe qin thomas badgwell department chemical engineering university texas austin texas austin tx usa aspen technology eldridge parkway houston tx usa received november accepted august provides overview commercially available model predictive control mpc technology linear nonlinear primarily data provided mpc vendors 
brief history industrial mpc technology followed results vendor survey mpc control identification technology 
general mpc control algorithm approaches taken vendor different aspects calculation described 
identification technology reviewed determine similarities differences various approaches 
mpc applications performed vendor summarized application area 
final section presents vision generation mpc technology emphasis potential business research opportunities 
elsevier science rights reserved 

model predictive control mpc refers class computer control algorithms utilize explicit process model predict response plant 
control interval mpc algorithm attempts optimize plant behavior computing sequence manipulated variable adjustments 
input optimal sequence sent plant entire calculation repeated subsequent control intervals 
originally developed meet specialized control needs power plants petroleum mpc technology wide variety application areas including chemicals food processing automotive aerospace applications 
publications provide theoretical practical issues associated mpc technology 
rawlings provides excellent introductory tutorial aimed control practitioners 
badgwell qin rawlings wright comprehensive overview nonlinear mpc moving horizon estimation including summary theoretical developments corresponding author 
tel fax 
mail address qin che utexas edu qin 
time survey tab rice university 
see front matter elsevier science rights reserved 
pii numerical solution techniques 
mayne rawlings rao provide comprehensive review theoretical results closed mpc algorithms 
notable past reviews mpc theory include garc morari morari lee muske rawlings rawlings meadows muske mayne lee cooley 
books mpc published zheng cannon 
authors survey industrial mpc technology linear models chemical process control conference qin badgwell summarizing applications 
review industrial mpc applications nonlinear models nonlinear model predictive control switzerland qin badgwell 
lu samad describe industrial mpc practice developments vendor viewpoint 
young fontaine downs andersen report development mpc technology operating companies 
survey mpc technology japan provides wealth information application issues point view mpc users ohno hashimoto 
years mpc landscape changed drastically large increase number reported applications significant improvements technical capability mergers vendor companies 
primary purpose updated representative snapshot commercially available mpc technology 
information reported collected vendors starting mid reflecting status mpc practice just prior new millennium roughly years applications 
brief history mpc technology development followed results industrial survey 
significant features offering outlined discussed 
mpc applications date vendor summarized application area 
final section presents view generation mpc technology emphasizing potential business research opportunities 

brief history industrial mpc section presents abbreviated history industrial mpc technology 
fig 
shows evolutionary tree significant industrial mpc algorithms illustrating connections concise way 
control algorithms emphasized relatively little information available development industrial identification technology 
sub sections describe key algorithms mpc evolutionary tree 

lqg development modern control concepts traced kalman early kalman 
greatly simplified description results point discussion come 
discrete time context qin badgwell control engineering practice dmc dmc lqg process considered kalman workers described discrete time linear state space model xk buk vector represents process inputs manipulated variables vector describes measured process outputs 
vector represents process states controlled 
state disturbance wk measurement noise independent gaussian noise zero mean 
initial state assumed gaussian non zero mean 
objective function minimized penalizes expected values squared input state deviations origin includes separate state input weight matrices allow tuning trade offs xn jjj norm terms objective function defined follows jjxjj implicit formulation assumption variables written terms deviations desired steady state 
solution problem known linear quadratic gaussian lqg controller involves separate steps 
time interval output measurement yk obtain optimal state estimate xk jk buk kf optimal input uk computed optimal proportional state controller uk kc pfc pct rmpct fig 

approximate genealogy linear mpc algorithms 
th generation mpc rd generation mpc nd generation mpc st generation mpc notation refers state estimate time information upto including time kalman filter gain kf computed solution matrix equation 
controller gain kc constructing dual equation numerical techniques software calculations 
infinite prediction horizon lqg algorithm endows algorithm powerful stabilizing properties 
case perfect model shown stabilizing reasonable linear plant stabilizable states detectable quadratic criterion long positive semidefinite positive definite 
extensions handle practical issues controlling outputs achieving offset free control computing steady state targets followed rapidly 
constraints process inputs states outputs generally addressed development lqg theory 
lqg theory soon standard approach solve control problems wide range application areas 
goodwin estimate may thousands real world applications lqg roughly patents year kalman filter 
little impact control technology development process industries 
significant reasons cited failure include garc morari constraints process nonlinearities model uncertainty robustness unique performance criteria cultural reasons people education 
known economic operating point typical process unit lies intersection constraints 
successful industrial controller process industries maintain system close possible constraints violating 
addition process units typically complex nonlinear constrained multivariable systems dynamic behavior changes time due effects changes operating conditions catalyst aging 
process units quite individual development process models fundamental physics chemistry difficult justify economically 
application areas lqg theory immediate impact aerospace industry characterized physical systems technically economically feasible fundamental models 
process units may unique performance criteria difficult express lqg framework qin badgwell control engineering practice requiring time dependent output weights additional logic delineate different operating modes 
significant reasons lqg theory failed strong impact may related culture industrial process control community time instrument technicians control engineers exposure lqg concepts regarded impractical 
environment led development industry general model control methodology dynamic optimization problem solved online control execution 
process inputs computed optimize plant behavior time interval known prediction horizon 
general case desired objective function 
plant dynamics described explicit process model take principle required mathematical form 
process input output constraints included directly problem formulation constraint violations anticipated prevented 
input optimal input sequence injected plant problem solved time interval updated process measurements 
addition developing flexible control technology new process identification technology developed allow quick estimation empirical dynamic models test data substantially reducing cost model development 
new methodology industrial process modeling control refer mpc technology 
modern processing plants mpc controller part multi level hierarchy control functions 
illustrated fig 
shows conventional control structure left unit mpc structure right unit 
similar hierarchical structures described garc 
structure plant wide optimizer determines optimal steady state settings unit plant 
may sent local optimizers unit run frequently consider detailed unit model possible plant wide level 
unit optimizer computes optimal economic steady state passes dynamic constraint control system implementation 
dynamic constraint control move plant constrained steady state minimizing constraint violations way 
conventional structure accomplished combination pid algorithms lead lag blocks high low select logic 
difficult translate control requirements level appropriate conventional control structure 
mpc methodology combination blocks replaced single mpc controller 
development application mpc technology driven industry noted idea controlling system solving sequence open loop dynamic optimization problems new 
example described moving horizon controller 
lee markus anticipated current mpc practice optimal control text technique obtaining feedback controller synthesis knowledge open loop controllers measure current control process state compute rapidly open loop control function 
portion function short time interval new measurement function computed new measurement 
procedure repeated 
wide theory practice 
essential contribution industry put ideas practice operating units 
experience came fresh set problems kept theoreticians busy 
qin badgwell control engineering practice unit conventional control structure plant wide optimization unit local optimizer unit local optimizer high low select logic pid pid sum sum fc pc tc lc fc unit model predictive control structure model predictive control mpc unit dcs pid controls unit dcs pid controls pc tc lc 
global economic optimization day local economic optimization hour dynamic constraint control minute basic dynamic control second fig 

hierarchy control system functions typical processing plant 
conventional structure shown left mpc structure shown right 
description mpc control applications conference summarized automatica 
described approach model predictive heuristic control 
solution software referred acronym identification command 
distinguishing features approach impulse response model plant linear inputs internal variables quadratic performance objective finite prediction horizon plant output behavior specified trajectory input output constraints included formulation optimal inputs computed heuristic iterative algorithm interpreted dual identification 
chose input output representation process process inputs influence process outputs directly 
process inputs divided manipulated variables mvs controller adjusts disturbance variables dvs available control 
process outputs referred controlled variables cvs 
chose describe relationship process inputs outputs discrete time finite impulse response fir model 
single input single output siso case fir model looks yk xn model predicts output time depends linear combination past input values summation weights hi impulse response coefficients 
sum truncated point past inputs longer influence output representation possible stable plants 
finite impulse response identified plant test data algorithm designed minimize distance plant model impulse responses parameter space 
control problem solved algorithm noting control mathematical dual identification 
iterative nature control algorithm allows input output constraints checked algorithm proceeds solution 
control law linear expressed transfer function refer heuristic 
today context algorithm referred linear mpc controller 
algorithm drives predicted output trajectory closely possible trajectory defined order path current output value desired setpoint 
speed desired closed set time constant trajectory 
important practice provides natural way control aggressiveness algorithm increasing time constant leads slower robust controller 
important point dynamic control embedded hierarchy plant control functions order effective 
describe levels control similar structure shown fig 
level time space scheduling production 
level optimization setpoints minimize costs ensure quality quantity production 
level dynamic multivariable control plant 
level control ancillary systems pid control valves 
point significant benefits come simply reducing variations controlled variable better dynamic control level 
qin badgwell control engineering practice real economic benefits come level better dynamic control allows controlled variable setpoint moved closer constraint violating 
argument provides basic economic motivation mpc technology 
concept hierarchy control functions fundamental advanced control applications followed practitioners 
garc example describe similar hierarchy 
describe applications algorithm fluid catalytic cracking unit main column power plant steam generator poly pvc plant 
examples constrained multivariable processes 
main example involved controlling key tray temperatures stabilize composition heavy light product streams 
controller adjusted product compensate inlet temperature disturbances maintain level key internal tray 
power plant steam generator problem involved controlling temperature pressure steam delivered turbine 
application interesting process response time varied inversely load system 
nonlinearity overcome executing controller variable sample time 
benefits main application reported yr due increasing light product stream 
combined energy savings columns pvc plant reported yr 
dmc engineers shell oil developed independent mpc technology early initial application 
cutler details unconstrained multivariable control algorithm named dynamic matrix control dmc national aiche meeting cutler joint automatic control conference cutler 
companion meeting described application dmc technology reactor algorithm modified handle nonlinearities constraints 
discussed process identification technology 
key features dmc control algorithm include linear step response model plant quadratic performance objective finite prediction horizon plant output behavior specified trying follow setpoint closely possible optimal inputs computed solution leastsquares problem 
linear model dmc algorithm relates changes process output weighted sum past input changes referred input moves 
siso case model looks xn yk si move weights si coefficients 
mathematically defined integral impulse response model form easily obtained 
multiple outputs handled superposition 
step response model write predicted output changes linear combination input moves 
matrix ties called dynamic matrix 
representation allows optimal move vector computed analytically solution squares problem 
feedforward control readily included formulation modifying predicted outputs 
practice required matrix inverse computed line save computation 
row final controller gain matrix needs stored move needs computed 
objective dmc controller drive output close setpoint possible leastsquares sense penalty term mv moves 
results smaller computed input moves aggressive output response 
trajectory technique provides degree robustness model error 
move suppression factors provide important numerical benefit directly improve conditioning numerical solution 
cutler showed results furnace temperature control application demonstrate improved control quality dmc algorithm 
feedforward response dmc algorithm inlet temperature changes superior conventional pid lead lag 
described application dmc technology reactor control 
applications completed additional applications underway time written 
described additional modifications dmc algorithm prevent violation absolute input constraints 
predicted input came sufficiently close absolute constraint extra equation added process model drive input back feasible region 
referred time variant constraints 
qin badgwell control engineering practice decision add equation line matrix inverse solution recomputed control execution 
developed matrix tearing solution original matrix inverse computed line requiring matrix inverse corresponding active time variant constraints computed line 
initial dmc algorithms represent generation mpc technology enormous impact industrial process control served define industrial mpc paradigm 

original dmc algorithms provided excellent control unconstrained multivariable processes 
constraint handling somewhat ad hoc 
engineers shell oil addressed weakness posing dmc algorithm quadratic program qp input output constraints appear explicitly 
cutler described algorithm aiche conference cutler 
garc published comprehensive description years 
key features algorithm include linear step response model plant quadratic performance objective finite prediction horizon plant output behavior specified trying follow setpoint closely possible subject move suppression term optimal inputs computed solution quadratic program 
garc show dmc objective function re written form standard qp 
projected outputs related directly back input move vector dynamic matrix allows input output constraints collected matrix inequality involving input move vector 
algorithm somewhat advanced control algorithm qp simplest possible optimization problems pose 
hessian qp positive definite linear plants resulting optimization problem convex 
means solution readily standard commercial optimization codes 
garc wrapped presenting results furnace application 
controller adjusted fuel gas pressure order control stream temperature locations furnace 
test results demonstrated dynamic enforcement input constraints decoupling temperature dynamics 
reported results applications shell problems large process outputs process inputs 
stated algorithm proven particularly profitable line optimization environment providing smooth transition constrained operating point 
algorithm regarded representing second generation mpc technology comprised algorithms provide systematic way implement input output constraints 
accomplished posing mpc problem qp solution provided standard qp codes 

mpc technology gained wider acceptance problems tackled mpc technology grew larger complex control engineers implementing second generation mpc technology ran practical problems 
algorithm provided systematic approach incorporate hard input output constraints clear way handle infeasible solution 
example possible feedforward disturbance lead infeasible qp control recover infeasibility 
soft constraint formulation completely satisfactory means constraints violated extent determined relative weights 
clearly output constraints important violated 
sense shed low priority constraints order satisfy higher priority ones 
practice process inputs outputs lost real time due signal hardware failure valve saturation direct operator intervention 
just easily come back control problem sample interval 
means structure problem degrees freedom available control change dynamically 
illustrated fig 
illustrates shape process transfer function cv qin badgwell control engineering practice mv thin plant determined degrees freedom cv mv square plant unique solution degrees freedom matrix general cases 
square plant case occurs plant just mvs cvs leads control problem unique solution 
real world square rare 
common fat plant case mvs available cvs control 
extra degrees freedom available case put additional objectives moving plant closer optimal operating point 
valves saturated lower level control action lost plant may reach condition cvs mvs thin plant case 
situation possible meet control objectives control specifications relaxed example minimizing cv violations squared sense 
fault tolerance important practical issue 
simply turning signals lost practical mpc controller remain online try best sub plant control 
major barrier achieving goal conditioned multivariable plant may contain number poorly conditioned sub plants 
practice mpc controller recognize screen poorly conditioned sub plants result erratic control action 
increasingly difficult translate control requirements relative weights single objective function 
including required trade offs single objective function means relative weights assigned value output setpoint violations output soft constraint violations inputs moves optimal input target violations 
large problems easy translate control specifications consistent set relative weights 
cases sense include variables objective function driving inputs optimal targets may lead larger violation output soft constraints example 
consistent set relative weights care taken avoid scaling problems lead ill conditioned solution 
garc commented problem cv mv fat plant determined degrees freedom fig 

process structure determines degrees freedom available controller 
adapted 
combination multiple objectives objective function allow designer reflect true performance requirements 
issues motivated engineers setpoint shell france versions mpc algorithms 
version marketed setpoint called distinguish single input single output version called nearly identical version referred hierarchical constraint control 
id com controller described 
second aiche conference describes application shell fundamental control problem provides additional details concerning constraint methodology 
distinguishing features algorithm include linear impulse response model plant controllability supervisor screen ill conditioned plant subsets multi objective function formulation quadratic output objective followed quadratic input objective controls subset points time output called coincidence points chosen trajectory single move computed input constraints hard soft hard constraints ranked order priority 
important distinction algorithm uses separate objective functions outputs extra degrees freedom inputs 
quadratic output objective function minimized subject hard input constraints 
output driven closely possible desired value single point time known coincidence point 
name comes fact desired predicted values coincide 
desired output value comes order trajectory starts current measured value leads smoothly setpoint 
output basic tuning parameters coincidence point closed loop response time define trajectory 

provide simulation results representative control problem 
problem involves controlling gas composition gas temperature bed temperature manipulating feed oil flow recycle oil flow air 
simulation example demonstrates multiple inputs improve dynamic performance reaching pre determined optimal steady state condition 
second example demonstrates controller switches controlling output qin badgwell control engineering practice controlling measured disturbance causes constraint violation 
third example demonstrates need controllability supervisor 
oxygen analyzer fails controllability supervisor left gas temperature bed temperature consider 
correctly detects controlling lead ill conditioned problem outputs respond similar way inputs 
pre set priority elects control gas temperature 
controllability supervisor turned simulation scenario leads erratic unacceptable input adjustments 
setpoint engineers continued improve technology eventually combined identification simulation configuration control products single integrated offering called setpoint multivariable control architecture 
improved numerical solution engine allowed solve sequence separate steady state target optimizations providing natural way incorporate multiple ranked control objectives constraints 
late engineers shell research france developed shell multivariable optimizing controller marquis described bridge state space mpc algorithms 
sought combine constraint handling features mpc richer framework feedback offered statespace methods 
motivate effort discussed control unit reactor beds series 
control system maintain average bed temperature desired setpoint hold temperature differences beds close desired profile preventing violation maximum temperature limits reactor 
manipulated variables include reactor inlet temperature quench flows beds 
typical mpc input output model view manipulated variables inputs bed temperatures independent outputs constant output disturbance assigned bed temperature 
clear bed temperatures independent disturbance bed ultimately affect downstream reactors 
addition controlled variables process outputs linear combinations thereof 
state space control design methods offer natural solution problems provide optimal way enforce maximum bed temperature constraints 
algorithm includes features considered essential modern mpc formulation state space models full range linear dynamics represented stable unstable integrating 
explicit disturbance model describes effect unmeasured disturbances constant output disturbance simply special case 
kalman filter estimate plant states unmeasured disturbances output measurements 
distinction introduced controlled variables appearing control objective feedback variables state estimation 
input output constraints enforced qp formulation 
algorithm nearly equivalent solving lqr problem input output constraints formulated finite horizon 
inherit strong stabilizing properties lqr algorithm 
stabilizing infinite horizon formulation constrained lqr algorithm come academics began embrace mpc paradigm rawlings muske rawlings 
algorithms represent third generation mpc technology include pct algorithm sold algorithm sold honeywell 
generation distinguishes levels constraints hard soft ranked provides mechanism recover infeasible solution addresses issues resulting control structure changes real time provides richer set options feedback allows wider range process dynamics stable integrating unstable controller specifications 

dmc plus rmpct years increased competition mergers mpc vendors led significant changes industrial mpc landscape 
late honeywell purchased formed honeywell hi spec solutions 
algorithm offered honeywell merged pct controller create current offering called rmpct 
early aspen technology purchased setpoint dmc 
followed acquisition treiber controls 
dmc technologies subsequently merged create aspen technology current dmc plus product 
dmc plus rmpct representative fourth generation mpc technology sold today features windows graphical user interfaces 
multiple optimization levels address prioritized control objectives 
qin badgwell control engineering practice additional flexibility steady state target optimization including qp economic objectives 
direct consideration model uncertainty robust control design 
improved identification technology prediction error method sub space id methods 
mpc algorithms currently available marketplace described greater detail section 

survey mpc technology products industrial mpc technology changed considerably publication survey years ago qin badgwell included data vendors dmc honeywell setpoint treiber controls :10.1.1.129.1507
late honeywell purchased formed honeywell hi spec 
early setpoint dmc acquired aspen technology 
years aspen purchased treiber controls companies original survey merged 
mergers continued product development emergence viable nonlinear mpc products qin badgwell changed mpc market believe updated survey worthwhile 
began collecting data survey mid solicited information vendors order assess current status commercial mpc technology 
companies surveyed product names descriptions listed tables 
survey added new companies offering linear mpc products shell global solutions sgs systems 
isi lewis evans uk 
nonlinear mpc vendors included continental controls table companies products included linear mpc technology survey product name description hierarchical constraint control pfc predictive functional control glide identification package aspen tech dmc plus dynamic matrix control package dmc plus model identification package honeywell rmpct robust model predictive control hi spec technology shell global solutions ii shell multivariable optimizing control control identification package licensed mdc technology past 
shell global solutions organization markets current technology 
dot products technologies 
believe technology sold companies representative industrial state art fully recognize omitted mpc vendors survey especially just entered market fisher abb 
companies asked participate chose participate responded late included 
companies documented successful mpc applications asked participate 
noted companies mpc technology developed house included survey offer technology externally 
mpc packages known academic researchers known proprietary reasons 
algorithm originally developed shell france included survey commercially available sgs 
mdc technology license agreements shell 
initial data survey collected industrial mpc vendors written survey 
blank copies survey form available request authors 
survey information supplemented published papers product literature dmc setpoint honeywell personal communication authors table companies products included nonlinear mpc technology survey product name description pfc predictive functional control aspen tech aspen target nonlinear mpc package continental controls mvc multivariable control dot products nova nlc nova nonlinear controller technologies process nonlinear control table comparison linear mpc identification technology qin badgwell control engineering practice product test protocol model form vendor representatives 
results linear mpc survey summarized tables 
nonlinear mpc survey results summarized separately tables 
data provided vendors analysis authors 
presenting survey results intention highlight important features algorithm intent determine superiority product versus 
purpose showing application numbers give relative magnitude mpc applied different areas 
absolute numbers important changing fast 
numbers exactly comparable size mpc application different 
understanding mind discuss procedure control design tuning 
describe various model forms linear nonlinear technology 
sections summarize main features identification control products sold vendor 

control design tuning mpc control design tuning procedure generally described follows dmc setpoint honeywell stated control objectives define size problem determine relevant cvs mvs dvs 
test plant systematically varying mvs dvs capture store real time data showing cvs respond 
derive dynamic model principles plant test data identification package 
configure mpc controller enter initial tuning parameters 
test controller line closed verify controller performance 
est 
method dmc plus step lss mls rmpct arx bj ls gn pem aida fir tf mm pem ls gn glide non tf gd gn gm arx mm rls pem 
bound model form finite impulse response fir velocity fir laplace transfer function tf linear state space lss auto regressive exogenous input arx box jenkins bj multi model mm 
est 
method squares ls modified ls mls recursive ls rls subspace id smi gauss newton gn prediction error method pem gradient descent gd global method gm 
commercial name rmpct profit controller 
aida advanced identification data analysis 
table comparison linear mpc control technology aspen honeywell sgs tech hi spec product dmc plus rmpct pfc 
linear model fsr arx tf fir lss tf arx arx fir lss forms feedback cd id cd id cd id cd id cd id kf rem ill cond ims svt ims ims ss opt obj ss opt const ih os ih oh ih oh ih oh ih os dyn opt obj dyn opt const ih ih os ih oh os ia oh os ih os ih os output traj rt rt output fh fh fh cp fh fh input param mm sm bf sol 
method sls ls cutler honeywell marquis dmc model form finite impulse response fir finite step response fsr laplace transfer function tf linear state space lss auto regressive exogenous input arx linear nonlinear stable integrating unstable 
feedback constant output disturbance cd integrating output disturbance id kalman filter kf 
removal ill conditioning singular value thresholding svt input move suppression ims 
steady state optimization objective linear quadratic inputs outputs multiple sequential objectives outputs ranked order priority 
steady state optimization constraints input hard maximum minimum rate change constraints ih output hard maximum minimum constraints oh constraints ranked order priority 
dynamic optimization objective quadratic inputs outputs input moves sub optimal solution 
dynamic optimization constraints input hard maximum minimum rate change constraints ih input acceleration constraints ia output hard maximum minimum constraints oh output soft maximum minimum constraints os constraints ranked order priority 
output trajectory setpoint zone trajectory rt rt bounds funnel 
output horizon finite horizon fh coincidence points cp 
input parameterization single move sm multiple move mm mm blocking basis functions bf 
solution method squares ls sequential ls sls active set quadratic program 
download configured controller destination machine test model predictions openloop mode 
close refine tuning needed 
mpc packages surveyed provide software tools control design model development closed loop simulation steps 
significant amount time currently spent closed loop simulation step verify acceptable performance robustness control system 
typically tests performed check regulatory servo response cv system response violations major constraints verified 
final tuning tested sensitivity model mismatch varying gain dynamics key process models 
thorough simulation testing usually exhaust possible scenarios 
products surveyed rmpct package provides robust tuning automatic way 
accomplished min max design procedure user enters estimates model uncertainty qin badgwell control engineering practice directly 
tuning parameters computed optimize performance worst case model mismatch 
robustness checks mpc controllers performed closed loop simulation 

process models technical scope mpc product largely defined form process model uses 
tables show wide variety linear nonlinear model forms industrial mpc algorithms 
helpful visualize models dimensional space illustrated fig 

horizontal axis refers source information model development vertical axis designates model linear nonlinear 
far left side diagram represents empirical models derived exclusively process test data 
empirical models mainly perform fitting points data set generally expected accurately predict process behavior range test data 
far right side diagram lie table comparison nonlinear mpc control technology aspen continental dot technology controls products technologies product pfc aspen mvc nova process target nlc nonlinear model nss fp nss nnn snp arx nss fp nnn arx forms feedback cd id cd id ekf cd cd cd id rem ill cond ims ims ims ss opt obj ss opt const ih oh ih oh ih os ih oh os dyn opt obj dyn opt ia oh os ih os ih os ih oh os ih os const output traj rt rt rt tw output cp cp fh fh fh input param bf mm sm mm mm sol 
method grg nova grg de oliveira papadopoulos 
mvc user manual fontaine johnston martin zhao 
zhao papadopoulos young keeler martin moran 
boe mathur turner poe johnston martin 
martin johnston 
model form input output io principles fp nonlinear state space nss nonlinear neural net nnn static nonlinear polynomial snp stable integrating unstable 
feedback constant output disturbance cd integrating output disturbance id extended kalman filter ekf 
removal ill conditioning input move suppression ims 
steady state optimization objective quadratic inputs outputs 
steady state optimization constraints input hard maximum minimum rate change constraints ih output hard maximum minimum constraints oh 
dynamic optimization objective quadratic norm inputs outputs input moves 
dynamic optimization constraints input hard maximum minimum rate change constraints ih ih input acceleration constraints models derived purely theoretical considerations mass energy balances 
principles models typically expensive develop able predict process behavior wider range operating conditions 
reality process models mpc technology effective combination process data theory 
principles models example typically calibrated process test data estimate key parameters 
likewise empirical models adjusted account known process physics example cases model gain may known certain sign value 
mpc products surveyed time invariant models fill quadrants fig 
nonlinear qin badgwell control engineering practice ia output hard maximum minimum constraints oh output soft maximum minimum constraints os output soft constraints exact penalty treatment os de oliveira 
output trajectory setpoint zone trajectory rt upper lower trajectories trajectory weighting tw 
output horizon finite horizon fh coincidence points cp 
input parameterization single move sm multiple move mm basis functions bf 
solution method nonlinear squares multi method generalized reduced gradient grg mixed complementarity nonlinear program nova 
principles models nonlinear empirical models linear empirical models 
various model forms derived special cases general continuous time nonlinear state space model uar mu vector mvs vector cvs vector state variables var mv vector measured dvs war mw vector unmeasured dvs process noise nar mx vector measurement noise 
sections describe model type detail 
table summary linear mpc applications areas estimates vendor survey estimates include applications companies licensed vendor technology area aspen honeywell technology hi spec 
nonlinear principles models nonlinear principles models nova nlc algorithm derived mass energy balances take exactly form shown 
unknown model parameters heat transfer coefficients reaction kinetic constants estimated line test data line extended kalman filter ekf 
typical application process model differential algebraic equations 
sgs refining chemicals pulp air gas utility mining food processing polymer aerospace defense automotive unclassified total app 
dmc pct rmpct opc largest app 
numbers reflect snapshot survey conducted mid read static 
update vendor showed increase number applications 
applications january reported 
embedded applications difficult accurately report number distribution 
product literature indicates applications pfc january 
number applications includes house applications shell unclassified 
total number estimated 
empirical aspen target mvc process rmpct pfc nonlinear linear pfc nova nlc principles fig 

classification model types industrial mpc algorithms 
qin badgwell control engineering practice total pfc algorithm different model types 
general discrete time principles model derived integrating sample time xk xk uk vk wk xk uk special care taken stiff systems 

linear empirical models linear empirical models majority mpc applications date surprise current mpc products model type 
wide variety model forms derived linearizing operating point get xk pfc algorithms model form 
equivalent discrete time transfer function model written form matrix fraction description kailath yk uy uu uk uv vk uw wk backward shift operator 
output error identification approach ljung minimizes measurement error nk results nonlinear parameter estimation 
multiplying uy sides equation results autoregressive model exogenous inputs arx yk uy yk uu uk uv vk uw wk fk uy nk model form rmpct pfc algorithms 
equation error identification approach minimizes fk colored noise measurement noise nk white 
rmpct identification algorithm provides option box jenkins model error terms term ek yk uy uu uk uv vk ue ek stable system fir model derived approximation discrete time transfer function model uk vk wk model form dmc plus algorithms 
typically sample time chosen coefficients required describe full open loop response 
equivalent velocity form useful identification dy dn alternative model form finite model fsr cutler nu uk nu nv vk nv nw wk nw sj hi hi si si fsr model dmc plus rmpct algorithms 
rmpct pfc algorithms provide option enter laplace transfer function model 
model form automatically qin badgwell control engineering practice converted discrete time model form control calculations 

nonlinear empirical models basic types nonlinear empirical models products surveyed 
aspen target product uses discrete time linear model state dynamics output equation includes linear term summed nonlinear term xk xk uk stable processes controlled aspen target product eigenvalues lie strictly unit circle 
nonlinear function obtained neural network 
state vector necessarily limited physical variables nonlinear model appears general measurement nonlinearity 
example wiener model dynamic linear model followed static nonlinear mapping represented form 
claimed type nonlinear model approximate discrete time nonlinear processes fading memory zhao 
known neural networks unreliable extrapolate range training data 
main problem sigmoidal neural network model derivatives fall zero network range training data set 
aspen target product deals problem calculating model confidence index mci line 
mci indicates neural network prediction unreliable neural net nonlinear gradually turned model calculation relies linear portion fa cg 
feature modeling algorithm ekf correct model plant mismatch unmeasured disturbances zhao 
ekf provides bias gain correction model line 
function replaces constant output error feedback scheme typically employed mpc practice 
mvc algorithm process nonlinear input output models 
simplify system identification task products static nonlinear model superimposed linear dynamic model 
martin boe keeler johnson describe details process modeling approach 
presentation single output form concept applicable multi input multi output models 
assumed process input output decomposed steady state portion obeys nonlinear static model deviation portion follows dynamic model 
input uk output yk deviation variables calculated follows uk yk ys ys steady state values input output respectively follow general nonlinear relation ys hs deviation variables follow second order linear dynamic relation identification linear dynamic model plant test data pulse tests nonlinear static model neural network built historical data 
believed historical data contain rich steady state information plant testing needed dynamic sub model 
bounds enforced model gains order improve quality neural network control applications 
composite model control step described follows 
desired output target yd nonlinear optimization program calculates best input output values yf nonlinear static model 
dynamic controller calculation nonlinear static gain approximated linear interpolation initial final steady state gains ks uk kf ui ufs current steady state values input respectively dus ui dus evaluated static nonlinear model 
bounds kf applied 
substituting approximate gain eq 
linear sub model yields bi bik gi bi aj pn bj aj pn bj kf qin badgwell control engineering practice purpose approximation reduce computational complexity control calculation 
seen steady state target values calculated nonlinear static model dynamic control moves calculated quadratic model eq 

quadratic model coefficients local gain change control execution simply rescaled match local gain static nonlinear model 
approximation strategy interpreted successive linearization initial final states followed linear interpolation linearized gains 
interpolation strategy resembles gain scheduling model different gain scheduling gain re scaling 
model assumption process dynamics remain linear entire range operation 
asymmetric dynamics different local time constants result represented model 

mpc modeling identification technology table summarizes essential details modeling identification technology sold vendor 
models usually developed process response data obtained stimulating process inputs carefully designed test sequence 
vendors dot products advocate principles models 

test protocols test signals required excite steady state low frequency dynamic medium high frequency dynamics process 
process model identified process input output data 
vendors believe plant test single important phase implementation dmc plus controllers 
prepare formal plant test pre test usually necessary reasons mv adjust existing instruments pid controllers ii obtain time steady state cv iii obtain data initial identification 
identification packages test manipulated variables time fix variables steady state 
approach valid long process assumed linear superposition works 
packages allow mvs change simultaneously uncorrelated signals different mvs 
plant test run hours day engineers monitoring plant 
mv stepped times output cv signal noise ratio 
plant test may take days depending time steady state number variables unit 
requirements imposed test pid configuration tuning changes allowed ii operators may intervene test avoid critical situations synchronizing correlated moves allowed 
may merge data multiple test periods allows user cut period data may corrupted disturbances 
lower level pid control tuning changes significantly may necessary construct new process model 
model identified input output combined discrete convolution new input setpoint input model 
appears stepping signals primary test signals identification packages 
glide package uses binary signal optimized dedicated way 
random magnitude random signals dmc plus model rmpct 

linear model identification model parameter estimation approaches mpc products mainly minimizing squares criterion xl jj equation error approach output error approach ljung 
major difference equation error approach output error approach appears identifying arx transfer function models 
equation error approach past output measurements fed back model eqn 
yk uy uu uk uv vk output error approach past model output estimates fed back model yk uy yk uu uk uv vk equation error approach produces linear leastsquares problem estimates biased measurement noise eqn 
white 
output error approach unbiased white measurement noise 
arx model parameters appear nonlinearly model requires nonlinear parameter estimation 
may see equation error approach step ahead prediction approach ym output error approach long range prediction approach ym fir models results linear parameter model output error approach estimation variance may inflated due possible 
dmc plus model squares method estimate fir model parameters velocity form eqn 

advantage velocity form reduce effect step unmeasured qin badgwell control engineering practice disturbance cutler 
velocity form sensitive high frequency noise 
dmc plus model allows data smoothed prior fitting model 
fir coefficients converted fsr coefficients control 
uses recursive squares prediction error formulation implement adaptive features 
worth noting subspace model identification smi ljung algorithms implemented mpc modeling algorithms 
uses canonical variate analysis cva identify state space model model form controller 
vendors developing testing versions smi algorithms 
rmpct adopts step approach identify box jenkins model pem fir model cholesky decomposition ii fit identified model low order arx model smooth large variance due possible fir model 
output error approach fit arx model gauss newton method iii convert arx models laplace transfer functions 
alternative ii iii rmpct option fit identified model directly fixed structure laplace transfer function 
model control transfer function models discretized fsr models sampling interval 
advantage approach flexibility choose different sampling intervals data collection 
model uncertainty bounds provided products rmpct 
glide continuous transfer function models identified directly gradient descent gauss newton approaches 
model uncertainty identified global method finds region parameter space fitting criterion value 
value larger minimum criterion order find feasible region 
linear mpc products allow user apply nonlinear transformations variables exhibit significant nonlinearity 
example logarithm transformation performed composition variables distillation column control 

nonlinear model identification difficult issue nonlinear empirical modeling selection nonlinear form polynomial neural network selection robust reliable identification algorithm 
example aspen target identification algorithm discussed zhao 
builds model output separately 
process having output variables miso sub models built 
procedure employed identify submodel process data 

specify rough time constant input output pair series order filters laguerre model constructed input zhao 
filter states inputs comprise state vector 
static linear model built output state vector inputs partial squares pls 

model reduction performed output model identified steps principal component analysis internal balancing eliminate highly collinear state variables 

reduced model rearranged state space model generate state sequence kg model converges reduction model order go step return step 
pls model built state vector output yj pls model coefficients form matrix 

neural network model built pls latent factors previous step pls residual output yj nonlinear static map gj pls latent factors state vectors improve robustness neural network training reduce size neural network 
novel feature identification algorithm dynamic model built filters filter states predict output variables 
due simplistic filter structure input variable set state variables making matrix block diagonal 
treatment assumes state variable affected input variable inputs decoupled 
typical case input variables coupled algorithm generate state variables linearly dependent collinear 
words resulting state vector minimal realization 
pls algorithm estimation matrix conditioned 
iteration estimation matrices eliminate initial error estimating process time constants 
process nonlinearity added model concern model validity model confidence index 
model extrapolation linear portion model 
ekf output error feedback aspen target interesting benefit treatment demonstrated 
qin badgwell control engineering practice 
mpc control technology mpc controllers designed drive process constrained steady state 
may receive optimal steady state targets optimizer shown fig 
may compute economically optimal operating point internal steady state optimizer 
general objectives mpc controller order importance 
prevent violation input output constraints 
drive cvs steady state optimal values dynamic output optimization 
drive mvs steady state optimal values remaining degrees freedom dynamic input optimization 
prevent excessive movement mvs 
signals actuators fail control plant possible 
translation objectives mathematical problem statement involves number approximations trade offs define basic character controller 
design problem possible solutions surprise number different mpc control formulations 
tables summarize mpc vendors accomplished translation 
fig 
illustrates flow representative mpc calculation control execution 
read current values process inputs dvs mvs process outputs cvs 
addition numerical values measurement carries sensor status indicate sensor functioning properly 
mv carry information status associated lower level control function valve saturated mv permitted move direction 
mv controller disabled mv control considered measured disturbance dv 
remaining steps calculation essentially answer questions process heading 
output feedback process go steady state 
local steady state optimization best way drive process needs go 
dynamic optimization 
sections describe aspects mpc calculation greater detail 
read mv dv cv values process output feedback state estimation determine controlled process subset remove ill conditioning local steady state optimization dynamic optimization output mv process fig 

flow mpc calculation control execution 

output feedback state estimation output feedback step controller available measurements order estimate dynamic state system 
point calculation failure embrace lqg concepts detrimental impact industrial mpc technology 
separating problem natural components state estimation state control industrial mpc products incorporate concept process state rely ad hoc biasing schemes incorporate feedback 
implications additional process output measurements non cvs improve accuracy state estimation easily incorporated control structure additional effort required control linear combinations process states average bed temperature example control unmeasured outputs unmeasured disturbance model options severely limited ad hoc fixes introduced remove steadystate offset integrating unstable systems measurement noise addressed suboptimal manner 
qin badgwell control engineering practice currently mpc products exploit kalman filter technology output feedback 
discussed earlier limitations listed motivated original development algorithm marquis 
currently sold product retains kalman filter 
aspen target product includes ekf feedback straightforward extension nonlinear systems kailath hassibi 
stable processes remaining mpc algorithms included survey form feedback comparing current measured process output ym current predicted output yk bk yk bias bk term added model subsequent predictions yk xk uk bk form feedback equivalent assuming enters output remains constant time morari lee lee morari garc 
muske rawlings analyzed assumption context kalman filter corresponding filter gain kf means feedback process state estimates identity feedback output disturbance 
muske rawlings show wide variety disturbance models possible 
particular show constant output disturbance model leads sluggish rejection disturbances entering process input point criticism mpc 
problem addressed directly building input disturbance model similar internal model principle 
context discrete time linear model general disturbance model written xk sk sk yk nk ms represents constant state disturbance mp represents constant output disturbance 
control designer complete freedom specifying number location disturbances disturbance states observable 
practice means total number disturbances exceed number measured outputs ms process model disturbance allowed enter certain state output directions muske 
design sensible disturbance models mpc applications ripe area academic research especially nonlinear systems 
stable processes constant output disturbance model provides integral action controller effectively removing steady state offset due disturbances model mismatch rawlings 
integrating unstable processes constant output disturbance model fails estimator contains unstable poles process muske rawlings 
addressed easily input state disturbance models industrial mpc forced address issue ad hoc fixes incorporate kalman filter 
approach dmc plus product typical assumed constant integrating disturbance entered process rotation factor describe fraction prediction error due constant integrating disturbance relative constant output disturbance 
specific output variable integrating mode corresponding disturbance model represented xk xk apk pk pk yk pk rotation factor 
case shown disturbance pk observable rotation factor nonzero 
scheme provides offset free control integrating systems choice appropriate rotation factor difficult practice control noisy integrating systems poor 
mpc products include features address variety feedback scenarios encountered applications 
cases cv measurement may available control execution may happen example cv measurement provided analyzer 
case typical solution skip bias update affected cv number control intervals 
counter provided disable control cv executions go feedback 

determining controlled sub process process state estimated controller determine mvs manipulated cvs controlled 
general measurement status cv operator enabled control cv controlled 
mv meet criteria control addition lower level control functions available manipulation 
lower level controller saturated high low add temporary hard mv constraint qin badgwell control engineering practice problem prevent moving mv wrong direction 
lower level control function disabled mv control 
case treated dv 
decisions controlled subprocess defined control execution 
general shape subprocess changes real time illustrated fig 

applications typical include low level control outputs valve positions mpc control formulation additional cvs 
cvs forced stay high low saturation limits treating range zone control variables 
serves lower level controllers away valve constraints compromise performance 
mpc products sensor faults limited complete failure goes pre specified control limits 
sensor faults significant bias drifting normal limits generally detected identified products 
dmc plus rmpct algorithms distinguish critical cv failure noncritical cv failure 
noncritical cv fails rmpct dmc plus algorithms continue control action setting failed cv measurement model predicted value means feedback failed cv 
noncritical cv fails specified period time rmpct drops cv control objective function 
critical cv fails dmc plus rmpct controllers turn immediately 

removal ill conditioning particular control execution process encountered controller may require excessive input movement order control outputs independently 
problem may arise example controlled outputs respond identical way available inputs 
consider difficult independently control adjacent tray temperatures distillation column control cyclone temperature 
important note feature process controlled algorithm attempts control ill conditioned process address problem 
high condition number process gain matrix means small changes controller error lead large mv moves 
conditioning full control problem certainly checked design phase nearly impossible check possible sub processes may encountered operation 
important examine condition number controlled sub process control execution remove ill conditioning model necessary 
strategies currently mpc controllers accomplish task singular value thresholding input move suppression 
singular value thresholding svt method rmpct controller involves decomposing process model singular values urv decomposition 
singular values threshold magnitude discarded process model lower condition number reassembled control 
neglected singular values represent directions process hardly moves large mv change applied svt method gives directions avoid erratic mv changes 
method solves ill conditioning problem expense neglecting smallest singular values 
magnitude neglected singular values small compared model uncertainty may better neglect anyway 
svt collinear cvs approximated principal singular direction 
case collinear cvs example principal direction weighted average cvs 
note svt approach sensitive output weighting 
cv weighted heavily cv represent principal singular direction 
controllers input move suppression ims dmc plus algorithm provide alternative strategy dealing ill conditioning 
input move suppression factors increase magnitude diagonal elements matrix inverted squares solution directly lowering condition number 
move suppression values adjusted point erratic input movement avoided commonly encountered sub processes 
case collinear cvs move suppression approach gives upa little bit moving cv target 
move suppression solution similar svt solution sense tends minimize norm mv moves 
limit infinite move suppression condition number sub processes 
useful find set finite move suppression factors guarantee subprocesses condition number greater desired threshold value authors aware academic addresses question 

local steady state optimization mpc products surveyed perform separate local steady state optimization control cycle compute steady state input state output targets 
necessary optimal targets may change time disturbances entering operator inputs redefine control problem 
optimization problem typically formulated drive steady state inputs outputs closely possible targets determined local economic optimization just mpc algorithm fig 
violating input output qin badgwell control engineering practice constraints 
constant disturbances estimated output feedback step appear explicitly steadystate optimization removed 
rao rawlings describe representative formulation problem rao rawlings 
local steady state optimization uses steady state model may come linearizing comprehensive nonlinear model control execution may simply steady state version dynamic model dynamic optimization 
controller uses linear program lp local steady state optimization 
distinguishing feature lp solution optimal steady state targets lie vertex constraint boundary 
constraint boundary changes frequently due model mismatch noise optimal steady state solution may bounce unnecessarily leading poor control performance 
typical solutions problem include heavily filtering output signals optimizer adding term minimizes movement solution 
solutions slow movement steady state target hamper rejection process disturbances 
alternative solution direct incorporation model uncertainty proposed implemented commercially badgwell hawkins 
rmpct pfc aspen target mvc process algorithms quadratic programs qp steady state target calculation 
qp solution necessarily lie constraint boundary optimal steady state targets tend bounce lp solution 
dmc plus algorithm solves local steady state optimization problem sequence lps 
cvs ranked priority control performance cv sacrificed order improve performance lower priority cv 
prediction error spread set cvs grouping priority level 
calculation proceeds optimizing highest priority cvs subject hard soft output constraints cvs input hard constraints 
subsequent optimizations preserve trajectory high priority cvs equality constraints 
likewise inputs ranked priority order inputs moved sequentially optimal values extra degrees freedom permit 
products surveyed enforce hard input constraints steady state optimization 
find steady state targets feasible respect input constraints provided defined sensible way 
true output constraints 
large disturbance enters process may possible available input space completely remove disturbance steady state 
reason dmc plus mvc process products provide soft output constraints steady state optimization 
allow violation output constraint magnitude violation minimized objective function 
remaining products may subject steady state infeasibility problems precautions taken 
similar infeasibility problems may arise due failure zero integrating modes process steady state 
dmc plus algorithm example includes explicit constraint forces integrating ramp cv variables line steady state 
constraint violated due large disturbance entering loop dmc plus product shut warning message 
products address issue similar way 
alternative solution penalize violation soft constraint controller try best line integrating cvs steady state shutting 
disturbance diminishes operator provides room input constraints possible steady state calculation feasible 
nova nlc controller perform separate steady state optimization steady state dynamic optimizations performed simultaneously 
may improve controller performance long steady state dynamic objectives conflict 
example separate objectives possible steady state target may computed achieved due constraints appear dynamic optimization 
combining objectives leads complex numerical problem 

dynamic optimization dynamic optimization level mpc controller compute set mv adjustments drive process desired steady state operating point violating constraints 
mpc products surveyed described approximately minimizing dynamic objective function xp jjq xm jjq rj subject model constraint xk xk uk yk xk uk qin badgwell control engineering practice jjj sj subject inequality constraints jp sj sjx jp jpd objective function eq 
involves conflicting contributions 
output behavior controlled penalizing deviations desired output trajectory yr defined ey yk yr prediction horizon length output constraint violations penalized minimizing size output constraint slack variables sj input deviations desired steady state input controlled input penalties defined eu uk control horizon length rapid input changes penalized separate term involving moves size deviations measured vector norm usually norm relative importance objective function contributions controlled setting time dependent weight matrices qj tj sj rj chosen positive semi definite 
solution set input adjustments uk uk uk mpc controllers quadratic objective function similar dynamic optimization 
case dynamic optimization takes form qp solved reliably standard software 
large problems fast processes may sufficient time available solve qp 
reasons dmc plus pfc algorithms fast sub optimal algorithms generate approximate solutions dynamic optimization 
dmc plus algorithm input predicted violate maximum minimum limit set equal limit calculation repeated mv removed 
pfc algorithm performs calculation constraints clips input values exceed hard constraints 
techniques prevent violation hard input constraints general involve loss performance difficult predict 
typically resulting performance acceptable solutions satisfy karush kuhn tucker necessary conditions optimality 
dmc plus algorithms penalize input deviation order drive system optimal steady state rj rm final input weight large process stable approximately equivalent having terminal state constraint 
dynamic solution horizon significantly different steady state targets means terminal states effectively constrained dmc plus controller automatically turn 
setting effectively provides nominal stability dmc plus controller 
final input weights applicable integrating processes derivative integrator driven zero 
rmpct pfc algorithms penalize input moves directly sj 
pfc algorithms predefined output trajectory avoid aggressive mv moves 
rmpct controller defines funnel described finds optimal trajectory optimal mv moves minimizing arg min xp jjy jj subject funnel constraints 
relative priority terms set weighting matrices 
case term completely satisfied typical due funnel formulation cv error vanish minimization fact performed second term 
case results similar having separate objectives cvs mvs 
case infinite number solutions typical due relaxing trajectory minimum norm solution mvs obtained due singular value thresholding 
single objective function dynamic optimization means trade offs contributions resolved relative weight matrices qj tj sj rj algorithm resolves conflicting dynamic control objectives solving separate cv mv optimization problems 
decision priori cv errors important mv errors 
quadratic output optimization problem solved similar including terms 
thin square plant cases provide unique solution calculation terminates 
fat plant case remaining degrees freedom optimize input settings 
case controller solves separate quadratic input optimization problem similar including terms 
input optimization includes set equality constraints preserve output trajectories output optimization 
eliminates need set weights determine trade output input errors cost additional computation 
pfc controller includes process input output terms dynamic objective uses constant weight matrices tj rj sj qin badgwell control engineering practice 
aspen target mvc products include terms constant weights tj rj sj 
nova nlc product adds option norms tj rj sj 
trajectory process product tj rj sj uses dynamic objective trajectory weighting gradually increase horizon type weighting control errors horizon important horizon allowing smoother control action 

constraint formulations types constraints commonly industrial mpc technology hard soft setpoint approximation 
illustrated fig 

hard constraints shown fig 
violated 
soft constraints shown middle fig 
violation may allowed violation typically minimized quadratic penalty objective function 
past past past hard constraint quadratic penalty soft constraint quadratic penalty setpoint approximation soft constraint fig 

basic types constraint hard soft setpoint approximation 
hard constraints top violated 
soft constraints middle may violated violation penalized objective function 
setpoint approximation constraint bottom penalizes deviations constraint 
shades areas show violations penalized dynamic optimization 
adapted 
way handle soft constraints setpoint approximation illustrated bottom fig 

setpoints defined soft constraint resulting objective function penalties sides constraint 
output weight adjusted dynamically weight significant cv comes close constraint 
violation predicted weight increased large value control bring cv back constraint limit 
soon cv constraint limit steady state target setpoint 
mpc algorithms allow hard mv maximum minimum rate change constraints defined 
generally defined lower level mv controllers controllable range prevent violent movement mvs single control execution 
pfc algorithm accommodates maximum minimum mv acceleration constraints useful mechanical servo control applications 
exception dmc plus algorithm mpc products enforce soft output constraints dynamic optimization 
hard output constraints provided options pfc nova nlc algorithms carefully enforcement hard output constraints lead closed phase processes muske rawlings 
hard output constraints cause feasibility problems especially large disturbance enters process 
pfc algorithms hard output constraints ranked order priority low priority constraints dropped problem infeasible 
algorithm provides constraint optimization match number active constraints number degrees freedom available controller number unconstrained mvs 

output input trajectories industrial mpc controllers basic options specify cv behavior setpoint zone trajectory funnel 
illustrated fig 

shaded areas correspond eu terms 
controllers provide option drive cvs fixed setpoint deviations sides penalized objective function 
practice type specification aggressive may lead large input adjustments controller fashion 
particularly important internal model differs significantly process 
mpc algorithms move suppression factors purpose 
controllers provide cv zone control option designed keep cv zone defined qin badgwell control engineering practice past past past past quadratic penalty quadratic penalty quadratic penalty quadratic penalty setpoint zone trajectory funnel fig 

options specifying cv behavior setpoint zone trajectory funnel 
shaded areas show violations penalized dynamic optimization 
upper lower boundaries 
way implement zone control define upper lower soft constraints 
implementations possible 
dmc plus algorithm example uses setpoint approximation soft constraints implement upper lower zone boundaries 
pfc aspen target mvc nova nlc algorithms provide option specify desired path cv called trajectory 
second order curve drawn current cv value setpoint speed response determined trajectory time constants 
cv deviations trajectory penalized 
limit zero time constants trajectory reverts back pure setpoint case controller sensitive model mismatch strategy move suppression 
drawback trajectory formulation penalizes output happens drift quickly setpoint happen response unmeasured disturbance 
cv moves quickly due model mismatch trajectory beneficial slow cv minimize overshoot 
trajectory interpreted mathematically filter feedback path similar robustness filter recommended imc theory morari 
general trajectory time constants increase controller able tolerate larger model mismatch 
nova nlc trajectory slightly general allows separate specification upper lower trajectories different dynamics setpoints 
controller objective deviations upper trajectory deviations lower trajectory penalized 
provides additional freedom transient controller utilize tasks 
rmpct algorithm attempts keep cv user defined zone setpoints defined setting maximum minimum zone limits equal 
cv goes outside zone rmpct algorithm defines cv funnel shown bottom fig 
bring cv back range 
slope funnel determined user defined performance ratio defined desired time return zone divided open loop response time 
weighted average open loop response time multivariable systems 
algorithm uses variation funnel zone cv falls range 
case zone trajectory bounds defined drive cv back control zone 
nova nlc upper lower trajectories rmpct funnel trajectory bounds advantageous disturbance causes predicted cv reach setpoint quickly dv sp cv qin badgwell control engineering practice trajectory allows controller take action 
effectively frees freedom controller achieve objectives 
situation controllers move inputs bring cv back defined trajectory 
illustrated fig 
case rmpct funnel 
mpc algorithms surveyed provide mv setpoints drive inputs optimal values sufficient degrees freedom 

output horizon input parameterization industrial mpc controllers generally evaluate cv behavior finite set time intervals called prediction horizon 
illustrated top fig 

finite output horizon formulation dv past past sp cv fig 

mpc funnel allows cv move back setpoint faster trajectory require pulse disturbance releases 
trajectory mpc try move away setpoint follow trajectory 
finite horizon prediction horizon coincidence points fig 

output horizon options 
finite horizon top includes points 
subset prediction horizon called coincidence points bottom may 
shaded areas show violations penalized dynamic optimization 
funnel algorithms discussed 
length horizon basic tuning parameter controllers generally set long capture steady state effects computed mv moves 
mpc controllers multiple point output horizon means predicted objective function contributions evaluated point 
pfc process aspen target controllers allow option simplify calculation considering subset points prediction horizon called coincidence points 
concept illustrated bottom fig 

separate set coincidence points defined output useful output responds quickly relative 
full finite output horizon selected special case 
industrial mpc controllers different methods parameterize mv profile illustrated fig 

mpc algorithms compute sequence moves spread finite control horizon shown fig 

length control horizon basic tuning parameter controllers 
common past control horizon past past multiple moves single move basis function fig 

input parameterization options 
multiple move option top single move option middle basis function parameterization bottom 
qin badgwell control engineering practice parameterization referred multiple moves means separate input adjustment computed time point control horizon 
performance improves increases expense additional computation 
simplify calculation aspen target rmpct algorithms provide move blocking option allowing user specify points control horizon moves computed 
reduces dimension resulting optimization problem possible cost control performance 
mvc algorithms compute single input move shown middle fig 

greatly simplifies calculation algorithms helpful algorithm separate dynamic optimizations solved control execution 
single move involves sacrifice closed may difficult quantify 
pfc controller parameterizes input profile set polynomial basis functions 
possible solution illustrated bottom fig 

allows relatively complex input profile specified large potentially infinite control horizon small number unknown parameters 
may provide advantage controlling nonlinear systems 
choosing family basis functions establishes features computed input profile way ensure smooth input signal example 
polynomial basis chosen order selected follow polynomial setpoint signal lag 
feature important mechanical servo control applications 

numerical solution methods interesting consider various numerical solution methods mpc control calculations 
focus dynamic optimization step takes form nonlinear program 
linear mpc technology reduces qp 
pfc algorithm linear models solves qp simplest possible way squares solution followed clipping enforce input constraints 
clearly sub optimal single linear system solved pfc controller applied fast processes 
dmc plus algorithm slightly complex solves sequence leastsquares problems order accurately approximate qp solution 
remaining linear products various active set qp methods solve input profile 
unfortunately algorithms exploit problem structure efficiently solution time generally grows proportion control horizon 
efficient solutions possible model retained equality constraint yielding solution time grows linearly proportion rao wright rawlings describe method interior point techniques rao wright rawlings 
nonlinear mpc products course powerful solution techniques usually sequence iterations linearized version problem solved 
aspen target product uses multi step newton type algorithm developed de oliveira named advantage intermediate solutions optimal guaranteed feasible 
permits early termination optimization algorithm necessary guarantees feasible solution 
aspen target uses engine local steady state optimization dynamic mv calculation 
mvc process products generalized reduced gradient code called grg developed warren 
nova nlc product uses nova optimization package proprietary mixed complementarity nonlinear programming code developed dot products 
pfc controller nonlinear model performs unconstrained optimization nonlinear squares algorithm 
solution computed rapidly allowing controller short sample time applications missile tracking 
performance loss may expected input constraints enforced clipping 

applications summary tables summarize reported applications linear nonlinear mpc technology 
important note vendors free define constitutes application reason careful drawing data 
qin badgwell control engineering practice example cases single application may defined large mpc controller encompasses entire chemical plant 
cases automobile engine control vendor may report single application copies completed controller sold 
note count mpc applications performed vendors include significant number house applications performed licensees vendor technology dupont 
include consideration mpc technology developed completely house operating companies eastman chemical 
total mpc applications reported tables twice number previous survey years earlier qin badgwell 
safe conclude usage mpc technology growing rapidly 
vendors report significant number applications progress number continue increase coming years 
noted size applications ranges single variable hundreds variables 
number applications indication market share 
tables show mpc technology wide variety application areas 
largest single block applications refining amounts classified applications 
original application areas mpc technology solid track record success 
significant number applications chemicals taken longer mpc technology break areas 
significant growth areas include chemicals pulp food processing aerospace automotive industries 
table shows honeywell hi spec highly focused refining handful applications areas 
table summary nonlinear mpc applications areas estimates vendor survey estimates include applications companies licensed vendor technology area aspen continental dot total technology controls products technologies air gas chemicals food processing polymers pulp refining utilities unclassified total apparently broader range experience applications food processing mining aerospace automotive areas 
applications reported include number embedded pfc applications difficult report number distribution 
total number reported sgs includes number house applications shell distribution shifted refining applications 
bottom table lists largest linear mpc applications date vendor form outputs inputs 
numbers show difference philosophy matter controversy 
prefers solve large control problem single controller application possible report application outputs inputs 
vendors prefer break problem meaningful sub processes 
nonlinear mpc applications reported table spread evenly number application areas 
areas largest number reported applications include chemicals polymers air gas processing 
observed size scope applications typically smaller linear mpc applications martin johnston 
due computational complexity algorithms 

limitations existing technology currently available industrial mpc algorithms suffer limitations inherited original dmc technology 
problems control technology discussed morari lee muske rawlings include limited model choices sub optimal feedback lack nominal stability sub optimal inefficient solution dynamic optimization 
linear mpc algorithms dmc plus rely convolution models impulse step response 
problematic controlling process widely varying time constants case typical sacrifice dynamic control fast process modes order keep model length reasonable 
potentially significant problem impulse step response models limited strictly stable processes 
certainly possible modify algorithms accommodate pure integrator modifications may lead problems adding derivative noisy qin badgwell control engineering practice output signal feedback path 
possible general represent unstable process impulse response model 
problems overcome auto regressive parametric model form state space arx model 
bias update feedback technique industrial mpc controllers probably best assumption stable plants total absence disturbance measurement information better feedback possible distribution disturbances characterized carefully 
bias update method implicitly assumes stochastic disturbances affecting system state measurement perfect 
measurement noise typically dealt separately applications ad hoc filtering techniques 
bias update fails purely integrating systems number ad hoc methods developed practitioners handle case 
methods tend poorly presence significant measurement noise 
industrial practitioners need recognize kalman filter provides rich framework address problems 
muske rawlings demonstrated better performance achieved mpc applications statespace model optimal state observer muske rawlings 
course problems motivated original development algorithm marquis uses kalman filter feedback 
tuning mpc controllers stable operation presence constraints may difficult process model perfect 
currently effort spent closed prior controller 
recognized simulating possible combinations active constraints impossible practice 
far better build algorithm inherently stable cases control theory known nominally stabilizing algorithm 
rawlings show done linear case infinite prediction control horizons 
chen ower quasi infinite horizon method nonlinear systems chen 
research results nonlinear case covered thoroughly mayne 

currently available industrial mpc algorithms full ideas 
sub optimal solutions dynamic optimization packages presumably order speed solution time 
difficult justify case refining applications controllers run order minute 
goodwin 
give example unconstrained lqr solution significant performance deterioration compared mpc solution severe constraints 
high speed applications controller execute milliseconds tracking position missile may feasible solve qp control execution 
case sub optimal solution may option 
linear mpc products exploit structure qp dynamic optimization 
singular value technique rmpct efforts robust numerical techniques 
properly exploiting structure problem possible handle significantly larger faster processes rao 
model uncertainty addressed adequately current mpc technology 
identification packages provide estimates model uncertainty vendor honeywell provides way information control design 
mpc algorithms provide way control improve robustness trade performance robustness generally clear 
connection possible determine model accurate particular control application 
robust mpc results available academic literature focus dynamic optimization simple setpoint change 
promising results may eventually impact mpc practice include robust stability conditions modified algorithm nikolaou robust mpc algorithm balakrishnan morari robust steady state target calculation described badgwell hawkins 
research needed area 
current model identification technology suffers number limitations plant test signals typically step require close attention experienced engineers test tool determine collected data adequate represent process dynamics mpc design practice plant generally tested increasing implementation cost test period identification algorithms mainly leastsquares type modern subspace identification prediction error methods statistical efficiency consistency identification algorithms addressed lack model validation methods verify identified model adequate control significant model deterioration occurred mpc controller commissioned little practice multivariable closed qin badgwell control engineering practice useful line model updating adaptive mpc implementation systematic approach building nonlinear dynamic models 
guidelines plant tests needed build reliable nonlinear model 
important test data required empirical nonlinear model empirical linear model 

generation mpc technology mpc vendors asked describe vision generation mpc technology 
responses combined views earlier analysis come composite view mpc technology 

basic controller formulation difficult express relevant control objectives single objective function mpc technology utilize multiple objective functions 
infinite prediction horizon beneficial theoretical properties probably standard feature 
output input trajectory options include setpoints zones trajectories funnels 
input parameterization basis functions may widespread infinite control horizons moves computed control interval may possible 

adaptive mpc adaptive mpc algorithms gpc algorithm introduced clarke proposed clarke adaptive mpc algorithms reached marketplace star dot products dollar melton glasgow 
despite strong market incentive self tuning mpc controller 
reflects difficulty doing adaptive control real world 
barring theoretical breakthrough situation change near 
hand adaptive demand tuning pid controllers successful marketplace 
suggests adaptive mpc controllers may emerge siso loops adaptive pid technology generalized handle difficult dynamics 

robust mpc exception honeywell industrial mpc controllers rely solely brute force simulation evaluate effects model mismatch 
robust stability guarantees significantly reduce time required tune test industrial mpc algorithms 
robust research results mayne eventually way mpc products 
robust stability guarantees combined uncertainty estimates identification software greatly simplify design tuning mpc controllers 

nonlinear mpc generation mpc technology allow nonlinear models developed seamlessly combining process knowledge operating data 
continuoustime fundamental model defined graphical representation plant 
process test signals designed automatically explore important regions operating space model inadequate control 
closed tests conducted signals minimal site time requirements 
owing difficulty data modeling nonlinear processes principles models alternative modeling methods foss marquardt necessary practice 

discussion mpc technology progressed steadily dmc applications years ago 
survey data show number mpc applications approximately doubled years 
mpc applications show solid foundation refining significant penetration wide range application areas chemicals food processing 
mpc technology landscape changed dramatically years making difficult swift progress academic research industrial applications 
major developments include technological changes due development new algorithms academia industry computer hardware software advances breadth industrial applications 
organizational changes due acquisitions mergers acquisition aspen technology setpoint treiber controls 
integration mpc technology distributed control system dcs platforms illustrated acquisition predictive control parent 
qin badgwell control engineering practice increased applications users license mpc software vendors 
current generation linear mpc technology offers significant new capabilities unnecessary limitations remain 
products allow parametric models 
feedback options severely limited leading poor control integrating systems slow rejection unmeasured disturbances 
algorithms nominally stabilizing tuning choices tested extensively closed 
linear mpc algorithms modern numerical solution methods limiting size speed processes applied 
applications nonlinear mpc products continue grow areas linear mpc technology proven difficult apply control processes 
nonlinear mpc algorithms reported differ simplifications generate tractable control calculation 
models usually specified linear dynamic subsystems added nonlinearity 
nova nlc controller current offering allows rigorous nonlinear model derived principles 
important observation majority industrial mpc controllers empirical dynamic models identified test data 
improvements identification technology result shorter process testing times large positive impact bottom line mpc technology users 
choosing mpc technology application complex question involving issues addressed 
emphasized technical capabilities mpc technology 
vendor selected design implement advanced control system wise weigh heavily experience particular process question 
research needs perceived industry control engineering issues algorithm issues 
industrial practitioners perceive closed loop stability example serious problem 
questions variables control 
model identification plant test 
determine source problem controller performing poorly 
added expense nonlinear mpc controller justified 
design control system entire plant 
estimate benefits control system 
answering questions provide control practitioners theoreticians plenty foreseeable 
just agree control algorithms best industrial practitioners different views trends mpc 
just pid controllers different implementations series form parallel form mpc controllers anticipated converge single form foreseeable 
academic research continue algorithms prove new facts mpc domain industrial development consider priorities healthy interaction academia 
plenty room refine mpc algorithms pushing technology new application areas equally important challenging 
uneven distribution mpc applications today safe anticipate development theory practice ahead 
authors wish vendor representatives responded mpc survey time effort 
wish people constructive criticism pierre jim downs harry forbes brian pierre john rob hawkins dean geoff lewis joseph lu greg martin steve jim rawlings andy douglas white robert young hong zhao 
badgwell qin rawlings wright 

nonlinear predictive control moving horizon estimation introductory overview 
frank ed advances control highlights ecc 
berlin springer 
zheng eds 

nonlinear model predictive control progress systems control theory 
vol 

basel boston berlin birkhauser verlag 
fontaine 

feedback method controlling non linear processes 
patent 
papadopoulos 

multivariable process control method apparatus 
patent 
papadopoulos moran 

multivariable process control method apparatus 
patent 
chen 

quasi infinite horizon nonlinear model predictive control scheme guaranteed stability 
automatica 
clarke 

generalized predictive control part basic algorithm 
automatica 
mvc user manual 
continental controls product literature 
cutler 

industrial perspective advanced control 
aiche annual meeting washington dc october 
cutler 

dynamic matrix control computer control algorithm 
aiche national meeting houston tx april 
cutler 

dynamic matrix control computer control algorithm 
proceedings joint automatic control conference 
qin badgwell control engineering practice cutler 

experience dmc inverse identification 
ray eds chemical process control cpc iv 
fourth international conference chemical process control pp 

amsterdam elsevier 
johnston martin 

neural network modeling control process 
society engineers international conference houston tx 
dmc dmc tm 
technology overview 
product literature dmc july 
dollar melton glasgow 

consider adaptive multivariable predictive controllers 
hydrocarbon processing 
downs 

linking control strategy design model predictive control 
preprints chemical process control assessment new directions research cpc vi az january pp 

foss marquardt 

field study industrial modeling process 
journal process control 


model predictive control past 
isa transactions 


application shell fundamental control problem 
aiche annual meeting november 
garc 

quadratic programming solution dynamic matrix control 
chemical engineering communications 
garc morari 

model predictive control theory practice survey 
automatica 
goodwin 

control system design 
englewood cliffs nj prentice hall 


controller 
eds proceedings ifac workshop model process control pp 

oxford pergamon press 
andersen 

model predictive control grade transitions reactor 
proceedings th european symposium computer aided process engineering escape dublin march 
honeywell 

rmpct concepts 
product literature honeywell october 
kailath 

linear systems 
englewood cliffs nj prentice hall 
kailath hassibi 

linear estimation 
upper saddle river nj prentice hall 
kalman 

contributions theory optimal control 
bulletin de la de 
kalman 

new approach linear filtering prediction problems 
transactions asme journal basic engineering 
badgwell hawkins 

robust steady state target calculation model predictive control 
ch journal 
keeler martin boe mathur johnston 

process step multivariable control optimization 
technical report technologies austin tx 
balakrishnan morari 

robust constrained model predictive control linear matrix inequalities 
automatica 
cannon 
eds 

nonlinear predictive control theory practice 
london iee 
lu samad 

emerging technologies enterprise optimization process industries 
preprints chemical process control assessment new directions research cpc vi arizona january pp 



linear optimal control systems 
new york wiley 


canonical variate analysis identification filtering adaptive control 
proceedings th conference decision control pp 

warren 

grg user guide 
cleveland oh cleveland state university 
lee cooley 

advances model predictive control related areas 
kantor garcia eds fifth international conference chemical process control aiche cache pp 

lee markus 

foundations optimal control theory 
new york wiley 
lee morari garc 

state space interpretation model predictive control 
automatica 
lewis evans 

application predictive control techniques distillation column 
journal process control 
ljung 

system identification theory user 
englewood cliffs nj prentice hall ljung 

system identification theory user 
englewood cliffs nj prentice hall 

predictive control constraints 
englewood cliffs nj prentice hall 
marquis 

bridge state space model predictive controllers application automation unit 
eds proceedings ifac workshop model process control pp 

oxford pergamon press 
martin boe keeler 

method apparatus modeling dynamic steady state processes prediction control optimization 
patent 
martin johnston 

continuous model optimization 
hydrocarbon processing process optimization conference houston tx 
mayne 

nonlinear model predictive control assessment 
kantor garcia eds fifth international conference chemical process control aiche cache pp 

mayne rawlings rao 

constrained model predictive control stability optimality 
automatica 
morari lee 

model predictive control bad ugly 
ray eds chemical process control cpc iv fourth international conference chemical process control pp 

amsterdam elsevier 
morari 

robust process control 
englewood cliffs nj prentice hall 
muske 

linear model predictive control chemical processes 
phd thesis university texas austin 
muske rawlings 

model predictive control linear models 
ch journal 
ohno hashimoto 

model predictive control experiences university industry joint projects statistics mpc applications japan 
international workshop predictive receding horizon control korea october 
de oliveira 

extension algorithms nonlinear process control 
automatica 
de oliveira 

constraint handling stability properties model predictive control 
ch journal 
johnson 

nonlinear model predictive control neural networks 
ieee control systems magazine 
qin badgwell control engineering practice poe 

benefits advanced process control economic optimization processes 
hydrocarbon processing process optimization conference houston tx 
garc 

fundamental process control 
boston butterworths 


optimization constrained multivariable control catalytic cracking unit 
proceedings joint automatic control conference 


linear programming methods synthesizing sampled data automatic systems 
automatic remote control 
qin badgwell 

overview industrial model predictive control technology 
chemical process control cpc cache 
tahoe city ca january 
qin badgwell 

overview industrial model predictive control technology 
kantor garcia eds chemical process control fifth international conference chemical process control cache aiche pp 

qin badgwell 

overview nonlinear model predictive control applications 
zheng eds nonlinear model predictive control workshop assessment directions switzerland 
qin badgwell 

overview nonlinear model predictive control applications 
kantor garcia eds nonlinear model predictive control 
basel birkhauser 
rao rawlings 

steady states constraints model predictive control 
ch journal 
rao wright rawlings 

application interior point methods model predictive control 
journal optimization theory application 
rawlings 

tutorial overview model predictive control 
ieee control systems magazine 
rawlings meadows muske 

nonlinear model predictive control tutorial survey 
proceedings ifac japan 
rawlings muske 

stability constrained receding horizon control 
ieee transactions automatic control 


industrial applications model control 
automatica 


algorithmic control industrial processes 
proceedings th ifac symposium identification system parameter estimation 
pp 



model predictive heuristic control applications industrial processes 
automatica 


model predictive control state art 
ray eds chemical process control cpc iv fourth international conference chemical process control pp 

amsterdam elsevier 
mayne 

min max feedback model predictive control constrained linear systems 
ieee transactions automatic control 
rawlings 

constrained linear quadratic regulation 
ieee transactions automatic control 
zhao 

statespace nonlinear process modeling 
ch journal 
setpoint 

smc state art multivariable predictive controller 
product literature setpoint october 


feedback controllers process industries 
new york mcgraw hill 
nikolaou 

performance bounds robust quadratic dynamic matrix control condition 
ch journal 
young fontaine 

evolution industrial nonlinear model predictive controller 
preprints chemical process control cpc vi tucson arizona pp 

cache 


steady state optimization inside model predictive control proceedings acc boston ma pp 

qin badgwell control engineering practice 

robust model predictive control processes hard constraints 
computers chemical engineering 
zhao 

nonlinear industrial model predictive controller integrated pls neural state space model 
ifac th world congress beijing peoples republic china 
zhao 

identification approach nonlinear state space model industrial multivariable model predictive control 
proceedings american control conference philadelphia pp 

