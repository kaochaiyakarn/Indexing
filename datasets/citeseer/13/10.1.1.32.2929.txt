chapter causal inference graphical models steffen lauritzen aalborg university february bayesian networks pearl associated local computation algorithms lauritzen spiegelhalter shenoy shafer jensen lauritzen olesen initiated renewed interest understanding causal concepts connection modelling complex stochastic systems 
clear graphical models particular directed acyclic graphs natural causal interpretations form base language causal concepts discussed analysed precise terms 
consequence explosion writings primarily mainstream statistical literature concerned exploitation language clarify extend causal concepts 
mention particular books spirtes glymour scheines shafer pearl collection papers glymour cooper 
briefly fundamentally important distinction distinction types conditional probability 
refer conditioning intervention conditioning observation suggest notation jj notions 
authors expressions set denote intervention conditioning 
causal inference graphical models existing controversy lack clarity due misconception identical related simple fashion distinction properly clearly explicitly better expositions regression see example box section cox 
try develop basic ideas needed distinction precise discuss number classical statistical problems distinction important 
important aspects views causality causal inference touched concerned particular aspect prediction effect interventions system 
material organized follows 
section introduces necessary graph terminology 
sections concerned basic elements graphical models conditional independence markov properties undirected directed graphs 
section introduces notion causal markov field associated intervention probabilities 
sections concerned exploitation idea number important cases 
conclude discussing structural equation models methods counterfactual variables potential responses give brief discussion issues treated se 
writing particular exploited pearl robins 
graph terminology section introduces necessary graph terminology 
basically terminology cowell dawid lauritzen spiegelhalter identical lauritzen 
define graph pair finite set vertices called nodes subset set theta ordered pairs vertices called edges links set graph multiple edges 
require consist pairs distinct vertices loops 
ordered pairs ff fi fi ff belong say undirected edge ff fi write ff fi say ff fi neighbours ff neighbour fi fi neighbour ff 
set neighbours vertex fi denoted ne fi 
ff fi fi ff call edge directed write ff fi 
say ff parent fi fi child ff 
set parents vertex fi denoted pa fi set children vertex ff ch ff 
family fi denoted fa fi fa fi ffig pa fi 
graph terminology ff fi fi ff say ff fi joined 
ff fi indicates ff fi joined ff fi fi ff write ff 
fi ff fi ae expressions pa ne ch denote collection parents children neighbours respectively elements excluding element pa ff pa ff ne ff ne ff ch ff ch ff edges graph directed say directed graph 
conversely edges graph undirected say undirected graph 
boundary bd ff vertex ff set parents neighbours ff boundary bd subset ae set vertices parents neighbours vertices bd pa ne closure cl bd 
undirected version graph undirected graph obtained replacing directed edges undirected edges 
call ga ea subgraph ea theta 
may contain vertex set possibly fewer edges 
addition ea theta say ga subgraph induced vertex set graph called complete pair vertices joined 
say subset vertices complete induces complete subgraph 
complete subgraph maximal respect called clique 
path length ff fi sequence ff ff ff fi distinct vertices ff gamma ff path cross moving path goes directions arrows 
cycle length path modification vertex identical ff ff cycle directed contains arrow 
directed graph contains cycles called directed acyclic graph dag 
trail length ff fi sequence ff ff ff fi distinct vertices ff gamma ff ff ff gamma ff gamma ff moving trail go direction arrows contrast case path 
words trail sequence vertices form path undirected version possible order nodes dag linear ordering numbering nodes connected edge points lower higher nodes respect ordering 
causal inference graphical models directed acyclic graph set vertices ff ff 
fi fi 
ff ancestors fi fi descendants de ff ff vertices fi ff 
fi fi 
ff 
nd ff ff set de ff ff 
pa ff ff say ancestral set 
symbol denotes smallest ancestral set containing subset said ff fi separator trails ff fi intersect subset said separate ff fi separator ff fi ff fi separator said minimal proper subset ff fi separator 
directed acyclic graph define moral graph undirected graph obtained adding undirected edges pairs vertices common children joined forming undirected version resulting graph 
conditional independence text central notion conditional independence random variables groups 
concerned situation collection random variables ff ff values probability spaces ff ff probability spaces real finite dimensional vector spaces finite discrete sets quite general just sufficiently behaved ensure existence conditional probabilities 
simplicity consider discrete case 
subset xa theta ff ff typical elements xa denoted xa ff ff similarly xa ff ff formally random variables joint distribution say conditionally independent write measurable set sample space exists version conditional probability function 
usually fixed omitted notation 
trivial say independent write 
discrete random variables condition 
simplifies equation holds 
variables admit joint density respect product measure xy conditional independence equation hold surely respect condition rewritten fxy equality hold values densities continuous 
ternary relation 
properties denotes arbitrary measurable function sample space 

note converse follows 
generic symbol probability density random variables corresponding arguments statements true equalities hold apart set triples probability zero 
property conditional independence relation 

hold universally additional conditions essentially non trivial logical relationship trivial counterexample appears pfx pfx proposition joint density variables respect product measure strictly positive statement hold true 
proof assume simplicity variables discrete density 

gives values suitable strictly positive functions causal inference graphical models choosing fixed get ae ae 
ae 
desired 
cases specifically interested conditional independence groups random variables example xa ff ff subset short notation xa xb xc 
get properties consequence similarly analogue disjoint subsets hold universally specific extra assumptions 
holds example assumption joint density random variables involved strictly positive 
illuminating think properties particular analogues purely formal expressions meaning necessarily tied probability 
interpret symbols random variables symbols pieces knowledge obtained say reading books interpret symbolic expression 
knowing reading irrelevant reading properties translate knowing reading irrelevant reading reading reading knowing reading irrelevant reading book reading irrelevant reading chapter knowing reading irrelevant reading book remains irrelevant having read chapter knowing reading book irrelevant reading having read reading irrelevant reading reading irrelevant reading markov properties undirected graphs view relations pure formal properties notion irrelevance 
property slightly subtle 
certain sense symmetry somewhat special property probabilistic conditional independence general irrelevance 
tempting relations formal axioms conditional independence irrelevance 
semi algebraic structure satisfies 
holds disjoint subsets called pearl 
similarly refer semi axioms axioms 
markov properties undirected graphs conditional independence properties joint distributions collections random variables compactly described expressed called markov properties various graphs 
section consider case graph undirected 
refer lauritzen cowell 
proofs assertions proved 
associated undirected graph collection random variables ff ff range different markov properties 
probability distribution said obey pairwise markov property relative pair ff fi non adjacent vertices ff 
fi fff fig local markov property relative vertex ff ff 
cl ff bd ff global markov property relative triple disjoint subsets separates conditional independence intimately related factorization markov properties 
probability measure said factorize complete subsets exist non negative functions depend exists product measure omega ff ff density respect form complete functions uniquely determined 
arbitrariness choice groups functions multiplied split different ways 
fact loss generality assume causal inference graphical models practical cliques appear sets set cliques factorizes say property 
different markov properties related follows proposition undirected graph probability distribution holds proof see lauritzen 
graph state space theta ff ff denote set distributions satisfy different markov properties mf mg ml mp 
proposition equivalently formulated mf mg ml mp markov properties genuinely different general case positive density possible show implies markov properties equivalent 
result discovered various forms number authors speed usually attributed hammersley clifford 
precisely theorem hammersley clifford probability distribution positive density respect product measure satisfies pairwise markov property respect undirected graph factorizes proof see lauritzen 
fact holds global local pairwise markov properties coincide 
fact stated theorem due pearl paz see pearl 
theorem pearl paz probability distribution holds disjoint subsets proof see lauritzen 
global markov property important gives general criterion deciding groups variables conditionally independent third group variables strengthened 
example holds directed markov property state spaces binary ff gamma mf separates words separated factorizing distribution conditionally dependent 
directed markov property consider set previous section graph assumed directed acyclic 
say probability distribution admits recursive factorization exist oe finite measures ff nonnegative functions ff delta delta ff henceforth referred kernels defined ff theta pa ff ff ff pa ff ff dy ff density respect product measure omega ff ff ff ff ff pa ff say property df 
easy show admits recursive factorization kernels ff delta pa ff fact densities conditional distribution ff pa ff pa ff ff ff pa ff refer kernels conditional specifications immediate form undirected moral graph see section lemma admits recursive factorization directed acyclic graph factorizes moral graph obeys global markov property relative proof factorization follows fact construction sets fffg pa ff complete fffg pa ff ff simple lemma useful consequences shall see examples sequel 
local markov property moral graph find ff 
ff bl ff causal inference graphical models bl ff called markov blanket ff 
markov blanket set neighbours ff moral graph directly original dag set ff parents children children parents bl ff pa ff ch ff ffi ch fi ch ff particular follows called full conditionals satisfy ff nff ff bl ff density ff nff ff pa ff fi ch ff fi pa fi result easily shown proposition admits recursive factorization directed acyclic graph ancestral set marginal distribution pa admits recursive factorization da combination lemma yields corollary factorize recursively separated moral graph smallest ancestral set containing lauritzen dawid larsen property corollary referred directed global markov property dg distribution satisfying directed markov field show global directed markov property role global markov property case undirected graph sense gives sharpest possible rule reading conditional independence relations directed graph 
procedure illustrated example example consider directed markov field graph fig 
problem deciding 
moral graph smallest ancestral set containing variables involved shown second graph fig 

immediate separates moral graph implying 
alternative formulation global directed markov property pearl formal treatment verma pearl 
recall trail sequence vertices forms path undirected version directions arrows ignored 
trail directed acyclic graph said blocked contains vertex fl fl arrows meet head head fl directed markov property pq gamma gamma psi gamma gamma psi gamma gamma psi gamma gamma psi fx yg gamma gamma gamma gamma gamma gamma directed global markov property 


moral graph smallest ancestral set graph containing fag fbg clearly separates implying 
fl descendants arrows meet head head fl 
trail blocked said active 
subsets said separated trails blocked result proposition disjoint subsets directed acyclic graph separates separates proof see lauritzen 
global directed markov property formulated requiring separates making analogy undirected case clearer 
depends specific context purpose criterion criterion definition global directed markov property easiest 
illustrate concept separation applying query example 
fig 
indicates trails blocked global markov property gives 
shall symbolic expression denote separated equivalently separated shown verma pearl lemma fixed directed acyclic graph relation satisfies axioms 
geiger pearl show criterion separation improved sense directed acyclic graph causal inference graphical models illustration pearl separation criterion 
trails drawn thick lines 
blocked different vertices fl indicated open circles play role blocking vertices 
find state spaces ff ff probability distribution result strengthened meek showed state spaces finite cardinality set probability distributions satisfying lebesgue measure zero set directed markov probability measures 
complete section say obeys local directed markov property dl variable conditionally independent non descendants parents ff 
nd ff pa ff seemingly weaker requirement ordered directed markov property replaces non descendants ff condition predecessors pr ff ff ordering nodes ff 
pr ff pa ff contrast undirected case properties df dl dg equivalent just assuming existence density stated formally theorem directed acyclic graph 
probability distribution density respect product measure conditions equivalent df admits recursive factorization dg obeys global directed markov property relative dl obeys local directed markov property relative obeys ordered directed markov property relative causal markov models proof df implies dg corollary 
dg implies dl follows observing fffg nd ff ancestral set pa ff obviously separates fffg nd ff pa ff fffg nd ff trivial dl implies pr ff nd ff 
final implication shown induction number vertices jv ff vertex ff conditional density ff chosen depend pa ff 
marginal distribution trivially obeys ordered directed markov property admits factorization inductive assumption 
combining factorization ff yields factorization completes proof 
conditions theorem equivalent sense speak directed markov field conditions satisfied 
set distributions directed acyclic graph denoted 
particular case directed acyclic graph perfect parents married directed markov property factorization property undirected version coincide 
proposition perfect directed acyclic graph undirected version 
directed markov respect factorizes proof see lauritzen 
causal markov models simplicity assume random variables discrete finite state spaces specifically indicate 
emphasize discreteness little generic symbol probability mass function general density 
conditioning observation intervention important issue distinguish different types conditioning operations modify probability distribution response information obtained 
conditional probabilities defined calculated refer type conditioning conditioning observation conventional conditioning 
cases represents way causal inference graphical models probability distribution modified information revealed 
paradoxes appear unclear information revealed shafer different discussion 
discussing causal issues important realize typically way distribution modified intervene externally force value equal refer type modification conditioning intervention conditioning action 
distinction clear different symbols conditioning indicated jj generally quantities different jj quantity left hand side calculated probability measure additional assumptions 
judge assumptions reasonable context needs specification precise way intervention just conventional conditioning needs specification information revealed 
moment give precise meaning directed acyclic graph causal 
imply graph left oe jj jj relations reversed graph right holds jj jj 
causal graphs directed acyclic graph said causal probability distribution respect subset markov respect ff ff pa ff holds jj ff na ff pa ff fi fi fi fi fi fi xa ff ff pa ff fi fi fi fi xa causal markov models alternatively think right hand side mathematical definition intervention probability left hand side 
simply say causal fully causal expression causal directed markov field respect say causally markov respect note causal markov property gives relation different probability measures representing probability law associated specific intervention 
refer intervention formula 
appeared various forms pearl spirtes 

implicit robins literature 
ways causal interpretation directed markov model justified 
important realize ways associate causal relationships directed acyclic graphs 
particular apparent highly interesting book shafer develops language causal interpretation probabilities event trees 
leads events natural direct causes variables 
variety causal relationships variables derived consequences formalism 
general setting interested allowing types intervention described 
example wish control value variable way depends previously observed variables 
simplicity consider case simple interventions 
contrast intervention formula conventional conditioning bayes formula fi fi fi fi xa ya fi fi fi fi fi xa differs intervention formula denominator product conditional specifications replaced marginal probability 
implies particular intervention takes place single variable parents observation intervention identical effects corollary ff parents pa ff holds jj ff ff 
illustrate similarities differences intervening variable 
graph causal intervention produces distribution jj observation leads causal inference graphical models gamma gamma gamma gamma gamma gamma illustration causal directed acyclic graph 
gamma gamma gamma gamma gamma gamma gamma gamma intervention fig 
produces causal directed markov field respect graph left 
observation produces distribution satisfies chain graph markov property respect graph right 
modified distribution delta xa directed causal markov field subgraph na induced remaining variables 
corresponding conditional specifications just modified ff pa na ff jj ff pa ff na pa ff expressed words causal assumption conditional specifications unchanged variables intervention 
example variable modifications specifications involve children intervention variables variables get jj jj corresponding subgraph displayed graph left fig 

contrasted effect observation variable creates dependence structure determined chain graph lauritzen right 
due factor creating function depending factorization 
note general conditional independence structure induced conditioning observation perfect correspondence chain graph 
assessment treatment effects sequential trials important realize successive conditioning operations type commute intervention observation general interchanged 
adopt convention operations performed right left 
jj denotes modified probability obtained observing subsequently intervening jj reflects intervention performed observation 
example consider graph intervening subsequently observing leads jj additional assumptions predict effect intervention observation assumptions example functionally related structural equation model see section 
assumption lead equality jj jj functionally unrelated value known fixed 
generally ensure unambiguous meaning intervention conditioning introducing assumptions intervention node ff variables corresponding descendant nodes observed 
assessment treatment effects sequential trials example adapted robins simplest example traditional approaches assessment treatment effects give incorrect results methods described coincide developed robins known computation give correct answer 
consider study population aids patients 
imagine population large sampling error ignored practical purposes 
study involves binary variables 
notation label initial randomized treatment denotes patient treated indicates 
period patient observed causal inference graphical models gamma gamma gamma graph displaying causal relationships variables particular sequential trial 
graph assumed causal respect interventions fa bg 
missing arrow reflects assigned randomization 
patient develops pneumonia corresponding variable indicates case 
assume patients survive point 
subsequently secondary treatment antibiotics contemplated corresponding variable ethical reasons patients developed pneumonia treated antibiotics treatment randomized patients 
period registered patient survived time corresponding variable denotes patient survived 
question assess effect survival combined treatment antibiotics new patient 
words wish calculate jj done way 
relevant graph displayed missing arrows reflect randomized allocation treatments 
graph fully causal may unobserved variables simultaneously affect assumed causal respect interventions fa bg 
note effects estimable observations 
example effect treating assessed 
find jj jj jj jj pointed robins conventional wisdom gives ambiguous incorrect answers variable affected treatment adjust simply estimate conditional identifiability causal effects probability jj hand covariate effect treatment survival 
adjustment needed jj answers disagree correct calculation 
calculation special case general situations described robins randomized treatment allocations intermediate responses alternate example effect combined treatment fixing final response desired 
computation involving steps 
modifying joint distribution variables corresponding complete dag cases intervention formula 
calculating marginal distribution rk recursive forward computation possibly monte carlo methods 
refrain describing general situation suggested treatment regime allowed depend previous treatments recordings emphasize create essentially new problems 
identifiability causal effects section concerned problem identifying effects interventions partial observation causal system expressed form causal directed markov field 
largely ideas pearl pearl 
general problem consider usual finite set variables labelled designated treatment variable group variables considered response labelled assume directed acyclic graph joint distribution variables causally markov respect object interest causal effect group response variables represented intervention distribution xr xr xr jj remaining variables partitioned set observed covariates variables remain un causal inference graphical models observed 
principle discuss multiple treatments responses done 
experimental observational study obtain information joint distribution observed variables ignoring sampling error causal effect determined information 
phrased way variables needed order determine effect 
causal effect determined observed distribution calculated analogue computation gives correct answer 
causal effects precisely determined give inequalities numbers satisfy 
discussion precise say identifies causal effect pair distributions causally markov respect holds xc xr xc xr jj jj basic question phrased determining set covariates identifies causal effect clearly identifies effect interested minimal sets identifying covariates 
generally identify causal effects conditional distributions identified joint distribution 
section assume xc combinations xc explicitely state 
intervention graphs effect potential intervention discussed convenient represent explicitly associated graph model considered 
done pearl spirtes 
done intervention graph formed augmenting node representing variable intervention contemplated additional parent 
denote additional parent vertex ff ff corresponding random variable ff ambiguity results just denoted ff variable ff state space ff foeg conditional distributions ff parents intervention graph ff pa ff ff ae ff pa ff ff oe ffi ff ff ff ff identifiability causal effects ffi xy kronecker symbol ffi xy ae 
general setup ff vary set randomized decision policies consider simpler case 
approach representation causal effects related called influence diagrams howard matheson shachter smith oliver smith connection consequence gives alternative basis causal interpretation graphical models heckerman shachter 
variables ff ff set variables intervention contemplated arbitrary distribution positive probability states 
clearly ff oe ff holds subset jj xb ff ff ff ff oe ff follows corollary ff ff ff ff oe ff ff ff ff ff oe ff variables ff parents 
importance relation gives simple connection intervention conditioning original graph conventional conditioning intervention graph 
inference rules operations needed find groups identifying covariates typically involve sequence operations gradually transform expressions involving intervention probabilities expressions involving ordinary conditional probabilities principle accessible empirical observation 
considering simple case intervention node contemplated effect group variables studied context xa observed xa denote separation intervention graph obtained augmenting intervention variable additional parent possibly intervention variables interventions contemplated described 
inference rules causal inference graphical models neutral observation xa xr xa neutral intervention xa jj xr xa equivalence observation intervention fa tg xr xa jj xr xa derived directed markov property combined fact intervention obtained appropriate observation conditioning intervention graph 
example derive observe implies holds trails trails blocked blocked global directed markov property entails 
follows 
relations follow directly fact intervention conditioning equivalent observation conditioning rules direct consequences theorem spirtes 
pearl formulates inference rules somewhat differently conjectures inference rules complete sense set covariates identifying effect terms involving intervention conditioning expression intervention distribution changed terms involving observational conditioning successive application rules 
shall see examples subsection number classical concepts epidemiology illustrated 
back door formulae classic conditions set covariates identifying captured theorem known back door theorem formula 
earlier contemplate effect group variables plan observe set covariates remaining variables system unobserved 
denotes intervention graph obtained augmenting intervention variable additional parent denotes separation theorem derived directly theorem spirtes 
identifiability causal effects theorem back door assume satisfies bd covariates unaffected intervention bd intervention affects response treatment modified observed covariates ftg 
identifies effect treatment xr jj xc xr xc proof proof simple application inference rules 
partition xc apply get xr jj xc xr xc jj jj xc xr xc jj xc xr xc condition bd formulated demanding covariates descendants condition checked note positivity assumption important joint distribution identify xr xc combinations arguments 
formulation name back door theorem obvious 
lemma clarifies reason name 
back door trail trail involve arrow emanating leaves back door 
similarly front door trail trail begins arrow emanating lemma covariates descendants ftg back door trails blocked proof assume ftg 
trail corresponds uniquely trail descendants identical blocking trails correspond front door trails blocking trails corresponding back door trails 
consequently blocked blocked condition lemma phrased terms original graph intervention graph 
causal inference graphical models james robins personal communication gives heuristic argument criterion treatment effect identified conditionally association causation 
removing arrows eliminates causation 
demand conditional association remains arrows removed 
formula classical formula adjusts covariates affected treatment 
theorem slightly general version extended recursive argument 
theorem extended back door assume satisfies effect treatment covariates identified bd intervention affects response treatment modified observed covariates ftg 
identifies effect treatment xr jj xc xr xc jj proof shown exactly theorem just omitting step calculation 
confounding situation considered light back door theorem classical case current context defined unobserved quantity simultaneously affects treatment response 
causal graph common ancestor treatment response 
literature epidemiology contains wealth precise definitions term 
situation illustrated displaying corresponding intervention graph associated moral graph 
conditional distribution intervention determined joint distribution 
randomization example illustrates randomization overcomes identification problem caused 
just observing treatment allocated known random mechanism possibly depending observed covariate leading diagram described 
randomization ensures arrow pointing treatment conditionally independent identifiability causal effects gamma gamma gamma intervention graph associated moral graph experiment unobserved 
path moral graph circumventing back door criterion violated effect identified observations gamma gamma gamma gamma gamma gamma intervention graph associated moral graph experiment randomized treatment allocation 
moral graph reveals fc tg back door criterion satisfied treatment effect assessed 
covariates see bd theorem satisfied form ancestral set generated fc equal fc ug associated moral graph edge ancestral set generated fc rg equal full set variables associated moral graph displayed 
clearly separated fc tg graph bd satisfied 
note allowed influence treatment allocation corresponding arrow graph left induced edge moral graph common parents violating bd confounding relation sufficient covariate situation considered observational study control treatment allocation mechanism able find sufficient set covariates set covariates informative response mechanism response conditionally independent unobserved variable treatment covariates 
corresponding intervention graph associated moral graph displayed 
causal inference graphical models gamma gamma gamma gamma gamma gamma intervention graph associated moral graph observational study sufficient covariate 
moral graph reveals fc tg back door criterion satisfied treatment effect assessed 
gamma gamma gamma psi gamma gamma gamma phi phi phi phi phi phi gamma gamma gamma intervention graph associated moral graph study partial compliance 
moral graph reveals fa tg effect treatment assignment identified 
separated effect treatment assessed 
ancestral set generated equal fc ug associated moral graph edge ancestral set generated fc rg equal full set variables associated moral graph displayed 
clearly separated fc tg graph bd satisfied 
partial compliance example describes study treatments assigned completely random individuals individuals complying assignments receive treatment different assigned 
situation displayed labelling assignment actual treatment received 
response treatment assigned treatment received observed 
inspection moral graph clearly follows fa tg effect treatment assigned identified back door formula 
corresponding assessment commonly referred analysis intention treat 
separated effect treatment identifiable observations 
shall see derive bounds effects particular case 
identifiability causal effects gamma gamma gamma psi intervention graph associated situation theorem applies 
covariate capturing way affecting possibly modified unobserved variable front door formula theorem describes situation causal effect treatment identified 
observed covariates considered active agent determining response 
basic example mind effect smoking lung cancer active agent tar content lungs 
unobserved say genetic feature influenced response tendency smoke 
corresponding diagram displayed conditions theorem reflect conditional independence relations directed markov property diagram 
theorem front door formula assume subset ftg fd variables unaffected intervention fd intervention affects covariate treatment independently variables ft fd intervention affects response covariate modified variables identifies effect treatment xr jj xc xc xr xc proof assume loss generality xr jj xc xu xr xc xu jj xu jj xc xu xr xc xu xu jj jj fd deduce intervention term product neutral 
causal inference graphical models fd combined semi properties satisfied relation lemma yields ftg yields intervention second term may substituted ordinary conditioning conditioning xu ignored 
fd gives third term product independent xr jj xu xc xr xu xc rewrite xu note fd allows conditioning term get xr jj xu xc xr xu xc xc xc xr xc proof complete 
formula name due pearl part theorem 
pearl front door conditions formulated differently obvious equivalent believe 
pearl formulation terminology conditions fd directed paths intersect fd trails contain arrow fd back door trails blocked justification name obvious pearl formulation formulation 
true fd fd reflect blocks front door paths fd reflects back door paths blocked 
note importance positivity assumption 
take satisfy conditions theorem 
necessary conditional distributions identified marginal distributions 
additional examples conclude section identifiability treatment effects discussing number additional examples illustrating potential back door formulae 
identifiability causal effects gamma gamma gamma psi intervention graph associated example front door back door formulae apply observed 
example consider example intervention graph displayed 
case observed treatment response back door formula applies covariate front door formula covariate 
extended back door theorem applies covariates observed 
holds jj xc xc treatment effect identified observational situations true corresponding maximum likelihood estimates equally efficient case estimated data 
clearly loss information associated observing variables 
illustrate assume variables discrete potential sample independent identically distributed cases counts observed contrast corresponding incomplete samples giving 
situation maximum likelihood estimate model restricted satisfying directed markov property graph equal nn nn conditional probabilities variable parents estimated corresponding observed relative frequencies lauritzen causal inference graphical models theorem 
extended back door formula relation get jj xc xc similar expression back door case observed jj xc xc note case generally true model induces restrictions conditional probability 
obvious jj xc reasonable estimate intervention probability 
estimate traditional estimate applies general case conditional independence 
violated 
presumably estimate efficient condition 
known hold 
front door case observed similarly jj maximum likelihood estimate second conditional probability may equal corresponding relative frequency 
obvious reasonable estimate treatment effect equal jj interesting compare loss efficiency observing vs observing identifiability causal effects gamma gamma psi gamma gamma psi gamma gamma gamma psi phi phi phi phi phi phi gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma intervention graph associated example corresponding moral graph 
gamma gamma gamma psi graphical model expressing instrumental variable 
note similarity situation partial compliance described assignment variable instrument 
example example taken pearl somewhat complex 
illustrated 
shows suffices covariate front door formula theorem apply 
moral graph seen direct inspection observing necessary sufficient satisfy back door theorem 
needs supplemented non empty subset variables union separate graph 
example observed extended back door formula yields treatment effect estimated complete data counts jj probability ideally estimated account relevant restrictions induced model empirical relative frequencies directly 
leave reader consider estimation treatment effects different observational schemes 
causal inference graphical models displays situation variable instrumental variable instrument assessing effect notion important econometrics rubin 
instrumental variable affects treatment uncorrelated unobserved factors 
instrumental variable derive bounds treatment effects shall show section 
show inequality provides example restrictions conditional independence constraints imply marginal distributions 
precisely holds discrete treatment variable independence assumptions associated diagram hold sup xr sup dx generic symbol appropriate conditional density 
instrumental inequality apparently derived pearl give quite simple proof 
conditional independence restrictions imply xu dx denotes marginal distribution remaining entities appropriate densities 
treatment variable discrete hold supremum sup get sup xu dx xu dx xr sup dx xr xu dx dx xu xr dx dx follows 
structural equation models importance inequality assumption instrument falsifiable observations 
note discreteness variable critical point proof 
time writing known assumption instrument falsifiable general case 
words arbitrary joint distribution variables exist random variable distribution markov respect graph marginal 
case multivariate gaussian answer question known positive distribution exists instrumentality falsifiable gaussian case 
structural equation models mentioned section assumption intervention formula applies additional model assumption follow basic axioms probability 
different ways justifying assumption context subject matter knowledge play essential role justification process 
particular modelling formulation leading causal markov models documented relevance areas application 
structural equation models bollen invented context genetics wright exploited economics wold social sciences goldberger see example pearl spirtes richardson meek scheines glymour discussion 
main justification motivation studying causal markov models speed carlin speed pearl pearl 
commonly structural equation models assumed linear important exceptions 
consider general structural equation system associated directed acyclic graph precisely consider system equations pa assignments carried sequentially ordering directed acyclic graph times assigned value variables pa assigned value 
variables assumed independent 
literature correlation generally allowed disturbances non recursive systems studied 
systems correspond directed markov models studied 
conditional independence properties cyclic linear structural equation systems causal inference graphical models studied example spirtes richardson spirtes 
koster 
term structural equation system really misplaced structural assignment system appropriate 
controversy literature particular concerning calculation intervention effects due treating assignment systems equation systems solving moving variables right hand side left hand side 
particular matters interventions considered 
important aspect structural equation models specify way intervention carried 
implicit literature example quite explicit wold effect intervention variable label simply corresponding line replaced assignment described intervention 
refer process intervention replacement 
clearly justification reasonable assumption context difficult direct justification causal markov assumption follows stated formally 
theorem determined structural equation system corresponding directed acyclic graph denote distribution 
intervention carried replacement causally markov respect proof vertices ordered vn assignments carried corresponding order 
variables assumed independent clearly 
gamma 
pr pa gives 
pr pa distribution satisfies ordered directed markov property 
theorem yields directed markov intervention structural equation system replacement clear conditional distributions involving interventions preserved 
intervention formula applies 
note functions random uniquely determined distribution known causally markov 
assuming specific structural equation model generally stronger way typically empirically potential responses counterfactuals testable just assuming causal markov property captured 
authors prefer structural equation model justification causal markov property property primitive assumption stand usual scientific testing 
view may reasonable specific subject matter knowledge naturally leads equations 
potential responses counterfactuals mentioned causal markov model dag represented structural equation system done different ways 
type representation deserves particular attention 
observe equations values matter prescribe values fixed value possible parent configurations pa consequence introduce maps pa pair determines map pa pa conversely set maps define pa pa denoting random map omega define structural equation system pa omega system said canonical form 
random variables omega pa describes potential response value observed parent configuration equal pa sense sets random variables omega pa pa pa counterfactual 
variables omega called mapping variables heckerman shachter 
approach causal inference example neyman rubin holland plays fundamental role methods developed robins usually introduced slightly different context 
counterfactual objects times basis causal reasoning lewis 
note formulation variables omega counterfactual random variable causal inference graphical models considered deterministic function 
random element 
proved useful contexts lead paradoxes consequences taken far 
dawid argues strongly counterfactual random variables individual impossible observe variables omega pa counterfactual variables complementary 
dangerous assumptions concerning joint distribution omega pa pa pa distributions purely metaphysical 
interesting results concerning causal inference derived counterfactuals pitfalls associated avoided 
partial compliance revisited section show counterfactual variables get bounds treatment effects case partial compliance corresponding situation displayed 
mentioned bound derived random variables yield simple method deriving bounds example 
notation earlier interested intervention probabilities jj xu dx joint observations possible 
assuming infinite sample observe combinations xu dx back door front door criterions apply treatment effect appears identifiable possible derive bounds intervention probabilities subject constraints 
simplicity assume observed values binary values 
case total independent constraints group treatment assignment 
bounds probabilities involved derived ways 
example bounds derived instrumental variables apply observed frequencies instrument 
part assumptions checked observed data 
bounds treatment effects derived robins 
easy check bounds derived sharp balke pearl derive sharper bounds show bounds improved 
argument counterfactual variables shall sketch argument 
potential responses counterfactuals may illuminating phrase arguments terms example considered rubin balke pearl 
example considered study effects child mortality sumatra described sommer west sommer zeger 
part argument value nature matters way affects responses done rubin loss generality assume unobserved variable pair potential responses 
denotes treatment taken individual assigned treatment indicates response individual treatment potential response variables varies space elements unobserved variable total possible values 
values variable may called taker taker taker denotes taken similarly values may called cured cured beneficial terms rewrite equations jj difference conditional probabilities known equal zero 
problem finding bounds solved linear programming methods identify best possible bounds 
ij ij jj bounds gamma gamma gamma gamma gamma gamma remaining bounds obtained suitable index substitution 
bounds turn quite wide example mentioned analysis inconclusive case 
rubin full bayesian analysis model imposing prior assumptions distribution potential responses obtains causal inference graphical models effect beneficial average 
prior assumptions may questionable 
see chickering pearl discussion example 
demonstrated balke pearl bounds tight sharp available 
holds example data concerning coronary heart disease analysed efron feldman 
issues extension chain graphs intervention calculus extended general graphical models directed acyclic graphs 
chain graph models graphs directed undirected links cycles traversed direction going arrows 
chain components graphs undirected graphs obtained removing directed arrows chain graph 
naturally unify directed acyclic graphs undirected graphs undirected graphs chain graphs chain component directed acyclic graphs chain graphs chain components singletons 
corresponding set markov properties associated chain graphs lauritzen 
terms factorization chain graph markov property manifests outer factorization gamma pa delta factor factorizes graph gamma pa delta gamma gamma pa delta oe complete sets gamma pa delta oe graph obtained pa dropping directions edges adding edges pair members pa 
intervention ff ff corresponding intervention formula argued jj ff ff ff ff ff pa ff fi fi fi fi fi ff ff ff chain component including ff 
formula specializes fully directed case undirected case 
issues intervention formula corresponds analogy decision networks chain graphs discussed cowell 

lauritzen richardson investigating dynamic regimes lead intervention calculus potential alternative interpretation simultaneous equation systems 
causal discovery controversial aspect causal inference graphical models associated identifying causal relationships data 
appearance glymour scheines spirtes kelly version corresponding program tetrad subject quite heated discussions freedman humphreys freedman robins wasserman glymour spirtes richardson humphreys freedman 
basically different types approach 
constraintbased approach spirtes generally conceived take place ideal environment joint distribution system random variables known completely error causal graph generated distribution unknown 
apart assumption causal directed acyclic graph exists assumed faithful words conditional independence relationships variables follow directed markov property previously mentioned results meek indicate distributions faithful 
assumption spirtes 
provide algorithms relatively modest number tests identifies causal graph markov equivalence produce graph property disjoint subsets give variants algorithms assume entire system variables observed 
results supplemented conditions identifiability causal effects give methods identifying causal effects remain invariant equivalence class 
richardson spirtes extend approach situations involving feedback 
little done explore statistical properties similar methods applied cases knowledge distribution obtained finite samples 
spirtes 
contains small simulation study area deserves better explored 
causal inference graphical models line research pure bayesian approach learning structure bayesian network initiated cooper herskovits heckerman geiger chickering 
approach pursued heckerman meek cooper 
see cooper overview current state art area 
necessary background material acquired author fellow center advanced study behavioral sciences stanford california financial support partly provided national science foundation number sbr 
completed author fellow fields institute research mathematical sciences toronto canada 
am grateful institutions excellent working conditions provide 
research supported danish research councils programme 
am indebted thomas richardson providing detailed constructive critical comments earlier versions manuscript 
rubin identification causal effects instrumental variables discussion journal american statistical association 
balke pearl nonparametric bounds causal effects partial compliance data de mantaras poole eds proceedings th conference uncertainty artificial intelligence morgan kaufmann publishers san francisco california pp 

balke pearl bounds treatment effects studies imperfect compliance journal american statistical association 
bollen structural equations latent variables john wiley sons new york 
instrumental variables cambridge university press cambridge uk 
box abuse regression technometrics 
chickering pearl clinician tool analyzing glymour cooper eds computation causation discovery mit press cambridge ma pp 

cooper overview representation discovery causal relationships bayesian networks glymour cooper eds computation causation discovery mit press cambridge ma pp 

cooper herskovits bayesian method induction probabilistic networks data machine learning 
cowell dawid lauritzen spiegelhalter probabilistic networks expert systems springer verlag new york 
cox design experiments regression journal royal statistical society series 
dawid causal inference counterfactuals journal american statistical association appear 
efron feldman compliance explanatory variable clinical trials journal american statistical association 
freedman association causation regression turner eds causality crisis university notre dame press pp 

chain graph markov property scandinavian journal statistics 
marginalization graphical interaction models annals statistics 
geiger pearl logic causal models shachter levitt kanal lemmer eds uncertainty artificial intelligence iv north holland amsterdam pp 

glymour cooper computation causation discovery mit press cambridge ma 
glymour scheines spirtes kelly discovering causal structure academic press new york 
glymour spirtes richardson possibility inferring causation association background knowledge glymour cooper eds computation causation discovery mit press cambridge ma pp 

goldberger structural equation models social sciences econometrica 
non linear methods econometrics north holland amsterdam netherlands 
statistical implications system simultaneous equations econometrica 
hammersley clifford markov fields finite graphs lattices unpublished manuscript 
heckerman shachter decision theoretic foundations causal reasoning journal artificial intelligence research 
heckerman geiger chickering learning bayesian networks combination knowledge statistical data machine learning 
heckerman meek cooper bayesian approach causal discovery glymour cooper eds computation causation discovery mit press cambridge ma pp 

holland statistics causal inference journal american statistical association 
howard matheson influence diagrams howard matheson eds readings principles applications decision analysis strategic decisions group menlo park ca 
humphreys freedman grand leap british journal philosophy science 
humphreys freedman algorithms discover causal structure synthese 
press 
rubin bayesian inference causal effects randomized experiments annals statistics 
jensen lauritzen olesen bayesian updating causal probabilistic networks local computation computational statistics quarterly 
speed structural analysis multivariate data review ed sociological methodology bass san francisco 
speed carlin recursive causal models journal australian mathematical society series 
koster markov properties non recursive causal models annals statistics 
koster linear structural equations graphical models lecture notes 
fields institute toronto canada 
koster validity markov interpretation path diagrams gaussian structural equation systems correlated errors scandinavian journal statistics 
lauritzen graphical models clarendon press oxford united kingdom 
lauritzen richardson chain graph models intervention manuscript preparation 
lauritzen spiegelhalter local computations probabilities graphical structures application expert systems discussion journal royal statistical society series 
lauritzen dawid larsen independence properties directed markov fields networks 
lewis counterfactuals harvard university press cambridge ma 
nonparametric bounds treatment effects american economic review papers proceedings 
meek strong completeness faithfulness bayesian networks proceedings eleventh annual conference uncertainty artificial intelligence uai morgan kaufmann publishers san francisco ca pp 

neyman application probability theory agricultural experiments 
essay principles polish 
english translation section speed statistical science 
oliver smith influence diagrams belief nets decision analysis john wiley sons chichester united kingdom 
pearl constraint propagation approach probabilistic reasoning kanal lemmer eds uncertainty artificial intelligence north holland amsterdam netherlands pp 

pearl fusion propagation structuring belief networks artificial intelligence 
pearl probabilistic inference intelligent systems morgan kaufmann publishers san mateo ca 
pearl graphical models causality intervention statistical science 
comment spiegelhalter 

pearl causal diagrams empirical research biometrika 
pearl causal inference indirect experiments artificial intelligence medicine 
pearl graphs causality structural equation models sociological methods research 
pearl causality models reasoning inference cambridge university press cambridge uk 
pearl paz graph logic reasoning relevancy relations boulay hogg steel eds advances artificial intelligence ii north holland amsterdam pp 

richardson spirtes automated discovery linear feedback models glymour cooper eds computation causation discovery mit press cambridge ma pp 

richardson models feedback interpretation discovery phd thesis carnegie mellon university 
robins new approach causal inference mortality studies sustained exposure periods application control healthy worker survivor effect mathematical modelling 
robins analysis randomized non randomized aids treatment trials new approach causal inference longitudinal studies freeman eds health service research methodology focus aids public health service washington dc pp 

robins causal inference complex longitudinal data ed latent variable modelling applications causality vol 
lecture notes statistics springer verlag new york pp 

robins wasserman impossibility inferring causation association background knowledge glymour cooper eds computation causation discovery mit press cambridge ma pp 

rubin estimating causal effects treatments randomized non randomized studies journal educational psychology 
rubin bayesian inference causal effects 
role randomization annals statistics 
shachter evaluating influence diagrams operations research 
shafer conditional probability international statistical review 
shafer art causal conjecture mit press cambridge massachusetts 
shenoy shafer axioms probability belief function propagation shachter levitt kanal lemmer eds uncertainty artificial intelligence north holland amsterdam netherlands pp 

smith influence diagrams bayesian decision analysis european journal operational research 
sommer zeger estimating efficacy clinical trials statistics medicine 
sommer west impact childhood mortality randomized controlled community trial lancet pp 

speed note nearest neighbour gibbs markov probabilities series 
spiegelhalter dawid lauritzen cowell bayesian analysis expert systems discussion statistical science 
spirtes directed cyclic graphical representations feedback models besnard hanks eds proceedings eleventh annual conference uncertainty artificial intelligence uai morgan kaufmann publishers san francisco ca pp 

spirtes glymour scheines causality prediction search springer verlag new york 
spirtes richardson meek scheines glymour path diagrams structural modelling tool sociological methods research 
wold recursive versus nonrecursive systems attempt synthesis econometrica 
verma pearl causal networks semantics expressiveness shachter levitt kanal lemmer eds uncertainty artificial intelligence north holland amsterdam netherlands pp 

wold causality econometrics econometrica 
wright correlation causation journal agricultural research 
wright theory path coefficients reply criticism genetics 
wright method path coefficients annals mathematical statistics 
