shape shading linear approximation ping sing tsai shah department computer science university central florida orlando fl extremely simple algorithm shape shading implemented lines code algorithm fast seconds sun sparcstation theta image purely local highly parallelizable parallel implementation included 
approach employ linear approximation reflectance function 
major difference discrete approximations surface normal finite differences linearize reflectance function depth algorithm tested synthetic real images lambertian specular surfaces results obtained 
research reported supported florida hitech council national science foundation number cda 
code images obtained anonymous ftp cs ucf edu directory pub shading 
contents shape shading lambertian surfaces specular surfaces comparison pentland method convergence implementation details experiments results lambertian surfaces result specular surfaces parallel implementation shape shading deals recovery shape single monocular image 
recovered shape terms depth surface normal surface gradient 
main classes algorithms computing shape shaded image global methods local methods 
global methods shape recovered minimizing cost function involving constraints smoothness 
approaches variational calculus technique iteratively compute shape globally consistent 
local methods shape recovered local constraints surface recovered reflectance map 
common assumptions surface shape reflectance surface locally spherical reflectance map linear surface shape 
local methods general simple provide approximate shape 
global methods hand complex provide close accurate shape 
representative method global approaches horn 
algorithm simultaneously computes depth surface gradient 
combines constraints brightness constraint integrability constraint gradient smoothness constraint 
local shape shading algorithms pentland lee rosenfeld 
shape shading algorithms assumed reflectance map form known 
images surfaces real world approximated lambertian reflectance majority shape shading methods lambertian reflectance model 
important parameters lambertian reflectance albedo illuminant directions 
commonly albedo assumed constant 
methods computing light source direction originated pentland 
methods assume surface locally spherical 
chellappa zheng proposed methods computing light source direction local voting method contour method 
methods robust accurate synthetic real images consistent different bands real color images different subimages scene images different resolutions 
authors provide comparison methods pentland lee rosenfeld method 
chellappa zheng proposed global algorithm constrained function optimization 
typical cost function horn involves intensity constraint regularization constraint integrability constraint 
key idea chellappa zheng approach introduce new cost function quadratic regularization term 
require gradients reconstructed image close gradients input image 
chellappa zheng linear approximation reflectance function surface normal taylor series expansion order terms similar pentland 
suggested smoothness term objective function unnecessary images containing singular points maximally bright points 
believes smoothness distort surface reconstruction 
bichsel pentland simple algorithm lines 
algorithm minimum downhill principle guarantees continuous surfaces stable results 
lee kuo proposed algorithm triangular element surface model linear approximation reflectance map 
approximate smooth surface union triangular surface patches expressed linear combination set nodal basis functions 
depth value computed minimizing quadratic cost functional brightness error 
method require integrability constraints assumptions boundary conditions 
pentland proposed local algorithm linearity reflectance map surface gradient greatly simplifies shape shading problem 
pentland extension linear model quadratic surfaces photometric motion extracting shape reflectance 
believe linearity reflectance map depth appropriate cases results better depth map 
new method computing depth single shaded image 
approach employ discrete approximations finite differences linearize reflectance 
method faster operation purely local 
addition gives results spherical surfaces linear methods 
method general applied reflectance function 
instance describe extension method specular surface 
organization rest follows 
section deals main part describe method shape shading 
consider lambertian specular surfaces 
section comparison method pentland method highlight advantages method 
issue convergence solution addressed section 
algorithm extremely simple implement special cases 
discuss cases provide general algorithm section 
method tested extensively large set real synthetic images lambertian specular surfaces 
experiments summarized section 
shape shading lambertian surfaces reflectance function lambertian surfaces modeled follows pp qq cos oe cos sin oe sin sin oe gray level pixel cos sin oe cos oe sin sin oe cos oe tilt illuminant oe slant illuminant 
discrete approximations gamma gamma gamma gamma reflectance equation rewritten gamma gamma gamma gamma gamma gamma gamma fixed point image linear approximation taylor series expansion order terms function equation depth map gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma equation written follow gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma vector form follow gamma gamma 

zn gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma gamma image equations form linear systems delta matrix vectors 
linear system difficult solve directly involve inverse huge matrix solved easily jacobi iterative method 
look carefully inside jacobi iterative method 
initial approximation depth value solved sequentially iteration 
example depth value th iteration solved previous estimates gamma gamma gamma gamma gamma respectively substituted gamma gamma equation third fourth terms right hand side vanish 
equation reduces surprisingly simple form equation gamma gamma gamma dz gamma depth map th iteration solved directly follow gamma gammaf gamma dz gamma df gamma dz gamma gamma pp qq assuming initial estimate pixels depth map iteratively refined equation 
observed application gaussian smoothing final depth map results smoother depth map 
specular surfaces specularity happens incident angle light source equal reflective angle 
formed components specular spike specular lobe 
specular spike zero directions narrow range direction specular reflection 
specular lobe spreads direction specular reflection 
simplest model specular reflection described delta function follows ffi gamma specular brightness strength specular component angle light source direction viewing direction angle surface normal viewing direction 
model assumes highlight caused specular reflection single point 
real life assumption true 
model developed phong 
represents specular component reflection powers cosine angle perfect specular direction viewing direction 
model capable predicting specularities extend single point 
parameters model physical meaning 
refined model torrance sparrow model assumes surface composed small randomly oriented mirror facets 
describes specular brightness product components energy incident light fresnel coefficient facet orientation distribution function geometrical attenuation factor adjusted foreshortening 
basis torrance sparrow model healey binford came simplified model gaussian distribution facet orientation function considering components constants 
described ke gamma ff specular brightness constant ff angle surface normal bisector viewing direction source direction ff cos gamma delta indicates surface roughness bisector light source direction view direction surface normal 
reflectance function specular surface terminology equation modeled follows ke gamma cos gamma deltah discrete surface normal applying technique case lambertian gamma gamma gamma gamma gamma gamma gamma gamma gamma df dz gamma df gamma dz gamma gamma cos gamma deltah cos gamma delta gamma delta gamma ph qh gamma depth information recovered formula function case lambertian 
comparison pentland method method similar pentland linear shape shading method aspects compare methods 
pentland uses linear approximation reflectance map taylor series expansion reflectance function equation order terms gamma gamma lambertian reflectance equation reduces cos oe cos sin oe sin sin oe pentland takes fourier transform sides equation 
term right dc term dropped 
identities 
fz 
gammai 

fz 
gammai 
fz fourier transform get fe fz 
gammai 
cos sin oe fz 
gammai 
sin sin oe fe fourier transform image 
depth map computed rearranging terms equation inverse fourier transform 
major difference pentland method method linearizing reflectance discrete approximations terms linearize reflectance 
way advantages 
feel linearization reflectance better linearization instance produces depth estimate spherical surface compared pentland method 
shows gray level image sphere approximation 
shows image generated linear approximation reflectance map shows histogram difference gray levels shows reconstructed depth method 
second light source direction viewing direction similar images central illumination pointed pentland quadratic terms surface normal dominating reflectance function fourier transforms doubling effect frequency domain 
fourier transform frequency doubling effect method general apply low angle illumination central illumination 
third note fourier components exactly perpendicular illuminant seen image data obtained boundary conditions simply set zero 
method depth obtained intensity domain fourier domain boundary conditions required 
advantage method computationally simple 
operation purely local method highly parallelizable 
pentland method needs compute fourier inverse fourier transform image time consuming 
convergence basically iterative algorithm form raphson method 
known raphson method converges quadratically provided sufficiently accurate initial approximation 
generally speaking nonlinear system vector unknowns solved method nonlinear systems 
plot results sphere image method 
gray level image approximation 
light source direction 
gray level image linearity 
histogram difference 
plot depth map computed algorithm 
method functional iteration procedure evolves selecting generating gamma gamma gamma gamma gamma matrix defined xn xn 
fn fn fn xn called jacobian matrix 
method generally expected give quadratic convergence provided sufficiently accurate starting value known gamma exists 
involves solving linear system 
done jacobi iteration method efficient terms computer storage computational times large system high percentage zero entries 
equation nonlinear equation unknowns 
nonlinear system equations unknown image depth value point 
way solve linear approximation really form method large nonlinear system high percentage zero entries 
mentioned method generally expected converge quadratically provided sufficiently accurate initial approximation 
case prior knowledge input image best initial estimation depth pixel zero order show algorithm converges correct answer evaluate performance need choose error measure test images 
horn discusses number possible error measures 
average magnitude gradient error jp gamma pj jq gamma qj error measure estimated surface normal iterations true surface normal 
true surface normal real images performed convergence tests synthetic images sphere mozart 
error iteration curve sphere image shown 
clearly see average error surface normal decreasing number iterations increase 
number iterations plot error iteration curve sphere image results mozart image shown 
true depth map shown obtained laser range finder university southern california 
gray level image generated true depth map light source shown 
gray level image generated estimated depth map method light source shown 
shows error iteration curve iterations 
implementation details iterative algorithm implemented straightforwardly 
assuming initial estimate pixels need compute function gamma derivative function gamma iteration 
formula equation refine depth map step 
recall derivative function gamma equation guarantees nonzero value step 
depending surface shape object equation zero cause division zero equation 
example surface normal directly facing light source derivative function zero 
order solve problem need number iterations plot results mozart image 
plot actual depth map obtained laser range finder usc 
reconstructed gray level image actual depth map light source 
reconstructed gray level image estimated depth map light source 
error iteration curve 
modification 
rewrite equation follow gamma gammaf gamma needs satisfy constraints 
approximately equal inverse df dz gamma 
second equals zero df dz gamma approaches zero 
third zero approaches true 
define follow df dz gamma gamma expectation operator small non zero 
small value approximately equal mx inverse df dz gamma 
approaches zero zero 
approaches true expected value gamma zero 
zero 
see clearly definition satisfies constraints 
people vision community recognize example kalman filtering applied problems lower level vision 
considered extended kalman filtering general equations state vector measurement vector kalman filter nonlinear 
estimates vectors available linear approximation small neighborhood considered 
precisely done 
kalman filtering terminology known kalman gain standard deviations associated input state variables respectively 
complete code algorithm sample images available anonymous ftp cs ucf edu directory pub shading 
main part program including iterative loop lines 
program runs efficiently computations purely local 
instance takes seconds cpu time iteration sun sparcstation theta image 
experiments results lambertian surfaces applied algorithm real images obtained quite encouraging results 
results shown figures 
figures depth map shown iterations 
experiments direction light source computed lee rosenfeld method results illuminant direction quoted chellappa zheng directly 
results image shown 
image test case papers image compression shape shading 
example nose eyes lips recovered quite reasonably shown plot depth map 
surface area cheeks appear nice smooth 
gray level images generated recovered depth map different light sources shown figures 
results mannequin image shown 
example head surface area cheeks recovered reasonably shown plot depth map 
gray level images generated recovered depth map different light sources shown figures 
results image shown 
line drawing famous underground cartoon character named 
image taken pentland standard camcorder digitized 
recovered surface shown amazingly 
ears nose eyes lips clear 
results appear slightly better results shown pentland image 
parts pentland plot appear flat 
gray level images generated recovered depth map different light sources shown figures appear similar original gray level image shown 
results part image shown 
image automobile part 
recovered depth map clearly shows various surfaces 
round surface center appears higher depth surface areas shown outside center 
results image 
input image 
light source parameters estimated zheng chellappa method slant tilt 
plot depth map computed algorithm 
reconstructed gray level image depth map constant albedo estimated light source direction slant tilt 
reconstructed gray level image depth map constant albedo light source direction slant tilt 
results mannequin image 
input image 
light source parameters estimated lee rosenfeld method slant tilt 
plot depth map computed algorithm 
reconstructed gray level image depth map constant albedo estimated light source direction slant tilt 
reconstructed gray level image depth constant albedo light source direction slant tilt 
results image 
input image 
light source parameters estimated lee rosenfeld method slant gamma tilt 
plot depth map computed algorithm 
reconstructed gray level image depth map constant albedo estimated light source direction slant gamma tilt 
reconstructed gray level image depth map constant albedo light source direction slant tilt 
results part image 
input image 
light source parameters estimated lee rosenfeld method slant tilt 
plot depth map computed algorithm 
reconstructed gray level image depth map constant albedo estimated light source direction slant tilt 
reconstructed gray level image depth map constant albedo light source direction slant tilt 
result specular surfaces results synthetic specular sphere image shown 
input image generated healey binford reflectance model 
reconstructed gray level image generated recovered depth map light source reflectance model shown 
scaled needle map center area image shown 
needle map clearly shows shape sphere 
results cylinder image shown 
input image taken camcorder lab 
exact point light source image wide bright strip thin line 
reconstructed gray level image looks similar original gray level image 
results tomato image shown 
input image obtained carnegie mellon university 
scaled needle map center area image shown 
parallel implementation algorithm purely local suitable parallel implementation 
currently algorithm takes seconds theta image sun sparcstation 
algorithm real time parallel machine 
experimented preliminary versions algorithm bbn gp parallel machine version input image treated common memory shared processors 
second version processor supplied copy input image order reduce memory contention 
version single processor gp took seconds due slow processors bbn machine 
speedup processors achieved 
second version single processor took seconds speedup obtained processors 
shows time processor curve sphere image second version parallel algorithm 
architecture gp mimd machine suitable problem general appropriate problems involving image matrix data structures 
gp row image matrix assigned process results 
results synthetic specular sphere image 
input image 
light source direction 
reconstructed gray level image estimated depth map light source direction 
needle map 
results specular cylinder image 
input image 
light source direction approximate 
reconstructed gray level image estimated depth map light source direction 

results specular tomato image 
input image obtained cmu 
light source direction 
needle map center area 
number processors version time processor curve sphere image memory contention 
note due local nature algorithm simd machine suitable parallel implementation 
maspar simd parallel machine features facilitate parallelization algorithms solving problem 
maspar machine pe array theta 
second processor distributed local memory 
third processor easily communicate neighbors 
image naturally mapped pe array processor performs instructions simultaneously pixels 
implementation shape shading algorithm maspar 
expect achieve speedup close theta image processors 
recovery surface shape single shaded image important problem computer vision 
simple fast algorithm computing depth map single monocular image 
approach uses linear approximation reflectance employ discrete approximation compute taylor series reflectance order term 
results simple iterative scheme computing depth map intensity image light source direction known 
algorithm works quite easy implement 
results real scenes demonstrate method 
authors thankful professor carnegie mellon university providing tomato image dr stein university southern california providing mozart image 
bichsel pentland 
simple algorithm shape shading 
ieee conference computer vision pattern recognition pp 
june 
healey binford 
local shape specularity 
computer vision graphics image processing 
horn 
height gradient shading 
international journal computer vision 
lee rosenfeld 
improved methods estimating shape shading light source coordinate system 
ai 
lee 
kuo 
shape shading linear triangular element surface model 
tech 
rep usc 
appear ieee transactions pattern analysis machine intelligence 

shape shading constrained problem 
computer vision graphics image processing image vol 
pages september 
pentland 
finding illuminant direction 
journal optical society america 
pentland 
shape information shading theory human perception 
second international conference computer vision tampa fl december pages washington dc 
computer society press 
pentland 
photometric motion 
proc 
international conference computer vision pages december 
phong 
illumination computer generated pictures 
comm 
acm 
torrance sparrow 
theory specular reflection surfaces 
optical society america 
zheng 
estimation illuminant direction albedo shape shading 
ieee transactions pattern analysis machine intelligence vol 
pages july 
