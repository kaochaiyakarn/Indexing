ieee transactions medical imaging vol 
april multimodality image registration maximization mutual information frederik maes andr collignon dirk guy marchal paul suetens member ieee new approach problem multimodality medical image registration proposed basic concept information theory mutual information mi relative entropy new matching criterion 
method applies mi measure statistical dependence information redundancy image intensities corresponding voxels images assumed maximal images geometrically aligned 
maximization mi general powerful criterion assumptions regarding nature dependence limiting constraints imposed image content modalities involved 
accuracy mi criterion validated rigid body registration computed tomography ct magnetic resonance photon emission tomography pet images comparison registration solution robustness evaluated respect implementation issues interpolation optimization image content including partial overlap image degradation 
results demonstrate accuracy respect solution achieved completely automatically prior segmentation feature extraction preprocessing steps method suited clinical applications 
index terms matching criterion multimodality images mutual information registration 
geometric alignment registration multimodality images fundamental task numerous applications dimensional medical image processing 
medical diagnosis instance benefits complementarity information images different modalities 
radiotherapy planning dose calculation computed tomography ct data tumor outlining better performed corresponding magnetic resonance scan 
brain function analysis images provide anatomical information functional information may manuscript received february revised july 
supported part ibm belgium academic joint study belgian national fund scientific research 
associate editor responsible coordinating review recommending publication ayache 
asterisk indicates corresponding author 
maes laboratory medical imaging research katholieke universiteit leuven esat leuven belgium 
belgian national fund scientific research mail frederik maes uz kuleuven ac 
marchal suetens laboratory medical imaging research katholieke universiteit leuven esat leuven belgium 
publisher item identifier 
ieee obtained positron emission tomography pet images bulk registration algorithms medical imaging see overview classified frame point landmark surface voxel 
frame registration accurate inconvenient applied retrospectively external point landmark method anatomical point landmark methods usually accuracy depends accurate indication corresponding landmarks modalities 
surface registration requires delineation corresponding surfaces images separately 
surface segmentation algorithms generally highly data application dependent surfaces easily identified functional modalities pet 
voxel registration methods optimize functional measuring similarity geometrically corresponding voxel pairs feature 
main advantage methods feature calculation straightforward absent grey values accuracy methods limited segmentation errors surface methods 
registration multiple methods proposed optimize global measure absolute difference image intensities corresponding voxels overlapping parts region interest roi 
criteria rely assumption intensities images linearly correlated generally satisfied case registration 
crosscorrelation feature images derived original image data applied ct matching geometrical features edges ridges especially designed intensity transformations 
feature extraction may introduce new geometrical errors requires extra calculation time 
furthermore correlation sparse features edges ridges may peaked optimum registration solution time insensitive misregistration larger distances voxels correlate equally 
multiresolution optimization strategy required necessarily disadvantage computationally attractive 
approach woods hill misregistration measured dispersion dimensional histogram image intensities corresponding voxel pairs assumed minimal registered position 
dispersion measures ieee transactions medical imaging vol 
april propose largely heuristic 
hill criterion requires segmentation images delineation specific histogram regions method woods criterion additional assumptions concerning relationship grey values different modalities reduces applicability specific multimodality combinations pet 
propose general notion mutual information mi relative entropy describe dispersive behavior histogram 
mi basic concept information theory measuring statistical dependence random variables amount information variable contains 
mi registration criterion states mi image intensity values corresponding voxel pairs maximal images geometrically aligned 
assumptions regarding nature relation image intensities modalities criterion general powerful applied automatically prior segmentation large variety applications 
expands ideas collignon 
related area includes viola wells 
theoretical concept mi section ii implementation registration algorithm described section iii 
sections iv vi evaluate accuracy robustness mi matching criterion rigid body ct pet registration 
section vii summarizes current findings section viii gives directions 
discuss relationship mi registration criterion multimodality criteria 
ii 
theory random variables marginal probability distributions joint probability distribution statistically independent maximally dependent related mapping mi measures degree dependence measuring distance joint distribution distribution associated case complete independence means kullback leibler measure mi related entropy equations entropy respectively joint entropy table properties mutual information conditional entropy respectively entropy known measure amount uncertainty random variable amount uncertainty left knowing reduction uncertainty random variable knowledge random variable equivalently amount information contains properties mi summarized table see proof 
considering image intensity values pair corresponding voxels images registered random variables respectively estimations joint marginal distributions obtained simple normalization joint marginal histograms overlapping parts images 
intensities related geometric transformation defined registration parameter mi registration criterion states images geometrically aligned transformation maximal 
illustrated fig 
ct image brain showing histogram image intensity values registered position 
high intensity values histogram ct image originating bone skull mapped low intensity values histogram image images properly aligned resulting peak histogram 
uncertainty voxel intensity largely reduced corresponding ct voxel known high intensity 
correspondence lost case misregistration 
mi criterion limiting assumptions regarding relation image intensities corresponding voxels different modalities highly data dependent constraints imposed image content modalities involved 
maes multimodality image registration maximization mutual information fig 

joint histogram overlapping volume ct brain images dataset tables ii iii initial position yw registered position yw 
misregistration mm see parameters table iii 
marginal distributions considered independent registration parameters mi criterion reduces minimizing joint entropy 
independent case images completely contained mi criterion reduces minimizing conditional entropy images partially overlap optimization volume overlap change varied generally depend mi criterion takes account explicitly clear interpreted follows maximizing mi tend find possible complexity separate datasets maximizing terms time explain minimizing term useful registration criterion behaved respect optimization vary smoothly function misregistration requires change smoothly varied case image intensity values spatially correlated 
illustrated graphs fig 
showing behavior function misregistration image rotated image center 
trace left obtained original image shows single sharp optimum broad attraction basin 
trace right obtained image having reduced spatial correlation image intensity repeatedly swapping pairs randomly selected pixels 
curve shows local maxima attraction basin global maximum smaller deteriorates optimization robustness 
formulation mi criterion suggests spatial dependence image intensity values taken account dependence fact essential criterion behaved registration solution 
iii 
algorithm transformation images associated image coordinate frame origin positioned corner image fig 

spatial correlation image intensity values increases mi registration robustness 
top original image image shuffled swapping randomly selected pixel pairs 
images image content 
bottom mi registration traces obtained partial volume distribution pv interpolation plane rotation image 
local maxima marked 
axis row direction axis column direction axis plane direction 
images selected floating image samples taken transformed image set grid points sub superset thereof 
subsampling floating image increase speed performance aims increasing accuracy 
value registration parameter values retained falls inside volume restricted transformation rigid body transformations clear mi criterion applied general transformations 
rigid body transformation superposition rotation translation registration parameter component vector consisting rotation angles measured degrees translation distances measured millimeters 
transformation image coordinates image image diagonal matrixes representing voxel sizes images respectively millimeters image coordinates centers images rotation matrix matrixes representing rotations axis respectively translation vector 
ieee transactions medical imaging vol 
april fig 

graphical illustration nn tri pv interpolation 
nn tri interpolation find image intensity value position update corresponding joint histogram entry pv interpolation distributes contribution sample multiple histogram entries defined nn intensities weights tri interpolation 
criterion denote image intensity floating image position intensity transformed position image joint image intensity histogram overlapping volume images position computed binning image intensity pairs order efficiently floating image intensities linearly rescaled range respectively total number bins joint histogram 
typically general coincide grid point interpolation image needed obtain image intensity value nearest neighbor nn interpolation generally insufficient guarantee accuracy insensitive translations voxel 
interpolation methods trilinear tri interpolation may introduce new intensity values originally image leading unpredictable changes marginal distribution image small variations avoid problem propose trilinear partial volume distribution pv interpolation update joint histogram voxel pair interpolating new intensity values contribution image intensity sample joint histogram distributed intensity values nn grid weights tri interpolation fig 

entry joint histogram sum smoothly varying fractions histogram changes smoothly varied 
estimations marginal joint image intensity distributions obtained normalization mi registration criterion evaluated optimal registration parameter arg search images initially positioned centers coincide corresponding scan axes images aligned orientation 
powell multidimensional direction set method maximize brent dimensional optimization algorithm line minimizations 
direction matrix initialized unit vectors parameter directions 
appropriate choice order parameters optimized needs specified may influence optimization robustness 
instance matching images brain horizontal translation rotation vertical axis constrained shape head rotation left right horizontal axis 
aligning images horizontal plane optimizing plane parameters may facilitate optimization plane parameters optimization proceeds powell algorithm may introduce optimization directions change order considered 
complexity algorithm implemented ibm rs workstation aix mhz specfp source code available request 
computation time required evaluation mi criterion varies linearly number samples taken floating image 
tri pv interpolation nearly complexity samples nn interpolation times efficient samples 
number criterion evaluations performed optimization typically varies depending initial position images order parameters optimized convergence parameters specified brent powell algorithm 
maes multimodality image registration maximization mutual information table ii datasets experiments discussed sections vi iv 
experiments performance mi registration criterion evaluated rigid body registration ct pet images brain patient 
rigid body assumption satisfied inside skull scans head patient related changes due instance operations neglected provided scanner calibration problems problems geometric distortions minimized careful calibration scan parameter selection respectively 
registration accuracy evaluated section comparison external marker registration results retrospective registration methods robustness method evaluated section vi respect implementation issues sampling interpolation optimization image content including image degradations noise intensity inhomogeneities distortion partial image overlap 
different datasets experiments described table ii 
dataset contains high resolution ct images dataset obtained smoothing subsampling images dataset simulate lower resolution data 
dataset contains acquired ct pet images edited remove markers 
dataset contains image illustrate effect various image degradations registration criterion 
images consist axial slices cases axis directed horizontally right left axis directed horizontally front back axis directed vertically image resolution lowest direction 
experiments joint histogram size fractional precision convergence parameters brent powell optimization algorithm set respectively 
accuracy images datasets registered mi registration criterion different choices floating image different interpolation schemes 
case optimization strategy starting parameters initially equal zero optimizing parameters order 
results summarized table iii parameters transformation data provided van den 
data provided fitzpatrick 
fig 

bounding box central eighth floating image defines points near brain surface difference different registration transforms evaluated 
takes image image 
optimization required evaluations mi criterion performed ibm rs workstation pv interpolation min ct matching dataset min ct matching min pet matching dataset images dataset registered van den correlation registration method 
visual inspection showed result accurate skin marker registration validate registration accuracy mi criterion datasets dataset compare results registration solution provided fitzpatrick 
difference mi registration solutions evaluated points near brain surface fig 

solutions mean maximal absolute transformed coordinate differences measured points included table iii 
solutions obtained dataset dataset different interpolation schemes different choice floating image similar 
dataset largest differences solutions occur rotation axis 
dataset differences somewhat larger especially direction due offset translation parameter mm 
translational differences may caused interpolation subsampling artifacts introduced creating images dataset dataset ct registration tri interpolation converge solution 
case ct registration performs clearly worse ct registration differences largest mm direction solution obtained pv interpolation due offset rotation parameter 
pet pet registration pv interpolation yields smallest differences solution especially direction respect pet image case pet registration 
relatively large differences occur direction due offsets translation parameter mm 
vi 
robustness interpolation optimization robustness mi registration criterion respect interpolation optimization evaluated dataset images registered ct ieee transactions medical imaging vol 
april table iii mi registration parameters datasets mean maximal absolute difference evaluated points near brain surface volume floating image different interpolation methods 
combination various optimization strategies tried changing order parameters optimized starting initial position parameters set zero 
results summarized fig 

scatter plots compare solutions represented registration parameters mi registration measure maximal denoted interpolation methods separately ct image floating image 
different solutions classified norm registration parameter difference vector horizontal axis mm degrees translation rotation parameters respectively difference value mi criterion mi mi vertical axis 
differences small interpolation methods ct registration somewhat robust ct registration 
importantly solutions obtained pv interpolation clustered obtained nn tri interpolation indicating pv interpolation results smoother behavior registration criterion 
apparent traces registration space computed optimal solution nn tri pv interpolation fig 

traces look similar large parameter range considered neighborhood registration solution traces obtained nn tri interpolation noisy show local maxima traces obtained pv interpolation quadratic optimum 
mi values obtained tri interpolation larger obtained nn pv interpolation interpreted tri averaging noise reduction image intensities resulted larger reduction complexity joint histogram corresponding reduction complexity image histogram 
subsampling computational complexity mi criterion proportional number samples taken floating image compute joint histogram 
subsampling floating image applied increase speed performance long deteriorate optimization behavior 
investigated dataset registration subsampled image original ct image pv interpolation 
subsampling performed samples regular grid sample intervals voxels direction respectively nn interpolation 
averaging smoothing image subsampling applied 
optimization strategy case 
registration solutions obtained subsampling compared solution subsampling applied fig 

subsampling factors direction maes multimodality image registration maximization mutual information fig 

evaluation mi registration robustness dataset horizontal axis norm difference vector different optimization strategies nn tri pv interpolation 
corresponds registration solution best value registration criterion interpolation schemes applied 
vertical axis difference registration criterion solution optimal 
ct image floating image 
image floating image 
fig 

mi traces optimal registration position dataset rotation axis range bottom row nn tri pv interpolation 
direction optimization converged min solution mm solution subsampling 
partial overlap clinically acquired images typically partially overlap ct scanning confined specific region minimize radiation dose protocols frequently image larger volumes 
influence partial overlap registration robustness evaluated dataset ct registration pv interpolation 
images initially aligned experiment section optimization strategy applied part ct data considered computing mi criterion 
specifically slice slabs selected bottom skull basis middle top part dataset 
results summarized table iv compared solution full dataset mean ieee transactions medical imaging vol 
april table iv influence partial overlap registration robustness ct registration dataset fig 

effect subsampling floating image dataset registration solution 
horizontal axis subsampling factor indicating voxels considered evaluating mi criterion 
vertical axis norm difference vector 
corresponds registration solution obtained subsampling applied 
maximal absolute difference evaluated full image points section largest parameter differences occur rotation axis translation direction resulting maximal coordinate differences ct voxel direction average differences respect ct voxel sizes 
image degradation various image degradation effects noise intensity inhomogeneity geometric distortion alter intensity distribution image may affect mi registration criterion 
evaluated image dataset comparing mi registration traces obtained original image similar traces obtained original image degraded version fig 

traces computed translation direction shown fig 

noise original data ranges mean 
white zero mean gaussian noise variance superimposed original image 
fig 
shows increasing noise level decreases mi images affect mi criterion position maximal mi traces computed registration parameters changed amount noise increased 
intensity inhomogeneity simulate effect intensity inhomogeneities registration criterion original image intensity altered slice slice planar quadratic inhomogeneity factor fig 

slice original image dataset zero mean noise added variance grey value units quadratic inhomogeneity geometric distortion 
image coordinates point inhomogeneity centered scale factor 
fig 
shows mi traces different values traces parameters reach maximum position mi criterion affected presence inhomogeneity 
geometric distortion geometric distortions applied original image slice slice planar quadratic model magnetic field inhomogeneity image coordinates center image plane scale parameter 
fig 
shows traces registration criterion various amounts distortion expected distortion shifts optimum translation parameter proportional average distortion shift occurred traces obtained registration parameters 
maes multimodality image registration maximization mutual information fig 

mi traces pv interpolation translation direction original image dataset degraded version range mm original noise intensity inhomogeneity geometric distortion 
vii 
discussion mi registration criterion assumes statistical dependence corresponding voxel intensities maximal images geometrically aligned 
assumptions regarding nature dependence mi criterion highly data independent allows robust completely automatic registration multimodality images various applications minimal tuning prior segmentation preprocessing steps 
results section demonstrate registration differences respect registration solution obtained ct pet matching prior knowledge grey value content images correspondence 
additional experiments datasets similar dataset retrospective registration evaluation project fitzpatrick verified results 
section vi demonstrated robustness method respect partial overlap shown section vi large image degradations noise intensity inhomogeneities significant influence mi registration criterion 
estimations image intensity distributions obtained simple normalization joint histogram 
experiments discussed joint histogram computed entire overlapping part images original image data fixed number bins 
evaluated influence bin size choice roi application nonlinear image intensity transformations behavior mi registration criterion 
schemes estimate image intensity distributions instance parzen windowing set samples taken overlapping part images 
approach viola stochastic sampling floating image increase speed performance 
pv interpolation introduced joint marginal distributions mi vary smoothly small changes registration parameters 
results section vi indicate pv interpolation improves optimization robustness compared nn tri interpolation 
experiments needed compare approach parzen windowing method viola multiresolution cubic resampling approach 
optimization mi registration criterion performed powell method 
noticed images initial order parameters optimized strongly influences optimization robustness 
generally obtained best results optimizing plane parameters optimizing plane parameters low resolution images optimization converge global optimum different parameter order specified due occurrence local optima especially rotation ieee transactions medical imaging vol 
april translation parameters 
experiments discussed amount misregistration recovered large mm extensively investigated robustness method respect initial positioning images instance multiple randomised starting estimates 
choice floating image may influence behavior registration criterion 
experiment section vi ct matching robust ct matching 
clear caused sampling interpolation issues fact image complex ct image spatial correlation image intensity values higher ct image image 
tuned design search strategy specific applications 
instance number criterion evaluations required may decreased limited image resolution account determining convergence 
results section vi demonstrate high resolution images subsampling floating image applied deteriorating optimization robustness 
important speed ups realized multiresolution optimization strategy starting coarsely sampled image efficiency increasing resolution optimization proceeds accuracy 
furthermore smooth behavior mi criterion especially pv interpolation may exploited gradient optimization methods explicit formulas derivatives mi function respect registration parameters obtained 
experiments discussed registration ct pet images brain patient 
clear mi criterion equally applied applications general geometric transformations 
method successfully patient patient matching brain images correlation functional data registration ct images hardware phantom geometrical description assess accuracy spiral ct imaging 
mi measures statistical dependence comparing complexity joint distribution marginals 
marginal distributions taken account explicitly important difference measures proposed hill third order moment joint histogram collignon entropy joint histogram focus joint histogram 
discuss relationship criteria measure woods variance intensity ratios mi criterion 
mi family measures statistical dependence information redundancy see appendix 
experimented shown metric entropy correlation coefficient 
cases measures performed better original mi criterion establish clear preference 
furthermore mi multimodality image registration restricted original image intensities derived features edges ridges 
selection appropriate features area research 
viii 
mi registration criterion allows accurate highly robust completely automatic registration multimodality medical images 
method largely data independent requires user interaction preprocessing method suited clinical practice 
research needed better understand influence implementation issues sampling interpolation registration criterion 
furthermore performance registration method clinical data improved tuning optimization method specific applications alternative search strategies including multiresolution gradient methods investigated 
registration criteria derived alternative information measures applied different features 
appendix show relationship multimodality registration criterion devised hill joint entropy hill th order moment scatter plot measure dispersion histogram entries common volume overlap 
approximating joint probability distribution get turns related joint nyi entropy order properties 
shannon entropy 
normalized second third order moment criteria defined hill equivalent generalized version joint entropy appendix show multimodality registration criterion devised woods relates conditional entropy denote set possible intensities images 
denote intensities common voxel position voxel maes multimodality image registration maximization mutual information value image value voxel corresponding image mean standard deviation set registration criterion woods minimize defined follows marginal distribution function image intensities shown mean standard deviation equality conditional distribution image intensities normal distribution jensen inequality concave functions get mean intensity image constant assumed normally distributed minimization amounts optimizing conditional entropy approach woods assumption approximately accomplished editing away parts dataset skin additional modes occur hill proposed take specifically selected regions joint histogram account 
mi appendix example general measures dependence set joint probability distributions set joint probability distributions assuming independent 
information derived concept divergence defined suitable definitions examples divergence divergence divergence corresponding informations information information note information measure counterpart th order moment hill furthermore definition mi 
astola entropy correlation coefficient measure statistical dependence categorized data proc 
univ discussion papers finland 
baddeley error metric binary images proc 
ieee workshop robust computer vision bonn pp 

brown survey image registration techniques acm computing surveys vol 
pp 
dec 

chen statistical pattern recognition 
park spartan hayden 
chiang sullivan coincident bit counting new criterion image registration ieee trans 
med 
imag vol 
pp 
mar 
collignon suetens marchal multimodality medical image registration feature space clustering proc 
st int 
conf 
computer vision virtual reality robotics medicine lecture notes computer science ayache ed 
new york springer verlag apr pp 

collignon maes suetens marchal automated multimodality medical image registration information theory proc 
th int 
conf 
information processing medical imaging computational imaging vision barillot di paola eds 
boston kluwer june pp 

cover thomas elements information theory 
new york wiley 
duda hart pattern classification scene analysis 
new york wiley 
fitzpatrick evaluation retrospective image registration vanderbilt univ nashville tn national institutes health project number ns 
ieee transactions medical imaging vol 
april chiron registration multimodality medical images region overlap criterion cvgip graphical models image processing vol 
pp 
sept 
hill hawkes harrison strategy automated multimodality image registration incorporating anatomical knowledge characteristics proc 
th int 
conf 
information processing medical imaging lecture notes computer science barrett eds 
new york springer verlag june pp 

hill hawkes voxel similarity measures automated image registration proc 
visualization biomedical computing spie vol 
pp 

maes collignon marchal suetens multi modality image registration maximization mutual information proc 
ieee workshop mathematical methods biomedical image analysis june pp 

maintz van den viergever comparison feature matching ct brain images proc 
st int 
conf 
computer vision virtual reality robotics medicine lecture notes computer science ayache ed 
new york springer verlag apr pp 

maurer fitzpatrick review medical image registration interactive image guided neurosurgery ed 
park ridge il amer 
association neurological surgeons pp 

marchal suetens problem geometric distortion magnetic resonance images neurosurgery magn 
reson 
imag vol 
pp 

press flannery teukolsky vetterling numerical recipes nd ed 
cambridge cambridge univ press ch 
pp 

radcliffe shalev fast robust absolute grey level image alignment algorithm med 
phys vol 
pp 
june 
hill hawkes multiresolution voxel similarity measures pet registration proc 
th int 
conf 
information processing medical imaging computational imaging vision barillot di paola eds 
boston kluwer june pp 

hill hawkes automated registration truncated ct images head proc 
british machine vision conf pp 

theory statistical inference information 
dordrecht netherlands kluwer 
van den 
pol viergever medical image matching review classification ieee eng 
med 
biol pp 
mar 
van den maintz 
pol viergever automatic registration ct brain images correlation geometrical features ieee trans 
med 
imag vol 
june 
van den 
pol adler grey value correlation techniques automatic matching ct brain spine images proc 
visualization biomedical computing oct vol 
pp 

new class similarity measures robust image registration comput 
vision graphics image processing vol 
pp 
nov 
viola wells iii alignment maximization mutual information proc 
th int 
conf 
computer vision june pp 

wells iii viola nakajima kikinis multi modal volume registration maximization mutual information med 
image anal vol 
pp 
mar 
west fitzpatrick wang maurer jr kessler comparison evaluation retrospective image registration techniques proc 
image processing feb vol 
pp 

woods mazziotta cherry mri pet registration automated algorithm comput 
assist 
vol 
pp 
july aug 
