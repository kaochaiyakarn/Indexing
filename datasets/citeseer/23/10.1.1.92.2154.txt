grabcut interactive foreground extraction iterated graph cuts carsten vladimir kolmogorov microsoft research cambridge uk andrew blake examples grabcut user drags rectangle loosely object 
object extracted automatically 
problem efficient interactive foreground background segmentation images great practical importance image editing 
classical image segmentation tools texture colour information magic wand edge contrast information intelligent scissors 
approach optimization graph cut developed successfully combines types information 
extend graph cut approach respects 
developed powerful iterative version optimisation 
secondly power iterative algorithm simplify substantially user interaction needed quality result 
thirdly robust algorithm border matting developed estimate simultaneously alpha matte object boundary colours foreground pixels 
show moderately difficult examples proposed method outperforms competitive tools 
cr categories computer graphics picture image generation display algorithms computer graphics methodology techniques interaction techniques image processing computer vision segmentation pixel classification partitioning keywords interactive image segmentation graph cuts image editing foreground extraction alpha matting addresses problem efficient interactive extraction foreground object complex environment background trivially subtracted 
resulting foreground object alpha matte reflects proportion foreground background 
aim achieve high performance cost modest interactive effort part user 
high performance task includes accurate segmentation object background subjectively convincing alpha values response blur mixed pixels transparency clean foreground colour mail carrot microsoft com mail microsoft com mail microsoft com free colour bleeding source background 
general degrees interactive effort range editing individual pixels labour intensive extreme merely touching foreground background locations 
previous approaches interactive matting describe briefly compare state art interactive tools segmentation magic wand intelligent scissors graph cut level sets matting bayes matting knockout 
fig 
shows results matting task degree user interaction required achieve results 
magic wand starts user specified point region compute region connected pixels selected pixels fall adjustable tolerance colour statistics specified region 
user interface straightforward finding correct tolerance level cumbersome impossible 
fig 
shows result magic wand adobe photoshop adobe systems 

distribution colour space foreground background pixels considerable overlap satisfactory segmentation achieved 
intelligent scissors live wire magnetic lasso mortensen barrett allows user choose minimum cost contour roughly tracing object boundary mouse 
mouse moves minimum cost path cursor position back seed point shown 
computed path deviates desired additional user specified seed points necessary 
fig 
magnetic lasso photoshop 
main limitation tool apparent highly texture un textured regions alternative minimal paths exist 
user interactions necessary obtain satisfactory result 
snakes active contours related approach automatic refinement lasso kass 
bayes matting models colour distributions probabilistically achieve full alpha chuang ruzon tomasi 
user specifies trimap tb tu tf background foreground regions tb tf marked alpha values computed remaining region tu high quality obtained fig 
tu region large background foreground colour distributions sufficiently separated 
considerable degree user interaction required construct internal external path 
knockout corel proprietary plug photoshop driven user defined trimap bayes matting results similar fig 
quality chuang 
graph cut boykov jolly greig powerful optimisation technique setting similar bayes matting including probabilistic colour models achieve robust segmentation foreground background colour distributions separated 
system explained detail section 
graph cut techniques image synthesis cut corresponds optimal smooth seam images source target image 
level sets caselles standard approach image texture segmentation 
method front propagation solving corresponding partial differential equation energy minimization tool 
advantage energy 
computes local minimum may depend initialization 
cases energy function minimized exactly graph cuts method preferable 
case identified boykov kolmogorov computing geodesics minimal surfaces riemannian space 
proposed system grabcut ideally matting tool able produce continuous alpha values entire inference region tu trimap hard constraint alpha values may 
way problems involving smoke hair trees dealt appropriately automatic way 
experience techniques designed solving general matting problem ruzon tomasi chuang effective sufficient separation foreground background color distributions tend fail 
may general matting problem solvable sense humans find hard perceive full matte 
motivates study somewhat ambitious achievable form problem 
obtain hard segmentation sections iterative graph cut followed border matting section alpha values computed narrow strip hard segmentation boundary 
full transparency border dealt grabcut achieved matting brush chuang experience works areas sufficiently free 
novelty approach lies handling segmentation 
enhancements graph cuts mechanism iterative estimation incomplete labelling allow considerably reduced degree user interaction quality result fig 

allows grabcut put light load user interaction consists simply dragging rectangle desired object 
doing user indicating region background free need mark foreground region 
secondly developed new mechanism alpha computation border matting alpha values regularised reduce visible artefacts 
image segmentation graph cut segmentation approach boykov jolly foundation grabcut built described detail 
image segmentation boykov jolly addresses segmentation monochrome image initial trimap image array zn zn grey values indexed single index segmentation image expressed array opacity values pixel 
generally hard segmentation background foreground 
parameters describe image foreground background grey level distributions consist histograms grey values background foreground 
histograms assembled directly labelled pixels respective trimap regions tb tf 
histograms normalised sum grey level range 
segmentation task infer unknown opacity variables image data model 
segmentation energy minimisation energy function defined minimum correspond segmentation sense guided observed foreground background grey level histograms opacity coherent reflecting tendency solidity objects 
captured gibbs energy form 
data term evaluates fit opacity distribution data histogram model defined zn 
smoothness term written dis exp zm zn denotes indicator function values predicate set pairs neighboring pixels dis euclidean distance neighbouring pixels 
energy encourages coherence regions similar grey level 
practice results obtained defining pixels neighbours adjacent horizontally vertically diagonally way connectivity 
constant smoothness term simply known ising prior encouraging smoothness degree determined constant 
shown boykov jolly far effective set relaxes tendency smoothness regions high contrast 
constant chosen boykov jolly zm zn denotes expectation image sample 
choice ensures exponential term switches appropriately high low contrast 
constant obtained optimizing performance ground truth training set images 
proved versatile setting wide variety images see blake 
energy model fully defined segmentation estimated global minimum argmin 
minimisation done standard minimum cut algorithm boykov jolly kolmogorov zabih 
algorithm forms foundation hard segmentation section outlines developments led new hard segmentation algorithm grabcut monochrome image model replaced colour gaussian mixture model gmm place histograms 
secondly shot minimum cut estimation algorithm replaced powerful iterative procedure alternates estimation parameter learning 
thirdly demands interactive user relaxed allowing incomplete labelling user specifies tb trimap done simply placing rectangle lasso object 
magic wand intelligent scissors bayes matte knockout graph cut grabcut comparison matting segmentation tools 
top row shows user interaction required complete segmentation matting process white brush lasso foreground red brush lasso background yellow crosses boundary 
bottom row illustrates resulting segmentation 
grabcut appears outperform approaches terms simplicity user input quality results 
original images top row displayed reduced intensity facilitate overlay see fig 

original 
note implementation graph cut boykov jolly uses colour mixture models grey value histograms 
grabcut segmentation algorithm section describes novel parts grabcut hard segmentation algorithm iterative estimation incomplete labelling 
colour data modelling image taken consist pixels zn rgb colour space 
impractical construct adequate colour space histograms follow practice soft segmentation ruzon tomasi chuang gmms 
gmm background foreground taken full covariance gaussian mixture components typically 
order deal gmm tractably optimization framework additional vector kn kn introduced kn assigning pixel unique gmm component component background foreground model gibbs energy segmentation depending gmm component variables data term defined account colour gmm models kn zn kn zn log zn kn log kn gaussian probability distribution mixture weighting coefficients constant kn zn log kn kn zn kn kn zn kn 
parameters model soft assignments probabilities component pixel preferable allow expectation maximization dempster involves significant additional computational expense turns negligible practical benefit 
weights means covariances gaussian components background foreground distributions 
smoothness term basically unchanged monochrome case contrast term computed euclidean distance colour space exp zm zn 
segmentation iterative energy minimization new energy minimization scheme grabcut works iteratively place previous shot algorithm boykov jolly 
advantage allowing automatic refinement opacities newly labelled pixels tu region initial trimap refine colour gmm parameters 
main elements grabcut system fig 

step straightforward done simple enumeration kn values pixel step implemented set gaussian parameter estimation procedures follows 
gmm component say foreground model subset pixels zn kn defined 
mean covariance estimated standard fashion sample mean covariance pixel values weights denotes size set step global optimization minimum cut exactly boykov jolly 
structure algorithm guarantees proper convergence properties 
steps iterative minimisation shown minimisation total energy respect sets variables turn 
decreases monotonically illustrated practice fig 

algorithm guaranteed converge local minimum straightforward detect ceases decrease significantly terminate iteration automatically 
practical benefits iterative minimisation 
figs 
illustrate additional power iterative minimisation grab cut reduce considerably amount user interaction needed complete segmentation task relative shot graph cut boykov jolly approach 
apparent ways 
degree user editing required initialisation optimisation reduced 
second initial interaction simpler example allowing incomplete labelling user described 
initialisation user initialises trimap supplying tb 
foreground set tf tu complement background 
initialise tb tu background foreground gmms initialised sets respectively 
iterative minimisation 
assign gmm components pixels tu kn kn zn 
kn 
learn gmm parameters data argmin 
estimate segmentation min cut solve min tu min 

repeat step convergence 

apply border matting section 
user editing edit fix pixels background brush foreground brush update trimap accordingly 
perform step just 
refine operation optional perform entire iterative minimisation algorithm 
iterative image segmentation grabcut energy green red green red convergence iterative minimization data fig 

energy example converges iterations 
gmm rgb colour space side view showing initialization convergence 
mixture components background red foreground blue 
initially gmms overlap considerably better separated convergence foreground background labelling accurate 
user interaction incomplete incomplete 
iterative minimisation algorithm allows increased versatility user interaction 
particular incomplete labelling feasible place full trimap user needs specify say background region tb leaving tf 
hard foreground labelling done 
iterative minimisation fig 
deals incompleteness allowing provisional labels pixels foreground subsequently retracted background labels tb taken firm guaranteed retracted 
course complementary scheme firm labels foreground possibility 
implementation initial tb determined user strip pixels outside marked rectangle marked red fig 

automatic segmentation user interaction automatic segmentation user editing 
initial user interaction segmentation top row user edits fig 
necessary 
marking roughly foreground brush white background brush red sufficient obtain desired result bottom row 
user editing 
initial incomplete user labelling sufficient allow entire segmentation completed automatically means 
user editing needed boykov jolly shown fig 
takes form brushing pixels constraining firm foreground firm background minimisation step 
fig 
applied 
note sufficient brush roughly just part wrongly labeled area 
addition optional refine operation fig 
updates colour models user edits 
propagates effect edit operations frequently beneficial 
note efficiency optimal flow computed graph cut re user edits 
transparency matting tool able produce continuous alpha values describe mechanism hard segmentation described augmented border matting full transparency allowed narrow strip hard segmentation boundary 
sufficient deal problem matting presence blur mixed pixels smooth object boundaries 
technical issues estimating strip generating artefacts recovering foreground colour free colour bleeding background 
border matting border matting begins closed contour obtained fitting polyline segmentation boundary iterative hard segmentation previous section 
new trimap tb tu tf computed tu set pixels ribbon width pixels side 
goal compute map tu order robustly strong model assumed shape profile tu form model mortensen barrett important additions regularisation enhance quality estimated map dynamic programming dp algorithm estimating tu parameterization contour periodic period curve closed 
index assigned pixel tu fig 

profile taken soft fig 
rn rn signed distance pixel contour parameters determine centre width respectively transition border matting 
original image trimap overlaid 
notation contour parameterisation distance map 
contour yellow obtained hard segmentation 
pixel tu assigned values integer contour parameter distance rn pixels shown share value 
soft step function profile centre width 
profile 
assumed pixels index share values parameters parameter values estimated minimizing energy function dp dn tu smoothing regularizer role encourage values vary smoothly increases curve take 
dp computation values discretised levels levels 
general smoothness term require quadratic time number profiles move regularizer allows linear time algorithm distance transforms rucklidge 
contour closed minimization done exactly single pass dp approximate complete passes dp assuming pass gives optimal profile 
data term defined dn logn zn denotes gaussian probability density mean covariance 
mean covariance defined matting ruzon tomasi 
gaussian parameters foreground background estimated sample mean covariance regions ft bt defined ft st tf bt st tb st square region size pixels centred segmentation boundary take 
foreground estimation aim estimate foreground pixel colours colours bleeding background source image 
bleeding occur bayes matting probabilistic algorithm aims strip background component mixed pixels precisely 
residue stripping process show colour bleeding 
avoid stealing pixels foreground tf 
bayes matte algorithm chuang eq 
applied obtain estimate foreground colour fn pixel tu neighbourhood defined pixel colour similar fn stolen form foreground colour fn 
combined results border matting regularised alpha computation foreground pixel stealing illustrated fig 

knockout bayes matte grabcut comparing methods border matting 
border trimap shown fig 
grabcut obtains cleaner matte knockout bayes matte due regularised profile 
results various results shown figs 

images fig 
show cases bounding rectangle sufficient user interaction enable foreground extraction completed automatically grabcut fig 
shows examples increasingly difficult 
failures terms significant amount user interactions occur cases regions low contrast transition foreground background black part butterfly wing fig 
ii true foreground background distributions overlap partially colour space soldier helmet fig 
iii background material inside user rectangle happens adequately represented background region fig 

user interactions third case reduced replacing rectangle lasso fox image fig 
demonstrates border matting method cope moderately difficult alpha 
difficult alpha dog image fig 
matting brush needed 
operating time acceptable interactive user interface target rectangle size pixels butterfly fig 
requires sec initial segmentation sec brush stroke ghz cpu mb ram 
comparison graph cut boykov grabcut experiment amount user interaction segmentation tasks evaluated 
moderately difficult examples flowers fig 
grabcut needed significantly fewer interactions 
methods performed comparably second experiment compare grabcut single outside lasso red line fig 
top graph cut outer inner red white lines fig 
top 
missing foreground training data grabcut performs level accuracy graph cut 
ground truth database images error rates graph cut compared grabcut new algorithm foreground extraction proposed demonstrated obtains foreground alpha quality moderately difficult images modest degree user effort 
system combines hard segmentation iterative graph cut optimisation border matting deal blur mixed pixels object boundaries 
image credits 
images fig 
flower image fig 
corel professional photos copyright microsoft research rights reserved 
image fig 
courtesy matthew brown 
see www research microsoft com vision cambridge segmentation user interaction results grabcut row shows original images superimposed user input red rectangle 
second row displays user interactions red background brush white foreground brush yellow matting brush 
degree user interaction increases left right 
results obtained grabcut visualized third row 
row shows zoomed portions respective result documents recovered alpha smooth free background bleeding 

gratefully acknowledge discussions assistance anandan bishop perez torr brown 
adobe systems 

adobe photoshop user guide 
blake brown perez torr 
interactive image segmentation adaptive model 
proc 
european conf 
computer vision 
boykov jolly 

interactive graph cuts optimal boundary region segmentation objects images 
proc 
ieee int 
conf 
computer vision cd rom 
boykov kolmogorov 
computing geodesics minimal surfaces graph cut 
proc 
ieee int 
conf 
computer vision 
caselles kimmel sapiro 
geodesic active contours 
proc 
ieee int 
conf 
computer vision 
chuang curless salesin szeliski 
bayesian approach digital matting 
proc 
ieee conf 
computer vision pattern recog cd rom 
corel 

knockout user guide 
dempster laird rubin 
maximum likelihood incomplete data em algorithm 
roy 
stat 
soc 

greig 
exact map estimation binary images 
roy 
stat 
soc 

kass witkin terzopoulos 
snakes active contour models 
proc 
ieee int 
conf 
computer vision 
kolmogorov zabih 
energy functions minimized graph cuts 
proc 
eccv 
cd rom 
sch dl essa turk bobick 
textures image video synthesis graph cuts 
proc 
acm siggraph 
mortensen barrett 
intelligent scissors image composition 
proc 
acm siggraph 
mortensen barrett 
intelligent scissors parameter edge model 
proc 
ieee conf 
computer vision pattern recog vol 

rucklidge 
efficient visual recognition hausdorff distance 
lncs 
springer verlag ny 
ruzon tomasi 
alpha estimation natural images 
proc 
ieee conf 
comp 
vision pattern recog 
