ieee transactions medical imaging vol 
xx 
feb surface interpolation radial basis functions medical imaging jonathan carr richard fright member ieee richard beatson radial basis functions practical solution problem interpolating incomplete surfaces derived dimensional medical graphics 
specific application considered design cranial implants repair defects usually holes skull 
radial basis functions impose restrictions geometry interpolation centers suited problems interpolation centers form regular grid 
high computational requirements previously limited problems number interpolation centers small 

developed fast evaluation techniques overcome limitations radial basis interpolation practical approach larger data sets 
radial basis functions fitted skull surface obtained ray ct data ray tracing techniques 
smoothly interpolate surface skull defect regions 
resulting mathematical description skull surface evaluated desired resolution rendered graphics workstation generate instructions operating cnc mill 
keywords surface interpolation radial basis function approximation medical graphics titanium ct imaging 
interpolation role play computer assisted surgical planning reconstruction missing surfaces prediction soft tissue movement 
context repair defects skull cranial implants 
application medical graphics reveal bone surfaces ray ct data 
fitting mathematical function smoothly interpolates holes surface hard plastic mold computer numerically controlled cnc mill 
titanium prosthesis formed pressing flat titanium plate mold high pressure hydraulic press 
desired characteristics interpolant smooth single valued function interpolate irregularly shaped holes tends flat plate far interpolation centers 
organized follows 
section ii backgrounds application 
section iii discusses various approaches interpolation problem 
section iv introduces radial basis functions section illus jonathan carr department electrical electronic engineering university canterbury christchurch new zealand 
richard fright department medical physics christchurch hospital christchurch new zealand 
richard beatson department mathematics statistics university canterbury christchurch new zealand 
application radial basis functions problem interpolating depth maps skull surface 
section vi presents examples fitting surfaces real data section vii considers computational requirements 
discussion follows section viii 
notation denote function continuous derivatives 
notation indicates storage depending context required process bounded multiple 
example solving theta system linear equations special structure 
ii 
procedure repairing defects usually holes skull cranial implants 
difficult form cranial prosthesis intra defect large cm occurs region bones thin surround vital tissue orbit eye 
regions complex shape implant requires formed 
cranial implant requires accurate model defect area ensure fit achieved time surgery need alteration minimized 
standard process design manufacture prefabricated cranial implants treatment facility varying details method case approached individually 
methods involve forming model implant template implant manually fitted 
attempted remove manual aspects case defect unilateral 
reflect sound side anatomy defective side body software model prosthesis intention providing symmetry shape repaired skull 
technique applicable symmetrical region skull exists 
criterion met restoring original skull shape desirable large cavities result brain implant 
furthermore skull naturally symmetric 
problem designing cranial implant viewed surface interpolation problem surface skull described mathematical function 
problem fit function bone surface interpolates user defined defect regions 
aim create step process design cranial implants integrating medical graphics surface interpolation cnc milling 
depth maps skull surface obtained ray ieee transactions medical imaging vol 
xx 
feb ct data ray tracing techniques construct models cranial defects 
ct data set form regular array voxels obtained stacking set equally spaced ct slices taken head 
set uniformly spaced parallel rays cast ct data set user determined direction 
ray propagates data set interpolation strategy employed estimate ct number voxel centers 
threshold corresponding number bone typically chosen criterion terminating ray 
depth ray terminates recorded form depth map surface interest 
accurate determination depth map values important ensure fit final implant 
threshold chosen carefully 
partial artifacts ct data mean ray tracing may produce errors vicinity thin bones 
difficulties associated extracting depth maps discussed 
sections address problem interpolating depth maps 
suffice say defects occur regions skull convex bone thick 
applying global threshold provides sufficient accuracy purposes cases 
resulting depth map model block cnc mill 
model region immediately surrounding defect required model single orientation workpiece 
depth map cranial defect displayed graphics workstation aid shading 
rendered view skull surface allows user graphically identify defect region skull 
rendering techniques medical graphics literature 
surface shading determined gradient surface ray position hypothesized light sources provide realistic visualization surface dimensional display device 
phong shading model single light source render depth maps skull defects 
user identifies defect region graphically aid workstation mouse 
depth maps rendered resolution sufficient operator identify defect regions subsampled purpose fitting surface 
depth map mesh mm squares provides adequate sampling surface skull interpolation cases 
resolution ct slice usually mm spacing slices cranial examinations typically mm 
consequently depth map resamples data higher frequency contain ripple originates interpolation procedure employed ray tracer 
furthermore depth map result unnecessarily large number interpolation nodes greatly increasing storage computational costs solving interpolation equations 
illustrates cranial surface interpolation problem 
example ray traced view surface skull rendered ct data set 
detailed view defect region identified free defect user highlighted 
illustrates lower resolution depth map corresponding detailed view defect partial depth map corresponding highlighted region 
depth map interpolating function fitted 
summary original ray traced depth data lies regular rectangular grid 
user interactively identifies defect region irregular shape corresponding data points discarded 
results final depth data set interpolated form finite grid hole holes 
iii 
surface interpolation depth map regarded single valued function variables ir ir interpolation nodes value function known generally form complete regular grid 
problem approximate smooth function interpolates data provides continuity order avoid creases restored surface 
approach problem fit polynomial data 
invertible system uniquely defines interpolant guaranteed positions interpolation nodes 
polynomial interpolant typically display spurious bumps 
alternative fit piecewise polynomials 
require ir divided suitable patches typically rectangles triangles 
employs different polynomials different patches pieces joined ways provide continuity prescribed low order derivatives 
examples methods tensor product spline interpolants parametric spline interpolants surfaces clough macro elements triangles surfaces types widely cad finite element methods solving partial differential equations 
suited scattered data interpolation problems particularly large data free regions 
radial basis approximation method offers advantages piecewise polynomial interpolants 
geometry known points restricted regular grid need define mesh patches 
resulting system linear equations guaranteed invertible mild conditions 
radial basis functions variational characterizations eminently suited interpolation scattered data large data free regions 
iv 
radial basis function approximation introducing radial basis function approximation generally considering specific case approximating function variables 
consider ir ir real valued function variables approximated ir ir values ff ng fx ng set ieee transactions medical imaging vol 
xx 
feb distinct points ir called nodes interpolation 
consider approximations form pm oe kx gamma ir ir pm low degree polynomial jj delta jj denotes euclidean norm oe fixed function ir ir 
radial basis function linear combination translates single radially symmetric function oe delta plus low degree polynomial 
denote space polynomials degree variables 
coefficients approximation determined requiring satisfy interpolation conditions side conditions examples popular choices oe name corresponding radial function 
oe linear oe log thin plate spline oe gaussian oe positive constants 
typical conditions nodes interpolation conditions uniquely specify radial basis function table case polynomial term absent radial basis function corresponding side conditions 
coplanar context means nodes lie single hyperplane equivalently linear polynomial variables vanishes nodes 
surveys powell light excellent properties radial basis functions 
particularly concerned depth map data consider linear thin plate spline interpolants 
imply coefficients radial basis function polynomial solving linear system ij oe kx gamma 
xn thin plate dimensional spline consider models deflection infinite thin plate 
linear radial basis function interpolate data thin plate spline attractive provides continuity minimizes energy functional ir dxdy interpolants energy functional defined 
sense thin plate spline smoothest interpolator higher order splines achieve continuity higher derivatives 
perrin tri harmonic thin plate spline oe kxk log kxk interpolate continuity distributions potential current scalp density measured surface head 
radial basis interpolation depth maps section discuss application radial basis functions interpolation cranial depth maps 
task calculate interpolant coefficients 
current solution procedure follows 
nodes scaled uniformly shifted new nodes lie unit square 
variational characterization thin plate spline interpolant means preserved transformation 
interpolation problem corresponding transformed data solved double precision diagonal pivoting method symmetric indefinite systems lapack 
implementation invokes iterative refinement improve accuracy initial solution warranted magnitude residual 
experiments infinity norm condition number system typically theta initial relative residual theta gamma initial relative error theta gamma aim obtain relative error true thin plate interpolant gamma adequate accuracy fitted surface readily obtained solving double precision iterative refinement 
natural criterion assessing restored cranial surface closely matches original surface prior defect 
original surface rarely known exist case defect 
simulated performance method seeing restored artificial holes complete 
interpolant fitted incomplete depth map compared original surface 
illustrates test data employed interpolation example artificial hole ieee transactions medical imaging vol 
xx 
feb introduced initially defect free depth map cranial surface 
rendered view ct data set free defect 
enlarged view part artificial hole superimposed 
corresponding depth map 
thin plate spline radial basis interpolant fitted points 
compares fitted surface original data 
complete depth map original data depth map interpolated surface 
figures rendered views respective depth maps 
difference fitted thin plate spline surface original displayed 
scales 
maximum error thin plate spline interpolant mm 
corresponding comparison original surface linear radial basis interpolant 
largest error original mm 
differences interpolants original surface dependent surface data chosen 
example typical smooth low curvature surfaces reconstructed 
magnitude error fitted surfaces similar variational characterization thin plate spline continuity natural choice cranial implant design 
surface evaluation linear system solved evaluated resolution ir shows surface evaluated outside convex hull interpolation nodes 
rendered view taken surface corresponding depth map 
apparent planar component solution described low degree polynomial term 
christchurch hospital cranial implants flat titanium plate pressed mold hydraulic press 
interpolant determines shape mold 
tendency interpolant flat plane outside interpolation nodes ideal characteristic application 
smooth convergence mold surface flat plane reduces likelihood thinning tearing metal periphery drawn mold 
desirable orient mold surface planar component flat respect plane press 
normal planar component fitted surface derived directly coefficients polynomial term gammac gammac rotation angles axes denoted respectively required re orient interpolated depth map normal aligns axis viewing axis tan gamma gammac tan gamma practice plane fitted surface usually close plane press risk tearing titanium plate press membrane 
ray tracing repeated improved viewpoint determined orientation angles 
new surface fitted depth map corresponding improved viewpoint 
vi 
examples examples illustrate application radial basis interpolation real ct data skull defects requiring repair 
example involves repair large cm hole basically convex region skull 
rendered view ct data set consists slices mm spacing pixel size mm 
rendered threshold corresponds number 
detailed view defect support region identified user highlighted 
mesh plot support shown 
mesh resolution approximately mm 
data surface fitted 
rendered view directly thin plate spline surface fitted data 
mesh plot fitted surface viewed direction 
mold produced interpolated surface data shown finished titanium plate 
cnc instructions generated surface data machine mold hard 
finished plate shown model defect area machined hard plastic depth map data shown 
second example involves repair hole close orbital margin regions high curvature arch 
consequently smooth concave mold produced mirror image unaffected side 
rendered view ct data set consists slices mm spacing pixel size mm 
rendered threshold corresponds number 
detailed view defect support region identified user highlighted 
mesh plot support shown 
mesh resolution approximately mm 
rendered view directly thin plate spline surface fitted data 
mesh plot fitted surface viewed direction 
surface continues smoothly outside support defect region essential pressing titanium mold tearing 
ieee transactions medical imaging vol 
xx 
feb vii 
computational considerations radial basis functions previously proposed interpolants data interpolation centers lie regular grid nielson 
nielson notes conventional methods limit application radial basis functions data sets moderate size 
cutting thin plate spline radial basis function warp wire mesh template skull cranial surface data extracted ct mri data 
done manually identifying homologous landmarks data sets 
landmark template dataset forms interpolation node warping vector associated maps pair skull dataset 
radial basis functions interpolate potentials measured surface head produce topographical maps 
number electrodes interpolation nodes application small typically fewer 
generating radial basis interpolant involves solving linear system jc oe typically non zero growing away zero matrices systems display special structures sparsity positive definiteness commonly exploited enable fast solution linear systems 
solution systems direct simple iterative methods requires operations storage 
advantage symmetry system halve usual operations count gaussian elimination symmetric solvers impractical large 
requirements considerable obstacle radial basis functions large 
fortunately known methods allow solution thin plate spline interpolation equations storage log operations see 
furthermore improved methods development powell promise solution log operations 
current calculations involve moderately sized data sets conventional techniques satisfactory solving corresponding linear systems 
node interpolation problem underlying required approximately seconds cpu time solve sun sparc node interpolation problem underlying required approximately seconds cpu time solve machine 
radial basis function fitted data face problem evaluating 
due behavior oe required direct evaluation single extra point proportional number nodes amount computation required direct evaluation fine mesh significant moderate node counts developed fast evaluation methods see beatson beatson light exploit hierarchical data structures series expansions reduce incremental cost evaluation thin plate spline precision ffl log fflj operations 
course setup time spline theta theta evaluation grid evaluation grid direct fast direct fast table ii comparison fast direct evaluation times thin plate spline interpolants 
evaluation depend node count nodal positions values spline coefficients desired accuracy 
table ii shows times seconds evaluation tasks associated figures 
improvement fast evaluation code dramatic 
computations carried double precision sun sparc machine fast evaluator required evaluate fitted surface infinity norm relative error ffl gamma viii 
discussion demonstrated application radial basis functions cranial implant design 
radial basis function approximation suited type problem due constraints placed geometry nodes interpolation 
alternative techniques available data lie complete regular grid 
thin plate spline particularly appropriate choice fits smooth surface data smoothest interpolant sense minimizes energy functional 
property interpolant tends flat plate far interpolation centers ideally suited manufacture titanium prostheses hydraulic press 
accurate depth map values required fitted surface passes specified depths 
ray tracing error example vicinity thin bone strength approach user arbitrarily exclude points depth map regions confidence values 
complex repairs described function consequently manufactured pressing titanium plate mold 
cases resort traditional hand forming techniques multiple part prostheses separate parts formed butt 
defects occur convex regions skull 
development current software provide surgeon interactive facility sculpting surface adjustment depth user specified control points 
example restoring natural shape skull large hole may lead large cavity forming brain prosthesis 
user may want indent initial depth map defect region ieee transactions medical imaging vol 
xx 
feb avoid cavities 
similarly surface data periphery hole may sufficient restore appropriate shape skull 
ultimately correct surface intended surgeon 
thin plate spline interpolant provides appropriate surface cases may require adjustment 
prerequisites new interactive software efficient means updating initial matrix factorization interpolation nodes added deleted fast means recalculating resulting surface 
fortunately algorithms tasks available 
suitable method task matrix updating method things discussed beatson powell 
change interpolation problem equivalent problem symmetric positive definite matrix consider means updating cholesky factorization matrix nodes interpolation change 
current context enable solving system extra nodes interpolation cost extra operations operations required started scratch 
suitable method second task fast evaluation code described section vii 
acknowledgments authors wish michael parker titanium plates dr mcfarlane reviewers helpful comments 
authors wish acknowledge late john hinton pioneered titanium christchurch hospital provided motivation 
supported telecom new zealand form post graduate scholarship jonathan carr lottery health research purchase hardware 
beatson 
fast evaluation radial basis functions computers mathematics applications 
beatson light 
fast evaluation radial basis functions methods dimensional splines 
technical report mathematics department university canterbury christchurch new zealand december 
beatson powell 
iterative method spline interpolation employs approximations lagrange functions 
griffiths watson editors numerical analysis pages 
longman scientific 
cutting bookstein haddad dean kim 
spline approach averaging threedimensional curves surfaces 
wilson wilson editors mathematical methods medical imaging ii spie proceedings volume pages 
foley van dam 
fundamentals interactive computer graphics 
addison wesley publishing 
harder 
interpolation surface splines 
journal aircraft february 
hinton blake 
repairing people titanium reconstructive surgery 
shadows new zealand journal medical radiation technology march 
arie kaufman 
volume visualisation 
ieee computer society press los ca 
lapack 
lapack users guide 
society industrial applied mathematics philadelphia 
levoy 
display surfaces volume data 
ieee computer graphics applications pages may 
levoy 
hybrid ray tracer rendering polygon volume data 
ieee computer graphics applications pages march 
light 
aspects radial basis function approximation 
singh editor approximation theory spline functions applications pages 
kluwer academic publishers 
tan richards moss 
dimensional visualisation data human anatomy diagnosis surgical planning 
journal audiovisual media medicine 
ney 
volumetric rendering principles techniques 
ieee computer graphics applications pages march 
nielson 
scattered data modelling 
ieee computer graphics applications pages january 
perrin bertrand 
scalp current density mapping value estimation potential data 
ieee transactions biomedical engineering bme 
perrin bertrand 
mapping scalp potentials surface spline interpolation 
clinical neurophysiology 
powell 
theory radial basis function approximation 
light editor advances numerical analysis ii wavelets subdivision algorithms radial functions pages 
oxford university press oxford uk 

shape interpolation multidimensional objects 
ieee transactions medical imaging march 

zero ensemble deconvolution eeg spectral topography 
phd thesis department electrical electronic engineering university canterbury christchurch new zealand 
heinz 
investigation medical rendering algorithms 
ieee computer graphics applications pages march 

shell rendering 
ieee computer graphics applications pages november 

van yamada 
cranial implants scan generated casts 
journal july 
ieee transactions medical imaging vol 
xx 
feb spatial polynomial restriction oe dimension degree nodes linear nodes coplanar thin plate nodes colinear gaussian absent multiquadric absent table conditions imposed nodes various radial basis interpolants 
ieee transactions medical imaging vol 
xx 
feb fig 

extraction depth map skull ct data 
rendered view bone surface ct data set detailed view defect user defined region defect free bone highlighted depth map rendered view defect partial depth map corresponding highlighted region 
ieee transactions medical imaging vol 
xx 
feb cm fig 

test data surface interpolation 
original ct data set 
detail test surface artificial defect superimposed 
depth map corresponding 
ieee transactions medical imaging vol 
xx 
feb fig 

comparison interpolated surface original 
depth map original data 
depth map thin plate spline surface 
rendered view original data 
rendered view thin plate spline surface 
ieee transactions medical imaging vol 
xx 
feb fig 

comparison surface variation thin plate spline linear radial bases variation 
difference thin plate spline surface original data 
difference linear surface original data 
ieee transactions medical imaging vol 
xx 
feb fig 

behavior interpolant far data points 
rendered view fitted thin plate surface 
mesh plot thin plate surface 
ieee transactions medical imaging vol 
xx 
feb fig 

depth map coordinate system 
ieee transactions medical imaging vol 
xx 
feb fig 

example fitting surface cranial defect 
rendered view full ct data set 
detail defect region support region surface highlighted 
depth map corresponding 
ieee transactions medical imaging vol 
xx 
feb fig 

rendered view surface fitted depth map 
depth map fitted surface 
ieee transactions medical imaging vol 
xx 
feb fig 

finished plate mold press titanium plate 
mold machined interpolated surface data shown 
finished plate plastic model defect area machined depth map data shown 
ieee transactions medical imaging vol 
xx 
feb fig 

example fitting surface cranial defect 
rendered view full ct data set 
detail defect region support region surface highlighted 
depth map corresponding 
ieee transactions medical imaging vol 
xx 
feb fig 

rendered view fitted surface 
depth map fitted surface 
