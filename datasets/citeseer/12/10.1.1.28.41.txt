real time tracking non rigid objects mean shift comaniciu ramesh peter meer imaging visualization department electrical computer engineering department siemens corporate research rutgers university college road east princeton nj brett road piscataway nj new method real time tracking non rigid objects seen moving camera proposed 
central computational module mean shift iterations finds probable target position current frame 
dissimilarity target model color distribution target candidates expressed metric derived bhattacharyya coefficient 
theoretical analysis approach shows relates bayesian framework providing practical fast efficient solution 
capability tracker handle real time partial occlusions significant clutter target scale variations demonstrated image sequences 
efficient tracking visual features complex environments challenging task vision community 
real time applications surveillance monitoring perceptual user interfaces smart rooms video compression require ability track moving objects 
computational complexity tracker critical applications small percentage system resources allocated tracking rest assigned preprocessing stages high level tasks recognition trajectory interpretation reasoning 
presents new approach real time tracking non rigid objects visual features color texture statistical distributions characterize object interest 
proposed tracking appropriate large variety objects different color texture patterns robust partial occlusions clutter rotation depth changes camera position 
natural application motion analysis mean shift procedure introduced earlier :10.1.1.21.2524
mean shift iterations employed find target candidate similar target model similarity expressed metric bhattacharyya coefficient 
various test sequences showed superior tracking performance obtained low computational complexity 
organized follows 
section presents extends mean shift property 
section introduces metric derived bhattacharyya coefficient 
tracking algorithm developed analyzed section 
experiments comparisons section discussions section 
mean shift analysis define sample mean shift introduce iterative mean shift procedure new theorem showing convergence kernels convex monotonic profiles 
applications mean shift property low level vision filtering segmentation see 
sample mean shift set fx points dimensional space multivariate kernel density estimate kernel window radius bandwidth computed point nh gamma minimization average global error estimate true density yields multivariate epanechnikov kernel ke ae gamma gamma kxk kxk volume unit dimensional sphere 
commonly kernel multivariate normal kn gammad exp gamma kxk introduce profile kernel function kxk 
example epanechnikov profile ke ae gamma gamma normal profile kn gammad exp gamma employing profile notation write density estimate fk nh fl fl fl fl gamma fl fl fl fl denote gammak assuming derivative exists finite set points 
kernel defined cg kxk normalization constant 
estimate density gradient gradient density estimate jr fk nh gamma fl fl fl fl gamma fl fl fl fl nh gamma fl fl fl fl gamma fl fl fl fl nh theta theta fl fl fl fl gamma fl fl fl fl fl fl gammax fl fl fl fl gammax fl fl gamma fl fl gammax fl fl assumed nonzero 
note derivative epanechnikov profile uniform profile derivative normal profile remains normal 
bracket contains sample mean shift vector fl fl gammax fl fl fl fl gammax fl fl gamma density estimate fg nh fl fl fl fl gamma fl fl fl fl computed kernel fg follows fg expression shows sample mean shift vector obtained kernel estimate normalized density gradient obtained kernel general formulation property remarked fukunaga 
sufficient convergence condition mean shift procedure defined recursively computing mean shift vector translating center kernel 
denote phi psi sequence successive locations kernel fl fl fl gammax fl fl fl fl fl fl gammax fl fl fl weighted mean computed kernel center initial kernel 
density estimates computed kernel points fk fk fk densities implicitly defined obtain need prove convergence sequences 
theorem kernel convex monotonic decreasing profile kernel defined sequences convergent 
theorem generalizes convergence shown epanechnikov kernel uniform kernel 
proof appendix 
note theorem valid associate data point positive weight bhattacharyya coefficient metric target localization task finding target location current frame formulated follows 
feature representing color texture target model assumed density function target candidate centered location feature distributed 
problem find discrete location associated density similar target density define similarity measure take account probability classification error statistical hypothesis testing directly related similarity distributions 
larger probability error similar distributions 
contrary hypothesis testing formulate target location estimation problem derivation estimate maximizes bayes error associated model candidate distributions 
moment assume target equal prior probability location neighborhood previously estimated location 
entity closely related bayes error bhattacharyya coefficient general form defined ae ae dz properties bhattacharyya coefficient relation fisher measure information quality sample estimate explicit forms various distributions 
interest expression motivated near optimality relationship bayes error 
denote ff fi sets parameters distributions set prior probabilities 
value smaller set ff set fi proved exists set priors error probability set ff error probability set fi 
addition starting upper lower error bounds derived probability error 
derivation bhattacharyya coefficient sample data involves estimation densities employ histogram formulation 
best nonparametric density estimate histogram satisfies low computational cost imposed real time processing 
estimate discrete density fq bin histogram target model fp estimated location bin histogram target candidate 
sample estimate bhattacharyya coefficient ae ae geometric interpretation cosine angle dimensional unit vectors gamma pm delta gamma delta 
distance distributions defined gamma ae statistical measure suited task target localization 
nearly optimal due link bayes error 
note widely histogram intersection technique theoretical foundation 

imposes metric structure see appendix 
bhattacharyya distance kullback divergence metrics violate distance axioms 

discrete densities invariant scale target quantization effects 
histogram intersection scale variant 

valid arbitrary distributions distance superior fisher linear discriminant yields useful results distributions separated mean difference 
similar measures computer vision 
chernoff bhattacharyya bounds employed determine effectiveness edge detectors 
kullback divergence finding pose object image 
section shows minimize function neighborhood location exploiting mean shift iterations 
distribution object colors considered texture distribution integrated framework 
tracking algorithm assume sequel support modules provide detection localization initial frame objects track targets periodic analysis object account possible updates target models due significant changes color 
color representation target model fx pixel locations target model centered 
define function mg associates pixel location index histogram bin corresponding color pixel 
probability color target model derived employing convex monotonic decreasing kernel profile assigns smaller weight locations farther center target 
weighting increases robustness estimation peripheral pixels reliable affected occlusions clutter background 
radius kernel profile taken equal assuming generic coordinates normalized respectively 
write kx ffi gamma ffi kronecker delta function 
normalization constant derived imposing condition kx summation delta functions equal 
target candidates fx pixel locations target candidate centered current frame 
kernel profile radius probability color target candidate nh fl fl fl fl gamma fl fl fl fl ffi gamma normalization constant 
radius kernel profile determines number pixels scale target candidate 
imposing condition obtain nh gammax note depend pixel locations organized regular lattice lattice nodes 
precalculated kernel different values distance minimization section probable location target current frame obtained minimizing distance equivalent maximizing bhattacharyya coefficient ae 
search new target location current frame starts estimated location target previous frame 
color probabilities fp target candidate location current frame computed 
taylor expansion values bhattacharyya coefficient approximated manipulations ae assumed target candidate fp change drastically initial fp introducing obtain ae nh fl fl fl fl gamma fl fl fl fl 
ffi gamma minimize distance second term equation maximized term independent second term represents density estimate computed kernel profile current frame data weighted 
maximization efficiently achieved mean shift iterations algorithm 
bhattacharyya coefficient ae maximization distribution fq target model estimated location target previous frame 
initialize location target current frame compute distribution fp evaluate ae 
derive weights fw 

mean shift vector derive new location target nh fl fl fl gammax fl fl fl nh fl fl fl gammax fl fl fl update fp evaluate ae 
ae ae 

gamma ffl 
set go step 
proposed optimization employs mean shift vector step increase value approximated bhattacharyya coefficient expressed 
operation necessarily increase value ae test included step needed validate new location target 
practical experiments tracking different objects long periods time showed bhattacharyya coefficient computed location defined equation larger coefficient corresponding performed yielded cases step iterations necessary 
termination threshold ffl step derived constraining vectors representing pixel image coordinates 
tracking consists running frame optimization algorithm described 
target model new location target current frame minimizes distance neighborhood previous location estimate 
scale adaptation scale adaptation scheme exploits property distance invariant changes object scale 
simply modify radius kernel profile certain fraction sigma tracking algorithm converge choose radius yielding largest decrease distance 
iir filter derive new radius current measurements old radius 
experiments proposed method applied task tracking football player marked hand drawn ellipsoidal region image 
sequence frames theta pixels initial normalization constants determined size target model 
epanechnikov profile histogram computation mean shift iterations computed uniform profile 
target histogram derived rgb space theta theta bins 
algorithm runs comfortably fps mhz pc java implementation 
tracking results 
mean shift tracker proved robust partial occlusion clutter distractors frame football sequence tracking player initial window theta pixels 
frames shown 
camera motion 
motion model assumed tracker adapted nonstationary character player movements alternates abruptly slow fast action 
addition intense blurring frames due camera motion influence tracker performance frame 
effect largely perturb contour trackers 
frame index number mean shift iterations function frame index football sequence 
mean number iterations frame 
number mean shift iterations necessary frame scale football sequence shown 
identify central peaks corresponding movement player center image back left side 
largest peak due fast movement left right side 
initial location convergence point values bhattacharyya coefficient corresponding marked region theta pixels frame 
surface asymmetric due player colors similar target 
mean shift iterations necessary algorithm converge initial location circle 
demonstrate efficiency approach presents surface obtained computing bhattacharyya coefficient rectangle marked frame 
target model selected elliptical region frame compared target candidates obtained sweeping elliptical region frame inside rectangle 
tracking approaches regions perform exhaustive search rectangle find maximum algorithm converged iterations shown 
note basin attraction mode covers entire window correct location target reached farther initial points 
optimized computation exhaustive search mode larger arithmetic complexity depending chosen search area 
new method applied track people subway platforms 
camera fixed additional geometric constraints background subtraction exploited improve tracking process 
sequences processed algorithm unchanged 
example shown demonstrating capability tracker adapt scale changes 
sequence frames theta pixels initial normalization constants 
presents frames minute sequence showing tracking person moment enters subway platform till gets train frames 
tracking performance remarkable account low quality processed sequence due compression artifacts 
thorough evaluation tracker subject current 
minimum value distance frame shown 
compression noise determined distance increase perfect match stationary value 
significant deviations value correspond occlusions generated persons rotations depth target 
large distance increase signals complete occlusion target 
discussion exploiting spatial gradient statistical measure new method achieves real time tracking performance effectively rejecting background clutter partial occlusions 
note technique employed derive measurement vector optimal prediction schemes extended kalman filter multiple hypothesis tracking approaches 
return prediction determine priors defining presence target neighborhood assumed equal 
connection scope 
patent application filed covering tracking algorithm kalman extension various applications 
observe idea centroid computation employed 
mean shift tracking human faces projecting subway sequence frames shown left right top 
histogram face model incoming frame 
direct projection model histogram new frame introduce large bias estimated location target resulting measure scale variant 
gradient region tracking formulated minimizing energy deformable region real time claims 
appendix proof theorem finite sequence fk bounded sufficient show fk strictly monotonic increasing fk fk 
assuming loss generality write fk gamma fk nh fl fl fl fl gamma fl fl fl fl gamma fl fl fl fl fl fl subway sequence frames shown left right topdown convexity profile implies gamma gammag inequality gamma gamma obtain fk gamma fk nh fl fl fl fl fl fl theta kx gamma ky gamma nh fl fl fl fl fl fl theta gamma ky nh theta fl fl fl fl fl fl gamma ky fl fl fl fl fl fl frame index detected minimum value distance function frame index minute subway sequence 
peaks graph correspond occlusions rotations depth target 
example peak value corresponds partial occlusion frame shown 
sequence person tracked gets train produces complete occlusion 
employing results fk gamma fk nh ky fl fl fl fl fl fl monotonic decreasing gammak 
sum fl fl fl fl strictly positive assumed nonzero definition mean shift vector 
long right term strictly positive fk gamma fk 
consequently sequence fk convergent 
prove convergence sequence phi psi rewrite assuming 
algebra fk gamma fk nh ky gammay fl fl fl fl gammax fl fl fl fl fk gamma fk converges zero implies ky gamma converges zero phi psi cauchy sequence 
completes proof cauchy sequence convergent euclidean space 
proof distance gamma ae metric proof properties bhattacharyya coefficient 
jensen inequality ae equality iff gamma ae exists discrete distributions positive symmetric equal zero iff triangle inequality proven follows 
consider discrete distributions define associated dimensional points gamma pm delta gamma delta gamma delta unit hypersphere centered origin 
account geometric interpretation bhattacharyya coefficient triangle inequality equivalent gamma cos gamma cos gamma cos fix points angle left side inequality minimized vectors lie plane 
inequality reduced dimensional problem easily demonstrated employing half angle formula trigonometric manipulations 
peter meer supported nsf iri 
bar shalom fortmann tracking data association academic press london 
deriche region tracking image sequences ieee int conf 
comp 
vis cambridge massachusetts 
birchfield elliptical head tracking intensity gradients color histograms ieee conf 
comp 
vis 
pat 
rec santa barbara 
computer vision face tracking component perceptual user interface ieee 
applic 
comp 
vis princeton 
cham rehg multiple hypothesis approach tracking ieee conf 
comp 
vis 
pat 
rec fort collins vol 

comaniciu meer mean shift analysis applications ieee int conf 
comp 
vis kerkyra greece 
comaniciu meer distribution free decomposition multivariate data pattern anal 
applic 
cover thomas elements information theory john wiley sons new york 
cox hingorani efficient implementation reid multiple hypothesis tracking algorithm evaluation purpose visual tracking ieee trans 
pattern analysis machine intell 
cui huang indoor monitoring collaboration peripheral foveal sensor ieee workshop visual surveillance bombay india 
quality training sample estimates bhattacharyya coefficient ieee trans 
pattern analysis machine intell 

eleftheriadis automatic face location detection tracking model assisted coding video teleconference sequences low bit rates signal processing image communication 
medioni finding waldo focus attention local color information ieee trans 
pattern anal 
machine intell 
terzopoulos color tracking heads mobile objects video frame rates ieee conf 
comp 
vis 
pat 
rec puerto rico 
fukunaga statistical pattern recognition second ed academic press boston 
intille davis bobick real time closed world tracking ieee conf 
comp 
vis 
pat 
rec puerto rico 
isard blake condensation conditional density propagation visual tracking intern 
comp 
vis 
isard blake unifying lowlevel high level tracking stochastic framework european conf 
comp 
vision freiburg germany 
kailath divergence bhattacharyya distance measures signal selection ieee trans 
commun 
tech com 
konishi yuille zhu fundamental bounds edge detection information theoretic evaluation different edge cues ieee conf 
comp 
vis 
pat 
rec fort collins 
lipton patil moving target classification tracking real time video ieee workshop applications computer vision princeton 
mckenna raja gong tracking colour objects adaptive mixture models image vision computing 
paragios deriche geodesic active regions motion estimation tracking ieee int conf 
comp 
vis kerkyra greece 
rosales sclaroff trajectory recovery tracking multiple objects trajectory guided recognition actions ieee conf 
comp 
vis 
pat 
rec fort collins vol 

scott multivariate density estimation new york wiley 
swain ballard color indexing intern 
comp 
vis 
viola wells iii alignment maximization mutual information ieee int conf 
comp 
vis cambridge massachusetts 
wren azarbayejani darrell pentland pfinder real time tracking human body ieee trans 
pattern analysis machine intell 
real time tracking non rigid objects mean shift patent pending 
