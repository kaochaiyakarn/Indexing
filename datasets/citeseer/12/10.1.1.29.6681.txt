non rigid image registration parameter free elastic model christoph schnorr karl rohr universitat hamburg fb informatik ab systeme vogt str 
hamburg germany presents new parameter free approach non rigid image registration displacements obtained mapping boundary structures source target image incorporated hard constraints elastic image deformation 
consequence approach contain parameters deformation model elastic constants 
approach guarantees exact correspondence boundary structures elastic transformation provided correct input data available 
describe linear incremental model model allows cope large deformations 
experimental results synthetic real medical images 
image registration aims finding transformation different object representations 
typical application medicine example registration human brain combination data form different sources helps physician better locate identify respectively relevant structures images 
formally mathematical transformation applied puts object representation source image best possible spatial correspondence target image 
important criteria assessing performance registration schemes accuracy robustness time required compute transformation 
non rigid registration approach belongs class physically numerical methods nonrigid transformations modeled deformations physical bodies elastic solids viscous fluids driven applied forces 
word numerical definition group methods order avoid confusion methods thin plate spline models physical motivation 
driving forces physically numerical methods usually derived image data similarity measure transformations computed finite difference finite element discretizations motion equations underlying materials 
propose parameter free registration model non linear equilibrium equations elasticity theory 
carried different linearizations equilibrium equations obtain correspondingly linear incremental model 
models applied image registration tasks 
forces set hard constraints case displacements obtained mapping boundary structures source image target image 
constraints incorporated addition conditions image boundary elastic deformation model 
discrete representations linear incremental model finite element method fem advantageous compared traditionally implemented finite differences allows cope complicated boundary conditions irregularly shaped possibly interactively specified domains 
principal advantages approach compared standard physically numerical registration methods local intensity similarity measure intensity properties reliable features case non rigid multi modality registration 
ii driving forces implicitly approach incorporating prescribed displacements constraints 
consequence remaining parameters deformation model elastic constants drop mathematical formulation registration approach model completely parameter free 
iii exists unique solution mathematical problem associated registration approach guaranteed required deformation obtained certain structures source image exactly matched target image due constraints provided correct input data available 
iv incremental model obviate known limitation models linearized elasticity theory see example arising unrealistic assumption small deformations 
physically numerical approaches known literature 
originally model derived elasticity theory automatically find optimal mapping ct image atlas brain anatomy 
linear model assumed small deformations 
applied forces derived correlating intensity properties local regions source target image 
model improved multi resolution scheme bajcsy kovacic increase speed computations avoid local minima 
probabilistic model fem reported properties similar proposed gee 
potentially large variability anatomical structures human brain possible deformations required map source target image limited locally small deformations 
cope problem approach class physically numerical methods theory fluid mechanics introduced christensen improved bro nielsen increase speed 
common drawback fluid model comparison elastic approaches mentioned local intensity similarity measure derivation forces 
davatzikos proposed linear elastic model boundary mapping local similarity measure 
elastic deformation driven external forces obtained mapping parametric representations outer cortical surface boundary ventricles 
model extended way cope inhomogeneous deformations 
model closely related approach principal differences assumes small deformations ii parameter dependent values elastic constants empirically determined obtain optimal registration results 
parameter free registration model section formally describes elastic registration approach linearizations non linear equilibrium equations linearized elasticity 
variational formulations model equations allow straightforwardly obtain discrete representations shown section 
model equations elastic registration interpreted finding state static equilibrium source image represented elastic body applied external forces 
omega subset continuous boundary gamma 
non linear equilibrium equation homogeneous dirichlet boundary condition written ae omega gamma non linear elasticity operator vector field applied forces denotes unknown displacement field 
obtain linearization corresponds linear model compute derivative non linear elasticity operator origin replace assumption small displacements 
weak variational formulation linearized equilibrium equation find fv omega gamma gammag denotes corresponding sobolev space symmetric bilinear form linear form defined omega ij ij dx omega delta dx omega gamma denotes applied body forces ij ji linearized strain tensor lam elastic constant considered scaling factor forces 
second elastic constant standard formulation set zero eliminate degree freedom model 
consequence objects images laterally shrink stretched 
sense nonrigid registration cf 
driving forces need applied direction object supposed grow 
properties bilinear linear form allow prove existence uniqueness solution see details 
serious limitation linear model assumption small deformations generally true 
cope large deformations introduce second linearization corresponds incremental model obtained successively solving linear problems starting ffiu ffif ffif gamma ffiu gamma formulation known lagrangian incremental method 
variational formulation parameter set zero ffiu ffiu omega ru ffiu dx omega ffif delta dx ru sr ffi iq ffi ip ffi jq ffi iq ffi jp ffi ij kronecker symbol sr denotes components green st strain tensor 
parameter free discrete representation obtain discrete representations linear incremental model galerkin method space admissible functions variational formulation replaced finite dimensional subspace vn oe oe solution vectors fu linear model ffiu incremental model obtained resulting systems linear equations 
explicit external forces elastic transformation computed due inhomogeneous boundary conditions 
consequence remaining elastic parameter dropped right hand side model equations discrete formulations making approach completely parameter free 
incorporation prescribed displacements respectively displacement increments incremental model realized conventional procedure incorporate inhomogeneous boundary conditions fem formulation described example 
procedure modify matrix linear system equations filling rows columns corresponding nodal points displacements prescribed zero setting diagonal elements 
right hand side vector modified system consists sum replaced matrix columns weighted prescribed values displacements 
contains values positions corresponding nodal points prescribed 
important point requires extra discussion 
applying incremental method implemented discrete grid case large deformations deformation gradient may locally approach zero iterations 
consequence matrix discrete incremental formulation badly conditioned updates carried 
bypass problem approximations iteration process 
possible approximation obtained ng det ru fflg words compute update stiffness matrix determinant deformation gradient locally falls threshold value ffl 
case preserve memory limited number preceding deformations 
possibility take approximation 
means carry memory preceding deformations model 
advantage method computationally expensive compared previous 
experimental results section experimental results achieved registration approach 
experiment registered synthetic image part cortical surface real image linear model 
obtained prescribed displacements needed input data model matching boundary cube cortical boundary minimal registration experiment 
top row source target deformed source images 
middle row magnitudes displacement field horizontal slices 
bottom row deformations horizontal slices projected xy plane illustrated grid 
registration example 
top row slices taken patient pre operative source image left 
middle row corresponding structures globally transformed source image target image 
pre post operative tumor outlines kindly provided oa dr med 
clinic aachen university technology rwth 
bottom row registration results 
left image result affine registration 
right image result elastic registration 
comparison linear incremental registration model 
top row left prescribed displacements 
top row right computed deformation linear model 
bottom row computed deformation incremental model memory left memory right 
see incremental model preserves grid topology computing large deformations 
distance algorithm 
size images theta theta voxels 
result experiment top row 
despite complicated shape cortical surface approximation obtained 
middle row magnitudes displacement field shown slices 
bottom row deformations slices represented deformations rectangular regular grid 
experiment registered pre post operative images patient linear model 
images depicted top row 
prior elastic registration data sets globally registered affine transformation 
computation transformation pairs landmarks manually localized 
corresponding structures elastic transformation took outer inner skin contours extracted edge detector 
additionally brain surface contours contours right lateral ventricle contour tumor source image contour resection area target image manually semi automatically snake approach determined 
depicted middle row 
additionally fixed boundary structures source image occipital part midline brain part brain shift area top brain 
input data elastic transformation obtained minimal distance algorithm skin contours snake model structures see details obtaining correspondences snake model 
result elastic registration shown right image bottom row 
see accurate match corresponding anatomical structures achieved elastic registration compared global affine registration left image 
local elastic transformation allowed cope metamorphic processes due tumor resection 
different approach cope deformations due brain shifts component tissue model see 
linear model may cause topology violations deformed image case large deformations 
illustration purposes comparison linear model incremental model memory case large deformation 
value ffl experiment chosen 
see incremental models preserve grid topology contrast linear model 
deformation computed model memory smooth 
choice incremental models dependence concrete application 
described parameter free elastic registration approach images elastically deformed incorporation prescribed displacements obtained mapping boundary structures 
experimental results linear incremental model model generally allows cope large deformations demonstrated synthetic example 
approach contain parameters deformation model input data influence registration result 
accuracy input data plays crucial role success registration approach 
experimental results conclude registration results obtained correct input data available 
complex shapes objects medical images development methods allow precisely determine point mapping boundary structures challenging task 
examples techniques minimal distance algorithm snake model 
practical usage example case irregular contour shapes limited 
development reliable methods objective current research 
important point research efficient numerical implementation approach 
implemented method conjugate gradients preconditioning shows acceptable results matrix completely loaded computer memory deformation image took minutes sgi power challenge possible case due large number variables deformation model 
prior usage approach real medical applications developments explicit parallelization possibly multi grid techniques required 
acknowledgments medical image data kindly provided philips research laboratories hamburg oa dr med 
clinic aachen university technology rwth 
bajcsy kovacic 
multiresolution elastic matching 
computer vision graphics image processing 
besl mckay 
method registration shapes 
ieee transactions pattern analysis machine intelligence 
bookstein 
principal warps thin plate splines decomposition deformations 
ieee transactions pattern analysis machine intelligence 
bro nielsen 
fast fluid registration medical images 
proc 
visualization biomedical computing vbc pages hamburg germany september 
springer verlag 

optimal registration deformed images 
doctoral dissertation university pennsylvania august 
christensen miller 
deformable templates large deformation kinematics 
ieee transactions image processing 
ciarlet 
finite element method elliptic problems 
northholland amsterdam 
ciarlet 
mathematical elasticity 
volume dimensional elasticity 
north holland amsterdam 
davatzikos 
spatial transformation registration brain images elastically deformable models 
computer vision image understanding special issue medical imaging 
davatzikos prince bryan 
image registration boundary mapping 
ieee transactions medical imaging 
edwards hill little hawkes 
deformation image guided interventions component tissue model 
duncan editors proc 
th internat 
conf 
information processing medical imaging ipmi pages vermont usa june 
springer verlag 
gee bajcsy 
finite element approach warping brain images 
proc 
spie image processing volume pages 
kass witkin terzopoulos 
snakes active contour models 
international journal computer vision 

fem navier equation applications medical imaging 
memo fbi hh dept computer science university hamburg november 
schnorr rohr 
step elastic image registration prescribed point displacements 
proc 
th int 
conf 
image analysis processing pages florence italy september 
springer verlag 
rohr kuhn 
point elastic registration medical image data approximating thin plate splines 
proc 
visualization biomedical computing vbc pages hamburg germany september 
springer verlag 
zilles 
new approach fast elastic alignment applications human brains 
proc 
visualization biomedical computing vbc pages hamburg germany september 
springer verlag 
schwarz 
methode der 
teubner stuttgart 

