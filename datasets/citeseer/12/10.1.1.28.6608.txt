coordinating fuel inventory electric power generation uncertainty lilian 
wu discuss problem hedging natural gas electric power markets 
multiple forecasts natural gas prices natural gas demand electricity prices stochastic optimization model advises decision maker buy sell natural gas transform gas electricity 
relatively small models branch bound solves problem optimality 
larger models solved benders decomposition lagrangian relaxation 
apply approach system electric utility succeed solving problems binary variables minutes optimal value 
keywords benders decomposition branch bound lagrangian relaxation spark spread stochastic programming unit commitment 
natural gas electricity markets going consumers longer obligation purchasing energy local utility companies 
consumers option choosing different suppliers selecting type energy contract prefer 
example may choose interruptible electric service exchange cheaper rate may prefer firm contracts guarantee uninterrupted service 
spectrum energy suppliers facing greater uncertainty new market result customers freedom choice 
refer reader depth discussion subject 
due utilities gas suppliers electric power generating companies trying position newly emerging energy market 
utility industry seen acquisitions mergers seeing today 
common strategy natural gas supplier purchase electric generating assets different mathematical sciences department ibm thomas watson research center box yorktown heights new york watson ibm com 
department industrial engineering university michigan ann arbor michigan engin umich edu 
lilian 
wu mathematical sciences department ibm thomas watson research center box yorktown heights new york watson ibm com 
locations 
goal approach hedge natural gas market electric power market 
case summer season natural gas prices low electricity peak 
beneficial natural gas supplier turn supply electricity profit electricity prices 
difference electricity price fuel cost called spark spread essential risk management tool open energy market 
discuss problem hedging gas electricity markets 
model assumes gas prices gas demand electricity prices stochastic 
uncertainty modeled set scenarios represent possible outcomes random parameters model 
describe problem section ii provide mixed integer formulation 
number generating units relatively small resulting model solved branch bound 
larger models tackled decomposing problem suggested section iii 
approach creates optimization problems mixed integer program smaller size original model linear program 
resulting mixed integer program large solved directly lagrangian relaxation decompose smaller programs 
described section iv 
section presents numerical results test problems system utility 
ii 
problem description consider energy marketer purchases natural gas open market sells contracted customers 
marketer firm contract customers meaning day uncertain demand met 
note market may offer fixed demand contracts special case variable demand contracts describe 
due discussion general 
order protect uncertainty demand changing spot market price natural gas marketer uses storage tank hold natural gas needed 
gas stored holding cost linear function amount gas tank incurred 
marketer pay fee sell stored gas back market period price 
option gas generate electricity sell produced electric power open electricity market 
assume information concerning physical properties available generating units disposal 
heat rate curves start requirements minimum times operating ranges units known 
note minimum uptime minimum time constraints complicate decision switching unit link periods planning horizon 
max profit marketer considers planning horizon periods 
period observes spot market price natural gas spot market price electricity gas demand customers decision gas purchase sell open market power generate 
decision attempts maximize revenue current state gas storage status electric generators system 
assume generating units 
status generator time denoted 
due minimum time constraints take values set feasible solutions amount power generated limited operating capacity generator status unit time write constraints form 
energy required run unit time start generation requirements function gamma denote gamma 
simplify notations denote constraints respectively 
furthermore write constraints gamma form 
model uncertainty prices demand set scenarios 
scenario represents forecast occur certain probability 
scenario case vector tuples contains pieces information natural gas price electricity price gas demand 
letter denote scenario denote total number scenarios model 
example binary decisions associated generator scenario referred amount power generated denoted understood collection vectors probability scenario denoted think scenarios associated probabilities discrete approximation joint distributions prices demand 
approximation yields mild assumptions solutions converge solution stochastic model number scenarios increases 
multiple scenarios model uncertainty requires adding new set constraints model 
scenarios indistinguishable time decisions adopted scenarios 
condition known non 
simply requires correspondence scenario tree decision tree 
scenarios indistinguishable information gas prices gas demand electricity prices associated prior 
mathematically indistinguishable enforce assume constraints embedded sets feasible decisions 
refer reader information 
certain amount fuel electric generation marketer goal maximize profit electric production 
fmax cz yg denotes mathematical expectations row vector represents electricity spot market price location generator period scenario hand assume amount power generated time period scenario known gas inventory problem formulated linear program 
define level inventory reservoir time time interval amount fuel bought spot market sold directly denoted positive fuel purchased negative fuel sold 
total amount power generated fuel inventory reservoir time calculated gamma gamma customers demand natural gas 
assume storage cost linear function denote ff period scenario denote spot market price natural gas fi cost associated market interaction period fi cost incurred period ff fi gamma fl fl revenue selling natural gas contracted customers 
note allow price contracted natural gas function time scenario 
rarely case presentation kept general possible 
natural gas problem minimize ff fi gamma fl subject gamma gamma gamma case electric power generation problem non constraints enforced natural gas model may subject constraints 
example storage level exceed maximum capacity reservoir 
cases desirable limit change level consecutive period jv gamma level 
clear adding constraints alter fact underlying model largescale linear program 
simplify presentation sections write linear program form fmin fx ax represents level gas reservoir amounts gas bought sold variables may needed represent activities related natural gas 
entries represent purchasing natural gas row vector contains gas spot market prices 
entries filled appropriately correspondence vector represents contribution electric power generation gas model 
merging natural gas electric generation models goal marketer fx gamma cz ax gamma important clarify model minimizes expected cost probability measure choice probabilities reflects marketer aptitude risk 
instance market provides financial instruments futures options hedging risk risk free probability measure perform optimization 
case re sults model obtained traditional financial methods 
detail see book discrete models article sick real options 
hand marketer speculator perception market plays big role setting values optimization assumes marketer risk averse provides policy maximizes return long run regardless risk exposure different branches scenario tree 
proposed model extended incorporate futures european options considering gas inventory electric power generation 
instruments incorporated riskless probability measure martingale 
objective function unbounded due arbitrage opportunities market 
proposed model fx gamma cz ax gamma mixed integer program 
furthermore continuous relaxation non linear non convex 
section benders decomposition handle effectively 
iii 
benders decomposition assuming amount power needs generated time period scenario known gas inventory problem linear program fmin fx ax 
function convex polyhedron 
result available dual solutions construct lower bound value 
note dual feasible solution gas inventory problem approximated set cuts constraints form psi psi approximate value kth dual solution available 
approximate description passed electric generation model determine optimal generation level 
results electricity model passed gas inventory problem new cut created 
process repeated optimal solution 
approach known benders decomposition 
comprehensive discussion subject 
formal description suggested algorithm 
ffl initialization 
set number cuts zero psi gamma 
ffl general step 

determine values psi solving power generation problem fmin gammae cz psi psi gamma kg 

determine optimal solving gas inventory problem fx ax 
row vector resulting dual multipliers 

psi current solution optimal 
terminate process 

set 
go 
electric power generation program fmin gammae cz psi psi gamma kg similar structure unit commitment problem 
precise resulting optimization problem structure stochastic unit formulation suggested 
solve stochastic unit commitment relax non constraints solve resulting unit commitment models relax demand constraints solve sequence stochastic dynamic program 
refer reader complete discussion subject 
unit commitment formulation deals requirement meeting uncertain electric demand formulation considers complicated constraints cuts result approximating natural gas problem 
underlying solution method remains similar unit commitment relaxing coupling constraints psi gamma generator optimization problem solved dynamic programming 
section describes approach 
iv 
lagrangian relaxation lagrangian relaxation approach solving fmin gammae cz psi psi gamma kg prove 
proposition constraint psi gamma satisfied equality optimal solution fmin gammae cz psi psi gamma kg 
proof note optimal solution fmin gammae cz psi psi gamma kg constraints psi gamma satisfied equality 
value psi decreased losing feasibility contradicts optimality assumption 
psi gamma statement proposition correct 
index psi cut psi redundant optimal corresponding psi iteration gamma 
psi maximum value dual objective function feasible yielding contradiction 
psi equal completes proof 
associate multiplier constraints psi gamma gamma 
relaxing constraints objective function gammae cz psi gamma gamma psi gamma gammae cz gamma gamma gamma psi gammae cz defined gamma gamma lagrangian function written fmin gammap oe gamma constant oe defined value oe average price supplying fuel generator scenario worthwhile mentioning cost negative 
example case holding cost gas high electricity prices low 
utility profit direct generation electricity benefits reducing cost inventory 
value computed stochastic dynamic programming 
approach adopted solving single generator problem stochastic unit commitment 
starting planning horizon backward recursion find optimal strategy generating units 
difference case unit commitment cost function generator concave negative 
cause problem single variable function minimum attained setting variable maximum generating capacity 
order find optimal set multipliers maximize feasible set gamma gamma gamma proposition states 
proposition optimal solution max value gamma gamma non negative 
proof value minimum gammae cz gamma gamma gamma psi 
gamma gamma zero minimum achieved psi goes infinity resulting gamma 
optimal solution max value non negative 
proposition proposition useful eliminate difficulties optimizing reducing number variables restricting search space 
function piecewise linear concave 
find maximum line search approach subgradient information 
subgradient computed gamma 
description suggested algorithm 
ffl initialization 
set gamma 
select upper bound step size 
set number iterations 
ffl general step 

define delta search direction delta ae 

delta terminate 
current solution optimal 

compute minf gamma delta delta gamma 

derivative free line search method determine optimal step size range minf 

update multipliers delta normalize new table exact solutions pure branch bound benders decomposition branch bound direct benders size optimum cpu cpu theta theta theta theta theta theta theta theta theta theta 
set 
permitted number iterations go 
section apply branch bound aforementioned decomposition approach problem maximizing marketer return fx gamma cz ax gamma numerical experience goal numerical tests determine effectiveness benders decomposition lagrangian relaxation solving fx gamma cz ax gamma test problems operations utility 
adopted methods solving underlying model 
direct approach mixed integer model fuel inventory electric generation scheduling solved optimality branchand bound 
branch bound implementation provided osl optimization subroutine library ibm 
second decomposition approach section iii 
fuel inventory fx ax handled dual simplex method routine osl 
scheduling generating units fmin gammae cz psi psi gamma kg performed optimality branch bound routine osl 
cuts added model generated linear programming solver 
third lagrangian relaxation section iv incorporate cuts psi gamma objective function electric scheduling problem 
approach benders decomposition coupled lagrangian relaxation implemented language considerable effort put optimizing code tuning performance 
fuel inventory problem assumed gas bought sold market charge 
period scenario balance con straint requiring inventory level equal storage level minus flow utility system gas delivered customers burnt generate power sold spot plus amount fuel purchased constraint maximum capacity storage tank 
simple set matrix contains zeros ones 
stochastic information gas price electricity price gas demand stored compact form similar storing stochastic linear programs 
distinct information stored reduce computer requirements 
case size problem determined number distinct nodes scenario tree number generating units 
discuss details scheme document 
refer reader comprehensive description data structure 
create scenarios created forecasting model demand model electricity gas prices 
demand forecasts driven weather forecasts maximum minimum temperatures consider demand elasticity effect energy prices consumption 
capture data hand partitioned subsets winter summer transitional 
models considered effect weekdays weekends 
handled analyzing data weekdays weekends separately 
electricity prices correlated weather supply demand electricity power pool 
supply electric power modeled considering available capacity spinning reserves 
generation cost element supply side gas prices went cost generation electric power increased 
demand electric power modeled studying major utilities power pool correlating demand weather parameters 
obtain better forecasts created electricity price models data subset 
model forecast price temperature certain threshold forecast prices temperatures went threshold 
consistent known phenomenon electricity prices spiking sharply certain circumstances 
refer reader article depth description forecasting method 
error forecast estimated jackknife procedure 
procedure th data analyzed construct model subsequently forecast remaining th 
process repeated times partitioning data different sets contained th data computing error remaining th 
error forecasting model calculated errors runs 
interested reader may refer text mosteller tukey discussion jackknife procedure 
expected value demand electricity price gas price associated errors randomly created set sample paths subsequently create scenario trees 
note tradeoff number samples complexity resulting model 
number scenario increases uncertainty captured accurately resulting optimization model harder solve 
problem choosing set scenario reflects uncertainty accurately maintaining size scenario tree minimum difficult 
discuss issue manuscript 
reader may refer detail 
important warn reader forecasting models consider market signals futures options prices 
believe financial instruments refine forecasts 
subject investigating 
table presents results cases able solve optimality 
column contains size problem 
example problem size theta refers model number generating units number distinct nodes scenario tree 
number binary variables model theta 
optimal objective function value listed second column 
note values negative indicating profit purchasing natural gas certain periods selling prices higher generating electricity selling open market 
execution times reported column labeled cpu execution times measured seconds ibm rs running aix mbytes memory mhz processor 
study effectiveness benders decomposition decomposed problem passed cuts fuel inventory program electric generation problem 
electric generation problem solved optimality branch bound 
expected optimal objective values column 
number cuts decreased model larger execution time approach disappointing 
entries containing indicates solve problem time hours reached 
table ii presents results obtained lagrangian relaxation handle power generation problem described section iv 
case approach constructs upper lower bound optimal value objective function 
column labeled upper contains value best feasible solution obtained 
duality gap gp percentage upper bound 
general gap smaller size problem increases 
er display error best feasible solution obtained 
error computed upper bound table ii optimal value table lagrangian relaxation produce results error 
column table ii contains cpu time seconds 
clear method outperforms comes execution time 
furthermore able solve significantly larger models approach table ii approximate solutions benders decomposition combined lagrangian relaxation size upper gp er cpu theta theta theta theta theta theta theta theta theta theta theta theta theta theta reasonable time 
mixed integer program solved optimality case number cuts large 
limited maximum number cuts 
size affect quality solution obtained significantly 
largest model solved binary variables took minutes obtain solution optimal solution 
table iii stochastic versus expected value size delta theta theta theta theta theta evaluate importance stochastic formulation constructed examples 
example solved twice stochastic solution method expectation 
expectations branches scenario tree truncated path expected value random elements 
resulting solution called expected value policy 
expected value policy applied path scenario tree 
cost policy compared stochastic policy 
expected stochastic policy outperformed deterministic 
table iii summarizes results 
column delta provides savings percentage stochastic policy value 
reader may feel savings justify stochastic solution method 
numerical experience indicates stochasticity increases value delta goes importance stochastic models evident 
vi 
discussed stochastic formulation problem controlling fuel inventory environment 
model links gas electricity markets 
stochasticity gas price gas demand electricity price modeled set scenarios 
resulting model mixed integer program solve branch decomposition approach iterates fuel inventory power generation problems 
case large models power generation problem approximated solving lagrangian dual 
solved problems binary variables optimal solution minutes 
shetty 
nonlinear programming theory algorithms 
john wiley sons 
bertsekas 
dynamic programming deterministic stochastic models 
prentice hall 
birge dempster gunn king wallace 
standard input format multiperiod stochastic linear programs 
coal newsletter 
birge 
stochastic programming 
springer verlag 
stack 
spreading news 
energy power risk management may 
cohen 
renaud 
stochastic optimization unit commitment new decomposition framework 
ieee transactions power systems may 

optimal power generation uncertainty stochastic programming 
stochastic programming methods technical applications lecture notes economics mathematical systems springer verlag berlin 
wu 
divide conquer threshold model 
energy power risk management march 
ibm 
optimization subroutine library guide th edition february 
sc 
jameson editor 
power market restructuring risk management 
risk publications 
jameson editor 
managing energy price risk 
risk publications 
jarrow editors 
finance volume handbooks operations research management science 
north holland 
wallace 
stochastic programming 
john wiley sons 
mosteller tukey 
data analysis regression second course statistics 
addison wesley publishing reading massachusetts 
koenig 
application lagrangian relaxation scheduling power generation systems 
operations research may june 
nemhauser rinnooy kan todd editors 
optimization volume handbooks operations research management science 
north holland 

mathematical finance discrete time models 
blackwell publishers 
rockafellar 
wets 
scenarios policy aggregation optimization uncertainty 
mathematics operations research 
birge long 
stochastic model unit commitment problem 
ieee transactions power systems august 

wu 
incorporating fuel constraints electricity spot prices stochastic unit commitment problem 
appear operations research 
technical report rc ibm research division watson research center domino watson ibm com library nsf home 
research staff member department ibm thomas watson research center yorktown heights new york 
holds ph degree operations research master degree civil environmental engineering university michigan 
areas concentration stochastic programming large scale optimization 
interested finance energy markets 
ph candidate department industrial operations engineering university michigan ann arbor 
interested decision theory stochastic processes production inventory systems 
research focuses application game theory open power markets 
lilian 
wu research staff member mathematical sciences department ibm thomas watson research center yorktown heights new york 
holds ph degree applied cornell university 
dr wu expert time series forecasting statistical planning data analysis 
currently member president clinton advisory committee science technology director international institute forecasters 
