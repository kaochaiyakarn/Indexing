classification driven medical image retrieval liu frank dellaert cs cmu edu robotics institute carnegie mellon university forbes ave pittsburgh pa propose novel image retrieval framework centered classification driven search weighted similarity metric image retrieval 
approach firmly rooted bayes decision theory 
defined image set argue image classification image retrieval share fundamentally goal 
distance metric defining classifier performs image set generate results similarity metric image retrieval 
report methodology initial results image retrieval approximate bilateral symmetry normal human brains exploited 
existing content image retrieval systems depend general visual properties color texture classify diverse dimensional images 
general visual cues fail effective discriminators image sets taken single domain images subtle domain specific differences 
furthermore global statistical color texture measures necessarily reflect meaning image 
databases composed volumetric images collateral information particular medical domain provide simple defined training sets meaning image pathological classification indicated image 
welldefined image set mean finite number image classes defined image set pair elements mutually exclusive image class 
system performance evaluation retrieval results readily quantified comparing pathology classes query image retrieved images 
test bed chosen multimedia digital database human neurology national medical practice knowledge bank project 
database containing large set medical cases different sub branches medicine current focus neurology 
case database composed image computed tomography ct magnetic resonance images mri 
approach basic idea defined image set image classification image retrieval share fundamentally goal 
hypothesis distance metric classifier gives classification results expected provide image retrieval results image similarity metric retrieval 
image classification image index feature selection tool find similarity metric image retrieval 
net effect equivalent warping original multidimensional feature space image points corresponding class clustered warped feature space 
obvious image retrieval nearest neighbors feature space achieve results 
basic framework steps classification driven image retrieval propose image retrieval framework consisting stages shown feature extraction pool candidate image indexing features extracted feature selection image classification determine quantitatively classification discriminating subset weighted features predefined image classes image retrieval nearest neighbors selected feature space weighted subset features best performance classification similarity metric image retrieval 
distinguishes existing systems direct evaluation chosen image features performed 
typical content image retrieval system simply extracts certain predetermined image features query image images database finds nearest neighbors query image feature space returns images retrieved result 
difficult feature weighting problem usually left human user decide 
providing insights distributions database image feature space terms image classes user weighting method manageable task user especially user experienced multiple indexing features 

missing common image retrieval practice evaluation extracted image features image retrieval 
critical questions left unanswered features sufficient capture content image 
redundancy features discriminating different images 
subset features discriminating power image semantic classes 
relative weights 
contrast method propose directly answers questions 
summary approach uses memory learning explore discover manipulate image feature space hope finding direct effective economical mapping proper subset non uniformly rescaled image features corresponding image classes 
bayesian classifiers memory learning mbl technique called kernel regression kr applied classify images database 
recall posterior probability cjx image class feature observed computed bayes law cjx xjc xjc xjc prior probability class estimated easily labeled training data dividing number instances class total number instances training set conditional density xjc class estimated parzen window 
changing kernel width oe kr density estimation distance metric feature weighting yields space classifiers 
approach consists line combinatorial search space classifiers find minimizes classification performance measure cross entropy 
cross entropy defined negative log likelihood training data specific classifier measure classifier performs 
minimizing cross entropy yield metric kernel width oe kernel regression best approximates posterior probabilities cjx optimally suited classification 
prevent overfitting training data classifier evaluated leave cross validation training set containing roughly thirds available data database 
rest data set aside evaluation purposes set results reported 
main result search similarity metric weighted set discriminating features classifier 
classification process screens majority features extracted image ends proper subset original feature attributes 
large redundancy exists initial feature set expect feature subsets quantitatively equivalent discriminating power 
case individual feature included subset subset classifier important 
classification evaluation general classification perfect densities classes overlap feature space 
motivates decision theory minimize cost deciding particular class sample 
specifically domain medical image classification retrieval imperative minimize false negative rate fnr minimize occurrence pathological cases classified normal 
motivates cost matrix structure 
false negative penalty incurred pathological image classified normal unit cost zero cost incurred normal image classified pathological class chosen correct class respectively 
classes 
normal 
blood 
stroke typically cost matrix form shown 
classification decision minimizing expected risk associated choosing class 
example risk take choosing class normal image 
expression see higher value higher risk 
increasing false negative decisions effectively punished 
risk matrix 
risk take choosing class normal 
higher value higher risk 
increasing false negative decisions effectively punished 
image retrieval evaluation locally optimal classifier associated distance metric apply metric image retrieval problem 
assume extracted image features form dimensional vector space distance function images defined gamma sigma gamma gamma dimensional image feature vectors images respectively sigma theta covariance matrix 
non uniformly scaled euclidean distance 
sigma diagonal matrix diagonal elements feature weights discovered classifier selection process described 
image retrieval done nearest neighbor knn commonly done image content retrieval 
evaluation retrieved images simply true positive rate precision top retrieved images 
number correct pathology class top retrieved images query image top precision rate defined tpr experiments study performed data set volumetric ct brain scans containing normal stroke blood cases 
clinical ct images collected directly local hospital emergency room 
images bear close resemblance images appearance query images 
medical image usually taken stack parallel images 
working directly images descriptive units database slices 
image easier display physicians primarily images queries access digital databases 
useful identify normal slices pathological brain image 
hard obtain sufficient number images small number images yields large set slices 
fact go step ultimately half slices basic descriptive unit testing approach doubling amount data disposal 
justified assumption normal human brains approximately symmetrical half brain slice potentially equivalent half 
violation symmetry implication pathology 
total image set divided training set containing thirds holdout test set containing third care taken separate test set way mixing images training test set level slices 
test set completely separate set images evaluation purposes 
image preprocessing ideal symmetry axis extracted intersection brain image plane 
method works presence obvious asymmetries example near frontal lobe left image 
orientation imaging coordinate system differs ideal head coordinate system kx rotation angles pitch roll yaw axes kx respectively 
step image preprocessing align images planes different brain images parallel pitch angle zero 
maximization mutual information affine registration algorithm cross correlation registration algorithm minimize rotational errors images 
effect extraction find plane supposed 
especially true pathology brains plane distorted shifted due large lesions 
shows sample results plane extracted intersected slices 
image preprocessing half slices labeled pathology class help 
feature extraction variations lesions left right acute blood acute blood medical image analysis segmentation lesion image necessary step 
known lesion segmentation hard problem particularly image contain multiple lesions lesion takes priori form density value shape geometric anatomic location see 
image retrieval systems depend human experts hand pick lesion initial input 
take completely different approach trying precisely locate lesion collect set relatively simple computationally inexpensive image features assumption normal brain symmetry 
hypothesis appropriately weighted subset simple features collectively may capture statistical appearance model pathology accurately 
selected features subsets effective result classification reflect fact 
expensive means extract relevant features 
extract features quantitatively describe amount type asymmetry image types symmetry descriptive features global statistical properties measures asymmetry half brains local asymmetrical regionbased properties 
addition global features mean image number edge pixels quarter topleft top right bottom left bottom right image 
features extracted original image plane centered vertically middle difference image original image mirror reflection respect thresholded difference image original image masked thresholded binary image 
left original image plane aligned 
middle difference image gamma ref 
right thresholded global statistical properties computed entire half brain include features mean standard deviation grey level intensity 
asymmetry features obtained voxel wise comparison corresponding left right half brains 
techniques obtain features 
simply subtract vertically reflected image left brain corresponding right half obtain difference image 
asymmetries show large positive negative density values difference image 
numeric features computed counts voxels remain thresholding different values 
second technique image smoothed gaussian filter having standard deviation pixels respectively 
equivalent examining images different resolutions 
difference voxel counterpart opposite symmetrical half recorded 
counterpart voxel falls significantly outside estimated image distribution difference greater standard deviations flagged significantly different number voxels pass threshold test counted 
set local region statistics generated masking original image threshold images obtained previous step 
intensity means variances computed asymmetrical areas pertain local areas asymmetries 
feature extraction carried half slices yielding total labeled data points dimensional feature space 
searching space classifiers look distance metric feature space having locally optimal classification performance proprietary combinatorial search engine called implemented cmu moore 
classifier defined distance metric smoothing parameter oe 
look kernel regression classifier minimizes leave training data classifier 
search engine works searching large set possible classifiers user specifications search stops exhausts possible choices time limit user reached 
applies number combinatorial search algorithms similar multiple restart local search ranging hill climbing metric space standard feature selection searches common machine learning literature 
typically run search full hour standard high performance workstations 
output specification best similarity metric far consisting weight input attribute warped scaled euclidean space proper subspace original feature space terms dimensions smoothing parameter oe 
evaluation classification results search engine yields anytime best classifier contains non determinism exact classifier may vary run run 
quantitative measure describing improvement prediction common class classifier 
score indicates discriminating power selected features 
different combinations features yield discriminative power redundancy features 
typical run classifier features original equally weighted distance metric 
list specific features shown slice left right half ih difference image gamma right left half difference image dh 
sequence labeling slices 
mean absolute value direction gradient ih 
ratio non zero pixels remaining thresholded 
white ratio non zero pixels remaining thresholded 
ratio non zero pixels remaining dh thresholded 
smoothing image oe computing new difference image mean non zero pixels remaining dh thresholded oe 
smoothing image oe computing new difference image mean non zero pixels remaining thresholded oe 
canny edge image threshold oe total number white pixels top left quarter 
sum pixel wise multiplication absolute value dh absolute value vertical gradient ih sum absolute values dh displays roc curves true positive rate false positive rate chosen classifier classifying half slices training data separate test set 
seen performance training set better performance unseen test set expected searched maximize 
reporting performance figures training data give optimistic information performance resulting classifiers 
cost matrix summary graphs provide quantitative overview strengths weaknesses particular set selected features 
select appropriate value classifying new unlabeled images 
roc curve classification training images loo hold testing image set 
classification rates increasing value cr classification rate tpr true positive rate fpr false positive rate fnr false negative rate cfr confusion pathologies rate 
possible extensions layered classifiers possible construct layered classifier top image classifiers 
example construct classifier determine pathology class image output classifier input data 
image half slices nn ns nb numbers predicted normal stroke blood classes nn ns nb ratios nb image distribution dimensional feature space observed 
feature spaces image points migrate ratio space increasing false negative penalty value class classifier 
observe separating blood cases normal easy true stroke cases especially false penalty classifiers increased 
demonstrates simple case conceivable complicated distributions apply approach done classifier new feature space find optimal classifier 
tried ratios classifier strength feature full strength feature true positive rate evaluated image test set 
query dependent similarity metric approach ideally suited tuning similarity metric specific type query may submitted system 
example interested finding image shows pathology regard type pathology 
case metric classifies images normal pathological different needs additional distinction stroke blood 
tried locally optimal classifier different metric ternary classification case give quantitatively comparable classification rates 
result indicates features equivalent discriminating power class class problems expect better performance query image belong blood class due clear class separation blood class rest classes feature space 
image retrieval similarity metric image classification serve image index vector retrieving images finding nearest neighbors feature space conventionally done content image retrieval 
dimension index feature vector reduced respect original feature space 
mean value retrieval precision function top retrieved images 
shows mean retrieval precision rate hold test images class case class case described previous section 
different optimal metrics classification similarity metric retrieval 
observe slightly better performance class class image set 
expected class classification leaves space errors class classification problem 
problem difficult class separation normals strokes observed original feature values classifier output 
near precision rate average result implies average top ranked retrieved images pathology query image 
figures show best retrieved results pathology cases 
left query image acute blood 
retrieved half slices follow left right descending order similarity 
pathologies retrieved images acute blood 
left query image stroke 
retrieved half slices follow left right descending order similarity 
pathologies retrieved images normal normal 
preliminary study stages essential components identified constructing classification driven image retrieval system 
stages line similarity metric learning feature selection line image retrieval 
essential components image preprocessing image feature extraction feature selection image classification image retrieval quantitative evaluation 
stages share common components goals constraints differ 
stage goal find best smallest subset image features capture image classes 
requires explicitly labeled image database extensive search large feature attribute matrix 
high computational speed plus necessary 
stage hand demands fast retrieval speed presentation retrieved images addition similarity metric query image 
basic framework individual components classification driven image retrieval application domain coming potential feature set important easily automated step 
candidate features need selected considerable domain knowledge 
advantage classification driven approach classification feature screening tool quantitative measurements classification result effort domain specific features control domain knowledge called reduced 
advantages include capability access unlabeled image databases extra step added classify retrieved un labeled images 
includes study different sets discriminative features different purposes different subsets image database dynamically switching similarity metric retrieval 
expect similarity metrics vary accordingly observed experiments binary ternary classes reported 
combine visual features collateral information age sex symptoms patient obtain better retrieval rate faster retrieval speed 
kind features eigenfeatures added 
basic framework provided information fusion capability 
authors dr sciences general hospital medical guidance prof andrew moore dr jeff schneider cmu helpful discussions 
research partly supported singer research institute prime contract national institute standards technology nist 
atkeson schaal andrew moore 
locally weighted learning 
ai review 
bishop 
neural networks pattern recognition 
clarendon press 
isbn 
duda hart 
pattern classification scene analysis 
john wiley sons new york 
faloutsos barber flickner hafner niblack petkovic equitz 
efficient effective querying image content 
journal intelligent information systems 
liu collins 
automatic bilateral symmetry plane extraction pathological images 
spie international symposium medical imaging february 
liu kanade 
content image retrieval preliminary results 
ieee workshop content image video databases conjunction iccv january 
maes collignon marchal suetens 
registration maximization mutual information 
ieee transactions medical imaging 
moore hill johnson 
empirical investigation brute force choose features smoothers function approximators 
hanson judd petsche editors computational learning theory natural learning systems volume 
mit press 
moore schneider deng 
efficient locally weighted polynomial regression predictions 
proceedings international machine learning conference 
morgan kaufmann 
virage home page 
www virage com 
pentland picard sclaroff 
photobook content manipulation image databases 
ijcv june 
picard 
models video image libraries 
ibm systems journal 
rui huang mehrotra 
relevance feedback techniques interactive content image retrieval 
spie conf 
storage retrieval image video databases vi 
volume january 
schneider moore 
locally weighted learning tutorial 

swain 
interactive indexing image databases 
spie 
