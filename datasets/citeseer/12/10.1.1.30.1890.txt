color coding noga alon yz institute advanced study tel aviv university raphael yuster dept computer science tel aviv university uri zwick dept computer science tel aviv university march revised march describe novel randomized method method color coding finding simple paths cycles specified length small subgraphs graph 
randomized algorithms obtained method derandomized families perfect hash functions 
color coding method obtain particular new results ffl fixed graph contains simple cycle size exactly cycle expected time log worst case time 
exponent matrix multiplication 
follows jv jej confusion may arise 
ffl fixed planar graph contains simple cycle size exactly cycle expected time log worst case time 
algorithm applies fact planar graphs minor closed family graphs family graphs 
ffl graph contains subgraph isomorphic bounded tree width graph eh jv log copy polynomial time 
previously known just path length 
results improve previous results authors 
third result resolves affirmative conjecture papadimitriou yannakakis log path problem show nc 
general subgraph isomorphism problem np complete various special cases known fixed parameter tractable see df definition solved polynomial time 
introduce color coding method 
method able solve subcases subgraph isomorphism problem polynomial time 
obtain efficient solutions subcases polynomial time solutions 
supported part basic research foundation israel academy sciences humanities sloan foundation 
preliminary version appears proceedings th stoc 
institute advanced study school mathematics princeton nj usa 
school mathematical sciences raymond beverly faculty exact sciences tel aviv university tel aviv israel 
mail addresses authors math tau ac il 
color coding method randomized method 
vertices graph subgraph isomorphic eh sought randomly colored jv colors 
jv log small probability polynomially small polynomial vertices subgraph isomorphic subgraph colored distinct colors 
shall see task finding color coded subgraph easier 
randomized algorithms obtained color coding method easily derandomized small loss efficiency 
needed family colorings subset vertices assigned distinct colors colorings 
required words family perfect hash functions 
jv jg 
kg 
simplest interesting subcases subgraph isomorphism problem directed undirected graph number contain simple directed path length 
contain simple directed cycle length exactly 
show color coding simple directed path length directed graph contains path delta expected time delta log delta worst case times 
graph undirected bounds replaced improves 
delta worst case bound bodlaender bod applies undirected graphs 
note particular decide polynomial time directed undirected graph contains simple directed path length theta log 
resolves affirmative conjecture papadimitriou yannakakis py 
exponential dependence bounds probably unavoidable problem np complete part input 
application color coding method show simple directed undirected cycle size exactly directed graph contains cycle deltav deltav expected time deltav log deltav log worst case time 
improves cases delta worst case bound obtained monien mon 
count number cycles length graph worst case time 
uses different techniques appear 
yz shown cycles length undirected graphs contain worst case time 
applied planar graphs non trivial minor closed family graphs color coding method yields optimal expected case optimal worst case algorithms finding simple cycles length 
algorithms fact graphs non trivial minor closed family graphs bounded degeneracy see section definition 
remind reader minor graph graph obtained removing contracting edges 
family graphs minor closed minor member member family non trivial include graphs 
family planar graphs easily seen non trivial minor closed family 
directed undirected planar graph graph non trivial minor closed family contains simple directed cycle size directed cycle expected time log worst case time worst case time 
improves extends log worst case bound obtained richards ric planar separators worst case bound obtained chiba cn 
algorithms finding triangles planar graphs time obtained papadimitriou yannakakis py itai rodeh ir 
initial goal obtain efficient algorithms finding simple paths cycles graphs 
algorithms developed color coding method turned wider range applicability 
linear time delta directed graphs delta undirected graphs bounds quoted simple paths apply fact forest vertices 
delta bound quoted simple cycles applies fact series parallel graph vertices 
generally contains subgraph isomorphic graph eh tree width subgraph delta expected time jv note forests tree width series parallel graphs tree width 
algorithm improves algorithm voigt pv running time delta 
result gives far know general subcase subgraph isomorphism problem known solvable polynomial time 
concept tree width introduced robertson seymour see rs series works graph minors 
robertson seymour concept ingredients non constructive show subgraph homomorphism problem graph graph eh subgraph homomorphic 
minor containment problem graph graph eh minor 
solved time fixed time path see joh survey results 
graph contains simple path length subgraph contains path minor 
gives alternative time algorithm deciding undirected graph contains simple path length obtained algorithm worse dependence furer fr karger kmr give algorithms finding polynomial time simple path length log hamiltonian weakly undirected hamiltonian graphs 
results significantly extend result find polynomial time simple path length log fixed directed undirected graph contains path 
section describe simplified version color coding method called method random orientations basic color coding method described section 
section show algorithms obtained methods 
sophisticated applications color coding method described sections 
random orientations undirected graph 
suppose want find pairs vertices connected simple paths length exactly raising adjacency matrix ag th power methods easily find pairs vertices connected paths length paths simple 
weed non simple paths 
easy way doing choosing random acyclic orientation graph orientation obtained choosing random permutation 
jv jg directing edge 

denote resulting directed graph directed path length simple corresponds simple path length simple path length hand 
chance directed path direction simple observation yields results theorem simple directed undirected path length directed undirected graph contains path 
delta expected time undirected case 
delta expected time directed case 
proof consider undirected case 
algorithm deltae expected time immediate 
simply choose random oriented version find longest directed path 
easily done time see clr 
longest path length probability 
longest path length repeat process 
expected number times process repeated desired path 
reduce deltae complexity desired deltav known easy fact graph vertices edges contains path length known proofs fact easily supply method finding path delta time 
specific way incorporating algorithm follows idea bodlaender bod 
start dfs depth search graph 
vertex depth output path root vertex 
vertex graph contains edges back edges point ancestors may apply algorithm described 
random orientation method easily adapted directed graphs 
turn directed graph acyclic graph choose random permutation 
jv jg delete edge 


delta expected time algorithm described works case 
theorem simple directed undirected cycle length directed undirected graph contains cycle log delta expected time 
proof algorithm similar proof theorem 
choose random oriented version raise adjacency matrix gamma st power log matrix multiplications 
gives pairs vertices connected directed paths length gamma vertices pairs connected edge cycle 
happen probability 
process repeated expected number times 
similar algorithm find directed simple cycles directed graphs 
match performance algorithm described theorem deterministic algorithm combining techniques monien mon bodlaender bod 
obtained algorithm works deltae time directed graphs deltav time undirected graphs 
algorithm color coding method omit description 
note algorithm theorem extremely simple result previously known 
algorithm derandomized section yielding log deterministic version 
methods count number cycles length deterministic time 
appear 

dependence theorems improved section 
random colorings directed undirected graph 
consider problem finding simple directed undirected paths length gamma choose random coloring vertices colors 
path said colorful vertex colored distinct color 
colorful path clearly simple 
simple path length gamma hand chance gammak colorful 
note exponentially small time needed find colorful path length gamma exists pairs vertices connected colorful paths length gamma 
lemmas give answers questions 
lemma directed undirected graph 
kg coloring vertices colors 
colorful path length gamma exists delta worst case time 
proof describe delta time algorithm receives input graph coloring 
kg vertex finds colorful path length gamma starts exists 
find colorful path length gamma starts just add new vertex color new color connect edges vertices look colorful path length starts colorful path length gamma starts specified vertex dynamic programming approach 
suppose vertex possible sets colors colorful paths length connect note record colorful paths connecting record color sets appearing paths 
vertex collection gamma delta color sets 
inspect subset belongs collection edge add set fc collection corresponds colorful paths length 
graph contains colorful path length gamma respect coloring final collection corresponding paths length gamma vertex non empty 
number operations performed algorithm outlined gamma delta delta jej clearly delta 
lemma directed undirected graph 
kg coloring vertices colors 
pairs vertices connected colorful paths length gamma delta delta worst case time 
proof delta algorithm obtained simply running algorithm described proof previous lemma jv times starting vertex 
obtain delta algorithm recursive approach 
enumerate partitions color set 
kg subsets size simplify presentation omit floor ceiling signs 
gamma delta partitions 
partition set vertices colored colors set vertices colored colors subgraphs induced respectively 
recursively find pairs vertices connected colorful paths length gamma 
collect information boolean matrices boolean matrix describes adjacency relations vertices boolean product ba gives pairs vertices connected colorful paths length exactly gamma vertices paths colored colors vertices colored colors ing matrices obtained partitions obtain desired result 
easy verify complexity approach delta number matrix multiplication satisfies recurrence 
deltav algorithm outlined finds pairs vertices connected colorful paths length gamma 
find colorful paths algorithm alon naor finding witnesses boolean matrix multiplication 
omit details 
lemmas immediately get results 
theorem simple directed undirected path length gamma directed undirected graph contains path delta expected time undirected case delta expected time directed case 
theorem simple directed undirected cycle size directed undirected graph contains cycle delta delta expected time 
yz authors show simple cycle size undirected graph contains cycle deterministically delta time 
mentioned color coding method efficiently find paths cycles subgraph bounded tree width 
generalization briefly section 
derandomized orientations colorings randomized algorithms previous sections derandomized small loss efficiency 
dependence retained small price extra log factor complexity 
need want give simple path length say gamma graph chance discovered list colorings subset size jv exists coloring list gives vertex distinct color 
need words perfect family hash functions 
jv jg 
kg 
schmidt ss fredman koml os szemer edi give explicit construction perfect family 
ng 
kg function specified log log bits 
size family log value functions specified element 
ng evaluated time 
family algorithms previous sections incurred cost multiplicative factor log log promised 
pointed moni naor size desired family hash functions reduced log way 
construct perfect family maps 
ng 
construct perfect family maps 

kg 
desired family obtained composing families hash functions 
perfect family size 

kg obtained construction schmidt ss 
construct perfect family size log 
ng 
small probability spaces support sequences wise independent random variables 
sequence 
random boolean variables independent positions delta delta delta bits ff 
ff fi fi ff 
ff gamma gamma fi fi fi note particular sequence 
gamma independent subset variables attains possible values positive probability 
constructions small probability spaces admit wise independent random variables obtained naor naor nn alon 
abn 
size sample spaces support random variables independent small log log constructed log log time 
construct perfect family size log 
ng 
probability space size log supports random variables gamma independent log attach random variables element 
ng assigning color 
consider elements probability assigned color gamma probability distinct elements 
ng assigned color strictly obtained family perfect 
algorithms obtained random orientations derandomized 
choosing random permutation 
jv jg choose random coloring 
kg remove edges 
edge directed obtained graph acyclic 
simple path length probability gammak directed path note difference color coding method version random orientations method 
require vertex path colored second forth 
color coding method just require vertices path colored distinct colors order 
list colorings sequence 
vertices colored consecutively 
coloring list easily obtained sequences log delta random variables log wise independent 
size list log list derandomization purposes section 
finding cycles minor closed families graphs undirected graph degenerate see bollob bol exists acyclic orientation smallest degenerate called degeneracy max min degree denoted 
easily seen see bol maximum minimum degrees subgraphs clearly degenerate jej delta jv simple lemma proof omitted part folklore see mb 
lemma connected undirected graph 
acyclic orientation time 
undirected graph 
graph minor obtained removal contraction edges 
family graphs said minor closed minor graph family member family 
known see bol non trivial minor closed family graphs minor closed family family graphs graphs bounded degeneracy 
words exists constant satisfies example consider family planar graphs minor closed degeneracy planar graph planar graph vertex degree 
second result claimed follows theorem derandomized version 
theorem non trivial minor closed family graphs fixed integer 
exists randomized algorithm graph finds simple cycle size exists expected time 
proof graph contains choose random coloring 
kg vertices said colored vertices consecutively colored 
probability gamma colored 
describe randomized algorithm running time delta graph minor closed family degeneracy coloring 
kg probability finding colored exists 
combining algorithm initial random coloring phase obtain deltav time algorithm finds exists probability gamma may small probability depends size graph 
rerunning algorithm independent set choices case failure obtain dk delta expected time algorithm finding graphs contain 
assume edges connect vertices colored consecutive colors modulo 
edges violating property removed remove colored randomized algorithm finding colored starts orienting degree vertex edges leave vertex assigned indices 
arbitrary manner 
takes time 
colored assumed exist contains edge vertex gamma colored gamma vertex colored algorithm guesses flipping fair coins orientation index edge 
possible orientations possible indices 
guess edge directed gamma guessed index edges leave vertices colored gamma index removed graph 
opposite direction guessed done edges leave vertices colored resulting graph denote contains colored probability 
subgraph induced vertices colored gamma forest rooted stars 
contract star single vertex assign new vertex color gamma 
obtain new graph new coloring easy see contains colored gamma contains colored verify recall edge edge connects consecutively colored vertices 
minor minor closed member apply algorithm recursively look colored gamma takes gamma delta time yields colored gamma probability gamma colored gamma colored easily reconstructed 
time spent deltav probability finding colored complete picture specify way recursion bottoms 
contractions various stages algorithm generate self loops immediately removed 
parallel edges may occur contractions applied graph colored colors colored graph obtained 
colored graph just pair parallel edges pair exists easily time 
alternatively recursion existing delta time algorithm see cn finding triangles general graph 
note triangle colored graph colored delta case 
algorithm just described derandomized 
theorem non trivial minor closed family graphs fixed integer 
exists deterministic algorithm decides graph contains finds exists log worst case time 
proof algorithm proof theorem 
random colorings exhaust list log colorings property sequence 
vertices consecutively colored 
coloring list 
list algorithms obtained random orientations method 
guessing direction index edge colored exhaust coloring possible choices 
contains way 
theorems deal undirected graphs 
minor modifications find directed cycles directed graphs undirected versions belong nontrivial minor closed family color coding method obtained result 
theorem directed undirected graph 
directed undirected exists delta worst case time 
corollary get non trivial minor closed family graphs member exists time 
eppstein epp showed planar graph graph vertices copy exists time 
eppstein result applies graphs bounded genus apply method minor closed families graphs 
finding bounded tree width subgraphs slight modification method section find paths find fixed directed undirected forest 
directed forest directed graph undirected version forest 
theorem directed undirected forest vertices 
directed undirected graph 
subgraph isomorphic exists delta expected time directed case delta expected time undirected case 
proof start usual choosing random coloring 
kg graph assumed contain copy probability gammak copy colorful vertex get different color 
assume case 
suppose composed directed trees 

vertices 
directed forest composed 
find color sets appear colorful copies easy find time color sets appear colorful copies 
note copies disjoint color sets necessarily disjoint 
collection corresponding empty contains colorful copy copy color set keep copy corresponding subgraph colored 
directed tree vertices arbitrary vertex delta time find vertex color sets appear colorful copies plays role contains single vertex easily done 
directed edge removal breaks directed subtrees recursively find vertex color sets appear colorful copies plays role color sets appear colorful copies plays role directed edge color set appears collection corresponding color set appears collection corresponding added collection corresponding 
easy see complexity recursive algorithm delta required 
obtain better bound undirected case fact graph delta jv edges contains subgraph forest vertices 
algorithms theorem obviously derandomized techniques described section 
basic ideas proof obtain algorithm looks trees forests graph bounded tree width notion introduced robertson seymour rs 
definition tree decomposition graph pair tree fx ig family subsets ii edge exists iii path tree width tree decomposition max jx gamma 
tree width graph minimum tree width possible tree decompositions graphs tree width called partial trees 
proof result similar theorem omitted 
theorem directed undirected graph vertices tree width directed undirected graph 
subgraph isomorphic exists deltav expected time delta log worst case time 
result similar result worse dependence obtained voigt pv 
real weight function fi defined edges algorithm voigt deterministic algorithm adapted find copy minimal maximal total weight 
special case theorem get log path problem difficult check algorithms described easily parallelizable 
follows log path problem nc 
mentioned robertson seymour rs showed minor closed family graphs excludes planar graph exists huge constant graph tree width simple corollary theorem get eh jv log say free minor decide polynomial time contains subgraph isomorphic concluding remarks open problems color coding method example demonstrating derandomization techniques 
algorithms obtained method easily parallelized yielding efficient nc algorithms corresponding problems 
problems listed remain open 
ffl polynomial time deterministic randomized algorithm deciding graph contains path length say log ffl log factor appearing derandomization omitted 
supply particular fixed optimal linear time deterministic algorithm deciding planar graph contains cycle length 
ffl problem deciding graph contains triangle difficult boolean multiplication matrices 
acknowledgment moni naor helpful conversations 
abn alon naor naor roth 
construction asymptotically error correcting codes pseudo random graphs 
ieee transactions information theory 
alon goldreich hastad 
simple constructions independent random variables 
random structures algorithms 
addendum random structures algorithms 
alon naor 
derandomization witnesses boolean matrix multiplication construction perfect hash functions 
appear algorithmica 
alon yuster zwick 
finding counting length cycles 
proceedings nd european symposium algorithms utrecht netherlands pages 
bod bodlaender 
linear time minor tests depth search 
journal algorithms 
bol bollob 
extremal graph theory 
academic press 
bol bollob 
extremal graph theory emphasis probabilistic methods 
regional conference series mathematics american mathematical society 
clr cormen leiserson rivest 
algorithms 
mit press 
cn chiba 
subgraph listing algorithms 
siam journal computing 
df downey fellows 
fixed parameter intractability 
proceedings th annual symposium structure complexity theory pages 
epp eppstein 
subgraph isomorphism planar graphs related problems 
proceedings th annual acm siam symposium discrete algorithms san francisco california pages 
fredman koml os szemer edi 
storing sparse table worst case access time 
journal acm 
fr furer 
approximating minimum degree spanning tree optimal degree 
proceedings rd annual acm siam symposium discrete algorithms orlando florida pages 
ir itai rodeh 
finding minimum circuit graph 
siam journal computing 
joh johnson 
np completeness column ongoing guide 
faces polynomial time 
journal algorithms 
kmr karger motwani 
approximating longest path graph 
proceedings workshop algorithms data structures montreal canada pages 
mb beck 
smallest ordering clustering graph coloring algorithms 
journal acm 
mon monien 
find long paths efficiently 
annals discrete mathematics 
nn naor naor 
small bias probability spaces efficient constructions applications 
proceedings nd annual acm symposium theory computing pages 
pv voigt 
finding minimally weighted subgraphs 
proc 
th workshop graph theoretic concepts computer science lecture notes computer science vol 
pages 
springer 
py papadimitriou yannakakis 
clique problem planar graphs 
information processing letters 
py papadimitriou yannakakis 
limited nondeterminism complexity dimension 
proceedings th annual symposium structure complexity theory san diego california pages 
ric richards 
finding short cycles planar graph separators 
journal algorithms 
rs robertson seymour 
graph minors 
ii 
algorithmic aspects tree width 
journal algorithms 
rs robertson seymour 
graph minors 
excluding planar graph 
journal combinatorial theory series 
ss schmidt siegel 
spatial complexity oblivious probe hash functions 
siam journal computing 
yz yuster zwick 
finding cycles faster 
proceedings st international colloquium automata languages programming jerusalem israel lecture notes computer science vol 
pages 
springer 

