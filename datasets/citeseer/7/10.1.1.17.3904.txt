issn institut national de recherche en informatique en automatique dynamical sources information theory general analysis trie structures julien cl ment philippe flajolet brigitte vall mars theme de recherche dynamical sources information theory general analysis trie structures julien cl ment philippe flajolet brigitte vall th nie calcul projet algo rapport de recherche mars pages digital trees known tries general purpose exible data structure implements dictionaries built sets words 
analysis major representations tries form array tries list tries bst tries ternary search tries 
size search costs corresponding representations analysed precisely average case complete distributional analysis height tries 
unifying data model dynamical sources encompasses classical models memoryless sources independent symbols nite markov chains nonuniform densities 
probabilistic behaviour main parameters size path length height appears determined intrinsic characteristics source entropy probability letter coincidence 
characteristics related natural way spectral properties speci transfer operators ruelle type 
key words information theory dynamical sources analysis algorithms digital trees tries ternary search tries transfer operator continued fractions 
sum unite de recherche inria rocquencourt domaine de voluceau rocquencourt bp le chesnay cedex france telephone sources en th orie de information une analyse rale des sum les sous le nom de tries sont une structure de don exible qui permet des sur des ensembles de mots 
nous une analyse de repr sentations de ces les tableaux les les de recherche 
la taille les ts de recherche de ces repr sentations sont pr cis ment qu une analyse en distribution de la est 
le mod le uni analyse est des sources les mod les comme les sources sans ind les de markov les non 
les propri des param tres de taille de li es deux de la source la probabilit de coincidence 
ces se elle mems reli es aux propri op de du type par ruelle 
mots cl th orie de information sources analyse algorithmes tries de recherche de fractions continues 
dynamical sources information theory general analysis trie structures julien cl ment philippe flajolet brigitte vall universit de france algorithms project inria rocquencourt le chesnay france february 
digital trees known tries general purpose exible data structure implements dictionaries built sets words 
analysis major representations tries form array tries list tries bst tries ternary search tries 
size search costs corresponding representations analysed precisely average case complete distributional analysis height tries 
unifying data model dynamical sources encompasses classical models memoryless sources independent symbols nite markov chains nonuniform densities 
probabilistic behaviour main parameters size path length height appears determined intrinsic characteristics source entropy probability letter coincidence 
characteristics related natural way spectral properties speci transfer operators ruelle type 
tries 
digital trees usually called tries structure data structure superimposed set words produced source 
structure tries splitting symbols encountered words 
consider xed alphabet fa arg nite set nite words trie associated toy de ned recursively rule trie na trie nar means subset ofy consisting strings start stripped initial symbol recursion halted soon contains elements 
advantage trie maintains minimal pre set characters necessary distinguish elements ofy versions tries essentially equivalent pre trees theory variable length coding 
clearly tree trie supports sety access path dictated successive symbols ofw 
similarly implement insertions deletions fully dynamic dictionary data type 
addition tries ciently support set theoretic operations union intersection partial match queries interval search suitable corresponding author 
mail address brigitte info fr 
cl ment flajolet vall adaptations method choice complex text processing tasks ch 

variety applications justi es considering trie structure central general purpose data structures computer science 
comes implementation options possible depending decision structure chosen guide descent subtrees node 
major choices array trie uses array pointers access subtrees directly 
list trie relies sorted linked list traversals 
bst trie uses binary search trees bst subtree access method 
array trie constitutes direct realization trie structure occasionally employ term standard trie refer situations parameters shared trie array trie instance case height size path length parameters 
list trie bst trie combine trie structure subtree access method globally referred hybrid tries original motivation considering hybrid trie structures came bentley sedgewick early ideas developed elegant implementation bst tries name ternary search trie 
basic idea represent bst trie ternary tree search symbols conducted standard binary search tree alphabet set trie descent performed escape pointer equality symbols detected 
structure brie discussed edition knuth treatise complete code detailed latest edition sedgewick book sec 

code especially compact simulations implementation constants appear particularly small 
bentley sedgewick report practical situations data structure cient hashing ering considerably wider functionality 
goal analysts examine claim precisely quantify goes 
implementation analyse parameters path length size number nodes 
path length determines search costs size characterizes memory requirements data structure 
addition analyse height trie provides valuable measure extremal search performance 
analysis expected provide useful guidance choice representation suitable particular application 
sources 
information theory contexts simpler models sources memoryless sources symbols words emitted independently previous ones markov chains probability emitting symbol depends solely bounded part past history 
data tries built arise sources may involve intricate dependencies 
analyses carried general framework related dynamical systems theory encompasses memoryless markov sources nonuniform density models 
model probabilistic dynamical sources introduced thoroughly developed vall describe nonmarkovian phenomena precisely dependency past history unbounded 
high level generality attained model 
dynamical sources tries probabilistic dynamical source de ned objects symbolic mechanism density 
mechanism associates real interval nite alphabet 
approach obviously related symbolic dynamics 
mechanism generalizes system binary expansion continued fraction expansion known instances 
probability interval allows values drawn interval nonuniform 
previous authors studied separately ect nonuniform densities speci mechanisms 
notable exception analyses carried far relative uniform density 
rst analyses context memoryless sources 
additive parameters size path length performed de bruijn knuth reported rst edition published 
height analysed poisson bernoulli models series papers 
asymmetric memoryless sources markov chain models treated systematically szpankowski collaborators see instance 
devroye rst consider ect tries nonuniform density conjunction standard binary representations 
allow nonuniform density mechanism capable modelling probabilistic bias individual digits 
operator methods 
methods earlier works analyse standard tries simpler source models diverse range probabilistic analytic 
feel uni es known regarding average case analysis basic parameters size path length distributional analysis height extending time analysis hybrid tries list tries bst tries 
shall see estimates appear involve crucial characteristics source entropy probability symbol coincidence 
rst quantity intervenes expectation size path length second expectation height 
memoryless sources generating functions classically conjunction mellin transforms 
source memory classical generating function techniques longer immediately applicable instance markov chain model jacquet szpankowski resort notion alignment conjunction suitable inclusion exclusion principle 
setting probabilistic dynamical sources main tool ruelle transfer operator 
classically generating operator easily generate objects essential analysis 
analysis tries involves pre xes words source words start pre come interval called fundamental interval 
context classical ruelle operator longer su cient 
previous study largely vall introduced generalization ruelle operator secant construction acts functions variables suitably generates fundamental intervals 
case hybrid tries need additionally generate simultaneously fundamental intervals 
purpose devise cl ment flajolet vall generalizations ruelle operator multi secant constructions acting functions variables 
classical version generalized ruelle operators depend complex possible express intervening dirichlet series pairs fundamental intervals play central le 
mellin transform heavily poles dirichlet series explicit pretty localized vicinity frontier line precise asymptotic estimates parameters possible 
furthermore positivity properties generalized ruelle operators real values parameters entail existence dominant spectral objects 
particular prove existence dominant eigenvalue function de ned neighbourhood real axis 
function turns ubiquitous analysis trie parameters 
main intrinsic characteristics source coincidence proven independent initial unit interval dependent mechanism source relations plan results 
section describes general framework dynamical sources de nes fundamental intervals basic characteristics source entropy coincidence probability 
sections devoted speci cations hybrid tries basic algebraic part analysis 
analyses reduce dirichlet series fundamental measures 
section introduces generalized ruelle operators shows generate dirichlet series needed 
section transfer properties operators various dirichlet series relate dominant spectral objects ruelle operator entropy coincidence probability 
sections come back average case analysis obtain precise estimates size path lengths height 
section section concludes examples include memoryless sources markov chain models continued fraction representations nonuniform initial densities 
results established random trie built 
height standard trie expectation order logn probability distribution asymptotically doubly exponential type sharp tail decay hn lim sup logn exp positive constant relative source initial 
ii average size trie possible small uctuations approximated quantity result particular generalizes improves results obtained devroye obtained conditions 
dynamical sources tries iii average path length depends hybrid implementation consideration 
hai represent array trie hli list trie hbi bst trie 
source built nite alphabet average path lengths invariably logn pa logn pl kl logn pb kb logn explicit kb depend mechanism source 
nite denumerable alphabet array trie meaningful anymore data structure 
case average path lengths relative list tries bst tries may happen di erent orders 
see prop 
instance case continued fraction source discussed section 
results rst established poisson model technically easier deal transferred xed size model called bernoulli model means techniques 
built theorems cover order 
combinations algebraic analysis asymptotic analysis poisson model bernoulli model size path lengths height extended results restricted uniform density models memoryless markov chain cases soda 
refer comparison theoretical predictions empirical studies large textual data 
justi ed practice bst tries trie searching times faster binary counterparts 
companion general study dynamical sources adapted freely parts sections 
regards methodology related approaches followed analysis gcd algorithms computational number theory 

probabilistic dynamical sources describe general framework probabilistic dynamical sources 
weintroduce symbolic dynamical sources mechanism basic markovian 
mechanisms related dynamical systems de ned expanding analytic maps unit interval 
reader may wish consult general background 
endowing unit interval analytic density de ne concept probabilistic dynamical source 
notion fundamental intervals fundamental measures introduce basic characteristics source entropy coincidence probability 
fundamentals dynamical sources studied related notions play important le analysis gcd algorithms computational number theory 
instance manuscript ciently spell checked modi ed version program implementation bst tries cl ment 
cl ment flajolet vall 
basic symbolic dynamical sources 
information theory contexts source mechanism produces nite words alphabet rst interested sources associated basic dynamical systems mechanism step 
reader unfamiliar theory expanding maps symbolic dynamics may wish examine de nition follows light usual binary number representation 
case alphabet shift ist xg fractional part partition fi 
encoding mapping de nition basic symbolic dynamical source 
basic dynamical source dened elements alphabet included inn nite denumerable topological partition disjoint open intervals im im encoding mapping constant equal im shift restriction im real analytic bijection im local inverse oft restricted im set fhm mg 
assumed exists xed complex neighbourhood set satis es extend holomorphic maps mapping strictly inside mappings jh mj extend holomorphic hm exist numbers je hm exists series converges re words emitted source produced follows mapping de ned iterating process shift mapping mapping mis encoding 
associated iis formed symbols mk th ofm equal 
number branches oft equals cardinality alphabet alphabet coding distinct branches oft denoted byt distinct inverse branches oft denoted 
hm bijection im coincides inverse oft im 
note domain de nition oft im 
remarks 
call dynamical source basic im literature asked dynamical system image im union elements ij partition 
conditions express inverse contractions equivalently expansive 
condition automatically holds nite alphabet useful case nite alphabets 
fact order treatment apply su cient xed iterate oft satisfy conditions 
instance shift associated continued fraction source ful ll conditions second 
dynamical sources tries memoryless sources 
memoryless sources described basic dynamical framework 
source said memoryless random independent follow law 
memoryless source associated probability pm nite denumerable source independent follow multinomial law parameters pm 
corresponding topological partition de ned im qm qm restriction oft im ne mapping de ned byt qm qm 
special cases importance ary expansion transformations de ned buc integer part fug mod buc fractional part ofu 
transformations give rise ary expansions baseband associated symmetric memoryless sources memoryless sources pj equal 
continued fraction expansions 
general framework may create di erent types sources memory 
arises soon nonlinear branches 
sense keeps memory previous history 
continued fraction transformation example situation 
alphabet topological partition de ned im restriction oft im decreasing linear fractional pj tcf cf iterated transformation gives rise continued fraction expansion ofx 
inverse branches linear fractional de ned hm 
rst satisfy set linear fractional transformations clearly satis es conditions noted theory sections applies case 

de nition probabilistic dynamical source preclude situation branches increasing decreasing 
introduce term refer case branches simultaneously type case 
binary continued fraction representations familiar binary re ected code known gray code memoryless sources binomial multinomial probability distributions common practice refer bernoulli sources qualify bernoulli model source model necessarily memoryless number items considered xed opposed poisson models 
cl ment flajolet vall 
dynamical sources 
top bottom binary representations memoryless source probabilities binary re ected code continued fraction rep markov source switches di erent representations 
plots represents graphs associated corresponding 
ifx ifx 
markov symbolic dynamical sources 
stage de ned unique rule 
modelling real life sources leads introducing dependencies form shift depends symbol emitted 
gives rise name markov sources classical markov chains special case 
de nition markov symbolic dynamical sources 
nite alphabet si sr set ofr di erent basic dynamical systems de ned alphabet basic dynamical system dynamical system sj chosen previously emitted symbol 
describe precisely mechanism source 
associates nite alphabet asin mk sequence iterates dynamical sources tries de ned initial recurrence relations tj associated topological partition ijj ir unit interval satisfy hypotheses de nition 
denote ijj ir branches ijj real analytic bijection ijj asked expansive 
inverse branches denoted ijj ijj real analytic bijection ijj extends holomorphic map mapping strictly inside ijj ir jr 
classical model markov chains order simply case sj memoryless 
precisely system sj memoryless system parameters ijj transition matrix markov chain rr matrix ijj jr initial probability system vector 
relation markov sources general dynamical systems 
markovian source associated dynamical system longer basic 
take copies instance ij 
denoting translation de ne ir jr ii ijj ti ijj bijection ii ii 
system associated partition ii general dynamical system 
interpretations markovian source prefer stay unit interval adopt rst formalism closer intuition underlying 
point view adopted ruelle 

fundamental intervals pre xes 
consider th iterate shift 
case basic source plainly th iterate oft taken usual sense 
case markovian source iterated sense de nition 
branch inverse branch th iterate shift called branch inverse branch 
depth inverse denoted jhj 
branch inverse branch associated unique way nite word mk length keeps track past choices 
basic case branch inverse branch mk form mk mk hw hm hm wheret denote th branch markov case branch branch mk form mk jmk hw jm cl ment flajolet vall nite alphabet branches 
denote hk set branches 
cyclic branches branches associated word starts ends symbol play important le case markov sources 
denote set cyclic branches set cyclic branches start 
vein ck ck denote objects relative 
main objects 
de nition fundamental intervals 
fundamental interval relative inverse transform ih unit interval inverse 
depth depth jhj ofh 
fundamental intervals depth exactly intervals initial partition 
fundamental interval ih formed real produce pre exactly nite word associated toh 
denoted 

probabilistic dynamical sources 
sequel interested probabilistic dynamical sources words emitted source mechanism previously described allow prescribed initial distribution determined density function unit interval 
de nition probabilistic dynamical sources 
dynamical source basic markovian letf areal analytic probability density interval extends analytic function letf dt associated dis tribution function 
pair called probabilistic dynamical source 
set words produced dynamical probabilistic source setm endowed probability induced 
context fundamental interval ih associated inverse de ned uh jf quantity plays especially important le equals probability source word starts pre relative toh 
called fundamental measure relative toh denoted 

dirichlet series fundamental intervals entropy coincidence probability 
relative probabilistic dynamical source de ned limit exists quantity involves fundamental lim jhj uh vein probability independent words pre equals jhj ku general quantity appears decrease exponentially leads de ne coincidence corresponding rate lim jhj dynamical sources tries provided exists 
previous de nitions involve series fundamental measures lim jhj jhj jf lim sequel show precise sense quantities de ned behave asymptotically ask th powers certain function de ned analytic near real axis prop 

entropy coincidence probability depend mechanism independent ofthe expressed solely terms function away consistent characteristics source play important le subsequent analyses tries 

general tries models analysis describe standard trie companion hybrid trie implementations main parameters relevant complexity standpoint 

de nition tries 
consider problem nite words analytical framework taken independently produced common dynamical source 
proceeding elementary comparisons symbols yields tree called trie 
letx sequence reals unit interval xn considers sequence words produced dynamical source xn need consider sequence formed rst symbol xi xi called rst slice ofm xn distinct kinds collections symbols intervene analysis nite words produced source represented vertical words nite sequences appear horizontal slices 
order build tree structure global fashion start root 
groups words start rst branch labelled corresponding subtree collects words starting stripped initial symbol 
model stripping initial symbol equivalent 
note reals associated group words cl ment flajolet vall ca ad cc ca cd aa cda da 
source emits independently nite words represented vertically top 
contrast internal node trie bottom slices appearing horizontally considered 
rst symbol fundamental 
case su xes words associated shifted sequence xn wheret de ned rst symbol equals 
process splitting continue words separated 
summarize language shifts associates tox digital tree called trie denoted trie de ned recursive rules ifx trie empty tree 
ifx cardinality equal trie consists single external node contains 
ifx cardinality jxj equal trie internal node represented attached built dynamical sources tries possible values ofm 
trie de ned trie trie tree structure underlies classical radix sorting methods 
built recursive 
pre common words ofm associated internal node trie associated fundamental interval iw containing elements ofx 

implementations tries hybrid tries 
tree structure representing trie internal node connected edges children 
assume alphabet totally ordered 
natural implementations node classical data structures array ordered list binary search tree 
result hybrid tries combine trie structure data structure governs access children nodes 
simplest implementation uses arrays cardinality equals size alphabet 
accesses children directly array pointers 
note solution meaningless practically nite alphabets space wasting large alphabets null pointers allocated quite adequate cardinality alphabet small typically binary words 
list trie structure remedies high storage cost array tries linking sister subtrees expense replacing direct array access sorted linked list traversal 
bst trie uses binary search trees bst subtree access method goal combining advantages array tries terms time cost terms storage cost 
noted hybrid trie obtained strictly equivalent tothe ternary search trie structure proposed see 
bst trie viewed ternary tree search conducted standard binary search tree straight links alphabet set trie descent performed escape pointer curved links equality symbols detected 
implementations trie drawn 
standard trie trie array trie version size path length respectively 
hybrid versions pointers data structures nodes induce extra path length list trie bst trie 

parameters 
rst consider standard tries structure array trie implementation 
level node trie number edges connect root 
height trie maximum level external node 
represents measure distance closest elements ofm equals minimum number comparisons required separate pair xi xj elements ofm 
path length standard trie sum levels nonempty external nodes 
path length equals total number symbols need examined order distinguish elements ofm 
divided number elements gives mean cost positive search search cost averaged cl ment flajolet vall bbd bbd bd ccd ca abc bd ccd ca abc bd ad bd ad bbd bd ccd ca abc bd ad 
representations trie built sequence words alphabet fa dg array trie top null pointers represented electrically grounded list trie bottom left bst trie bottom right 
items item trie 
size tree number internal nodes 
adding size cardinality ofx gives number fundamental intervals necessary isolate elements ofm 
clearly size determines storage requirements hybrid trie implementations 
trie path length decomposes sum components rst arises underlying trie structure second additional cost incurred traversal internal node structures 
overhead analysed hybrid tries 
interested global external path length su ces combine additively path length trie additional path length 
dynamical sources tries 
poisson bernoulli models 
bernoulli model considers sequence nite words independently produced dynamical source 
sequence obtained xn interval interval endowed probability denotes associated distribution function 
bernoulli model source denoted bn 
xing setx technically convenient consider elements obeys poisson law kg 
model called poisson model 
relative dynamical source denoted pz 
de nition expectations random poisson bernoulli models related pz bn zn 
similar relation holds probabilities events representable expectations indicator variables 
interest poisson model complete independence happens disjoint subintervals particular number elements fall interval distributed poisson variable 
property holds notably fundamental intervals associated source 
strong independence property poisson model provides easy access expectation basic parameters 
necessary return bernoulli model interest average case analysis commonly parametrized data items 
process translating poisson bernoulli model called strategies available 
ones 

algebraic relies fact equation poisson quantity factor ofe exponential generating function bernoulli counterparts bn pz represents coe cient ofz expansion ofh 
technique basis exact results bernoulli model theorems derived way counterparts theorems 
asymptotic 
poisson model narrowly concentrated near high probability poisson plays le similar bernoulli 
reasonable expect average values parameters models asymptotically equivalent 
generally problem character 
asymptotic ways establishing equivalence supplementary assumptions 

dirichlet relies existence mellin transforms approximation principle dirichlet series poisson cl ment flajolet vall bernoulli models 
technique average case analysis additive parameters size path length bernoulli model theorem derived way poisson version theorem 

saddle point relies estimates poisson averages equivalently generating functions nonprobabilistic values taken complex domain conjunction saddle point analysis 
technique distributional analysis multiplicative parameter height bernoulli model theorem derived way poisson version theorem 
net result dominant asymptotic estimates established initially poisson model remain eventually valid bernoulli model 

algebraic analysis trie parameters show expectations main parameters height size various forms path length standard hybrid tries expressed sums involve measures fundamental intervals 

additive parameters 
standard trie built elements depends fact set 
construction cost list trie shape bst trie depend relative order elements 
common implementations structure node indexed fully determined corresponding slice xn root trie determined slice collection root subtrees determined collection 
perspective decomposition synonymous trie trie consider additive parameter trie de ned recursively rule trie jxj trie trie jxj parameter called toll recurrence relation unwound leading trie provided zero slices contain symbol 
describe probabilistic model induced poisson model possible node trie determined pre probability word starts pre equal fundamental de ned probability symbol emitted pw uw uw dynamical sources tries notation concatenation sequence 
elements ofx independently drawn internal node labelled symbols emitted memoryless source bw de ned probabilities 
cardinality ofx random poisson variable length random poisson variable 
follows expectation parameter sum expectations parameter pz bw ranges nite sequences bw denotes memoryless source de ned 

search costs nodes 
consider additive parameters interest size path lengths relative kind hybrid trie evaluate expectations corresponding tolls 
toll associated size equals provided internal node indexed exists equivalently symbols jsj 
vein toll path length array trie simply jsj jsj 
parameters relative length list tries bst tries exactly traversal costs node structures built slice symbols repetition allowed inserted order structure list binary search tree toll cost incurred retrieval occurrence symbol proposition follows key step algebraic part treatment additive trie parameters 
substance evaluation expected tolls corresponding list tries bst tries analogous easy analysis lists harder analysis binary search trees nite domain nonuniform probability distribution see instance related developments 
approach relies symbolic description parameters generating functions independent interest 
proposition toll parameters 
memoryless source relative set probabilities pz poisson model 
model pz expectations toll parameters relative size trie path length array trie respectively pz pz cl ment flajolet vall model pz expectations traversal costs ordered lists binary search trees respectively pz pz zp zp wherep pk andp pk 
proof 
consider ordered alphabet fa arg th symbol denoted 
set ordinary generating function ogf exponential generating function egf relative toa parameter de ned xr bf xr xz jsj jsj jsj xr jsj 
jsj xr jsj denote respectively total length number occurrences formally andu mark length sequence jsj value parameter records occurrences 
formal languages generating functions intimately related 
course analysis operations languages better translated terms egf better expressed means ogf 
types generating functions related combinatorial laplace transform de ned fn 
instance generating functions relative set related le xr xr symbols emitted memoryless source relative probabilities expectation model pz pz pr exponential generating function associated parameter de ned 

expectations rst parameters direct consequences properties poisson process develop generating function framework serve basic principles 
decomposition translated egf yields dynamical sources tries xr xr xr xr zu xr zu xr egf relative application gives form 

parameter requires shu decomposition meaning word decomposes possibly void subwords repetitions ai shu ed possible ways 
known easy result generality languages disjoint alphabets corresponds product corresponding egf 
search cost slice equal number distinct corresponding exponential generating function bf xr su ces sum mand apply formula order get 

parameter needs subtle approach 
proceed stages describe search symbol bst search maximum rightmost branch bst means restricted elements index smaller dual search minimum leftmost branch bst 
sided search described regular expression corresponding multivariate rational functions 
combination achieved product involves formal laplace transforms 
extrema analysis 
rst problem solved analysis length rightmost branch tree built random words equivalently analysis left right maxima called records 
alphabet regular expression decomposition ry aj aj expresses precisely possible decompositions words sets left right maxima 
general principles concatenation translates ordinary product ogf 
accordingly ordinary multivariate generating function nmax xr ry xj coe cient nr equal number words maxima occurrences 
dually multivariate ogf minima nmin xr xj xr similar decompositions study maximum geometrically distributed random variables 
cl ment flajolet vall ii search costs 
consider search xed symbol bst 
shu decomposition mnf ar expresses fact decomposes subwords shu ed possible ways 
denote operation ogf translates shu product languages disjoint alphabets 
noted shu es languages correspond products egf laplace transform relates egf ogf 
xg equipped operation express ogf relative toc xr nmax xr zx xr factor takes account trailing sequences may contain 
iii explicit forms 
eq 
describes ogf information costs including full distribution 
egf obtained formal inverse laplace transform 
average cost usual obtained di erentiating respect principle 
rest computation details omitted carried means laplace transforms partial fraction expansions logarithmic derivatives obvious relations az az az az bz 
size path length 
form recurrence form probabilities node expressions obtained proposition somewhat simplify unwinding recursion 
consequence expectations additive parameters solely expressed fundamental measures 
theorem poisson expectations additive parameters 
dynamical source pz poisson model 
expectations model pz toll parameters relative respectively size trie path length array trie trie path length ordered list trie path length bst trie bs bpa bpl xx uw uw dynamical sources tries uw uw return bernoulli model principles algebraic summarized induce formal dictionary poisson bernoulli expectations az 
ze az expectations additive parameters bernoulli model bn expressible purely terms fundamental measures 
theorem bernoulli expectations additive parameters 
bn bernoulli model relative xed words independently drawn probabilistic dynamical source 
expectations size trie path length array trie path length ordered list trie path length bst trie pa uw uw uw pl uw pb uw uw uw uw 

height trie 
consider random trie equivalently array trie implementation produced probabilistic source poisson model pz 
trie height provided fundamental interval word 
probability event independence property poisson model mean value results 
theorem height poisson model 
distribution trie height poisson model pz pr hk zy expectation height jwj bh pz jwj corresponding quantities bernoulli model obtained means algebraic principle 
theorem height bernoulli model 
denote probability trie built ann tuple random items height cl ment flajolet vall bernoulli model bn 
exponential generating function satises corresponding expectation bn 
jwj jwj 
dirichlet series associated trie parameters 
expectations poisson model bernoulli model belong paradigm harmonic sums general sums form kf kz asymptotic analysis sums classically done mellin transform techniques see section application depends location nature poles associated dirichlet series mellin approach leads considering variety dirichlet series fundamental intervals 
instance poisson model kinds dirichlet series involved array tries list tries bst tries hai hbi hli uw similar modi ed versions arise bernoulli model 
uw uw contrast additive parameters quantity expressing probability distribution height harmonic sum logarithm log log jwj associated dirichlet series mk uw corresponding branches 
stage need way study dirichlet series fundamental measures order estimate asymptotically average values parameters 
necessitates locating poles dirichlet series de ned equations determining behaviour family dirichlet series de ned 
introduce generalizations ruelle operators play le generating operators fundamental intervals open avenue analytic study dirichlet series 
dynamical sources tries 
generalized ruelle operators analytic properties section starts easy notion density transformers section lift transfer operators introducing extra complex parameters section 
design class generalized ruelle operators multi secant operators section derivatives transfer operators replaced multivariate functions acted 
operators generate variety series fundamental measures including ones arising analysis trie parameters sections 

density transformers 
direct relationship dynamics source answers main problems section spectral properties operator closely related way transforms probability distributions 
basic ingredient developed dynamical systems theory class transfer operators 
simplest form transfer operator associated basic dynamical system density transformer jh term comes obvious fact ifx random variable distribution density oft 
words operator describes step source process 
component operator th term denoted de ned jh way de ne density transformer associated markov dynamical system 
erent densities fr correspond conditional densities fj density emitted symbol 
begins iteration shift associated initial system fj jh jj jj generally sequence conditional densities fr iteration stage sequence conditional densities gr iteration stage related matrix operators built density transformers gj associated dynamical system sj 
density transformer gj associated sj acts gj fj jh ijj ijj term previous sum de nes operator denoted ijj ijj jh ijj ijj term ijj fj represents part new comes 
consider matrix general coe cient cl ment flajolet vall ijj ijj index lines andj index columns 
matrix density transformer transforms sequence conditional densities fr iteration stage sequence conditional densities gr iteration stage gr ijj 
classical ruelle operators 
case basic dynamical system markovian proves highly useful general operators called ruelle operators 
component operator depends complex de ned analytic jh new component operators respectively denoted ijj fr hi fhi ijj fh ijj ruelle operators respectively de ned gs rx gs ijj basic case markovian case 
dynamics process priori described bys properties appear dependent complex values 

generalized ruelle operators 
vall introduced new tool generalized ruelle operator involves inverse branches tangents jh inverse branches 
design generalization involves multi hyper generalized operator gs acts space functions variables said extension 
applications shall need various extensions degrees 
rst de ne mappings extend inverse mapping de ned rst depends vm xm xm second denoted satisfy properties 
hs extends tangent mapping restriction diagonal coincides tangent mapping 
hs special ii hs satis es multiplicative properties style chain rule hs hg xm hs xm hs xm dynamical sources tries iii real hs possesses positivity property hs xm particularly important realizations multi secant mappings de ned collection ne di hs xm yh xi xj di di xi xj previous properties ii iii clearly satis ed 
component operator de ned analytic hs multi relative 
new component operators denoted ijj respectively 
act complex variables follows hs hi hi ijj hs ijj ijj way analogous generalized ruelle operators de ned gs rx gs ijj basic case markovian case respectively 
generalized ruelle operator constitutes extension classical ruelle operator sense iff diagonal times relation holds xm gs gs case corresponds exactly classical ruelle operator gs 
show operators gs generate depth rst case basic dynamical system section markovian case section 

dirichlet series basic case 
multiplicative property ii th iterate gs involves inverse gk jhj ehs hs analytic extension multi sum ranges inverse branches equivalently pre xes 
vein quasi inverse gs formal sum powers operator represents possible iterations consequently expressed sum ranges inverse branches gs ehs cl ment flajolet vall section equations dirichlet series arising analysis tries hai uw hbi hli hai uw ju uw uw rst series correspond dirichlet series fundamental measures de ned section play central le large number analyses involving pre xes words see 
generated operator relative true secant applied hai precisely hai hai hai jhj uw hai secant initial distribu jf hai hai jf hai hai hai jhj hai fv series hli hbi arise hybrid tries order symbols matters 
order alphabet natural order topological partition induce order interval 
assume orders identical reverse 
measure interval 
inverse relative pre points chosen hhi hhj hhj 
choice depends signs hi hj derivatives inverse hi hj 
measure uw measure interval 
endpoints chosen hhi 
choice depends signs hi 
term dirichlet series tries involves points case list tries points case bst tries 
accordingly corresponding ruelle operators act functions variables case list trie functions variables case bst trie 
denote respectively hli hbi de ned multi hbi dynamical sources tries andh hli hbi hli hbi jhj hbi fv hli jhj hli fv particular functions generate dirichlet series relative initial hbi hli opposed hai series hbi hli involve sums subdivisions fundamental intervals 
fundamental canonical depth relative uniform density play important le expression dirichlet series 
de ned jhi hi way consistent previous notations setu 

case branches increasing 
hli 
ii hi sl hli hi hi hbi iu ju hbi hbi hi hi hj hj case 
case branches increase decrease possible expressions depending values hi hj possible expressions measure uw depending values hi 
split alphabet subsets depending possible values hi split set possible relative possible pre xes subsets corresponding increasing branches decreasing branches wish generate separately subsets 
splitting introduce signed component operators de ned sign entails hi jhj gs cl ment flajolet vall relations gs gs egs gs gs gs show previous expressions extended case expressions involve quasi inverses gs gs particular part dirichlet series involves quasi inverse gs explicit 
associate hi quantity hi 
case bst tries consider tuples operate group order generated transpositions acting rst components components respectively 
denote subset contains elements case list tries consider tuples form operate group order generated transpositions respectively act rst components exchanges possible values 
denote subset contains elements part dirichlet series involves quasi inverse gs equals respectively hli hi sl hli sr hi hi list trie case 
iu ju bst trie case 
hbi hi hbi sr hi hi hj hj 
dirichlet series markovian case 
markovian case coe cient th iterate matrix gs involves toa word mk starts ends mk 
dirichlet series relative array tries wish generate inverse branches 
dynamical system rst consider operator ms relative initial ms gs gs ij rj denotes th dimensional vector times ms denotes generalized ruelle operator associated 
gs ms fork operators gk obtain analog dynamical sources tries gs ms gs ms ms generate inverse branches jhj ehs ehs deduce formulae dirichlet series relative array tries hai ei hai hai ms hai ms hai vein th vector canonical basis operator generates inverse branches pre xes symbol 
case branches increasing expressions dirichlet series relative list tries bst tries involve canonical fundamental measure extended markovian case ms ij jh ij ij consistently previous notations setu 
kj andu kj 
hbi hli ij jj hbi ij ij jj jj 
ij hli hli ij ij ms ms case 
general case branches may increasing decreasing consider signed ore gs component operators de ned sign ijj ijj ijj gs ijj ijj ijj entails formulae 
operators egs intervene quasi inverses expressions dirichlet series relative list tries bst tries quasi inverses operators gs 
cl ment flajolet vall 
asymptotic analysis 
asymptotic analysis coe cients dirichlet series dependent spectral properties generalized ruelle operator hai generate 
study height asymptotic behaviour ask tends nity related dominant spectral properties ruelle operator hai size path length dirichlet series involve quasi inverses gs gs various ruelle operators gs signed ruelle gs 
asymptotic analysis coe cients dirichlet series dependent location poles 
poles arise values gs egs singular values eigenvalue gs ore gs 
way poles dirichlet series relate spectral properties transfer operators 

generalized ruelle operators analytic properties generalized multi secant operators belong category nuclear operators de ned section particular discrete spectrum 
nite dimensional operators ways behave nite matrices de ned notions trace determinant attached 
weintroduce composition operators basic building blocks transfer operators section explicitly characterized spectrum section 
transfer operators including multi secant variety spectra determined composition operators means trace formulae section 
hand generalized operators possess strong positivity properties perron frobenius type real values parameters 
properties entail existence dominant positive spectral objects section eventually related basic parameters source entropy coincidence probability section 
related quasi power property gives access behaviour operators iteration sections 
properties transferred dirichlet series fundamental intervals interest analysis tries section 

nuclearity trace formula determinant 
rst recall notion nuclearity introduced grothendieck 
letb banach space andb dual space 
operator nuclear order admits representation ei jje jj summable 
matrix algebra extends operators particular de ne trace tr ei equal tr eigenvalues counted algebraic multiplicities 
traces iterates de ned analogue characteristic polynomial known determinant det ul iu dynamical sources tries eigenvalues counted algebraic multiplicities 
exists important relation determinant traces iterates det ul exp tr log ul exp uk tr lk extends familiar jacobi formula matrix theory log det tr log 
properties give access spectral properties nuclear operators order 

composition operators 
component operator gs de ned gs fh known composition operator 
recall es contraction properties de nition exists suitable neighbourhood jh extend analytics map closure inside exists je 
operator gs acts formed holomorphic domain continuous closure endowed sup norm sup vg banach space 
operators studied extensive way authors schwartz shapiro taylor shapiro 
es assumptions de nition generalized component operator gs acts space formed holomorphic domain continuous closure endowed sup norm sup um um banach space 

spectra composition operators 
extended composition operators gs relative eigenvalues 
multiplicities eigenvalues depend extension 
proposition 
denote value ofe xed 
spectrum operator gs formed eigenvalues eigenvalue appears sp gs multiplicity consequently formula gs holds tr gs proof 
proof uses theorem due mayer 
multi denotes set multisets built 
precisely multiset fa arg possible equality multi cl ment flajolet vall theorem mayer 
domain letb set functions holomorphic continuous de ned inb strictly maps 
spectrum sp multi sp unique xed point inside di erential components operators gs ful ll conditions theorem spectra precisely determined 
note purposes trie analysis interest 
operator gs coincides usual ruelle operator gs previous theorem applies sp fh sp gs ng exactly set formed elements de ned 
general case operator gs acts onm variables spaces mayer theorem applies hs vm xm diagonal matrix coe cients xm 
xed point point fh denotes multiset obtained element multi 
multiplicity eigenvalue spectra gs equals number words size am accordingly relations entail trace formulae involving quantity tr gs spectra gs gs contain elements 
compare precisely trace formulae 
generalized trace expressed terms trace classical operator tr gs tr gs pm tr gs consider signed gs ande gs gs introduced 
trace generalized operators gs gs dynamical sources tries expressed traces operators gs egs tr gs tre gs pm tr gs pm odd odd pm pm tr gs 
spectra transfer operators 
rst precise functional space gs operator applied 
operator determined multi hs 
markovian case restrict nite alphabets allow nite denumerable alphabets basic case 
situation possibility choosing open set conjunction convergence condition entails nice properties ruelle operator gs half plane re denote intersection real axis 
secant hs de ned strictly positive real part operator gs de ned half plane re basic case gs operators taken act space de ned set functions holomorphic domain continuous closure endowed sup norm 
markovian case gs operators taken act space functional spaces banach spaces 
component operators gs nuclear order operators gs nuclear order 
particular bounded compact 
spectra discrete 
signed gs de ned signed component operators egs gs egs gs gs ijj entails equalities powers ofe gs similar 
proposition relates spectrum generalized operator spectra classical ones 
proposition 
spectra generalized ruelle operators gs gs related spectra classical ruelle operators gs egs sp gs spe gs sp gs pm pm odd odd pm sp gs pm union taken sense multisets denotes multi set obtained element multi 
cl ment flajolet vall proof 
markovian case trace th iterate gs resp 
gs equals sum trace diagonal elements matrix gk resp 
gk diagonal elements cyclic branches associated word starts ends symbol 
cases trace formulae involve set ck set inverse branches basic case set cyclic inverse branches markov case tr ck tr gs tr ck tr gs relations extend powers transfer operators tr pm tr odd pm trace formulae determinant det expressed terms traces powers operators obtain log det pm log det odd pm log det determinant generalized ruelle operator gs acting functional space satis es det gs det gs pm odd hi pm det obtains relation spectra gs spectra gs 
proceed way signed gs 

dominant spectral properties reals 
real operators gs gs satisfy strong positivity properties related perron frobenius theory 
proof easily extended generalized framework positivity property iii ofe hs section 
obtain reals operator gs unique dominant eigenvalue eigenvalue largest modulus positive multiplicity 
priori dominant eigenvalue dependent chosen extension 
prove section extensions gs share dominant eigenvalue 
operator compact spectrum discrete spectral gap dominant eigenvalue remainder spectrum 
possible decompose gs gs ps ns ps projection dominant eigenspace ns relative remainder spectrum spectral radius strictly smaller dominant eigenvalue 
generally dynamical sources tries decomposes ps true particular classical ruelle operator gs dominant eigenvalue denoted 
previous relations positivity properties dominant projections entail equalities lim gk lim gk relation expressing gs extension gs entails equality operators gs dominant eigenvalue 
projection ps relative dominant subspace written ps xm es xm dominant eigenfunction andes linear form 
extension formula enables relate dominant objects dominant objects relative classical ruelle operator gs dominant eigenfunction dominant es es diagonal ofg proved proposition 
multi secant operators gs dominant spectral properties 
share dominant eigenvalue dominant spectral objects dominant eigenvectors dominant extensions corresponding dominant spectral objects classical operator gs es es diagonal ofg 

quasi power property 
classical theory analytic perturbation su ciently small neighbourhood point real axis unicity dominant eigenvalue preserved 

es de ne analytic functions neighbourhood point de ned 
extending neighbourhood real axis deduces th iterate gs behaves ak th power dominant eigenvalue gs xm assumption thatf positive satisfy xj 
dirichlet series associated array trie special case state detailed form course proofs theorems relative trie height 
proposition quasi power property 
real 
distribution associated strictly positive exists positive constant lim hai cl ment flajolet vall modulus subdominant eigenvalue constant 
exist strictly positive constants hai hai 
maximum properties dominant eigenvalue 
dominant spectral property dominant eigenvalue functions 
plays central le analyses 
establish important properties function 
generally study spectral radius operator gs 
points half plane re compare spectral gs er ofe gs spectral radius proposition maximum properties dominant eigenvalue 
constant referred condition de nition 
properties hold functions 
strictly decreasing real 
ii positive thats 
iii vertical line re er hold 
iv half plane re strict inequalities hold 
equality holds fors gs eigenvalue ia belongs spectrum gs 
holds fors eigenvalue ia belongs spectrum 
vi provided equal strict holds 
proof 
rst properties proven 
properties iii iv spectrum formula proposition strict decrease real axis way similar proofs 
property vi established means converse triangular inequality way proof proposition 

special values 
fors classical ruelle operator gs de ned de nition density transformer 
property entails explicit evaluations spectral objects ats 
proposition special values 
dominant eigenvalue ats equals dominant gs ats satis ese dx 
letf distribution relative 
residue ats gs hs independent involves dominant eigenfunction ats form gs hs proof 
fundamental intervals quasi partition unit hai interval results equality distribution function dynamical sources tries 
operator density transformer real gk dt dt dt obtained provided de ned density function normalization condition dt 
deduces expression extension property proposition 
diagonal mapping relative toh 
recall entropy coincidence probabilities de ned terms limits involving dirichlet series xed depth 
quasi power property provides expressions entropy coincidence probability seen involve spectral objects fors ands 
proposition entropy coincidence probabilities 
entropy source equal opposite derivative ofs 
ats coincidence probability equal 

singularities quasi inverses gs egs explained section necessary locate precisely poles various dirichlet series 
recall 
property iv proposition gs egs invertible half plane re 
operator gs analytic simple pole ats 
assertion vi proposition implies case ats equal gs 
focus may take place near line re consider called particular points spectrum gs contains eigenvalue equal 
assertions proposition prove particular points spectrum classical operators gs contains eigenvalue equal 
result extends results gives characterization particular points describes types behaviour may encountered 
proposition singularities quasi inverses 
operators gs gs may behave di erent ways line re aperiodic case 
particular points gs egs invertible punctured half plane re 
ii periodic case 
points operator gs 
regularly distributed line form kit operator gs may possible particular points form operators gs egs simple pole particular points strip left line re free 
proof 
proof follows lines proposition 
existence particular points gs implies equalities inverse branch possible cases depending equalities cl ment flajolet vall hold 
rst case particular points ats fork second case gs particular points 

asymptotic analysis size path length return analysis trie parameters starting additive parameters size various path lengths 
rst introduce main asymptotic tool mellin transform relates poles dirichlet series asymptotic forms harmonic sums including expressing additive trie parameters 
obtain main results poisson model 
stage dirichlet provides corresponding asymptotic estimates bernoulli model 

mellin transform 
mellin transform method choice deriving asymptotic expansions harmonic sums involved 
brie review properties needed survey article 
mellin transform integral transform de ned dx de ned strip re called fundamental strip denoted instance mellin transform ofe euler gamma function fundamental strip 
harmonic sum sum form kg kx coe cients kg kg called amplitudes frequencies called base function 
analysis tries reduces essentially asymptotic estimations particular harmonic sums 
basic principles mellin analysis list referring detailed conditions 
harmonic sum property 
transform general harmonic sum de ned satis es intersection strips absolute convergence andg 
mapping property 
mellin transform maps individual terms asymptotic expansion typically harmonic sum arising singularities 
correspondence fares ways rule assume de ned strip admits continuation extended strip analytic line re jsj im re singular term local expansion ofg pole extended strip provides corresponding term asymptotic expansion ofg dictionary error term dynamical sources tries 
combination yields basic principle asymptotic analysis mellin transforms mellin transform factorizes harmonic way asymptotic estimation sum reduces analysing separately collections singularities basic associated dirichlet series 
mellin analysis harmonic sums conducted situations base function exponential decay systematically case appears exponential function ii dirichlet series polynomial growth jim 
case fast decay ati application legitimate 
apparent complex poles induce periodic uctuations 
detailed framework extends function nitely poles nite strip provided remains controlled jsj set parallels real axis escape toi 
refer term asymptotics weak sense conditions imposed vertical ladder 
case nite superposition periodic elements may collectively periodic fact depends poles regularly spaced vertically 
poles accumulate right near boundary line re strip general paradigm needs mildly amended 
ect immediately clear induced uctuation contribute globally term 
precise result follows logically needed situation arises context dynamical sources 
proposition improved mellin asymptotics 
assume mellin ofg de ned admits continuation strip satis jsj weak asymptotic sense re line re nitely poles line 
implication 
asx ranges poles re singular expansion function domain denoted 
understood sense formal sum local singular expansions singularity domain 
proof 
possibly subtracting elementary functions tog wemay assume loss generality analytic re 
suitable combinations exponentials monomials transforms fast cl ment flajolet vall decay ati 
classical proof appeals integration large rectangle vertical sides re re see 
reduced proving right boundary ds sets iu andx equivalent estimate iu granted riemann lebesgue lemma du 


size path length poisson model nite alphabets 
gs invertible plane re series analytic simple pole ats 
types situations need distinguished depending periodicity source 
periodic case poles re regularly spaced line re contribute periodic terms asymptotic expansion 
vertical strip free poles provides bounds error terms 
aperiodic case poles line re may accumulation poles left line re 
proposition allows quantify directly contribution poles 
theorem additive parameters poisson model nite alphabet 
pz poisson model relative source nite alphabet initial 
case source aperiodic expectations size path length bs pa logz ca expectations path length list tries bst tries form wheren isb bst lists bpn kn logz cn ii case source periodic expectations size path length bs bpa qa logz logz ca qa logz dynamical sources tries expectations path length list tries bst tries form wheren isb orl bpn kn logz cn qn logz depends source small amplitude positive constant satisfying determined width pole free region left line re 
depend initial distribution may depend 
proof 
expressions theorem harmonic sums involve exponential function 
mellin transform exponential gamma function known singularities nonpositive integers 
conventions dirichlet series harmonic sums form dirichlet series fundamental intervals sorts 
precisely expressions theorem mellin transforms tabulated fundamental strip size bs 
hai path length pa 
hai path length list tries pl 
hli path length bst tries pb 
hbi transforms extend functions larger strip right line re way suitable mellin analysis 
properties gs singular expansion hai ats reads hai ca case hybrid tries list tries bst tries expressions basic case basic case markovian case special values proposition imply singular expansions hni ats form hni kn cn explicit depend uniform fundamental measures depth denoted byu values dominant eigenfunction boundaries fundamental intervals depth 
instance case dynamical source basic branches increasing kl kb 
hli hi hi hbi hi hi hj hj cl ment flajolet vall basic case branches increasing assertion vi proposition shows poles gs intervene dominant term previous expressions generalized kb kl 
hli hi hi hbi hi hi hj hj markovian case formulae similar involve components vector eigenfunction see equations 
determined residue calculations involve dominant spectral objects gs ats 
due fast decrease function conditions mellin analysis apply 
proof completed means equation combined basic residue calculations 
uctuations size asymptotically dominant order uctuations path length subdominant 

size path length poisson model nite alphabets 
case nite alphabet series uniform fundamental measures depth may involve singularities average path lengths hybrid tries logz 
consider dirichlet series ju ju 
hai series exactly dirichlet series 
hypothesis de nition exists series convergent re dominant spectral objects andes strictly positive reals dominant singularity hli located ats max sl dominant singularity ofl 
vein dominant singularity hbi located ats max sb dominant singularity 
discussion enables state proposition additive parameters poisson model nite alphabet 
assume canonical fundamental decreasing dominant strictly 
average path length bst trie necessarily form exist sources average path length list trie form bpl proof 
proof relations dominant sb dynamical sources tries 
ect implies 
decreasing 
decreasing ii lder inequality max entails convergence second series 
iii ifu 
case convergent general term general term 
discrepancy orders growth path length array tries list tries bst tries occurs instance generalized zipf laws riemann zeta function soft tails see case continued fraction source section 

dirichlet 
mellin transforms ideally suited analysis harmonic sums poisson sum relative path length array tries uh typical 
sums involving exponential occur analysis poisson models see theorem 
hand algebraic bernoulli model leads sums exempli ed counterpart uh uh see theorem 
problem analysing asymptotically bit trickier 
approach developed approximating directly singularities dirichlet series associated bernoulli model singularities simpler series arising poisson model perspective mellin analysis 
approach called dirichlet brie introduced put analysis multidimensional search justi cation 
immediately realized heart matter lies result 
proposition dirichlet 
positive 
de ne dirichlet series sx log uh cl ment flajolet vall assume nonempty domain convergence nite strip polynomial growth weak asymptotic sense 
properties hold fore 
addition singularities related sing fs js sing andk ng singular expansions ande related cj exps log log term weak refers fact growth need controlled certain parallels real axis tending toi 
proof 
want justify chain formal transformations uh exps log uh uh uh exps uh uh uh suh uh uh denotes abscissa convergence 
indices dropped assumed implicitly sums range set possible 
arbitrary control order expansions 
analytic continuation 
rst pass consider problem transforming way ensures analytic continuation worrying uniformity respect tos 
assume re 
taylor expansions produce log log computable 
exp sd exp particular di erence exp exp sd general term decreases re 
particular analytic re turn exp sd dynamical sources tries exp sd cm obtained equation 
quantity sd lies neighbourhood expansion exp applicable 
di erence cm general term decreases analytic re equations imply cm originally de ned re re xed arbitrarily ofe ofc results 
addition singularities ofe shifted singular expansion justi ed 
growth 
remains examine growth ofe im 
achieved modifying previous proof uniformity respect account 
re analytic continuation left matters 
basic idea exp 
rst line justi ed fact real re bounded bound replaced precise estimate second line follows standard expansion ofe near origin 
consequently function de ned eq 
iso jsj re manner similar separating cases yields uniform version exp sd cm jsj results re growth jsj 
sum quantities analytic quantity iso jsj 
weak polynomial growth re chosen arbitrarily result follows 
argument adapts general pair dirichlet series hu log uh property stated proposition holds case 
cl ment flajolet vall 
asymptotics bernoulli model 
principle dirichlet shows poles introduced method distance dominant poles arising poisson model 
consequently estimates theorem remain valid case 
theorem asymptotics bernoulli model nite alphabet 
bernoulli model source nite alphabet theo character expected trie size theo logn character expected path lengths hold estimates theorem remain valid provided poisson replaced bernoulli 
proposition similarly susceptible extensions bernoulli model 

asymptotic analysis height consider parameter height 
rst perform asymptotic reduction harmonic sum asymptotic form expected height poisson model derives 
step saddle point provides nal result bernoulli model 

double exponential approximation 
expectation height model relative source initial expressed nite sum see theorem pz jhj series fall directly orbit mellin transform techniques approximated harmonic sum 
quasi power property proposition provides existence constant de ned lim hai result gives rst asymptotic approximation distribution stated strong form convergence 
proposition 
distribution trie height poisson model admits double exponential approximation sequences jhj bk exp bk proof 
fact log proceed steps 
harmonic sum relative step 
compare ek jhj exp uh exp jhj uh hai choose arbitrary interval set dynamical sources tries logz log logz log bd existence quantities granted strict inequality log log assertion ii proposition 
exist positive numbers properties hold jhj sum split parts left tail central domain right tail integer 
left tail 
rst consider part relative 
inequality true forx implies exp ek exp introduces sequence bk jhj jhj exp uh exp uh positive sequence ai sums inequality ai ai jhj uh holds implies decreasing 
fact conjunction mean value theorem entails inequality ek exp property index quasi power property nally property index imply ek exp dz ii central domain right tail 
second part sum relative tok 
inequality relations log jhj ek log jhj cl ment flajolet vall entail ek jhj uh quasi power property ats conjunction property index yields inequalities ek second step 
poisson model approximated exp 
quasi power property provides andd inequalities hold jhj uh uh jhj lies strictly dominant eigenvalue modulus subdominant eigenvalue operator 
inequalities ek bk jek bk jd entail elementary argument mellin transforms exp equations imply result 
exp 
distribution height poisson model 
note equations provide asymptotic distribution hz model pz entail lim sup pr hz exp hand harmonic sum approximates average height model mellin transform exp textbook example mellin analysis 
fundamental strip singular expansion ats log log log regularly spaced poles line re entail periodic uctuations 
state dynamical sources tries theorem asymptotic height poisson model 
poisson model source initial average height bh log logz qf logz log log positive constant depending source periodic function small amplitude 
asymptotic distribution height double exponential type lim sup hz kg exp 
height bernoulli model 
rst recall notations theorem 
quantity denotes probability trie built ann tuple random items height bernoulli model 
exponential generating function value jhj case memoryless source analysis conducted saddle point method completely elementary case unbiased binary tries see 
propose follow precisely approach order analyse height case general dynamical source 
reader referred jacquet szpankowski interesting general framework saddle point name analytic 
formal idea analysis start cauchy integral formula 
dz zn simple closed contour positively origin 
arbitrary log xm xm exp log transformation applied integrand gives exp log uh uh uh mx uh sums taken jhj retaining rst terms leads expect suitable values ofk validity approximation 
exp uh zn viewed perturbation cauchy coe cient integral applied toe known integral estimated saddle point method consists steps cl ment flajolet vall integrate circle jzj approximate saddle point integrand ii observe contribution concentrated small conditions ensures iii nally reduce integral asymptotically complete gaussian integral evaluated 
case ofe course standard ways deriving stirling formula 
regard factor ofe zn constant tiny fraction integration contour matters led approximations 
exp exp exp uh dz view saddle point integral ofe stirling formula basic results relative fundamental intervals 
estimate double exponential approximation distribution encountered poisson model 
involves constant de ned 
theorem asymptotic height bernoulli model 
bernoulli model logarithmic character expected trie height uniform double exponential approximation hold estimates theorem remain valid provided poisson replaced bernoulli 
proof 
explain preceding strategy fully rigorous 
set consider small constant argument needs distinguish domains variation ofk boundary bd satisfy constraints re nements constraints encountered study poisson model 
log ensures fork exact order 
log strictly enclosed dominant eigenvalue modulus subdominant eigenvalue operator 
accurate absolute error soon ask see eq 

log fork cubic neglected dynamical sources tries log ensures fork 
technical requirement needed validate saddle point perturbation estimate 
observe compatible log concavity properties compatibility hand hand automatically granted 
consequently chosen interval max log log log log need repeatedly estimates form je ne andh cz small 
gn loge nei re ne cos cn cos elementary study shows granted andk gn attains uniquely maximum unimodal 
left tail 
atk ne wehave condition log jn cos quadratic term dominates exact order 
trivial bounds applied cauchy integral entail ne corresponds left tail distribution globally exponentially small 
ii central domain right tail 
fork need check saddle point method applies 
part contour je cos exp conditions imply contribution integral region satis es 
dz 
sup nn exp exp replacement order absorb terms form come stirling formula 
contribution exponentially small 
cl ment flajolet vall similar reasons quantity central region satis es exp exp results conditions condition ensures variation ofz bounded 
cauchy coe cient integral applied toe yields bound uniform approximation conclude fork exp equations fully characterize 
establish approximation type poisson model 
proof completed 
methodological aside observe proof essentially amounts lifting estimates established large real values poisson case assumes values parts large complex circle ne fact agreement general principles saddle point 
noted double exponential limit formula distribution height limit probability distribution strictest classical sense setting leaving aside error terms ne log log flog log jg fug fractional part function 
words distribution discrete sampling double exponential function expressed 
equivalently family distributions governed bounded parameter change gradually periodically powers 
periodicity phenomena expressed discrete samplings extreme value distribution fairly common tries see instance detailed discussion 

applications brie develop main applications bernoulli sources continued fraction source 
statements specializations theorems systematically bernoulli model simpli ed forms stated emphasize better shape results 
conclude open problems 
dynamical sources tries 
memoryless sources 
memoryless sources sources nite nite alphabet occurs independently 
standard ruelle operator associated system gs qm dominant eigenfunction component operator gs equals constant function values ofs re constant function dominant eigenfunction gs values ofs dominant eigenvalue 
dominant integral dt 
generally spectrum gs determinant sp gs pm eigenvector relative th eigenvalue polynomial degree 
symmetric memoryless sources th eigenvalue independent ofs case symbols family eigenfunctions coincides exactly bernoulli polynomials de ned 
te zt results obtained compared classical results digital trees built nite alphabet rg 
state corollary 
consider nite memoryless source nite alphabet probabilities entropy coincidence probabilities xx pi trie size standard path length expectations form logn ii trie height asymptotically double exponential distribution mean logn iii path lengths hybrid tries satisfy pl kl logn pb kl logn notation approximately equal opposed reserved precise asymptotically equivalent possible uctuations induced nonreal poles 
pi cl ment flajolet vall kl rx pi kb pi pj statements relative path length height extend analyses case general analytic density 
analysis hybrid tries 
devroye considered ect unbiased memoryless source density need analytic 
devroye showed logn orh depending density exist thatp logn soon asf square integrable 
quite authors take account possible periodic uctuations may occur main asymptotic estimate size 
examples periodic memoryless sources pm case determinant pseudo periodic ia witha interesting 
bernoulli source pseudo periodic exist real belong cyclic group generated belong cyclic group 
instance situation 
noted accumulation left line re 
improved mellin argument prop 
shows directly total contribution poles contributes term asymptotic expansion size logn expansion path length 

markov chains 
consider particular case 
alphabet nite matrix general term ijj plays central le 
fors transition matrix markov chain 
spectrum matrix operator gs exactly union spectra matrices integers sp gs sp det eigenvalues matrix denoted ir sp gs ir eigenvector relative components polynomials degree 
dominant eigenvalue operator gs exactly dominant eigenvalue matrix associated eigenfunction components constants 
th component eigenfunction vector stationary probabilities markov chain 
corollary 
consider markov chain transition probabilities entropy coincidence probabilities xx dynamical sources tries th component vector stationary probabilities markov chain dominant eigenvalue squared matrix ijj 
trie size standard path length expectations form logn ii trie height asymptotically double exponential distribution mean log logn iii expected values path length hybrid tries satisfy kl pl kl logn pb kb kb logn jjk ijk jjk mentioned result supplements 

continued fraction source 
preliminary results continued fraction source reported limited initial density uniform 
ruelle operator case called ruelle mayer operator gs sf convergence granted re 
entropy source related known vy constant plays key le metric theory continued fractions analysis euclidean algorithm 
coincidence probability relative ruelle mayer operator constant known vall constant intervenes dimensional generalizations euclidean algorithm 
aspects see 
dominant eigenfunction known gauss measure proportional 
corollary 
consider continued fraction source initial density analytic 
entropy coincidence probability log expected values size path length satisfy log pa log logn ii height obeys double exponential law mean logn log cl ment flajolet vall iii expected values path length hybrid tries satisfy pl pb log log logk example continued fraction source interesting counts 
stated iii average path list trie average path bst trie turn asymptotic order 

unexpectedly continued fraction source resembles generalized zipf source parameter see section second periodicity related issues particularly fascinating 
continued fraction source aperiodic poles gs intervene deep mathematical problems include nontrivial zeros riemann zeta function 
gs eigenvalue related eigenvalues hyperbolic laplace operators lie line re see efrat 
values occur poles dirichlet series hai id 
ect half plane re dirichlet series id represented see prop 
hai id analytic re 
initial density uniform asymptotic expansions ofs theorem solely involve nontrivial zeros riemann zeta function 
arbitrary density situation occurs hyperbolic laplace operators satisfy dx pointed 
nature second order asymptotics additive parameters related riemann hypothesis 
corollary 
uctuations mean value path length size standard tries continued fraction source riemann hypothesis 
instance size log sum indexed zeros riemann zeta function critical strip re res particular riemann hypothesis 
addition unconditionally respect implications hold 
zg lim dynamical sources tries ii conversely supremum unbounded zero inre 
proof 
equation follows formally residue computation large rectangle 
analytically justi ed fact grows somewhat large horizontal lines traverse critical strip high altitudes avoiding zeros critical strip 
accordingly weak polynomial growth strip contains critical strip 
fact granted known properties riemann zeta function omit details entirely similar discussion formula ramanujan book see sections 
granted implications follow easily 
numerical aspects uctuations 
er succinct discussion function 
know preceding discussion function weak polynomial growth 
truncated sum restricted zeros zeta function jim jt 
di erence product polynomial int quantity fast exponential decay gamma function ati 
discussion informal sense roughly equal 
take corresponding rst zeros zeta function computed van de lune te winter 
zeros satisfy riemann hypothesis 
forgetting ancillary polynomial factors upper bound truncation error terms corresponding high zeros ofz neglected worst je totally negligible values huge threshold practical purposes riemann hypothesis regarded true focus attention rst terms 
ingredients intervene fast decay gamma function fact rst nonreal zeros zeta function fairly large imaginary part 
assuming sake illustration residue modulus corresponding contribution numerically dominating anyway bounded zeros farther away gamma function smaller may reasonably expect quantity forn summary riemann hypothesis true false really ect physical nature uctuations 
addition oscillates going detectable quite large 
fluctuations particular completely set constant term expansion ofs 
fact interesting provides naturally occurring instance phenomenon rst discovered cl ment flajolet vall proved rigorously 
surprising phenomenon empirically values close apparently numerical convergence function reality left hand side eventually oscillates unboundedly asn 

extensions open problems 
reasons related database applications considers variant tries called bucket tries orb tries recursion halted soon subsets words encountered 
standard tries correspond tob subtrees stored buckets pages 
framework developed applies verbatim indicate brie corresponding 
corollary 
bucket tries height obeys double exponential law lim sup exp expected value satis es hn log logn size de ned number internal nodes tree mean bh various types path lengths de ned similarly analysed average random branch tree depth logn ano term modi es corresponding estimate standard tries 
noted parameters governing distribution height change radically estimate size shows pages tend capacity average ab trie behaves way quantitatively similar perfect packing pages 
preliminary investigations suggest theory may applicable su trees despite di culties due correlations inherently structure see treatment classical models 
globally wemay regard standard trie height known moments distribution characterized 
leave open problem interest question 
analysis height hybrid tries list tries bst tries height de ned length maximal chain pointers connecting root external node 
probabilistic methods problem amounts determining balance long branches trie large collections long branches inside structured nodes 
additive parameters general source models little distributional information available moment standard tries 
set open problems 
dynamical sources tries concentration distribution certainly holds size path length 
equivalent standard deviation order strictly smaller mean 
needs establish exact cancellation main asymptotic orders squared mean moment order 
study interesting standard trie uniform bernoulli model collaborators discovered surprising connections variance estimations modular form identities 
limit distribution gaussian type size path length hold subcases 
conjecture suggested hard analytical results jacquet szpankowski classical source models see book account aspects 
feeling moment limit laws dependent deep conjectures eigenvalues perturbations equation form 
continued fraction case riemann hypothesis lies immediately surface 
limit distribution search cost random item standard hybrid tries probably gaussian cases 
property isknown biased memoryless models hold unbiased model 
question enables conclude optimistic note problem somewhat tractable reduces analysis mean number nodes level random tree 

supported part long term research project alcom european union 
allen munro self organizing binary search trees 
journal acm oct 
bedford keane series ergodic theory symbolic dynamics hyperbolic spaces 
oxford university press 
bentley sedgewick fast algorithms sorting searching strings 
eighth annual acm siam symposium discrete algorithms january siam press pp 

new orleans 
quantum maps transfer operators 
physica 
burge analysis binary search trees formed sequences keys 
jacm july 
randomized binary searching tree structures 
communications acm mar 
cl ment flajolet vall analysis hybrid trie structures 
proceedings ninth annual acm siam symposium discrete algorithms philadelphia siam press pp 

cl ment zimmermann cient spell checker ternary search tries provisional title 
research report institut national de recherche en informatique en automatique 
preparation 
flajolet vall average case analysis gaussian algorithm lattice reduction 
combinatorics probability computing 
de bruijn asymptotic methods analysis 
dover 
reprint third north holland edition rst edition 
devroye probabilistic analysis height tries complexity 
acta informatica 
efrat dynamics continued fraction map spectral theory sl 
mathematicae 
cl ment flajolet vall fagin nievergelt pippenger strong extendible hashing fast access method dynamic les 
transactions database systems 
faivre distribution vy constants quadratic numbers 
acta 
flajolet functional equation arising analysis protocol multi channel 
adv 
appl 
prob 
flajolet performance evaluation extendible hashing trie searching 
acta inf 

flajolet birthday paradox coupon collectors caching algorithms self organizing search 
discrete applied mathematics 
flajolet dumas mellin transforms asymptotics harmonic sums 
theoretical computer science june 
flajolet puech partial match retrieval multidimensional data 
journal acm 
flajolet steyaert 
branching process arising dynamic hashing trie searching polynomial factorization 
automata languages programming nielsen schmidt eds vol 
lecture notes computer science springer verlag pp 

proceedings th icalp colloquium aarhus denmark july 
flajolet vall continued fraction algorithms functional operators structure constants 
theoretical computer science 
gonnet baeza yates handbook algorithms data structures pascal second ed 
addison wesley 
grothendieck nucl aires 
memoirs american mathematical society 
providence 
grothendieck la th orie de 
bulletin de la soci math de france 
jacquet trie partitioning process limiting distributions 
caap ed vol 
lecture notes computer science pp 

proceedings th colloquium trees algebra programming nice france march 
jacquet szpankowski analysis digital tries markovian dependency 
ieee transactions information theory 
jacquet szpankowski autocorrelation words applications analysis su trees string ruler approach 
journal combinatorial theory 
series 
jacquet szpankowski asymptotic behavior lempel ziv parsing scheme digital search trees 
theoretical computer science 
jacquet szpankowski analytical de applications 
theoretical computer science 
kato perturbation theory linear operators 
springer verlag 
eine anwendung der theorie der der informatik 
der akademie der wissenschaften 
applications formul ramanujan analysis algorithms 

szpankowski analysis splitting process arising probabilistic counting related algorithms 
random structures algorithms 
knuth art computer programming third ed vol 
vol 
sorting searching 
addison wesley 
positive solutions operator equations 
groningen 
larson dynamic hashing 
bit 
lind marcus symbolic dynamics coding 
cambridge university press cambridge 
combinatorics words vol 
encyclopedia mathematics applications 
addison wesley 
evolution random search trees 
john wiley new york 
mayer private communication 
mayer spectral properties certain composition operators arising statistical mechanics 
commun 
math 
phys 

mayer composition operators banach spaces holomorphic functions 
journal functional analysis 
dynamical sources tries paths random digital tree limiting distributions 
advances applied probability 
complex ruelle perron frobenius theorem counterexamples 

th 
dynam 
syst 
combinatorics geometrically distributed random variables left right maxima 
discrete mathematics 
average height trees digital search dynamic hashing 
information processing letters 
rivest partial match retrieval algorithms 
siam journal computing 
ruelle thermodynamic formalism 
addison wesley 
ruelle dynamical zeta functions piecewise monotone maps interval vol 
crm monograph series 
american mathematical society providence 
schwartz composition operators phd thesis univ toledo 
sedgewick algorithms fundamentals data structures sorting searching third ed 
addison wesley reading mass 
shapiro compact composition operators spaces boundary regular holomorphic functions 
proceedings ams vol 
pp 

shapiro taylor compact nuclear hilbert schmidt composition operators indiana univ math 

szpankowski results ary asymmetric tries 
journal algorithms 
szpankowski height digital trees related problems 
algorithmica 
heath brown theory riemann zeta function second ed 
oxford science publications 
pardo set representation set intersection 
tech 
rep stanford university 
vall algorithms computing signs determinants dynamics average case analysis 
algorithms esa burkhard ed lecture notes computer science pp 

proceedings fifth european symposium algorithms graz september 
vall op de ruelle mayer analyse des algorithmes de gauss 
acta 
vall dynamics binary euclidean algorithm functional analysis operators 
algorithmica 
vall dynamical sources information theory fundamental intervals words pre xes 
technical report university les cahiers du 
submitted 
vall lem average case analyses algorithms computing jacobi symbol 
rapport de recherche de universit de les cahiers du 
submitted 
yao 
note analysis extendible hashing 
information processing letters 
unite inria lorraine ole de nancy campus scienti que rue du jardin bp les nancy unite inria rennes irisa campus universitaire de beaulieu rennes cedex unite inria rh alpes avenue de europe montbonnot st martin unite inria rocquencourt domaine de voluceau rocquencourt bp le chesnay cedex unite inria sophia antipolis route des lucioles bp sophia antipolis cedex inria domaine de voluceau rocquencourt bp le chesnay cedex france www inria fr issn 
