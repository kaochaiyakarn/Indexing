mitsubishi electric research laboratories www merl com constructing free energy approximations generalized belief propagation algorithms jonathan yedidia william freeman yair weiss tr may important inference problems statistical physics computer vision error correcting coding theory artificial intelligence reformulated computation marginal probabilities factor graphs 
belief propagation bp algorithm efficient way solve problems exact factor graph tree approximate factor graph cycles 
show bp fixed points correspond stationary points bethe approximation free energy factor graph 
explain obtain regionbased free energy approximations improve bethe approximation corresponding generalized belief propagation gbp algorithms 
emphasize conditions free energy approximation satisfy order valid maxent normal approximation 
describe relationship different methods generate valid approximations bethe method junction graph method cluster variation method region graph method explain tell region approximation corresponding gbp algorithm accurate describe empirical results showing gbp significantly outperform bp 
may copied reproduced part commercial purpose 
permission copy part payment fee granted nonprofit educational research purposes provided partial copies include notice copying permission mitsubishi electric research laboratories acknowledgment authors individual contributions applicable portions copyright notice 
copying reproduction republishing purpose shall require license payment fee mitsubishi electric research laboratories rights reserved 
copyright mitsubishi electric research laboratories broadway cambridge massachusetts substantially revised version merl tr 
posted may 
revised version march published ieee transactions information theory vol 
july pp 

constructing free energy approximations generalized belief propagation algorithms jonathan yedidia william freeman yair weiss important inference problems statistical physics computer vision error correcting coding theory artificial intelligence reformulated computation marginal probabilities factor graphs 
belief propagation bp algorithm efficient way solve problems exact factor graph tree approximate factor graph cycles 
show bp fixed points correspond stationary points bethe approximation free energy factor graph 
explain obtain region free energy approximations improve bethe approximation corresponding generalized belief propagation gbp algorithms 
emphasize conditions free energy approximation satisfy order valid maxent normal approximation 
describe relationship different methods generate valid approximations bethe method junction graph method cluster variation method region graph method explain tell region approximation corresponding gbp algorithm accurate describe empirical results showing gbp significantly outperform bp 
index terms belief propagation bethe free energy cluster variation method generalized belief propagation kikuchi free energy message passing sum product algorithm 
problems involving probabilistic inference graphical models important wide variety disciplines including statistical physics signal processing artificial intelligence digital communications 
message passing algorithms practical powerful way solve problems 
centrality problems utility message passing algorithms solving explanation fact equivalent closely related message passing algorithms independently invented times 
known names forward backward algorithm hidden markov models viterbi algorithm gallager sum product algorithm decoding low density parity check codes turbo decoding algorithm pearl belief propagation algorithm inference bayesian networks kalman filter signal processing transfer matrix approach statistical mechanics :10.1.1.131.2084:10.1.1.115.4360
merl cambridge research lab broadway th floor cambridge ma 
yedidia merl com computer science artificial intelligence laboratory stata center cambridge ma 
ai mit edu school computer science engineering hebrew university jerusalem jerusalem israel 
cs huji ac il 
yair weiss supported israeli binational science foundation 
list standard belief propagation bp algorithms blurred distinction different objectives slightly different algorithms result 
interested obtaining global state system probable optimal 
cases interested obtaining marginal probabilities subset nodes system evidence nodes system 
focus exclusively problem 
standard bp algorithms messages sent node graphical model neighboring node 
algorithms exact graphical model free cycles 
common approach dealing graphical models cycles try convert equivalent cycle free graphical models standard bp algorithm 
cases possible cases practical interest approach intractable settle approximate methods 
fortunately standard bp algorithms defined give surprisingly approximate results graphical models cycles 
cases guarantees results quite poor algorithm fails give result converge 
major goals explain standard bp algorithm works graphical models cycles understanding develop improved algorithms cases 
class algorithms describe call generalized belief propagation gbp algorithms characteristic sets regions nodes send messages regions nodes 
regions nodes communicate easily visualized terms region graph 
standard bp algorithm special case gbp algorithm particular choice regions 
different choices region graphs give different gbp algorithms user choose trade complexity accuracy 
practice gbp algorithms dramatically outperform bp algorithms terms accuracy convergence properties minimal computational cost intelligent choice regions 
optimally choose regions gbp algorithm remains point open research problem 
hope contributes problem delineating classes constructions give results 
shall give theoretical justification gbp algorithms showing fixed points identical stationary points region free energy approxima tion free energy justified rigorous variational principle 
specialized examples free energies introduced long ago physics literature bethe kikuchi 
important special case standard bp algorithm show fixed points stationary points bethe free energy establishing important basic link classical algorithm classical approximation physics 
careful constructing region graph order ensure resulting approximations accurate 
original introducing gbp algorithms focused sub class gbp algorithms equivalent free energy approximations kikuchi cluster variation method 
shall show method variety methods generate region graphs corresponding free energies message passing algorithms 
original focused graphical models defined terms pair wise higher order markov random fields mrfs 
shall focus graphical models defined terms factor graphs 
results re expressed graphical models difficulty 
factor graphs certain practical advantages particular refer reader excellent review kschischang :10.1.1.54.1570
review explains equivalence factor graphs graphical models bayesian networks tanner graphs errorcorrecting codes pair wise mrfs explains standard bp algorithm various guises algorithm operates factor graphs 
number papers tried explain reformulate generalize standard belief propagation algorithm variety ways 
point interested reader 
original introduced region free energies gbp algorithms cluster variation method works appeared explored parallel ideas 
fact goals unify previous approach aji mceliece junction graphs 
recommend elegant exposition generalized belief propagation mceliece 
previously released number technical reports largely superseded somewhat popular 
outline rest follows 
section ii review introduce notation factor graphs standard bp algorithm 
sections iii iv introduce explain physical intuition variational free energies region approximations 
section consider bethe method obtain particularly simple region free energy approximations 
section vi show standard bp algorithm fixed points corresponding stationary points bethe approximation free energy 
section vii describe region graph method general method generating valid region graphs associated free energies 
section viii explain determine particular region free energy approximation give accurate answers 
section ix introduce gbp algorithms show variety ways define gbp algorithms region graph identical fixed points 
focus particular type gbp algorithm call parent child algorithm 
section give detailed example implementation parent child gbp algorithm 
section xi give empirical results showing gbp algorithms improve accuracy standard bp 
chosen put large amount material appendices 
appendices describe variety methods generate region graphs gbp algorithms easily prove important practice methods described main text 
ii 
factor graphs belief propagation xn set discrete valued random variables xi represent possible realizations random variable xi 
consider joint probability mass function xn xn shall write stands xn 
suppose factors product functions 
suppose general form fa xa 
index labeling functions fa fb fc fm function fa xa arguments xa subset xn 
assume functions fa xa non negative finite welldefined probability distribution 
normalization constant 
factor graph bipartite graph expresses factorization structure equation :10.1.1.54.1570
factor graph variable node draw circle variable xi factor node draw square function fa edge connecting variable node factor node xi argument fa 
shall index variable nodes letters starting factor nodes letters starting 
example factor graph corresponding fa fb fc shown 
shall focus problem computing marginal probability distributions 
call possible values xi states variable node qi denote number possible states variable node set variable nodes xs denote states corresponding variable nodes 
ps xs denote marginal probability function obtained marginalizing set variable nodes ps xs 
xs fig 

small factor graph representing joint probability distribution fa fb fc 
sum xs indicates sum states variable nodes set shall write pi xi marginal probability function set consists single node belief propagation bp algorithm method computing marginal probability functions 
note problem computing marginal probability functions general hard require summing exponentially large number terms 
describe bp algorithm terms operations factor graph 
mentioned computed marginal probability functions exact factor graph cycles bp algorithm defined empirically gives approximate answers factor graph cycles 
define bp algorithm introduce messages variable nodes neighboring factor nodes vice versa 
message ma xi factor node variable node vector possible states xi 
message interpreted statement factor node variable node relative probabilities different states function fa 
message ni xi variable node factor node may turn interpreted statement relative probabilities node different states information node function fa 
messages updated rules ni xi mc xi 
ma xi xa xi fa xa nj xj denotes nodes neighbors node node denotes sum xa xi variables xa arguments fa xi 
standard bp algorithm called sum product algorithm sum product occurs right hand side equation 
messages usually initialized ma xi ni xi factor nodes variable nodes states xi 
fact initializations possible normalization messages chosen arbitrarily 
important normalization condition beliefs introduced sum order properly represent probabilities 
messages initialized positive implies nonnegativity factors message update rules messages remain non negative iteration 
message update rules may initially appear quite mysterious major goal explain justify ultimately improve 
complete preliminary description standard bp algorithm introduce belief bi xi variable node bp approximation exact marginal probability function pi xi 
belief bi xi computed equation bi xi ma xi proportionality symbol indicate normalize beliefs sum 
bp message update equations iterated hopefully converge point beliefs read equation 
bp algorithm compute joint beliefs bs xs sets variable nodes may contain node 
consider important case set consists variable nodes attached ath function fa xa 
denote corresponding belief ba xa bp approximation ba xa fa xa ni xi fa xa mc xi 
xi xi xi fig 

illustrates message update rules derived belief equations marginalization conditions 
node belief node upper left equal multi node belief nodes including case node belief upper right marginalized nodes denote marginalization hatched pattern marginalized variable node 
cancel equivalent messages sides equation obtain message update rules lower 
directly derive message update rules belief equations marginalization condition bi xi ba xa xa xi holds xi arguments set xa 
belief equations considered define bp algorithm point view prove useful 
explain point detail diagrams show message update rules follow belief equations marginalization conditions 
bp algorithm normally justified exact algorithm factor graph cycles topology tree 
shall prove property simply give small example consider joint probability distribution equation illustrated 
suppose compute marginal probability distribution variable node 
repeatedly bp equations find ma fa fa mb fa fb fa fb mc fa fb fc exactly desired marginal probability function 
similarly demonstrate equation give exact multi node marginal probabilities graphs cycles 
see example graphs cycles bp algorithm essentially dynamic programming algorithm organizes computations necessary compute marginal probability distributions way tractable 
bp algorithm introduced coding literature gallager sub optimal probabilistic decoding algorithm linear block error correcting codes readers may familiar bp algorithm context 
pearl introduced popularized version algorithm widely adopted terminology belief propagation context problem probabilistic inference bayesian networks 
readers familiar bp algorithm written forms may want consult review kschischang explains equivalence forms bp algorithm chosen :10.1.1.54.1570
iii 
free energies section turn simply describing bp algorithm explaining success 
section ii saw bp algorithm defined terms belief equations 
shall eventually show belief equations correspond stationarity conditions function beliefs called bethe free energy bi ba 
fact serves sense justify bp algorithm factor graph operates cycles minimizing bethe free energy sensible approximation procedure long successful history physics 
points variety ways improve generalize bp especially improving approximations bethe free energy 
rest discuss issues turn explanation notion free energy 
suppose system particles discrete number states states ith particle labeled xi 
example variety simplifications characterize states atoms magnetic crystal electron atom spin spin 
state system denoted vector xn 
state system corresponding energy 
fundamental result statistical mechanics thermal equilibrium probability state boltzmann law 
temperature simply normalization constant known partition function space possible states system 
substantial part statistical mechanics theory devoted justification boltzmann law 
hand begins joint probability distribution non physical system view boltzmann law postulate serves define energy system temperature set arbitrarily simply sets scale units measures energy 
shall take point view set rest 
case factor graph probability distribution function fa xa define energy state ln fa xa order consistent boltzmann law 
note factors fa xa equal zero particular configurations xa probability states contain forbidden configurations zero 
corresponding energy states containing forbidden configurations infinite 
particularly important class factors forbidden configurations deterministic functions exclusive functions example defining error correcting codes 
helmholtz free energy fh system fh ln 
free energy fundamentally important quantity statistical mechanics calculate functional dependence fh quantities macroscopic magnetic field temperature easy compute experimentally measurable quantities response system change physicists devoted considerable energy developing techniques give approximations fh 
important technique variational approach 
suppose true probability distribution system obeys boltzmann law may know exactly form computation fh difficult 
introduce trial probability distribution course normalized obey corresponding variational free energy quantity called gibbs free energy defined 
variational average energy variational entropy ln 
note measure entropy natural logarithm base logarithm order consistent physics literature 
follows directly definitions fh ln kullback leibler divergence 
exists theorem theorem non negative zero see fh equality precisely 
minimizing variational free energy respect trial probability functions exact procedure computing fh recovering 
course large procedure totally intractable take exponentially large memory just store 
practical possibility upper bound fh minimizing restricted class probability distributions 
basic idea underlying mean field approach 
popular mean field form factorized form bmf bi xi bi xi normalized trial probability function single variable bmf energy function factor graph form equation easily compute mean field free energy arbitrary factor graph bn bn ln fa xa xa bi xi bi xi ln bi xi 
minimizing bn bi give equations bi solved numerically obtain mean field approximation beliefs bi xi 
factorized form consider complicated forms lead tractable approximations 
idea structured approach 
follow path describe quite different approach approximating section underlies bp algorithm 
iv 
region free energy approximations kikuchi physicists developed called cluster variation method introduced class approximations variational free energy 
idea approximations similar slightly different mean field approximation 
factorized mean field free energy function single node beliefs bi xi kikuchi approximation approximate free energy fk function beliefs bs xs larger sets variable nodes 
drawback cluster variation method contrast mean field approach normally explicitly construct trial belief vector consistent multi node beliefs bs xs normally obtain upper bound 
hand approximations accurate factorized mean field approximation great deal flexibility exact choice approximation 
shall see detail approximations exploited yield messagepassing algorithms particularly simple version bethe approximation give results equivalent standard bp algorithm 
shall describe class approximations generalize generated cluster variation method described physics literature refer approximations region approximations 
refer sub class approximations specifically generated cluster variation method kikuchi approximations 
region approximations point essentially reviewed notions definitions developed 
shall define concepts appear previous literature mark break explicitly indicate important xi fig 

illustration definition region 
regions sets variable factor nodes factor graph variable nodes connected included factor nodes included 
sets nodes regions region factor node included variable nodes included 
new definitions theorems 
order aid reader distinguishing important results label theorems results lesser importance called propositions definition define region factor graph set vr variable nodes set ar factor nodes factor node belongs ar variable nodes neighboring vr 
give examples sets nodes considered regions 
note set ar may empty factor need included ar neighboring variable nodes vr 
define state xr region collective set variable node states xi vr 
marginal probability function region denoted pr xr mean marginalization variable nodes vr 
corresponding belief br xr approximation true pr xr 
definition define region energy er xr er xr ln fa xa 
ar note variable nodes neighboring factor node ar guaranteed region determine needed state xa state xr 
definitions region define region average energy ur br region entropy hr br region free energy fr br ur br br xr er xr xr hr br br xr ln br xr xr fr br ur br hr br 
intuitive idea region free energy approximation try break factor graph set large regions include factor variable node say free energy sum free energies regions 
course large regions overlap counting free energy contributed nodes times need subtract free energies overlap regions way factor variable node counted exactly 
notions precise 
definitions define region approximate entropy hr hr br br region average energy ur ur br br chosen set regions associated set counting numbers cr instantiate approximation 
define region free energy fr br ur br hr br 
note passing generalize approximations allowing different counting numbers average energy entropy 
fact constructing approximations starting regions bethe approximation modifying entropic counting numbers differ bethe approximation way deriving fractional belief propagation algorithm essentially equivalent bethe free energy approximation 
assume just set counting numbers 
fact region approximations variational free energy equally 
point introduce notion valid region approximation 
shall narrow focus sub set valid approximations call maxent normal region approximations 
definition say set regions counting numbers cr give valid region approximation factor node variable node factor graph set membership indicator function indicator function equal equal 
conditions ensure factor variable node counted exactly time approximation free energy 
factor variable node added free energy different regions region subtracted back 
position prove propositions help explain interest valid region approximations 
proposition exactness average energy beliefs br xr equal corresponding exact marginal probabilities pr xr average energy ur br br valid region approximation exact 
proof compare region average energy ur br br xr ln fa xa cr xr exact average energy ar pa xa ln fa xa xa note overcounting numbers cr guarantee factor counted exactly equation 
regionbased average energy linear beliefs br exact equation properly marginalize terms pa xa equation 
hand region entropy hr br br cr br xr ln br xr typically approximation beliefs br xr exactly equal true marginal probabilities 
condition variable node counted lets prove proposition says entropy counting total number degrees freedom correctly 
proposition correct counting degrees freedom true joint probability distribution equiprobable distribution possible states beliefs br xr equal corresponding exact marginal probabilities pr xr entropy valid regionbased approximation exact 
proof uniform joint probability distribution entropy just logarithm number possible configurations ln qi 
hand fact marginal probability region belief region uniform distribution region entropy hr cr ln qi 
xr vr counting numbers valid region approximation guarantee variable node counted exactly entropy reduces exact entropy 
propositions particularly proposition entropy may strong results provide justification focus valid regionbased approximations choices counting numbers satisfy validity conditions give exact results average energy entropy restricted conditions propositions 
constrained region free energies want find minimum regionbased free energy respect set region beliefs 
precisely try minimize region free energy respect region beliefs subject set constraints region beliefs 
definition define constrained region free energy entropy average energy approximate regionbased free energy entropy average energy subject constraints region beliefs 
region belief br xr form probability function normalize obey br xr state xr 
marginal region beliefs xs consistent pairs regions set variable nodes included regions 
shall see particular pairs regions demand consistency change approximation 
constrained region free energy minimized interested accuracy constrained region entropy near maximum 
course maximum true entropy occurs joint probability distribution uniform 
similar property hold constrained region entropies 
motivates definition 
definition say constrained region free energy approximation maxent normal valid corresponding constrained region entropy hr br achieves maximum beliefs br xr uniform 
shall see important classes region approximations including bethe approximation provably maxent normal 
hand possible kikuchi approximations example maxent normal 
emphasize region approximation maxent normal expected give results give wrong answers energy term 
go selecting set regions counting numbers cr consistency constraints factor graph give valid better maxent normal approximation 
fact infinite number ways 
section describe straightforward approach call bethe method guaranteed give maxent normal region approximation 
section vi prove broad terms precise fixed points standard bp algorithm correspond stationary points constrained bethe approximation free energy 
section vii introduce region graph method general approach constructing valid region approximations region graph 
region graphs play central role description region graph free energy construction corresponding gbp algorithms provide clear way visualizing understanding region approximation 
bethe method important special case general region graph method 
appendices discuss important methods special cases region graph method junction graph method cluster variation method 
appendix discuss detail relationship different methods 
fig 

factor graph illustrate variety region free energy approximations 
bethe method origins bethe method date back bethe famous approximation method magnets 
pioneered cluster variation method kikuchi recognized bethe approximation simplest example approximation generated method 
modern point view early papers focused special graphical models warn reader wants read original papers description bethe kikuchi methods bear little resemblance expositions 
small preliminary definition regions say sub region super region set variable factor nodes subset 
definition region approximation generated bethe method take set regions included types 
set large regions rl regions rl contain exactly factor node variable nodes neighboring factor node 
second set small regions rs regions rs contain single variable node 
counting numbers cr region cr set regions super regions take example factor graph shown factor nodes label variable nodes label 
cs example large regions rl small regions rs 
complete set regions included bethe approximation rl rs 
definition see region rl cr region rs cr di di degree number neighboring factor nodes variable node easy confirm bethe approximation valid approximation factor variable node clearly counted required equation 
expressions counting numbers cr obtain bethe approximation free energy entropy average energy 
definition bethe free energy bethe average energy ba xa ln fa xa xa bethe entropy ba xa ln ba xa xa di bi xi ln bi xi 
bethe free energy justified physics literature version proposition states exact factor graph cycles 
proposition exact variational free energy equal bethe free energy factor graph cycles 
proof exact average energy reduces bethe average energy argument proposition 
bethe entropy exact factor graph cycles case exact formula xi pa xa pi xi di substitute formula variational entropy recover 
bethe free energy entropy average energy functions beliefs bi xi ba xa 
constrained bethe free energy defined enforcing beliefs obey normalization constraints bi xi ba xa xi xa consistency constraints ba xa bi xi xa xi inequality constraints bi xi ba xa 
definition refer bethe free energy subject constraints beliefs constrained bethe free energy similarly constrained bethe entropy constrained bethe average energy 
prove bethe method gives maxent normal region approximations 
theorem bethe approximations maxent normal 
global maximum constrained bethe entropy achieved beliefs bi xi ba xa uniform 
proof rewrite bethe entropy bi ba bi bi xi ln bi xi ba ba xa ln ba xa xa xi bi maximum bi subject constraints bi xi achieved bi xi uniform distribution 
mutual information ba greater equal zero equals zero beliefs involved uniform distributions see theorem 
bi achieves maximum ba achieves minimum beliefs uniform theorem proved 
simple corollary theorem proposition constrained bethe entropy exact maximum 
point wish re emphasize free energies obtained region approach approximations true variational free energy particular entropy obtained incorrect 
give rise problems illustrated simple factor graphs bethe approximation 
unrealizability beliefs constrained bethe free energy may minimized set beliefs ba xa bi xi marginals global probability function 
simple example pointed consists factor graph binary variable nodes pair nodes connected factor node 
take factor connecting nodes fa factor connecting nodes fb factor connecting nodes fc 
note factor connecting nodes factor connecting nodes prefer connected variables state factor connecting nodes prefers different states 
factors satisfied simultaneously simple example statistical physicists call frustrated system 
beliefs ba xa bi xi minimize constrained bethe free energy model ba bb bc 
problem beliefs ones obtained stable fixed points bp update equations messages equal ma xi expect theorems prove 
prove set beliefs obtained marginals node belief 
wainwright jordan emphasized problem proposed new variational inference techniques closely related region approximations differentiated requirement set beliefs marginals global belief 
call set beliefs realizable global belief marginal polytope negative entropies terms bethe entropy sign flipped normal form entropy factor graphs possible find sets beliefs satisfy constraints bethe entropy negative 
course true entropy negative global probability distribution 
example consider factor graph binary variable nodes pairs nodes connected factor 
pairs nodes single nodes 
large region assigned counting number small region containing single variable node assigned overcounting number bethe approximation 
consider set beliefs satisfy constraints pairs ba xi xj bi xi find pair nodes contributes ln bethe entropy single node contributes ln total bethe entropy set beliefs ln ln 
example possible construct set factors set beliefs local minimum constrained bethe free energy 
generally conjecture bethe entropy fact non negative local minima constrained bethe free energy 
notice example factors form fa xi xj beliefs equal corresponding exact marginal probabilities correct beliefs give negative bethe entropy 
minimum bethe free energy occur beliefs form pairs ba xi xj bi xi set obtained favoring second state beliefs give non negative zero bethe entropy 
vi 
correspondence bethe approximation standard bp logic region free energy approximations tells ultimately minimize constrained bethe free energy 
establish nature connection minima generally stationary points constrained bethe free energy fixed points bp algorithm 
exploit lagrange multiplier theory identify stationary points functions subject linear equality inequality constraints 
review lagrangian formalism briefly review necessary background lagrangian formalism constrained optimization 
excellent textbook containing information 
consider function xn variables xi variables may subject equality constraint written hj xn inequality constraint written gk xn 
assume equality inequality constraints linear xi constraints deal form constraints straightforward prove existence lagrange multipliers see proposition 
inequality constraint said active satisfied equality inactive 
point xn said edge point inequality constraints active interior point 
point xn local interior minimum interior point variation away point direction satisfies equality constraints increase value function 
local interior maxima similarly defined drop modifier local presume maxima minima local explicitly specified 
interior stationary point interior point gradient zero direction variations satisfy equality constraints 
course stationary points may minima maxima saddle points depending second derivatives function 
edge point inequality constraints active 
edge maintaining variation variation keeps active inequality constraints active satisfying equality constraints 
point edge stationary point edge point gradient zero direction edge maintaining variations 
note edge stationary point may gradients equal zero direction allowed variations edge maintaining 
edge stationary points may minima maxima 
lagrangian formalism recover constrained stationary points interior edge stationary points 
review works 
lagrange multipliers constructed corresponding equality constraints hj xn lagrange multipliers constructed corresponding inequality constraints gk xn 
defines lagrangian jhj kgk 
obtains set conditions constrained stationary points call lagrangian stationary point conditions setting equal zero derivative respect xi imposing called complementary slackness conditions enforce kgk 
complementary slackness conditions enforce inequality constraint active constrained stationary point corresponding lagrange multiplier zero 
solutions lagrangian stationary point conditions correspond interior edge stationary points interior edge stationary points correspond solutions lagrangian stationary point conditions 
application constrained bethe free energy apply lagrangian formalism constrained bethe free energy 
theorem interior stationary points constrained bethe free energy bp fixed points positive beliefs vice versa 
proof idea proof show lagrangian stationary point conditions hold interior stationary points constrained bethe free energy bp message update rules bp fixed points 
assuming interior stationary point constrained bethe free energy showing bp fixed point positive beliefs prove theorem opposite direction 
note omit consideration small regions consisting single variable node connected single factor node degree di 
regions counting number zero means contribute bethe free energy 
beliefs bi xi variable nodes arguments lagrangian bp fixed point equations ultimately derive 
need enforce normalization constraints xa ba xa factor node xi bi xi variable node degree di marginalization constraints xa xi ba xa bi xi factor node neighboring variable nodes degree di inequality constraints ba xa factor node sufficient set constraints constraints bi xi derived ones enforced 
form lagrange multipliers constraints lagrange multipliers ai xi marginalization constraints lagrange multipliers xa inequality constraints 
lagrange multipliers necessarily exist equality inequality constraints linear beliefs see proposition 
fact theorem assuming interior stationary point inequality constraints inactive xa equal zero ignore 
construct lagrangian form ba xa bi xi xa xi xi ai xi bi xi xa xi ba xa 
sum extends variable nodes degree di 
setting derivatives lagrangian respect lagrange multipliers equal zero gives back equality constraints 
setting derivatives lagrangian respect beliefs equal zero gives equations beliefs stationary points ba xa fa xa exp ai xi bi xi exp di identification ai xi ln ni xi ln ai xi 
mc xi find recover standard bp fixed point belief equations ba xa fa xa mc xi bi xi ma xi marginalization normalization constraints obtained give back fixed point equations bp algorithm 
note missing belief equations single variable nodes connected single factor node equations necessary bp algorithm case 
variable nodes dead ends messages beliefs computed beliefs ba xa factor node connected 
prove theorem reverse direction start bp belief update equations fixed point marginalization normalization constraints 
invert equation obtain ma xi exp di di ai xi ci xi di replacing messages bp update equations lagrange multipliers reverse derivation proof previous theorem obtain lagrangian stationary point conditions interior stationary point constrained bethe free energy 
factor graphs containing soft factors necessarily case beliefs positive bp fixed point 
large classes factor graphs true factor graphs contain soft factors definition say factor fa xa soft factor fa xa strictly positive xa 
fa xa xa call hard constraint helps prove variety interesting results assume time factors factor graphs soft returning consider factor graphs contain hard constraints 
proposition factors fa xa factor graph soft beliefs bp fixed points positive 
proof denote beliefs messages hold bp fixed point ba xa bi xi xi show bp fixed point beliefs ba xa positive marginalization conditions show beliefs bi xi positive 
fixed point belief update equations ba xa fa xa xi sees assumption factors fa xa messages xi positive beliefs ba xa 
messages xi obey fixed point message equations xi mc xi 
tells positive messages ma xi positive 
messages ma xi obey update rules ma xi xa xi fa xa xj 
recall assumed messages initialized non negative bp algorithm implies remain non negative 
assume loss generality messages xj nonnegative normalized sum function possible states xj positive negative 
assumption factors positive form equation implies messages ma xi positive proposition proved 
proposition combined theorem gives easy corollary 
proposition factors fa xa soft bp fixed points interior stationary points constrained bethe free energy 
prove proposition proposition factors fa xa soft local minima constrained bethe free energy interior minima 
proof wish show factors soft decrease bethe free energy configuration beliefs ba xa bi xi contains zero beliefs replacing zero beliefs small positive beliefs satisfying constraints beliefs 
simplicity give examples clarify proof binary variable nodes large regions contain variable nodes examples easily extended fully general case 
assume node beliefs bi xi positive zero beliefs ba xa 
zero beliefs replaced small positive beliefs way node beliefs unchanged 
example set beliefs ba xi xj positive constants keep beliefs unchanged replace belief ba xi xj 
doing possibly gain average energy gain entropy ln free energy decrease small 
note factors fa xa gain infinite average energy proof break point 
suppose bi xi zero 
suppose loss generality node culprit belief 
course larger regions contained node beliefs contain zeros form ba xj node culprit beliefs form ba xj 
increase bethe entropy amount ln adjust belief adjusting beliefs connected large regions ba xj ba xj 
point adjustment gives negative contribution bethe entropy node terms give larger positive contribution bethe entropy large region terms 
guaranteed fact sum counting number culprit node region plus sum counting numbers relevant larger regions 
adjustments systematically remove zeros collections beliefs started decreasing constrained bethe free energy 
theorem proposition combined give theorem factors fa xa soft local minima constrained bethe free energy bp fixed points 
shown assuming soft factors interior stationary points local minima constrained bethe free energy bp fixed points note easy construct edge maxima constrained bethe free energy bp fixed points 
example consider factor graph tree constant soft factors weight local configurations equally set beliefs consistent single configuration variable node completely biased states 
local maximum bethe free energy certainly bp fixed point 
prove bp fixed point exist factor graph soft factors 
theorem factors fa xa soft bp fixed point exists 
proof constrained bethe free energy bounded 
true factors fa xa nonnegative average energy bounded entropy clearly diverge positive infinity 
fact constrained bethe free energy bounded means global minimum theorem know global minimum bp fixed point 
course existence bp fixed point imply bp algorithm converge starting arbitrary initial conditions 
conditions uniqueness bp fixed points clarified equivalence bethe approximation 
graphs single cycle known factors soft unique bp fixed point 
general graphs equivalence established show factor graph may unique bp fixed point times bp fixed point depending strength interactions fa xa 
precise imagine defining sequence probability distributions original functions raised power fa xa fa xa equivalent changing temperature physical system 
systems example ising different numbers solutions critical temperature tc bethe approximation 
tc constrained bethe free energy unique stationary point tc multiple stationary points 
equivalence easy define small factor graphs show similar behavior 
topology change factors soft smoothly change factors go regime unique fixed point multiple fixed points 
explicit example consider factor graph containing binary variable nodes pair variable nodes connected factor node shown 
assume factors connecting variable nodes identical form fa xi xj exp exp exp exp temperature parameter 
factors effect making neighboring variable nodes prefer binary state effect stronger lower symmetry example sense search fixed points bp message update rules messages identical 
relatively straightforward see analysis bethe approximation fig 

factor graph variable nodes connected factor node variable nodes 
similar computation critical temperature tc ln solution solution gives variable nodes equal beliefs states 
tc fixed point stable tc unstable new stable fixed points appear 
new fixed points variable nodes identical beliefs fixed points beliefs biased binary state fixed point beliefs biased second binary state 
jordan explored question uniqueness bp fixed points detail 
connection bethe free energy obtain set sufficient conditions strength factors fa xa ensure unique bp fixed points arbitrary markov random fields 
heskes analyzed question connection bethe free energy sufficient conditions uniqueness take consideration topology factor graph 
shown standard bp converges stationary points constrained bethe free energy emphasize bp perform constrained minimization bethe free energy decrease constrained bethe free energy iteration 
marginalization constraints typically satisfied intermediate iterations bp bp fixed point beliefs necessarily obey consistency constraints 
correspondence bp fixed points ane bethe free energy stationary points noted earlier devised algorithms directly minimize free energy feasible set beliefs 
free energy minimizations somewhat slower bp algorithm guaranteed converge 
factor graphs containing hard constraints return consider general situation factor graphs contain hard constraints 
hard constraints example factor graph representations parity check codes 
contrast situation factors soft hard constraints possible local minima constrained bethe free energy edge minima possible beliefs bp fixed points zero 
give small example illustrate statements 
consider factor graph binary variable nodes factors connect pair variable nodes see 
assume factors hard parity checks variables form fa xi xj 
factor graph unstable bp fixed point messages node beliefs ma xi bi xi node beliefs ba xi xj 
stable bp fixed points messages beliefs ma xi bi xi ba xi xj messages beliefs ma xi bi xi ba xi xj 
point view constrained bethe free energy set beliefs satisfy marginalization normalization constraints infinite bethe average energy beliefs form ba xi xj bi xi constant beliefs 
factor graph considering sets beliefs give bethe average energy zero bethe entropy maximized minimized 
example guess correspondence bethe free energy edge minima bp fixed points zero beliefs 
believe argue correspondence exists 
unfortunately technical issues arguments correspondence completely rigorous 
issue results fact uses lagrangian formalism identify edge stationary points constrained bethe free energy lagrange multipliers diverge logarithmically edge points 
see phenomenon exist form equation relates marginalization lagrange multipliers logarithm bp messages 
bp message zero edge point corresponding lagrange multiplier diverges logarithmically 
trivial example demonstrates inescapable issue clear issue arises derivative entropy function diverges logarithmically edges 
consider single binary variable factor 
denote belief variable states free energy just ln ln equality constraint inequality constraint 
minimum free energy obviously occurs ln maxima occur edge region allowed beliefs 
free energy maxima zero 
recover results lagrangian formalism introduce lagrange multiplier enforce normalization equality constraint lagrange multipliers inequality constraints 
lagrangian ln ln 
derivatives lagrangian respect imposing complementary slackness conditions find lagrangian stationary point conditions ln ln equations solution completely ln corresponding free energy interior minimum 
solutions corresponding free energy edge maxima accepts lagrange multipliers logarithmically divergent 
solution ln solution ln 
note complementary slackness conditions ibi satisfied assume ln 
lessons simple example assume legitimacy logarithmically divergent lagrange multipliers identifying edge stationary points 
readers willing accept lagrange multipliers upgrade status conjecture theorem conjecture bp fixed points beliefs equal zero edge stationary points constrained bethe free energy 
argument need show bp fixed point conditions rewritten way guarantees lagrangian stationary point conditions satisfied including resulting inequality constraints 
inequality lagrange multipliers xa enforce inequality constraints ba xa 
complementary slackness conditions need satisfied xa ba xa 
lagrangian stationary conditions need satisfied marginalization normalization conditions beliefs belief equations ba xa fa xa exp xa ai xi variable nodes degree di bi xi exp di ai xi 
starting bp fixed point conditions making identification messages marginalization lagrange multipliers ai xi ln ni xi ln mc xi recover lagrangian stationary conditions xa consistent complementary slackness conditions 
note marginalization lagrange multipliers corresponding zero messages logarithmically divergent 
assuming lagrange multipliers legitimate shown bp fixed points beliefs equal zero stationary points constrained bethe free energy 
emphasize converse conjecture certainly hold described previously edge maxima constrained bethe free energy need bp fixed points 
hand argue edge minima constrained bethe free energy bp fixed points 
claim argument proof time argument depends continuity arguments reasonable questioned 
conjecture edge minima constrained bethe free energy bp fixed points 
argument recall proposition factors fa xa positive local minima constrained bethe free energy necessarily interior minima 
means edge minima necessarily result factor graph includes factors fa xa equal zero state arguments xa 
consider transformation factor graph adds positive term zero factor 
expect edge minima mapped transformation interior minima far away 
theorem minima correspond bp fixed points beliefs positive 
making inverse transformation back factor graph hard constraints expect bp fixed points mapped bp fixed points beliefs equal zero 
assuming continuity expectations met original edge minima constrained bethe free energy bp fixed points 
complete general picture relation bp fixed points stationary points constrained bethe free energy refer reader heskes argues stable bp fixed points local minima constrained bethe free energy gives counterexample shows converse true 
vii 
region graph method introduce region graphs central region graph method generating valid free energy approximations provide graphical framework gbp algorithms 
focus generating valid free energy approximations turn attention section question region graph free energy approximation maxent normal 
possible construct valid maxent normal free energy approximations correspond region graph 
region graph method virtue generalizing methods including bethe method junction graph method cluster variation method 
appendices discuss junction graph method cluster variation method detail 
appendix fully describe relationship different methods considered 
definitions set indices factor variable nodes factor graph 
region graph labeled directed graph vertex corresponding region labeled subset denote label vertex directed edge arc may exist pointing vertex vp vertex vc vc subset vp 
arc exists say vc child vp vp parent vc 
exists directed path vertex va vertex vd say va ancestor vd vd descendant va note transitivity subset relationship region graph directed acyclic graph sense arrows loop 
region graph closely related hasse diagram partially ordered set poset consider regions organized poset ordering relationship regions relationship 
differences region graphs hasse diagrams 
region graphs labeled graphs insist region graph conditions described labels satisfy 
second region graphs include arc regions connected path length greater forbidden hasse diagrams 
definitions counting number cv vertex region graph cv cu set vertices ancestors graph qualify region graph insist region graph condition requires index factor node variable node subgraph formed just vertices labels include connected graph satisfies condition cv 
having defined region graphs trivial define corresponding region graph method generating valid region free energy approximations 
simply create region graph vertices correspond regions labels corresponding factor variable nodes region require factor variable node contained region 
associate counting numbers cr regions directly counting numbers cv region graph region graph free energy frg frg fr free energy region obtain constrained region graph free energy enforce constraints region belief normalized pair regions connected arc region graph beliefs variable nodes regions consistent 
definitions proposition true inspection proposition region free energy approximations created region graph method valid 
fig 

example region graph 
listed counting number cr region 
give example region graph factor graph introduced 
region graph constructed demonstrate permitted legal region graph give results 
note region graph enforce clear delineation generations region child regions regions region grand child region child region 
note regions may counting number equal zero region fact region sub set region need imply descendant region regions 
essential region graph conditions described obeyed 
insist conditions reasons 
reiterate results propositions previously proved valid region free energy approximations condition factor node factor graph counted weighted sum regions ensures region graph average energy exact region beliefs exact recall proposition condition variable node counted ensures region graph entropy correctly counts degrees freedom recall proposition 
condition regions containing particular variable node form connected subgraph ensure marginal probability node consistent irrespective region beliefs uses compute 
empirically attempts run gbp algorithm described graphs satisfy region graph conditions results poor 
fig 

example graph regions region graph sum counting numbers regions containing variable node 
example false region graph graph regions satisfy region graph conditions shown 
problem plausible looking construction sum counting numbers regions containing variable node zero 
modify false region graph variety ways obtain real region graph 
example simply remove node region 
resulting region graph example junction graph see appendix alternatively add region just contained variable node connect regions result cluster variation method see appendix 
generalize proposition states bethe free energy exact factor graph cycles proposition region graphs proposition exact variational free energy equal region graph free energy region graph cycles 
proof exact average energy reduces region graph average energy argument proposition 
exact entropy reduces region graph entropy recursively applying junction graph formula probability distribution factor graph divided large regions rl small regions rs separate large regions see appendix details rl pr xr 
pr xr dr rs illustrate proposition example factor graph region graph 
recursively break full joint probability distribution show equal product marginal probability distributions regions precisely form necessary region graph free energy exact 
fig 

factor graph tree region graph shown 
note region graph region separates left part tree right part tree 
means 
marginal probability distributions turn written terms marginal probabilities smaller regions 
example see region separates regions 
expanding obtain joint probability distribution equals 
fig 

region graph cycles corresponding region graph free energy approximation exact 
notice equation product local kernels exponent corresponding counting number associated region 
substituting result formula exact entropy recover region graph entropy 
region graph average energy exact region beliefs demonstrates approximation exact case 
viii 
maxent normal region graph approximations region graph method restrictive natural question ask criteria choose different region graphs 
section focus notion maxent normal free energy approximations previously defined section iv 
recall approximation region free energies originates entropy term 
natural requirement entropy approximation give correct answer interactions achieve global maximum beliefs br xr uniform 
defined free energy approximations obey criterion proved theorem bethe approximation maxent normal 
hand region graph free energy approximations provably shown example 
example approximation maxent normal consider factor graph consists binary variable nodes pair nodes connected factor 
version factor graph random factors known physics literature ising spin glass 
take regions include region graph triplet nodes factors connect pair nodes factor connects single node 
complete definition region graph draw arc triplet region pair regions sub sets arc pair region single node regions sub sets 
region graph obtained cluster variation method see appendix starting triplet regions largest regions 
compute counting numbers follows 
triplet regions having counting number 
pair regions having counting number pair variable nodes belongs triplet regions 
single node regions having counting number computed fact single variable node belongs triplet regions pair regions 
consider consistent set beliefs single node region beliefs xi xi pair node region beliefs xi xj xi xj pair beliefs equal zero triplet node region beliefs xi xj xk xi xj xk triplet beliefs equal zero 
beliefs beliefs obtain marginalizing global probability distribution allowed states equal probability zeros state ones state 
beliefs entropy region triplet pair single node region ln 
entropy just determined sum counting numbers regions ln formula easy determine beliefs give entropy greater ln result uniform distribution 
see approximation derived cluster variation method triplet regions largest regions surely give poor results interactions approximation correct uniform distribution 
surprise researchers noticed approximation gives poor results model 
example approximation maxent normal fortunately hard find examples region graph approximations maxent normal bethe approximation 
nontrivial example approximation provably 
consider square lattice binary variable nodes variable node connected pair wise factors nearest neighbors 
course normally interested cases large sake example consider small version shown 
fig 

version square lattice factor graph 
construct region graph square lattice factor graphs cluster variation method see appendix starting small clusters largest regions 
small example resulting region graph shown 
fig 

region graph factor graph obtained cluster variation method starting clusters 
counting number region listed region 
prove particular region graph gives free energy approximation maxent normal idea proof bethe see proof theorem 
proposition free energy approximation region graph shown maxent normal 
proof need show entropy free energy approximation attains maximum beliefs uniform 
rewrite region graph entropy bi example bi bi xi ln bi xi xi maximum bi subject constraints bi xi achieved bi xi uniform distribution 
mutual informations greater equal zero equal zero beliefs involved uniform distributions see theorem 
bi achieves maximum mutual informations achieve minimum beliefs uniform proposition proved 
proposition proof easily generalized general case lattice ary variables proposition factor graph consisting lattice ary variables connected pair wise factors nearest free energy approximation obtained cluster variation method starting overlapping clusters largest regions 
proof left exercise reader 
discussion heuristics general problem generate region graph approximations give highly accurate marginals open research problem 
notion region graph approximations helpful complete story 
sub section discuss issue suggest heuristics prove useful 
point focusing accuracy free energy approximation usually interested accuracy approximate marginals compute 
related discuss point 
refer interested reader wainwright develops bounds approximation error marginals algorithm minimizes bethe free energy generalizations 
propose systematic approach choose promising region graph approximations suggest common sense heuristics 
emphasized region graph approximation maxent normal 
secondly improve ordinary bethe approximation try include shortest cycles factor graph inside regions 
observed region graph approximations obey heuristic tend accurate sum counting numbers regions equals cr 
avoid confusion emphasize heuristic different validity condition equation ensures variable node factor node counted 
heuristic considering factor graph binary variable nodes argument easily generalized ary variable nodes considering global probability distribution allows just states equal probability state nodes zeros state nodes ones 
reader may growing familiar distribution examples approximations give negative entropies examples approximations provably maxent normal 
exact entropy probability distribution obviously just ln 
marginalize distribution find region marginal probability allows ones state variable nodes 
region region entropy ln 
region approximation give correct entropy beliefs corresponding global distribution sum counting numbers regions 
heuristic normally satisfied bethe approximations exception exact bethe approximations factor graph cycles 
complicated region graph approximations satisfy heuristic including example maxent normal approximation discussed previous sub section square lattices clusters 
clearly worthwhile develop method accept arbitrary factor graphs automatically construct maxent normal region graph approximations satisfied heuristics 
know method refer reader interesting welling developed bottom approach generating region graph approximations starting bethe approximation 
ix 
generalized belief propagation algorithms seen stationary points bethe approximation free energy equivalent fixed points standard bp algorithm operates factor graph 
introduce generalized belief propagation algorithms operate region graphs demonstrate fixed points correspond stationary points region graph free energy 
construct generalized belief propagation gbp algorithms corresponding region graph free energy approximation 
fact ways construct message passing algorithms fixed points equivalent stationary points region graph free energy 
algorithms messages sort sent regions region graph 
note obtain different gbp algorithms corresponding free energy different region graphs free energy 
example modified region graph connecting grandparent region directly grandchild region gbp algorithms describe correspondingly modified approximate free energy changed new constraints redundant 
making modification alter dynamics gbp algorithm fixed points 
anantharam focused problem constructing minimal region graph free energy approximation focus problem refer interested reader directly papers 
fix attention particular region graph variety different gbp algorithms create 
main text describe possible approach call parent child algorithm 
appendices describe approaches child parent algorithm way algorithm give algorithms equivalent fixed points advantages 
main advantage parent algorithm comparison algorithms message passing rules region counting numbers just standard bp algorithm 
standard bp algorithm special case algorithms region graph obtained bethe method 
parent child algorithm recall standard bp message passing equations derived fact belief single variable node just product messages bearing information neighboring factor nodes belief region variable nodes adjoining single factor node product internal factor multiplied messages coming group nodes factor nodes outside region 
parent child algorithm generalizes idea 
algorithm previous exposition called canonical gbp algorithm belief region product local factors region multiplied messages coming region outside regions 
complication ensure algorithm equivalent minimizing region graph free energy need include additional messages regions descendants parent regions descendants region definitions parent child algorithm kind message mp xr parent region child region 
region belief br xr br xr fa xa mp xr ar mp xd set regions parents region set regions descendants region set regions descendants region set regions parents region region regions descendants region message update rules parent child algorithm mp xr fa xa mi xj mi xj sets calculated advance 
set connected pairs regions 
set connected pairs regions 
fig 

region graph illustrate parent child gbp algorithm 
note explicitly give variable factor node labels region purposes interested topology region graph 
example help definitions clearer 
consider example shown 
belief br xr region product local factors ar fa xa messages parents ma xr mb xr messages descendants parents descendants mc xe mc xh mf xh 
obtains self consistent message update rules requiring consistency beliefs pair parent child regions 
focus region child belief region fa xa br ma mb mc mc mf ar notation removing obvious functional dependencies messages belief region fa xa mc md mc mf ae marginalization constraint br xr ba xa xa xr obtain relation messages interpret message update rule xe md xg ma xr mb xr xr xe ar ae fa xa 
course similar message update rules obtained pairs parent children regions 
conditions determine message 
gbp fixed points free energy stationary points prove fixed points parent child gbp algorithm region graph correspond stationary points region free energy region graph 
simplify presentation restrict attention interior stationary points 
alternative exposition theorem refer reader proof theorem proposition 
theorem interior stationary points constrained region free energy valid region graph fixed points positive beliefs parent child gbp algorithm region graph vice versa 
proof region graph free energy fr br br 
derive stationarity conditions need create lagrangian free energy enforces consistency beliefs pair connected regions 
add lagrange multipliers xc enforce bc xc bp xp xp xc pair parent child regions need include lagrange multipliers enforce normalization beliefs xr br xr 
ignore lagrange multipliers corresponding inequality constraints br xr interior stationary points constraints inactive lagrange multipliers zero 
setting derivatives respect beliefs br xr equal zero gives stationarity conditions cr ln br xr cr ln fa xa ar xr rc xc set regions parents region set regions children region expression xa xc entirely determined value xr 
proof backwards belief equations want derive 
want show exists rotation lagrange multipliers set lagrange multipliers stationary point conditions re written cr ln br xr cr ln fa xa cr xr cr ar xd 
clearly show identifying message mp xr exp xr recover desired belief equations 
lagrange multipliers xr constrain 
answer impose constraint xr ba xa 
ca xa xr words lagrange multiplier constrains weighted belief region plus sum weighted beliefs ancestor regions region regions ancestors equal zero 
lagrangian lagrange multipliers straightforward stationary points equation 
prove theorem directions need show derive constraints lagrange multipliers lagrange multipliers vice versa 
note cr ca cp ca subtract equations obtain cr ca start xc constraints bc xc xp xc bp xp pair parent child regions equation basis deriving constraints associated lagrange multipliers 
prove derive constraints constraints induction starting regions parents level regions considering regions parents level regions level regions regions parents level level regions level regions 
region want show constraint respect parents holds helps inductive procedure want show condition cr br xr ba xa ca xa xr holds 
level regions counting number cr prove 
consider level region np parents parents 
consider particular parent constraint xr bp xa 
cp xa xr choosing parent obtain analogous equation subtracting equations obtain bp xp bp xp xp xr xp xr parents replace terms form xp bp xp parents equation equivalent terms remember cr np cp level know parents parents obtain br xr bp xp 
xp xr obviously obtain similar equation parent simply subtract equation equation show equation holds region level 
consider region level shown equation holds regions lower levels 
consider particular parent constraint xr ba xa ca xa xr equation applied obtain xr ba xa bp xp 
ca xa xr xp xr course obtain analogous equation parent subtracting equations obtain equation 
able follow procedure previously derived equalities replace equation terms form xa xr ba xa ancestors equivalent terms counting number definition cr ca obtain desired constraint 
course obtain result parent results obtain condition equation enable proceed level induction 
note general formula relating lagrange multipliers lagrange multipliers 
fortunately formula necessary proof need show exists rotation new set lagrange multipliers specify explicitly 
difficult derive general formula relating sets lagrange multipliers region graphs generations regions constructed junction graph method see appendix fact give relationship explicitly forward inverted directions xr xr cr xr xr cr cr xr 
note technical difficulty arise child parent way gbp algorithms described appendix algorithm messages directly exponentiated lagrange multipliers 
investigate issue edge stationary points active inequality constraints general constrained region graph free energies 
expect general picture emerged bethe bp case reproduced existence valid constrained region free energy approximations problem quite intricate 
detailed example gbp algorithm fig 

factor graph detailed example construct gbp algorithm 
give detailed example construct gbp algorithm 
consider factor graph drawn variable nodes factor nodes 
factor graph convenient slightly alter labeling conventions factor nodes ones attached single variable node labeled number letter 
factor graph corresponds joint probability distribution fi xi 
fa fb fc gbp algorithm making assumptions actual forms functions note particular factor graph represent probability distribution occurs decoding block error correcting code :10.1.1.54.1570
particular variable nodes binary possible states functions fa fb fc parity check functions equal sum arguments factor graph corresponds linear block hamming code parity check matrix 
decoding problem functions fi xi represent likelihoods possible states bits light received block channel assumed channel model 
fig 

region graph obtained factor graph cluster variation method 
obtain gbp algorithm need create region graph 
cluster variation method largest regions fa fb fc 
cluster variation method prescription finding intersection regions detailed appendix obtain region graph shown 
region graph need choose kind gbp algorithm want write belief message equations gbp algorithm 
choose parent child algorithm 
note region graph free energy useful theoretically justifying gbp algorithm necessary constructing algorithm 
directly belief equations 
recall parent child algorithm kind message mp xr parent region child region 
region belief br xr equation re write br xr fa xa ar mp xr mp xd words equation says belief region product local factors region messages parents messages descendant regions parents descendants 
region graph regions grouped types regions regions exemplified fa contain factor nodes variable nodes regions exemplified contain factor nodes variable nodes single region contains factor node variable node 
abbreviated notation dropping explicit xr dependence beliefs messages factor functions 
notation best explained examples write beliefs regions listed previous paragraph write message region fa region message region region abbreviate fa fa 
abbreviated notation belief equations largest regions faf fcf 
note regions parents relevant messages descendant regions parents descendants 
belief equations intermediate sized regions 
belief equation region 
message update rules obtained combining belief equations marginalization conditions parent child regions bc xc bp xp 
xp xc example requiring consistency beliefs region region tells obtain 
message update rules obtained way equivalently equation faf faf fcf fcf 
practice helps convergence step messages part way newly computed values 
simple heuristic eliminate shooting problems 
emphasize potential practical pitfall avoid inertia heuristic 
suppose set old messages old update equations calculate set messages update want set new messages halfway old messages updated messages new mold 
strongly recommend update equation message left hand side messages equations 
mixing mnew mold messages left hand side empirically results poor convergence properties 
example update equation explicitly update faf old 
fortunately possible schedule message updates computes updated messages smallest regions messages update available needed compute updated messages larger regions 
details handled different ways iterating message update equations 
example messages initialized way likes reasonable choices random uniform messages 
algorithm typically terminates fixed number iterations convergence criterion satisfied termination conditions possible 
decoding application typically checks iteration thresholded beliefs correspond code word terminates decoding algorithm stopping fixed number iterations passed 
xi 
accuracy gbp algorithms naturally interested gbp algorithms corresponding region free energy approximations extent improve standard bp bethe approach 
fortunately maxent normal region free energy approximations particularly satisfy heuristics described section viii reliably give accurate estimates marginal probabilities bethe approximation 
consider example square lattice ising 
model binary variable nodes arranged square lattice variable node connected nearest neighbors pairwise factor form fa xi xj exp exp exp exp 
model neighboring variable nodes spins prefer state 
parameter measures strength preference temperature 
limit large model phase transition critical temperature tc state state 
discussion model see textbook statistical mechanics 
translational symmetry model easy construct bethe kikuchi approximations treat analytically compare known exact results 
kikuchi studied approximation obtained cluster variation method starting overlapping clusters 
stated section viii approximation maxent normal satisfies heuristics shortest loops contained regions sum counting numbers regions equals 
finds model exact critical temperature tc approximately compared mean field theory prediction bethe approximation prediction kikuchi prediction clusters 
qualitatively similar results available physics literature wide variety models magnetic systems invariant interactions 
considering probabilistic inference bayesian networks decoding error correcting code interested studying accuracy predictions marginals approximations factor graphs symmetries 
results discuss reported interested reader find similar empirical results gbp algorithms 
readers interested rigorous bounds accuracy marginals want consult wainwright 
studied factor graphs known physics literature square lattice ising spin glasses random magnetic field 
variable nodes arranged square lattice connected nearest neighbors factors form fa xi xj exp jij exp jij exp jij exp jij 
parameters jij chosen independently factor gaussian probability distribution 
addition variable node connected local random field factor node fi xi form fi xi exp hi exp hi parameters hi chosen independently gaussian probability distribution 
focused case jij parameters chosen zero mean gaussian distribution standard deviation hi parameters chosen zero mean gaussian distribution standard deviation 
highly frustrated model chosen highlights weaknesses ordinary bp performs perfectly factor graphs 
algorithms inertia see section help convergence 
dozens samples parent child gbp algorithm converged accurate answers ordinary bp usually usually converge 
sufficiently small compute exact marginals re writing factor graph chain supernodes take different states 
give qualitative feel results compare ordinary bp parent child gbp exact results lattice ordinary bp converge 
plot results local magnetization belief node node state minus belief second state variable nodes row lattice 
note gbp algorithm accurate ordinary bp tends correctly predict direction magnetization highly confident local magnetization variable node bp gbp exact fig 

local magnetization variable nodes spin glass random magnetic fields computed exactly ordinary bp gbp 
dave forney robert mceliece erik sudderth helpful encouraging discussions david mackay erik sudderth max welling comments previous drafts 
anonymous referees criticisms suggestions 
appendix junction graph method natural idea generalize bethe method keep notion union set large regions rl set small regions rs regions rl rs contain nodes 
junction graph method describe exploits idea generalization junction graphs introduced aji mceliece 
define junction graph labeled bipartite graph vl vs large vertices corresponding large regions vl vl small vertices corresponding small regions vs vs directed edges arcs connecting large vertices small vertices 
vertices junction graph labeled label vertex vi denoted vi labels subsets set indices representing factor variable nodes factor graph 
graph considered junction graph insist conditions 
vs small vertex neighboring large vertices vl vl require vs subset vl vl equivalently vs vl vl 
secondly require index subgraph consisting vertices contain labels connected tree 
junction graphs introduced aji mceliece special case described 
junction graphs small vertices restricted precisely neighboring large vertices small vertices interpreted labeled edges large vertices 
required small region labels include indices representing factor nodes 
set regions rl rs organized junction graph obtain valid regionbased approximation defining set counting numbers cr follows 
regions rl cr region rs cr dr dr degree numbering neighboring large regions region prescription arcs junction graph relevant small region contribution free energy subtracted large region regions connected arc straightforward confirm prescription counting numbers gives valid region free energy approximation junction graph condition sub graph variable factor node tree guarantees variable factor node counted required equation 
aji mceliece proved theorem tells set large regions rl contain factor variable nodes factor graph find corresponding set small regions rs organize regions rl rs junction graph 
theorem generalizes difficulty version junction graphs 
example consider factor graph introduced main text re draw 
take set large regions rl regions 
acceptable set corresponding small regions rs junction graph shown 
case small regions connected large regions counting number 
set regions bethe method organized junction graph neces fig 

junction graph right factor graph left 
fig 

junction graph factor graph shown generated bethe method 
note isomorphism junction graph original factor graph 
restricted aji mceliece version junction graph example factor graph resulting junction graph shown 
obvious example isomorphism original factor graph corresponding junction graph obtained bethe method 
junction graph approximation variational free energy fjg br br br br rl br rl ur br dr ur br rs hr br dr hr br 
rs junction graphs special case region graphs generations regions 
follows minimizing junction graph free energy fjg give beliefs br equivalent obtained message passing bp algorithm 
algorithm known generalized distributive law 
follows corollary general results region graphs junction graph approximation variational free energy exact generalized distributive law give exact results junction graph tree 
case junction graph junction tree generalized distributive law reduces famous junction tree algorithm 
apply known result joint probability function junction trees case obtain rl pr xr 
pr xr dr rs obtain result note described region graphs junction graphs directed graphs point view statistical graphical models equivalent undirected graphs 
particular re write full joint probability distribution factor graph form rs xr xs xr rs rs denotes pairs connected regions region graph factor graph 
specifically set xr ar fa xa cr rs xr xs equal xr consistent xs equal form joint probability distribution equivalent original factor graph form 
formula true pairwise markov random fields set nodes rl separated set nodes rs shown convert region graph equivalent pairwise markov random field justified formula region graphs 
appendix cluster variation method method selecting valid set regions counting numbers cr cluster variation method introduced kikuchi developed physics literature 
main feature distinguishing method junction graph method may union just generations regions 
cluster variation method set distinct large regions factor node variable node factor graph included region 
require region subregion region 
construct set regions forming possible intersections regions discarding intersection regions sub regions intersection regions 
possible construct way set regions intersections regions discarding intersection regions appeared sub regions intersection regions 
long continue intersection regions construct sets regions rk way 
set regions cluster variation method rk 
form region graph cluster variation method draw connections regions obtained rk way 
regions connect regions super regions 
region connect regions super regions regions need direct connection super regions regions super regions similar rules followed regions 
define counting numbers cluster variation method cr set regions super regions region returning example factor graph drawn choose base set regions consist regions 
set base regions chosen choice cluster variation method 
case set intersection regions regions set intersection regions 
regions counting number cr 
regions subregion regions counting number cr 
region super region counting number 
represent set regions counting numbers region graph shown 
cs fig 

region graph generated cluster variation method 
note bethe approximation special case cluster variation method factor node shares variable node factor node equivalently cycles length factor graph 
factor graph shown example factor graph bethe approximation generated cluster variation method 
physics literature cluster variation method normally applied restricted class factor graphs particularly relevant models magnetic materials 
particular factor graph normally represents invariant crystal lattice factor nodes normally degree corresponding interactions 
translational symmetry factor graph dramatically simplifies problem minimizing kikuchi free energy factor nodes degree bethe method special case cluster variation method 
appendix relationships different methods appendix summarize relationships different methods generating valid sets regions region free energy approximation 
clear definition junction graph region graph converse true 
sets regions counting numbers generated cluster variation method represented region graph 
saw example 
emphasize construct region graph approximations generated junction graph cluster variation methods 
saw example introduced region graphs main text section vii 
constructions general constructed cluster variation method junction graph method may useful variety reasons including reducing computational complexity gbp algorithm 
fig 

factor graph choice regions corresponding counting numbers give valid region approximation represented region graph 
note region graph method general method introduced exist valid region free energy approximations region graph representation 
demonstrate example 
summary relationships illustrated venn diagram 
factor graph cluster variation method generalized junction graph method generate valid region free energy approximations subclasses possible valid approximations 
cluster variation method generalized junction graph method general subsumed general region graph method 
set regions generated bethe method generated junction graph valid region approximations cluster variational method kikuchi region graphs junction graphs aji mceliece junction trees bethe fig 

venn diagram illustrating relationships different methods generating valid region free energy approximations 
bethe method exemplar junction graph method special case cluster variation method factor graph pair factor nodes share variable node special case aji mceliece junction graph method relevant factor graph forney normal graph variable node connected factor nodes 
method generated cluster variation method factor graph cycles length 
general bethe method special case aji mceliece junction graph method factor graphs variable node adjacent factor nodes forney called normal factor graphs 
addition general method cluster variation method junction graph method feel region graph method easier understand intuitive level 
simply select set regions counting numbers variable factor node gets counted enforce consistency beliefs connected regions 
region graphs important advantage natural graphical structure describing generalized belief propagation algorithms 
anantharam suggested strengthening region graph requirements described section vii sub set variable nodes factor graph subgraph regions containing sub set connected sum counting numbers equal 
strengthening ensure beliefs computed sub set nodes consistent matter regions compute 
cluster variation method produces region graphs satisfy stronger requirements chose insist stronger requirements general region graphs created bethe method necessarily satisfy 
appendix child parent algorithm observation underlying child parent algorithm minimize bethe free energy lagrange multipliers enforcing marginalization constraints correspond exactly exponentiation ni xi messages variable nodes factor nodes bp algorithm 
considering messages messages child regions parent regions region graph try generalize approach arbitrary region graphs 
construct gbp algorithm simply minimizing region graph free energy identifying lagrange multipliers enforce consistency beliefs messages child regions parent regions 
approach considered detail kappen region graphs constructed cluster variation method 
lagrangian stationary point equation assuming interior stationary points obtained differentiating lagrangian respect beliefs 
obtained equation previously see equation re write cr ln br xr cr ln fa xa ar xr rc xc set regions parents region set regions children region xr lagrange multipliers enforce consistency beliefs region region cr re write equation br xr ar fa xa nc xc nr xr cr nc xc exp xc message child region parent region analogy messages ni xi standard bp 
cr get condition br xr br xr determined beliefs super regions marginalization conditions obtain condition messages region nc xc nr 
xr message update rules obtained applying marginalization conditions bc xc xp xc bp xp 
small example help clarify meaning equations reader 
consider probability distribution fa fb 
bethe approximation exact case factor graph tree 
obtain large regions counting numbers small regions counting numbers respectively 
obtain belief equations regions cr ba fa bb fb conditions messages regions cr 
conditions marginalization conditions find fb fa 
easily check example computed beliefs give back desired marginal probabilities exactly 
child parent algorithm construction clearly gives generalized bp algorithm fixed points correspond stationary points region graph free energy 
hand considered inelegant focuses messages child regions parent regions message update equations inevitably complicated involve counting numbers cr 
way algorithm described appendix parent child described main text section ix different gbp algorithms attempt ameliorate flaws 
appendix way algorithm motivate way algorithm return standard bp algorithm recall belief equations written form bi xi ma xi ba xa fa xa ni xi ni xi mc xi 
equations natural aim generalization belief equations form br xr fr xr nc xc mp xp 
words aim write belief equations belief region product local factors messages arriving connected regions parents children 
turn order gbp algorithm correspond region graph free energy need modified factors complicated relation nc xc messages mp xp messages generalizing relation standard bp equation 
convenient denote number parents region pr define numbers qr cr pr qr 
region parent pr cr take qr 
note bethe approximation qr regions 
assume qr defined normally region graph region qr able change connectivity avoid problem 
define set pseudo messages regions parents children xr fr xr mp xr nc xc xc fr xr xr xc mp xr nc xc fr xr ar fa xa cr aside fact raised product local factors power cr pseudo messages naively expect message updates look 
obtain true message updates needs combine pseudo messages going directions link follows nr xr xr xr mp xr xr xr note messages precisely pseudo messages 
way algorithm completed belief equations form equation 
position prove theorem theorem interior stationary points region graph free energy fixed points twoway gbp defined message belief equations strictly positive beliefs 
proof form lagrangian region graph energy indicated previous section child parent algorithm 
equation derived obtain equation br xr cr fr xr rc xc xr suppose set br satisfy stationary conditions lagrangian 
define nr xr xr mp xr br xr qr xr course message message lagrange multiplier definitions hold need constraints relating constraints definitions relations messages pseudo messages defined 
want show relations way gbp belief equations previously defined hold 
show belief equations hold 
br xr cr fr xr fr xr nc xc rc xc br xr fr xr br xr cr fr xr qr fr xr br xr xr mp xr nc xc mp xr nc xc mp xr br xr product local potentials incoming messages 
turning constraints definition xr xr mp xr br xr bp xp xp xr nr xr xr 
equations imply nr xr mp xr br xr qr xr mp xr qr 
equations give equations unknowns mp xr nr xr mp xr nr xr xr xr fr xr qr nr xr mp xr qr xr qr unique solution equations equations 
shown message passing algorithm previously defined fixed points equivalent stationary points region graph free energy 
way algorithm particularly elegant fr xr fr xr regions 
case region send messages adjacent regions message update rules natural generalization ordinary bp rules written kinds messages 
interesting note condition fr xr fr xr ensured requiring regions parents contain factor nodes condition regions ensured requiring sub graph obtained region ancestor regions form tree 
regions way gbp algorithm equivalent pearl method clustering form new nodes clusters variables original graph regions run ordinary bp algorithm resulting graph 
important bear mind equivalence holds subset possible region graphs uses method clustering set regions satisfy region graph conditions region graph regions resulting beliefs generally poor approximation 
frey 
graphical models machine learning digital communication 
mit press 
jordan editor 
learning graphical models 
mit press 
rabiner :10.1.1.131.2084
tutorial hidden markov models selected applications 
proceedings ieee 
viterbi 
error bounds convolutional codes asymptotically optimum decoding algorithm 
ieee trans 
info 
theory 
forney jr viterbi algorithm 
proceedings ieee 
gallager 
low density parity check codes 
mit press 
berrou glavieux 
near shannon limit error correcting coding decoding turbo codes 
proceedings ieee international conference communications pages geneva switzerland 
mceliece mackay cheng :10.1.1.115.4360
turbo decoding instance pearl belief propagation algorithm 
ieee sel 
areas comm 
pearl 
probabilistic reasoning intelligent systems networks plausible inference 
morgan kaufmann 
kalman 
new approach linear filtering prediction problems 
basic eng 
gelb editor 
applied optimal estimation 
mit press 
baxter 
exactly solved models statistical mechanics 
academic press 
cowell 
advanced inference bayesian networks 
jordan editor learning graphical models 
mit press 
murphy weiss jordan 
loopy belief propagation approximate inference empirical study 
laskey prade editors proceedings fifteenth conference uncertainty artificial intelligence 
bethe 
statistical theory 
proc 
roy 
soc 
london 
kikuchi 
theory cooperative phenomena 
phys 
rev 
yedidia freeman weiss 
generalized belief propagation 
leen dietterich tresp editors advances neural information processing systems volume pages cambridge ma 
mit press 
de boer 
approximation method order disorder problems ii iii 
physica xxi 
morita 
cluster variation method non uniform ising heisenberg models spin pair correlation function 
prog 
theor 
phys 
eds 
morita suzuki wada 
foundations applications cluster variation method path probability method 
prog 
theor 
phys 
supplement volume 
kschischang frey :10.1.1.54.1570
loeliger 
factor graphs sum product algorithm 
ieee trans 
info 
theory 
forney jr codes graphs normal realizations 
ieee trans 
info 
theory 
minka 
family algorithms approximate bayesian inference 
mit ph thesis 
wainwright jaakkola willsky 
tree reparameterization framework analysis sum product related algorithms 
ieee trans 
info 
theory 
aji mceliece 
generalized distributive law 
ieee trans 
info 
theory 
offer 
algebraic description iterative decoding schemes 
marcus rosenthal editors codes systems graphical models volumes mathematics applications 
springer verlag 

survey propagation algorithm satisfiability 
xxx lanl gov pdf cs 

loeliger 
propagation synchronization low complexity trellis decoding 
proceedings st allerton conference communication control computing pages 
aji mceliece 
generalized distributive law free energy minimization 
proceedings th allerton conference communication control computing pages 
mceliece 
belief propagation partially ordered sets 
gilliam rosenthal editors mathematical systems theory biology communications computation finance 
anantharam 
minimal graphical representation kikuchi regions 
proceedings th annual allerton conference communication control computing pages 
anantharam 
estimation marginalization kikuchi approximation methods 
available online eecs berkeley edu papers kikuchi pdf 
yedidia freeman weiss 
characterizing belief propagation generalizations 
www merl com reports tr index html 
yedidia freeman weiss 
bethe free energies kikuchi approximations belief propagation algorithms 
available online www merl com reports tr index html 
yedidia freeman weiss 
constructing free energy approximations generalized belief propagation algorithms 
merl tr available online www merl com reports tr 
yedidia freeman weiss 
understanding belief propagation generalizations 
lakemeyer nebel editors exploring artificial intelligence new millenium chapter pages 
morgan kaufmann 
cover thomas 
elements information theory 
john wiley sons 
jordan ghahramani jaakkola saul 
variational methods graphical models 
jordan editor learning graphical models pages 
mit press 
mackay yedidia freeman weiss 
conversation bethe free energy sum product discussion document 
available online www merl com reports tr index html 
wim tom heskes 
fractional belief propagation 
becker thrun obermayer editors advances neural information processing systems pages 
mit press cambridge ma 
wainwright jaakkola willsky 
new class upper bounds log partition function 
proceedings conference uncertainty artificial intelligence 
toulouse 
theory frustration effect spin glasses comm 
phys 
wainwright jordan 
graphical models exponential families variational inference 
uc berkeley dept statistics technical report 
bertsekas 
nonlinear programming 
athena scientific 
weiss 
correctness local probability propagation graphical models loops 
neural computation 
huang 
statistical mechanics 
john wiley sons 
jordan 
loopy belief propagation gibbs measures 
proceedings th allerton conference communication control computing 
heskes 
uniqueness belief propagation fixed points 
neural computation 
yuille 
cccp algorithms minimize bethe kikuchi free energies convergent alternatives belief propagation 
neural computation 
welling teh 
belief optimization binary networks stable alternative belief propagation 
proceedings conference uncertainty artificial intelligence 
kappen 
novel iteration schemes cluster variation method 
dietterich becker ghahramani editors advances neural information processing systems pages 
mit press cambridge ma 
tom heskes 
stable fixed points loopy belief propagation local minima bethe free energy 
thrun becker obermayer editors advances neural information processing systems pages 
mit press cambridge ma 
stanley 
enumerative combinatorics volume 
cambridge university press 

infinite ranged models spin glasses 
phys 
rev 
minka qi 
tree structured approximations expectation propagation 
advances neural information processing systems 
mit press 
welling 
choice regions generalized belief propagation 
proceedings conference uncertainty artificial intelligence 

frustration effect dimensional ising spin glass ii 
existence spin glass phase 
phys 
solid st phys 
harel mceliece 
poset belief propagation experimental results 
proceedings international symposium information theory page 
harel 
poset belief propagation experimental results 
caltech senior thesis 
biographies authors jonathan yedidia research scientist mitsubishi electric research labs merl 
received ph physics princeton university 
graduate post doctoral junior fellow harvard society fellows focused statistical mechanics disordered systems 
professional chess player teacher 
main research interests joining merl algorithms probabilistic inference applications communications signal processing artificial intelligence 
william freeman professor electrical engineering computer science mit 
studied computer vision phd mit degrees physics electrical engineering stanford cornell 
worked mitsubishi electric research labs merl years moving mit holds patents 
current research focus machine learning applied computer vision computer graphics 
yair weiss senior lecturer school computer science engineering hebrew university jerusalem 
received ph massachusetts institute technology visiting scientist berkeley 
research interests include human machine vision machine learning error correcting codes 
