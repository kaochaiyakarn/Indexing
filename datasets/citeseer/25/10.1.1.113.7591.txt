bayesian haplotype inference dirichlet process eric xing cs berkeley edu icsi berkeley edu michael jordan jordan cs berkeley edu computer science division department statistics university california berkeley ca problem inferring haplotypes genotypes single nucleotide polymorphisms snps essential understanding genetic variation populations important applications genetic analysis disease propensities complex traits 
problem formulated mixture model mixture components correspond pool haplotypes population 
size pool unknown knowing size pool correspond knowing significant genome history 
methods fitting genotype mixture crucially address problem estimating mixture unknown number mixture components 
bayesian approach problem nonparametric prior known dirichlet process 
model incorporates likelihood captures statistical errors haplotype genotype relationship 
apply approach analysis simulated real genotype data compare extant methods 

availability nearly complete human genome sequence possible explore individual differences dna sequences scale search associations genotypic variation disease phenotypes risch 
largest class individual differences dna single nucleotide appearing proceedings st international conference machine learning banff canada 
copyright authors 
snps 
millions snps detected far estimated total common snps 
snp commonly variants alleles population corresponding specific nucleotides chosen 
haplotype list alleles contiguous sites local region single chromosome 
assuming recombination local region haplotype inherited unit 
recall diploid organisms humans chromosomes come pairs 
haplotypes go genotype list unordered pairs alleles region 
genotype obtained pair haplotypes omitting specification association allele chromosomes phase 
common biological methods genotypes typically provide phase information phase obtained considerably higher cost patil 
desirable develop automatic methods inferring haplotypes genotypes possibly data sources pedigrees 
set inferred haplotypes hand associations disease explored 
point view population genetics basic model underlying haplotype inference problem finite mixture model 
letting denote set possible haplotypes associated region set cardinality case binary polymorphisms number snps probability genotype indicator function event haplotypes consistent assumption hardy weinberg equilibrium assumption standard literature mixing proportion assumed factor 
basic statistical structure simplest methodology haplotype inference maximum likelihood em algorithm treating haplotype identities latent variables estimating parameters 
methodology severe computational requirements probability distribution maintained large set possible haplotypes fundamentally fails capture notion small sets haplotypes preferred 
notion derives underlying assumption relatively short regions chromosome limited diversity due population bottlenecks relatively low rates recombination mutation 
approach dealing issue formulate notion parsimony develop algorithms directly attempt maximize parsimony 
important papers taken approach clark gusfield eskin yielded new insights algorithms 
approach elaborate probabilistic model particular incorporating priors parameters 
different priors discussed different authors ranging simple dirichlet priors niu priors process stephens priors capture aspects recombination greenspan geiger 
models provide implicit notions parsimony implicit ockham factor bayesian formalism 
take bayesian statistical approach current attempt provide explicit control number inferred haplotypes provided statistical methods proposed far resulting inference algorithm commonalities parsimony schemes 
approach nonparametric prior known dirichlet process ferguson 
setting finite mixture models dirichlet process confused dirichlet distribution able capture uncertainty number mixture components escobar west :10.1.1.51.1747
basic setup explained terms urn model process proceeds data sequentially 
consider urn outset contains ball single color 
step draw ball urn replace balls color ball new color place urn parameter defining probabilities possibilities 
association data points colors defines clustering data 
link bayesian mixture models associate color draw distribution defining parameters mixture components 
process defines prior distribution mixture model random number components 
multiplying prior likelihood yields posterior distribution 
markov chain monte carlo algorithms developed sample posterior distributions associated dirichlet process priors escobar west neal :10.1.1.51.1747
usefulness framework haplotype problem clear dirichlet process prior essence maintain pool haplotype candidates grows observed genotypes processed 
growth controlled parameter prior distribution corresponds choice new color urn model likelihood assesses match new genotype available haplotypes 
expand point advantage probabilistic formalism ability elaborate observation model genotypes include possibility errors 
particular indicator function eq 
suspect reasons individual genotype may match current pool haplotypes possibility mutation recombination individual errors data recording process 
sources small differences lead inference procedure spawning new haplotypes 
current statistical model haplotype inference dirichlet process prior likelihood includes error models genotypes 
describe markov chain monte carlo procedure particular procedure gibbs metropolis updates posterior inference 
results applying method analysis simulated real genotype data comparing state art phase algorithm stephens 

statistical model input phasing algorithm represented genotype matrix columns corresponding snps order chromosome rows corresponding individuals 
gi represents information alleles th individual snp denote alleles snp gi take values indicating site indicating site indicating missing data 
focus binary data worth noting methods generalize immediately non describe model terms pool ancestral haplotypes templates population haplotype originates greenspan geiger 
haplotype may undergo point mutation respect template 
size pool composition unknown treated random variables dirichlet process prior 
providing brief description dirichlet process subsequently show process incorporated model haplotype inference 

dirichlet process mixtures dirichlet process full generality focus specific setting mixture models urn model essential features process 
fuller presentation see james 
assume data arise mixture distribution mixture components 
assume existence base measure parameters dirichlet process 
parameter 
parameter prior generate prior manner discuss 
consider process generating samples 
xn mixture model consisting unspecified number mixture components equivalence classes sample sampled distribution parameter sampled base measure 
ith sample xi sampled distribution ci equivalence class sample ci drawn distribution sequential sampling process 
imply property choice equivalence class new sample previously populated classes chosen 
important emphasize process discussed prior distribution 
embed prior full model includes likelihood observed data 
section develop markov chain monte carlo inference procedures model 

model probabilistic model generation haplotypes population generation genotypes haplotypes 
assume individual genotype formed drawing random templates ancestral pool templates subject random perturbation 
model perturbations assume locus mutated independently ancestral state error rate 
assume noisy observations resulting genotypes 
model displayed graphical model 


ci cj 
ci ci cj 
ci nci occupancy number class ci number previous samples belonging class ci 

graphical model representation haplotype model dirichlet process prior 
circles represent state variables ovals represent parameter variables diamonds represent fixed parameters 
parameter ci associated mixture dashed boxes denote sets variables corresponding ancestral template haplotype genotype respec component ci obtained follows tively 
solid boxes correspond replicates sets ci cj ci variables associated particular individual cj ci populated equivalence class ancestral template respectively 
ci ci cj ci new equivalence class ordered list loci interest 
eqs 
define conditional prior equivalence class indicator ci sample binary data accommodate missing data 
individual denote haplotype hi hi 
hi maternal haplotype hi hi 
hi 
denote set ancestral templates ak ak 
ak particular member set 
framework probability distribution haplotype variable hit sub subscript indexes maternal origin modeled mixture model unspecified number mixture components corresponding equivalence class associated particular ancestor 
individual define equivalence class variables ci ci maternal haplotypes respectively specify ancestral origin corresponding haplotype 
cit random variables corresponding equivalence classes dirichlet process 
base measure dirichlet process joint measure ancestral haplotypes mutation parameters captures probability allele locus identical ancestor locus 
assume uniform distribution possible haplotypes 
beta distribution beta choose small value corresponding prior expectation low mutation rate 
cit set ancestors define conditional probability corresponding haplotype instance 
hj hit cit hit ak hj aj hj aj probability having allele hj locus ancestor 
eq 
assumes locus mutated independently error rate 
haplotypes hit takes values set alleles 
single locus mutation model hj aj hj aj hj aj indicator function 
joint conditional distribution haplotype instances hit 
parameter instances 
ancestor indicator haplotype instances set ancestors 
ak written explicitly mk mk hit ak cit number alleles mutated respect ancestral allele hit ak cit number mutated alleles 
count mk mk sufficient statistic parameter count mk sufficient statistic parameter 
marginal conditional distribution haplotype instances obtained integrating eq 
mk mk gamma function normalization constant associated beta 
simplicity abbreviation rh sequel 
introduce noisy observation model genotypes 
gi gi 
gi denote joint genotype individual loci 
gi denotes genotype locus assume observed genotype locus determined maternal alleles locus follows gi hi hi hi gi hi gi hi gi hi hi hi denotes unordered pair actual snp allele instances locus denotes set difference exactly element observed genotype true denotes set difference elements observed true genotypes different appropriately defined normalizing constants 
place beta prior beta 
assuming independent identical error models locus joint conditional probability entire genotype observation gi 
parameter haplotype instances gi hi hi sufficient statistics com puted hi gi hi hj gj respectively 
note ij 
reflect assumption observational error rate low set small constant 
marginal conditional distribution computed integrating 
gi having described bayesian haplotype model problem phasing individual haplotypes estimating size configuration latent ancestral pool solved posterior inference genotype data 

markov chain monte carlo haplotype inference section describe gibbs sampling algorithm exploring posterior distribution model including latent ancestral pool 
metropolis hastings variant algorithm appears mix better practice 
hit ak ci hit ci denotes set indices excluding represents number ci equal represents total number instances sampled far denote sufficient statistics associated haplotype instances originating ancestor hit expression simply bayes theorem hit ak playing role likelihood cit playing role prior 
likelihood hit ak obtained integrating parameter eq 

conditional probability newly proposed equivalence class populated previous samples requires summation possible ancestors hit hit 
gamma function factorize loci computing summation takes time exponential number loci 
problem endow locus mutation parameter parameters admitting prior beta 
gives rise closed form formula summation normalization constant eq 

arguably accurate reflection reality 

gibbs sampling algorithm gibbs sampler draws samples random variable conditional distribution variable sampled previously sampled values remaining variables model 
variables needed algorithm cit index ancestral template haplotype instance individual ak allele pattern th locus th ancestral template hit th allele snp th locus individual gi genotype locus individual observed variables model 
variables model integrated 
gibbs sampler samples values cit ak hit conceptually gibbs sampler alternates coupled stages 
current values hidden haplotypes sample cit subsequently ak associated dirichlet process prior 
second current state ancestral pool ancestral template assignment individual sample hj variables basic haplotype model 
stage conditional distribution cit cit cit hit ak need sample ancestor template ak newly sampled ancestor index cit equal existing index ci value ak needs chosen hit posterior distribution prior single dependent haplotype hit hand equivalence class populated previous samples ci draw new value ak hit cit 
new sample cit template longer associated haplotype instance remove template pool 
conditional distribution gibbs step ak hit cit hit ak hit ak previously instantiated hit cit ak mk nk previously instantiated mk respectively number instances originated ancestor locus identical respectively different ancestor ancestor pattern ak hit proceed second sampling stage sample haplotypes hit sample hit sequentially conditional distribution hit hi gi hit hi hit ak rg ij mj rh nk denotes set indices excluding mk hit ak similarly sufficient statistics 
note sampling step recompute sufficient statistics going change newly sampled hit old sample going change newly sampled hi results change allele 
cases new gamma function easily updated old 

metropolis sampling algorithm note long list loci uniform possible ancestral template patterns render probability sampling new ancestor infinitesimal due small value smoothed marginal likelihood haplotype pattern hit computed eq 

result slow mixing 
alternative sampling strategy partial gibbs sampling strategy metropolis updates 
proposal distribution equivalence class hit ci ci sample ac sequentially eq 

target distribution cit proposal factor cancels computing acceptance probability leaving cit min hit ac hit ac 
practice modification gibbs sampling algorithm leads substantial improvement efficiency long haplotype lists short lists gibbs sampler remains better due high acceptance rate 

experimental results validated algorithm applying simulated real data compared performance state art phase algorithm stephens current algorithms 
report results variants algorithm gibbs sampler denoted dp gibbs metropolis sampler denoted dp mh 
experiments set hyperparameter dirichlet process roughly population size data set individuals 
burn iterations datasets individuals iterations estimation 

simulated data set experiments applied method simulated data short sequence data stephens 

data contains sets haplotypes randomly paired form genotypes infinite sites model parameters determining mutation recombination rates respectively 
datasets combination individuals sites number individuals ranged number sites ranged 
evaluate performance algorithms error measures errs ratio incorrectly phased snp sites non trivial snps excluding individuals single snp ratio incorrectly phased individuals non trivial heterogeneous individuals ds switch distance number phase flips required correct predicted haplotypes non trivial heterogeneous snps 
results summarized table 
perform slightly worse phase measures slightly better switch distance measure uses sampling steps 
algorithms provide substantial improvement em 

real data applied algorithm real datasets compared performance phase stephens algorithms 
dataset contains genotypes individuals polymorphic sites daly 
addition contains genotypes parents individual allows inference large portion haplotypes eskin 

results summarized table 
apparent metropolis sampling algorithm significantly outperforms gibbs sampler preferred relatively limited number sampling steps 
performance comparable phase better hap halperin eskin eskin niu 
important emphasize methods provide posteriori estimates ancestral pool haplotype templates frequencies 
omit listing haplotypes provide illustrative summary evolution estimates dp mh phase em individuals errs ds errs ds table 
performance data stephens 

results em algorithm adapted stephens 

dp gibbs dp mh phase hap block id length errs ds errs ds errs ds errs errs table 
performance data daly 
block structure provided halperin eskin 
results hap adapted halperin eskin 
error rate halperin eskin uses number missing sites denominator non trivial ones rescaled error rates methods comparable 
sampling 
second dataset contains genotype data populations individuals genomic regions gabriel 
focused population contains genotypes allowing infer true haplotypes analyzed genotypes individuals medium sized regions see 
results summarized table 
methods yield higher error rates data compared analysis data daly 
presumably due low sample size 
setting regions algorithm outperformed phase types error measures 
preliminary analysis suggests performance gain may due bias parsimony induced dirichlet process prior 
number template haplotypes algorithm typically small phase haplotype pool large region haplotypes compared templates case individuals 

proposed bayesian approach modeling genotypes dirichlet process prior 
shown dirichlet process provides natural representation uncertainty regarding size composition pool haplotypes underly dp mh phase region length errs ds errs ds table 
performance data gabriel 

ing population 
markov chain monte carlo algorithms shown model leads effective inference procedures inferring ancestral pool haplotype phasing set genotypes 
model accommodates growing data collections noisy incomplete observations 
approach naturally imposes implicit bias small ancestral pools inference reminiscent parsimony methods doing founded statistical framework permits errors 
focus adapting technology dirichlet process setting standard haplotype phasing problem 
important underlying motivation general motivation pursuing probabilistic approaches genomic inference problems potential value model building block expressive models 
particular greenspan geiger lauritzen graphical model formalism naturally accommodates various extensions segmentation chromosomes 
top ancestral templates metropolis sampling block data daly 

numbers panels posterior means frequency template 
immediately burn samples 
samples burn 
samples burn 
haplotype blocks inclusion pedigree relationships 
dirichlet process parameterization provides natural upgrade path consideration richer models particular possible incorporate elaborate base measures dirichlet process framework coalescence distribution stephens 
interesting choice 
acknowledgments research supported part nsf itr ccr 
clark 

haplotype structure population genetic inferences nucleotide sequence variation human 
american journal human genetics 
daly 

high resolution haplotype structure human genome 
nature genetics 
escobar west 

bayesian density estimation inference mixtures 
journal american statistical association 
eskin halperin karp 

efficient reconstruction haplotype structure perfect phylogeny 
journal bioinformatics computational biology 


maximum likelihood estimation molecular haplotype frequencies diploid population 
molecular biology evolution 
ferguson 

bayesian analysis nonparametric problems 
annals statistics 
gabriel 

structure haplotype blocks human genome 
science 
greenspan geiger 

model inference haplotype block variation 
proceedings recomb 
gusfield 

perfect phylogeny conceptual framework efficient solutions 
proceedings recomb pp 

halperin eskin 

haplotype reconstruction genotype data imperfect phylogeny 
technical report columbia university 
james 

gibbs sampling methods stick breaking priors 
journal american statistical association 
lauritzen 

graphical models genetic analysis 
tr aalborg university 
neal 

markov chain sampling methods dirichlet process mixture models 
computational graphical statistics 
niu qin xu liu 

bayesian haplotype inference multiple linked single nucleotide polymorphisms 
american journal human genetics 
patil 

blocks limited haplotype diversity revealed high resolution scanning human chromosome 
science 
risch 

searching genetic determinants new millennium 
nature 


map human genome sequence variation containing single nucleotide polymorphisms 
nature 
stephens smith donnelly 

new statistical method haplotype reconstruction population data 
american journal human genetics 
