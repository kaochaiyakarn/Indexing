corotational simulation deformable solids michael wolfgang wsi gris university tubingen sand tubingen germany gris uni tuebingen de classical formulation large displacement elasticity requires geometrically nonlinear green tensor 
keeping track rotational part strain permits alternative formulations allow tensor stay linear time maintaining rotational invariance 
replace proposed warping technique application polar decomposition 
polar decomposition exactly extracts rotations enhances stability accuracy 
combine hierarchical finite element basis allows compute accurate rotations coarse level nonlinear simulation tensors finer detail 
keywords deformable objects polar decomposition strain tensors 

basing visual simulations physical laws established place computer graphics terzopoulos tf 
similarly authors methods derived form numerical engineering zt hw 
applications interactive deformable objects 
virtual surgery prominent example poses strict requirements fidelity 
thin deformable objects employed simulation cloth virtually dressing actors commerce customers 
simulations able reflect real materials applications virtual avatars focused accuracy 
moment computer games 
include physical realism soon necessary computing power widely available 
mass spring damper systems favored technique long time allow physical constants spring stiffness unable model homogenous materials vg 
possible model incompressibility transverse contraction model additional penalty forces 
reasons techniques numerical engineering finite element fem digital hard copies part personal classroom granted fee provided copies distributed profit commercial advantage copies bear notice full citation page 
copy republish post servers redistribute lists requires prior specific permission fee 
journal wscg vol issn wscg february czech republic 
copyright union agency science press 
nite difference fdm methods continue versatile accurate methods 
drawbacks computational expenses 
sufficient computational power available allow real time simulations physical accurate modelling 
simulations especially costly nonlinear systems involved 
unfortunately soon finite deformations considered measures strain nonlinear known geometrical nonlinearity 
closely linked invariance strain measure rigid body rotations 
classical linear cauchy strain widely metal concrete rotational invariant 
usual solution green tensor nonlinear displacements 
rotation problem obvious analysis orbiting structures dv solved rotating coordinate system compensating rigid body movements 
coupling single rigid body frame deformable simulation exploited terzopoulos tw 
generalization corotational formulation fel attaching local coordinate systems points elements mesh 
idea way computer graphics warping heuristics mmd 
employ polar decomposition enhance accuracy stability minor additional costs 
addition base rotation estimates hierarchical finite element basis 
allows stable nonlinear simulation coarse level strains finer levels resulting stable algorithm 

previous related terzopoulos metric tensor large displacement measure describe deformation small displacement measures common 
medical applications published bn linear finite elements cauchy small strain tensor 
real time animation explicit finite elements green tensor 
basis linearize floating frame 
hierarchical bases introduced numerics ban traced back th century 
adaptive bases extended concept basis gks 
idea floating frame exploited muller mmd 
linearizing green tensor introduce technique named warping extrapolate frame locally cauchy tensor warped coordinate systems 
computer graphic society relatively unaware polar decomposition 
able find duff sd keyframe matrix animation 
problem shows similarities needed separate strain rigid body descriptions 
similar application polar decomposition currently evaluated cloth simulations ke 
methods related discuss general case 
considering time integration methods advanced cloth simulation 
baraff bw implicit methods standard allowing larger time steps standard explicit methods paying price solving large linear systems 
employ variety implicit methods framework 

outline section describe physical modelling process 
section gives overview finite element techniques tailored needs 
section completes simulator briefly describing time integrator 
section application presenting results follows 
conclude section lessons learned directions research 

physical model section mathematical description strain related material behavior leading partial differential equation describes deformable object 
prove rotational invariance green tensor show rotated coordinate system allows linear cauchy tensor 

continuum mechanics solids mathematically deformable solid configuration mapping ir ir maps point material coordinates position space time common identify material coordinates body rest state usually time id convention configuration split id identity displacement field continuum mechanics ag know elastic energy arising displacement field outer tensor product el ij ij symmetric strain tensor symmetric stress tensor 
writing tensors standard matrix notation product defined tr applications stress strain related material law mapping current strain current stress 
el remains decide compute kind material law apply 

hooke law straight forward approach leads linear relation tensors hooke law 
isotropic materials entries distinct lame constants component notation ij ij kk ij kronecker 
dynamical simulation including inertia need viscous damping forces system coming rest 
standard approach apply elastic correspondence principle formulate damping forces way elastic forces replacing strain rate tensor oh 
simpler linear lumped rayleigh damping forces proportional linear velocity point damp rigid body modes 
amore complex material law frequency dependant elasticity held quasi linear variables wide class materials 
techniques proposed generalized setting 

elastic strain tensors commonly strain tensors lagrangian formulations parametrization rest state 
nonlinear green strain tensor ij 
linearization cauchy strain tensor ij green tensor written terms gradient configuration id 
invariance rotations seen id orthogonality hold cauchy tensor 
produces ghost forces lead distortions demonstrated examples 

corotational strain green tensor leads stiff nonlinear ode computationally expensive solve 
corotational formulation aims elimination geometrical nonlinearity 
idea keep track rotated coordinate system body fig 

employed single frame entire structure analysis orbiting space aircraft structures techniques obviously necessary dv 
unfortunately single frame 
considering long bar fig 
fixed bent shows sufficient keep track single rigid body movement 
attached part rotated may undergo arbitrarily large rotations 
moment suppose point know local rigid body rotation corotational cauchy stress trivially rotationally invariant strain description linear 
arising forces transformed back note contrast muller separating rotation deformation rotating frame 
non moving bar large rotations 
mmd discretize rotation field element vertex 
results finer representation tensor field consistent finite element modelling paradigm 

extracting rotation field major difference muller way rotations extracted 
stability sensitive rotation field heuristics called warping 
extracts rotations deterministic selection edges point mesh tracks rotations 
sufficient rigid body movement superimposed deformed configuration warping roughly follows produce large ghost forces 
accuracy suffers approximation directly clear rigid body mode arbitrarily deformed element looks 
way extract defined rotation employing polar decomposition deformation gradient 
solves problem find orthogonal minimizing frobenius norm gives rise decomposition rs reduces contain rotational component 
factor rotation closest tion gradient space matrices equipped frobenius norm sd 
dimensions straight forward compute sign det subsequent normalization columns gives higher dimensions higham hs proposed efficient quadratically convergent iteration scheme 
deformation gradient may singular case pure rotation coordinate axes qr decomposition ahead core algorithm proposed higham 
results robust fast algorithm 
seldomly need iterations 

principle virtual minimizing energy equating variation adding body forces surface traction inertia viscous damping forces arrive principle virtual dx dx weak partial differential equation 

spatial discretization section describe briefly transform ordinary differential equation finite elements 
full description refer standard textbooks taylor zt 

standard finite elements standard finite element approach functions replaced piecewise polynomial approximations decomposition disjoint elements simple shape 
properties tetrahedra usually preferred computer graphics 
discretization employs linear shape functions resulting piecewise affine approximation 
approximated 
inserting principle virtual leaves ordinary differential equation mass matrix mass density nonlinear operators load vectors 
integrals evaluated locally piecewise elements summed 
basis linear constant tetrahedron greatly reducing cost evaluation arranging computations carefully gives cost flops green tensor element evaluation operator 
corotational tensor transforms linear operator evaluated triangulation summed 
consistent finite elements rotation element keeps jacobian system symmetric rotation node breaks symmetry 
transform explicit second order ode standard form mass matrix needs inverted 
costly precomputed decompositions apply row sum mass lumping 
price mass lumping slight artificial increase viscosity depending mesh zt 

hierarchical approximations multi resolution representation employ hierarchical basis ban order able different strain measures different levels 
coarse tetrahedral discretization series nested meshes constructed tetrahedron 
hierarchical representation function described values nodes coarsest level difference nodal value finer level linear interpolation parent nodes 
key efficiency algorithms linked kind hierarchical representations fast basis transformations 
efficient wavelet transformation possible carry computations wavelet approximation minimal changes code 
details implementation refer hgs 

implicit time integration detailed analysis reveals eigenvalues linearisation located negative complex halfplane problem considered stiff 
physical interpretation fact system bounded solution limited amount energy transferred converges rest state 
numerical stability analysis hw characterizes stable integrations methods deliver bounded solution stability region covers parts complex plane 
eigenvalues system scaled located inside region 
unfortunately explicit methods possess bounded usually small stability region near zero sufficiently small fulfill stability restrictions 
implicit methods possess unbounded stability region covering complex halfplane negative real parts 
case artificial limit time step allowing arbitrary large steps hw bw 
drawback implicit methods solution large case green tensor nonlinear equation systems 
usually newton method involving jacobian respect basis coefficients 
advantage formulation obvious systems solved time step remain linear 
gives speedup depending original number newton iterations 
compared classical linear finite elements linear systems change time frames updated 
built layered solver core described employing integration formulas newton method backtracking 
example section backward euler bdf 
linear solver cg method block diagonal preconditioner sparse lu factorization reordering dd 
gauss method usually faster cg small systems 
small drawback factorizations expensive solves fast 
result jittering frame rates large systems 

application details results implemented prototype application framework laid 
tests performed desktop willamette 
room time sec relative force error cauchy polar hybrid warp example pressure forces 
time sec relative force error cauchy polar hybrid warp example shear forces 
improvements 
example corotational formulations special path 
implicit solver jacobian affine mapping computed force evaluation contributions tetrahedron summed 
exploiting computed jacobian speed roughly factor force computations major part workload 
memory consumption moderate hierarchical bar example takes total mb liver takes mb including texture 

example forces compare quality warping heuristics applied element polar decomposition performed experiment green tensor simulation rotated cube side length performing single rotation 
cube sheared constant force top surface 
coming rest rotated 
resulting local coordinate systems shown video 
pass visual test rotating globally rigid rotations locally shear deformation 
second video internal stress forces green black cauchy red polar green warped tensors violet computed 
ideally match green model 
time sec signed relative error polar msec 
hybrid msec 
warp msec 
polar msec 
hybrid msec 
warp msec 
example 
shearing 
time sec signed relative error polar hybrid warp example 
shearing rotating 
rotation deformation see phantom forces cauchy tensor switch rest video 
forces zero 
shear movement warped forces split green forces 
due fact green tensor second order model strain ones linear 
polar decomposition roughly halves error compared warping 
course rotational invariant 
figs 
plotted relative error different force contributions leaving away 
picture confirms observations shows error especially large pressure component 
introduced hybrid tensor shown blue combining green tensor pressure tensor shear forces 
cheap terms force computations course system nonlinear 
tensor jacobian updated correctly including nonlinear terms rotation frame updated 

example displacements example employs bar similar fig 
size time step ms gauss cpu newton evals lu dec time jacobi time step ms update rate ms green wa ped polar hybrid time step ms update rate ms green wa ped polar hybrid time step ms update rate ms rotating green wa ped polar hybrid table runtime details example 
solver 
bar discretised tetrahedra 
shear force rising linearly applied top surface time simulation performed tensor separately 
error measure chose relative error upper right front corner compared green 
results fig 
similar identifying hybrid formulation best warping worst 
change rotated frame updated time step 
ms 
causes gauss preconditioner updates frequent cost computing frame negligible table 
bring method limit performed test imposing rotation choosing time step ms updating frame ms degree rotation fig 

brings methods close showing favor tensors polar decomposition 
reaching rest position bar resulting oscillating error 
hybrid tensor suffers bad frame combined inaccurate jacobian due nonlinear pressure forces 
delaying updates deg 
linearized methods unstable green tensor newton iterations increase system remains stable 
rotation corotational formulations stay stable larger update rates time steps green tensor steps 
examples conclude corotational formulations perform especially rigid body movements fast compared time step 
tetrahedra gives realtime factor faster nonlinear simulation 
polar decomposition helps cut example 
tetrahedra 
induced error additional computational costs 
warping heuristics reasonable job able really extract essence rotation especially obvious comparing forces 

example hierarchical simulation example addresses corotational tensors hierarchical setting 
coarsest level green tensor allowing stable simulation 
configuration coarse level rotation state computed polar decomposition deformation gradient propagated finer levels 
necessary iterated recomputing rotations levels 
just top level 
coarse level linear algebra cheap perform full nonlinear simulation finer levels system linearized solved cg adding detail reduced computational costs 
computational costs finer levels dominate 
bar shown fig 
discretized tetrahedra steps give fine elements 
add rising top shear force rotate bar shown video simulation time step ms update rate ms coordinate systems 
specular highlights video silhouette fig 
show smooth deformation gained fine discretization 
coarse surface red wireframe 
computation time real time 
takes preconditioned cg steps iterations time steps smooth error finer levels 
comparison complete nonlinear simulation computed relative deformation error corner 
larger previous examples frame tetrahedra 
example 
liver tetrahedra 

example deforming liver experiment shows application virtual medicine 
employs liver model cm roughly measured shown fig 
top 
opaque parts possess homogenous dirichlet boundary condition fixed 
initial tetrahedralization elements add single level tetrahedra 
liver pushed region marked green arrows 
fine level surface stays smooth compared coarse initial seen fixed parts silhouette 
simulation application spent time step ms bdf 
video discloses small drawback large number coarse tetrahedra 
second update rotation frames recomputes linearized jacobian update coarse nonlinear jacobian including lu decomposition coincide giving unpleasant speed shift 
cured just delaying tasks coarser top level mesh decomposition faster 

system visual simulation deformable models 
corotational formulation keeps systems solved linear especially important fine discretizations cost solving linear systems grows polynomially dimension 
significant contribution polar decomposition extracting rotation state application hierarchical finite element setting 
compared approach muller mmd 
addition examined error arising corotational approximation nonlinear tensor 
point addressed previous 
examples show corotational approximation induces error give speedup factor applied hierarchical case 
polar decomposition warping heuristics helps decrease introduced error 
hybrid tensor reduce error computation times rise due reintroduced nonlinearity 
stability enhanced comparing admissible time steps published mmd ms 
step sizes ms examples stable ms 
especially hierarchical approach benefits unconditionally stable top level 
look adaptivity better subdivision schemes suffering fast factor growth 
adaptive mesh coarsening alleviate jittering effects seen example 

authors modelling multimedia assistance wand making point anonymous reviewers valuable comments 
partially funded dfg 

ag 
theory elasticity scientists engineers birkhauser boston 
ban randolph bank 
hierarchical bases fi nite element method 
acta numerica pages 
bn bro nielsen 
finite element modeling medical vr 
journal ieee 
bw david baraff andrew witkin 
large steps cloth simulation 
michael cohen editor siggraph conference proceedings pages july 
steve seth green brian curless tom duchamp zoran popovic 
interactive dynamic deformations 
siggraph pages 
acm siggraph 
dd timothy davis jain duff 
combined method unsymmetric sparse matrices 
acm trans 
math 
softw 
gilles mathieu desbrun cani alan barr 
dynamic real time deformations space time adaptive sampling 
siggraph pages 
dv de 
dynamics flexible bodies 
int 
engrg 
sci pages 
fel 
nonlinear finite element methods 
lecture notes university colorado colorado edu courses home html 
gross andg 
modelling soft tissues 
int 
workshop deformable modelling soft tissue simulation 
elsevier november 
gks schroder 
simple framework adaptive simulation 
siggraph conference proceedings pages 
acm press acm siggraph 

high performance solver animation deformable objects advanced numerical methods 
proc 
eurographics pages manchester uk 
hgs gross 
interactive physically solid dynamics 
proc 
siggraph symposium computer animation 
hs nicholas higham robert schreiber 
fast polar decomposition arbitrary matrix 
siam sci 
stat 
comput 
hw wanner 
solving ordinary differential equations ii 
springer verlag berlin 
ke michael olaf 
cloth simulations virtual 
private communications 
mmd muller mcmillan dorsey cutler 
stable real time deformations 
proceedings acm siggraph symposium computer animation pages 
acm press 
oh james brien jessica hodgins 
graphical modeling animation brittle fracture 
siggraph pages 
sd ken shoemake tom duff 
matrix animation polar decomposition 
proceedings graphics interface pages may 
tf terzopoulos fleischer 
deformable models 
visual computer 
tw demetri terzopoulos andrew witkin 
physically models rigid deformable components 
ieee computer graphics applications november 
vg allen van gelder 
approximate simulation elastic membranes triangle meshes 
journal graphics tools 

hierarchical bases 
pages 
siam 
zt taylor 
finite element method 
vol 

oxford 

