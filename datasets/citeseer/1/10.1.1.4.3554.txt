journal computational biology volume numbers mary ann pp 
continuous representations time series gene expression data ziv bar joseph georg gerber david gifford tommi jaakkola simon algorithms time series gene expression analysis permit principled estimation unobserved time points clustering dataset alignment 
expression pro le modeled cubic spline piecewise polynomial estimated observed data time point uences smooth expression curve 
constrain spline coef cients genes class similar expression patterns allowing gene speci parameters 
show unobserved time points reconstructed method error compared previous best methods 
clustering algorithm operates directly continuous representations gene expression pro les demonstrate particularly effective applied nonuniformly sampled data 
continuous alignment algorithm avoids dif culties encountered discrete approaches 
particular method allows control number degrees freedom warp speci cation parameterized functions helps avoid tting 
demonstrate algorithm produces stable low error alignments real expression data show speci application yeast knock data produces biologically meaningful results 
key words time series expression data missing value estimation clustering alignment 

principled methods estimating unobserved time points clustering aligning microarray gene expression time series needed data useful detailed analysis 
datasets measuring temporal behavior thousands genes offer rich opportunities computational biologists 
example dynamic bayesian networks may build models try understand genetic responses unfold 
modeling frameworks need suf cient quantity data appropriate format 
current gene expression time series data meet requirements may missing data points sampled nonuniformly measure biological processes exhibit temporal variation 
mit laboratory computer science technology square cambridge ma 
mit arti cial intelligence laboratory technology square cambridge ma 
whitehead institute biomedical research cambridge center cambridge ma 
bar joseph applications researchers may face problem reconstructing unobserved gene expression values 
values may observed reasons 
errors may occur experimental process lead corruption absence expression measurements 
second may want estimate expression values time points different originally sampled 
case nature microarray data straightforward interpolation dif cult 
data noisy replicates 
simple techniques interpolation individual genes lead poor estimates 
additionally cases large number missing time points series gene making gene speci interpolation infeasible 
case clustering treatment time series problematic time series represents set dependent experiments 
particular problem arises series sampled uniformly spellman 
chu 
eisen 

variability timing biological processes complicates gene expression time series analysis 
rate similar underlying processes cell cycle unfold expected differ organisms genetic variants environmental conditions 
instance spellman 
analyze time series data yeast cell cycle different methods synchronize cells 
clear cycle lengths different experiments vary considerably series different phases cell cycle 
needs method align series comparable 
statistical spline estimation represent time series gene expression pro les continuous curves 
method takes account actual duration time point represents previous approaches treat expression time series static data consisting vectors discrete samples eisen friedman 
algorithm generates set continuous curves directly estimating unobserved data 
method uses spline curves piecewise polynomials represent gene expression pro les reasonable gene individual spline due issues microarray datasets discussed 
constrain spline coef cients genes class similarly allowing gene speci parameters 
class set genes similar expression pro les may constructed prior biological knowledge clustering methods 
clustering algorithm infers classes automatically operating directly continuous representations expression pro les 
particularly effective applied nonuniformly sampled data 
note method require data sampled suf ciently high rate 
demonstrate section method performs datasets datasets sampled rates low capture changes underlying biological processes method effective 
direction method determine quality sampling rate 
alignment algorithm uses spline representation expression pro les continuously series 
parameterized function chosen maps time scale series 
parameterized functions explicitly specifying number allowed degrees freedom helpful avoiding tting 
algorithm seeks maximize similarity sets expression pro les adjusting parameters warping function 
remainder organized follows 
section brief splines 
section discuss algorithm estimating unobserved data section extend algorithm perform clustering 
section alignment algorithm 
section presents applications method expression data section concludes suggests directions 

related papers focused modeling analyzing temporal aspects gene expression data 

time translational matrix model temporal relationships different modes singular value decomposition svd 
method focuses svd modes speci genes 
addition relationships time points sampled lowest common frequencies studied 
available expression data 
zhao 
statistical model genes order nd cell cycle regulated 
method uses custom tailored model relying periodicity speci dataset analyzed general approach 
continuous representations time series data papers simple interpolation techniques estimate missing values gene expression data 
aach church linear interpolation estimate gene expression levels unobserved time points 
haeseleer 
spline interpolation individual genes interpolate missing time points 
show section techniques approximate expression curve gene especially missing values 

techniques missing value estimations explored 
suggested techniques take account actual times points correspond time series data treated way static data 
consequence techniques estimate values time points measured original experiments 
considerable statistical literature deals problem analyzing nonuniformly sampled data 
models known mixed effect models rice spline estimation methods construct common class pro le input data 
james hastie reduced rank mixed effects model classifying medical time series data 
extend methods gene expression data 
papers focus gene speci aspects common class pro le 
addition method able deal cases class membership 
difference james hastie reduced rank approach gene expression datasets contain information thousands genes 
clustering algorithms suggested gene expression analysis see shamir appear 
far aware algorithms treat input vector data points take account actual times points sampled 
contrast algorithm weights time points differently sampling rate 
aach church method aligning gene expression time series dynamic time warping discrete method uses dynamic programming conceptually similar sequence alignment algorithms 
method allowed degrees freedom warp operation aach church depends number data points time series 
algorithm allows mappings multiple time points single point stopping time datasets 
contrast algorithm avoids temporal discontinuities continuous warping representation 
substantial body speech recognition computer vision community deals data alignment 
instance nonstationary hidden markov models warping parameters alignment speech data deng mutual information methods registering medical images viola 
methods generally assume high resolution data case available gene expression datasets 

splines splines piecewise polynomials boundary continuity smoothness constraints 
widely elds computer aided design image processing statistics bartels watt watt eubank james hastie 
piecewise low degree polynomials results smooth curves avoids problems tting numerical instability oscillations arise single high degree polynomials 
cubic splines number desirable properties 
instance cubic polynomials lowest degree polynomials allow point ection 
restrict subsequent discussion cubic case 
cubic spline represented equation nx cisi tmin tmax id parameter time si polynomials ci coef cients 
typical way represent piecewise cubic curve simply jcl xj xjc 
bar joseph xj denote break points piecewise polynomials 
cubic polynomials denoted pj ld order determine coef cients polynomials equations required 
speci es value dj plus continuity constraints second derivative piecewise polynomial break point xj equations obtained internal break points pj xj dj pj xj pj xj xj xj xj xj additionally specifying values points pn xn dn yields total equations 
order solve spline coef cients additional equations needed 
typically equations obtained specifying rst second derivatives points spline 
note explicitly speci es values pj xj break points formulation equation particularly useful de ning interpolating splines 

splines method discussed far de ning cubic splines easy understand exible mathematically convenient formulation applications 
alternately write cubic polynomial terms set normalized basis functions 
popular basis spline basis number desirable properties 
texts rogers adams bartels 
give full treatment topic 
discussion limited features relevant 
signi cantly application tting curves gene expression time series data quite convenient spline basis obtain approximating smoothing splines interpolating splines 
smoothing splines fewer basis coef cients observed data points helpful avoiding tting 
regard basis coef cients ci interpreted geometrically control points vertices polygon control shape spline interpolated curve 
shown curve lies entirely convex hull controlling polygon 
vertex exerts local uence curve varying vector control points vector knot points discussed easily change continuity properties curve 
normalized spline basis calculated cox recursion formula rogers adams xi bi xi bi bi xi bic order basis polynomials cubic polynomial 
values xi called knots uniform knot vector entries evenly spaced uniform knot vector resulting spline called periodic basis functions translates bi bi bic 
see fig 
example 
periodic cubic spline equation specifying curve written nx id spline basis allows write particularly simple matrix equation tting splines set data points 
suppose observations time points tm giving vector dm continuous representations time series data fig 

spline basis functions periodic translates uniform knot vector 
shown normalized cubic spline basis knot vector basis functions shown spline de ned shaded region overlap 
data points 
write matrix equation sc vector control points matrix ij bj ti 
number control points equals number data points square equation may solved matrix inversion yielding interpolating spline 
discussed may lead tting desirable fewer control points data points obtain smoothing approximating spline 
case matrix equation solved squares sense yields 
estimating unobserved expression values time points order obtain continuous time formulation cubic splines represent gene expression curves 
mentioned knowing value splines set control points time series generate entire set polynomials spline basis functions 
formulation spline control points uniformly spaced cover entire duration dataset 
spline polynomials generated resample curve estimate expression values time points 
estimating splines expression data try gene individually 
due noise missing values approach lead tting data may general lead estimates different real expression values gene see section 
constrain spline coef cients genes covariance matrix genes class estimate missing values speci gene 

probabilistic model time series expression data section follow method similar james hastie classi cation 
focus gene speci aspects common class pro le 
allows handle variations expression levels caused gene speci behavior 
class set genes grouped prior biological knowledge clustering algorithm 
section assume class information 
discuss deal cases class information section 
bar joseph represent gene expression pro le spline curve 
gene class yi observed value time number spline control points vector spline basis functions evaluated time dimensions 
denote average value spline coef cients genes class gene speci variation coef cients 
assume normally distributed vector mean zero class spline control points covariance matrix matrix 
denote random noise term normally distributed mean variance model yi written yi model includes gene speci class speci parameters 
allows information genes class extent gene speci information missing 
restrict missing values gene requiring vary observed values class covariance matrix class average gene speci variation resample gene time experiment 
done evaluating spline basis time setting yi 
order learn parameters model observed values maximize likelihood input data 
denote yi vector observed expression values gene si spline basis function evaluated times values gene observed 
observed total expression values dataset si dimensions kth row si contains spline basis functions evaluated tk tk time kth value observed 
model yi si vector noise terms 
note estimating spline coef cients control points observed value effect related actual time represents 
different experiments different effects resulting curve expression values sampled nonuniformly 
solution assume expression values gene obtained independently genes 
assumption entirely true different experimental conditions affect multiple genes experiment 
simplifying assumption allows ef cient computations allows capture essence results 
normally distributed parameters model noise term gene speci parameters combined covariance matrix gene class written spline basis function evaluated time points experiments carried 
formulation determining maximum likelihood estimates model parameters non convex optimization problem see james hastie 
turn em algorithm 
values observed decomposed probability way translates joint probability ni ni exp exp yi si yi si number classes cj set genes class note need maximize joint probability simultaneously classes variance noise assumed genes 
continuous representations time series data representation leads procedure 
treat missing data solve maximum likelihood problem em algorithm 
step nd best estimation values 
step maximize equation respect holding xed 
see james hastie complete details 
complexity iteration em algorithm cc estimate parameters gene parameters class 

model clustering algorithm temporal data algorithm described previous section allows nd expression curve gene class partitioning known 
information available previous knowledge classi cation algorithm spellman case 
section describe new clustering algorithm simultaneously solves parameter estimation class assignment problems 
xed class model section assume mixture model 
model expression vector gene way 
select class gene uniformly random 
sample class covariance matrix sample noise vector construct yi setting yi si fig 
spline tting algorithm performs class assignment 
number desired classes input 
initially classes assumed prior probabilities easy modify algorithm prior knowledge different classes 
begins choosing class gene random gene initial estimate class center average spline coef cients 
treat class assignments missing variables iterate modi ed em algorithm 
step estimate gene class probability belongs class jji values obtained rest parameters step 
step equation maximize parameters fig 

estimating model parameters class information 
posterior jji clustering described text 
bar joseph class respect class probability jji computed step 
addition treat parameters nd map maximum posteriori estimate step 
complete details procedure explained appendix 
previous section increases likelihood monotonically terminates parameters converge 
algorithm converges gene discover class jji max kji assign class 
hard clustering need resample gene expression curve missing values estimation new time points estimated class parameters continue described previous section 
complexity iteration em algorithm cq estimate cq parameters gene 

aligning temporal data goal alignment algorithm warp time scale realization biological process 
set genes chosen members assumed temporal pattern expression prior biological knowledge clustering methods 
parameterized warping function selected algorithm seeks produce optimal alignment adjusting function parameters 
note possible align individual genes problematic suf ciently high quality data replicates large number time points 
assume sets time series gene expression pro les refer set 
denote spline curve gene time series smin smax 
smin smax starting points time series respectively 
similarly denote splines set warped tmin tmax 
de ne mapping transforms points scale time scale set warped 
discuss linear transformation stretch squash parameter translation 
complex transformations framework 
de ne alignment error gene ds tmin starting point alignment tmax point 
error alignment gene proportional averaged squared distance curve gene set set warped 
order take account degree overlap curves avoid trivial solutions mapping values curve single point divide error time length overlap 
goal nd parameters minimize discussed suggest minimizing error set genes 
de ne error set genes size es nx id wie wi weighting coef cients sum uniform unequal weighting 
instance wishes align wildtype time series expression data knockout data genes expression patterns expected unchanged experiments 
subset genes may highly affected 
case want weight contribution genes expected align 
way formulating require product wie genes weight inversely proportional error 
wie get es nk deduce wi wi es continuous representations time series data wi 
objective minimize es case equivalently maximize minimization es done numerically closed form solution possible 
linear case searching parameters minimize es directly standard nonlinear optimization techniques 
nelder mead simplex search method available matlab package gradients handle discontinuities 
linear warping case essential constraints 
numerical optimization method guarantee convergence global minimum multiple random restarts may necessary 
leads algorithm running time number random restarts number iterations convergence number genes number spline control points 
large numbers genes aligned suggest algorithm reduce computation time 
choosing random subset xed size genes random initial settings warping parameters uniform distribution 
minimization procedure carried process repeated new random choice warping parameters set number iterations 
termination alignment parameters correspond minimum error chosen 
parameters starting conditions es minimization full set genes 
see section experimental results reduces running time gene expression datasets 

results section demonstrate application method expression time series datasets showing results unobserved data estimation clustering alignment 
results cell cycle time series data spellman 

authors identify genes saccharomyces cerevisiae cell cycle regulated 
authors assigned genes groups refer 
analyzed time series data fkh fkh knockout experiment done zhu 

table summarizes data sets 

unobserved data estimation test missing value estimation algorithm concentrated cdc dataset 
chose dataset see table largest experiments contains nonuniformly sampled data 
results section obtained splines control points similar results obtained different numbers control points results shown 
compared algorithm interpolation techniques previous papers linear interpolation aach church spline interpolation individual genes haeseleer nearest neighbors knn achieved best results static data algorithms described 

order test algorithm large scale chose genes random set cell cycle regulated genes 
genes ran estimation algorithm different times hiding consecutive time points altering genes 
computed error estimations compared estimate variance log ratios expression values see appendix complete details 
shows comparison error estimation algorithm methods mentioned 
method performed separate runs 
rst class information provided table 
summary gene expression time series analyzed data set method arrest start sampling alphads alpha mating factor cdc ds temp 
sensitive cdc mutant ev 
hr ev 
hr ev 
min nal hr cdc ds temp 
sensitive cdc mutant fkh fkh ds alpha mating factor ev 
bar joseph fig 

comparison different missing value interpolation techniques 
finding missing values nding missing experiments time points originally sampled 
seen cases algorithm better methods 
spellman 
second algorithm described section obtain class information 
missing value algorithm achieves error nearest neighbors knn 
missing values algorithm achieves lower equal error rates compared knn far better interpolation techniques 
trying estimate consecutive missing values knn perform better algorithm 
consecutive missing values unusual practice cases need estimate consecutive values 
interestingly algorithm better allowed estimate class membership class information prespeci ed 
attributed fact classes spellman 
somewhat arbitrary divisions continuous cycle 
missing value estimation clustering algorithm able assign relevant class labels 
algorithm estimate expression values time point course experiments 
fig 
results obtained hiding consecutive experiments 
algorithm achieves error techniques 
note knn estimate missing experiments included comparison 

clustering order explore effect nonuniform sampling clustering generated synthetic curves follows 
rst curve obtained equation sin second curve equation sin sin sampled curve times sampled remaining portion curve different rates 
note curves sampled maximal difference sampled values amplitude curves 
different sampling generated vectors curve added random noise normally distributed mean variance 
algorithm compared results means clustering 
means clustering algorithm assumes mixture model tries assign genes classes class centers see shamir appear details 
means treats points way actual times represent 
seen fig 
lower sampling rate larger difference continuous representations time series data fig 

comparison means clustering vectors 
success rate determined total number correctly clustered vectors vectors 
seen lower sampling rate greater advantage algorithm 
performance means 
example sampling rate means slightly better chance higher classi cation success 
tested cdc ds described compared results means 
algorithms generated classes 
analyzing results spellman clusters gold standard determined clusters results correspond clusters 
results table 
seen clusters generated correspond clusters containing neighboring phases genes fth contained genes consecutive phases 
dealing cell cycle data clusters de ned spellman 
arbitrary boundaries joining reasonable 
hand means clustering result cluster contains genes different phases cluster contains genes different phases 
results clustering algorithm better correspondence existing biological knowledge means 

alignment aligned yeast cell cycle gene expression time series clearly occur different time scales different phases 
cdc ds set alphads cdc ds aligned linear warping full set cell cycle regulated genes identi ed spellman 

cdc ds obtained es 
results indicate cdc ds cell cycle runs approximately times table 
comparison means clustering cdc ds means phase cluster seen cases clusters generated contains genes neighboring phases 
means cluster contains genes different phases 
bar joseph speed cdc ds cycle starts approximately minutes calculate cdc ds starts minutes 
alphads obtained es 
fig 
shows aligned unaligned expression values clusters cdc ds cdc ds alignment 
alignment dataset took approximately minutes ghz pentium iii machine algorithm performs initial alignments smaller subsets genes alignments took approximately minutes improvement 
validate quality alignments performed analyses alignments genes alphads genes cdc ds gene identity cdc ds randomly permuted alignments alphads cdc ds different numbers genes 
note brevity alphads chose dataset smallest presumably demonstrates worst case results 
rst analysis performed trials giving es scores scores lying 
results suggest actual alphads cdc ds es score arise chance alignment genes 
second analysis sampled subsets genes times full set cell cycle regulated genes table 
analysis shows variance parameters decreases genes convergence settings full set genes 
interestingly algorithm usually able nd actual parameter settings relatively small numbers genes 
analyses give evidence algorithm reliably align cell cycle datasets 
results compare favorably aach church data 
case actual alignment score low percentile compared alignments randomized data gene values shuf ed 
indicate poor results obtained small cluster sizes analysis wide range sizes 
fact method uses continuous representation ts parameters genes helps explain performance cell cycle data 
careful extrapolating results clearly dependent underlying dataset 
second application alignment algorithm method discover yeast cell cycle regulated genes appear regulated fkh transcriptional factor 
zhu 
performed experiment yeast transcriptional factors fkh fkh knocked timeseries gene expression levels measured synchronized cells 
simon 
demonstrated microarray dna binding experiment set genes bound fkh wildtype unsynchronized yeast 
interested discovering genes set show altered expression knockout fig 

alignment genes cdc ds cdc ds 
linear warping full set cell cycle regulated genes 
left hand side shows class averages unaligned expression values clusters 
top row shows aligned results cluster genes bottom row cluster genes 
results indicate cdc ds cell cycle runs approximately times speed cdc ds cycle starts approximately minutes 
continuous representations time series data table 
results experiments random subsets fixed size sampled times alignment alphads cdc ds performed genes std std columns follows number genes stretch squash parameter standard deviation parameter offset parameter standard deviation parameter 
analysis shows variance parameters decreases genes convergence settings full set genes 
experiments 
direct comparison data zhu 
spellman 
problematic series sampled different rates different cell cycle phases exhibit different periods 
algorithm rank fty genes bound fkh difference expression curves aligned wildtype knockout experiments 
nonuniform weighting version algorithm align datasets genes identi ed cell cycle regulated spellman 
gene alignment error scores ranking 
shows plot spline expression pro les top genes worst alignment scores top best scores 
poor alignment score indicates gene behaving differently knockout experiment 
ranking produced algorithm appears yield biologically meaningful results highlighting genes appear regulated fkh merely bound 
instance genes worst alignment scores shown determined bound fkh fkh fig 

alignment fkh fkh knockout data wildtype alphads 
genes shown set genes demonstrated bound fkh 
shown genes worst top row best bottom row gene alignment scores 
poor score indicates gene behaving differently knockout experiment 
see text biological interpretation results 
bar joseph simon 
best aligning genes determined bound fkh 
corresponds biological knowledge indicating fkh fkh required regulation number genes 
interesting genes shown alignment bound swi mbp swi factors independently fkh proteins 
genes poor alignment known bound ndd mcm ace swi 
mcm ndd known fkh proteins suf cient regulate expression 
ace swi apparently bind regulate independently fkh proteins expression fkh dependent 

uni ed model algorithms statistical spline estimation represent gene time series expression pro les continuous curves 
results approach large yeast cell cycle dataset demonstrate framework estimating unobserved time points clustering alignment datasets substantial advantages methods treat time series vectors points 
believe analysis dynamic genetic behavior sophisticated principled model methods essential reconstructing combining data 
number interesting extensions 
experimental biologists determine sampling rate time series experiment knowledge quickly gene expression values change 
assessments little information may gleaned previous expression experiments 
algorithm nd right sampling rate time series experiments lead substantial time cost savings improvements biological results 
way extending develop clustering algorithm uses alignment method order group genes show similar kinetic changes datasets 
open problem developing principled method determining signi cance alignment error order automatically detect genes temporal behavior altered experiments 
em algorithm class assignment appendices appendix details em algorithm section 
start complete log likelihood log jji ni exp yi si yi si exp class index ni number observed values gene jji unobserved binary indicator variable assigns gene exactly class 
step compute expected values jji jji jji pj yi si yi si step rst nd map estimate setting pke yi si kc yi si kc st si yi si continuous representations time series data maximize class assignment probabilities computed step jji yi si yi si trace st si si computed setting set computing error rates jji si ni jji yi si jji st si jji describe detail method compute error rates different missing values algorithms discussed section 
denote yi hidden expression values gene time yi estimated values 
denote number missing hidden data points number genes test 
denote variance log ratios expression values 
error estimation missing data points de ned mn nx mx id ld yi tl yi tl error average bigger replication variance vice versa 
variance computed raw expression data unsynchronized cells different time points 
acknowledgments supported fellowship program mathematics molecular biology florida state university funding burroughs fund interfaces program 
aach church 
aligning gene expression time series time warping algorithms 
bioinformatics 
bartels beatty barsky 
splines computer graphics geometric modeling morgan kaufman 
rice 
smoothing spline models analysis nested crossed samples curves 
am 
statist 
assoc 

chu derisi 
transcriptional program yeast 
science 
deng sun wu 
recognition hidden markov models polynomial regression functions nonstationary states 
ieee trans 
speech audio processing 
haeseleer wen fuhrman somogyi 
linear modeling mrna expression levels cns development injury 
psb 
bar joseph eisen spellman brown botstein 
cluster analysis display genome wide expression patterns 
pnas 
eubank 
nonparametric regression spline smoothing marcel dekker 
friedman linial nachman pe er 
bayesian network analyze expression data 
recomb 

dynamic modeling gene expression data 
pnas 
james hastie 
functional linear discriminant analysis irregularly sampled curves 
stat 
soc 
appear 
neal 
fundamental patterns underlying gene expression pro les simplicity complexity 
pnas 
rogers adams 
mathematical elements computer graphics mcgraw hill 
shamir appear 
algorithmic approaches clustering gene expression data 
curr 
topics comp 
biol 
appear 
simon barnett 
serial regulation transcriptional regulators yeast cell cycle 
cell 
spellman sherlock 
comprehensive identi cation cell cycle regulated genes yeast saccharomyces microarray hybridization 
mol 
biol 
cell 
cantor 
missing value estimation methods dna microarrays 
bioinformatics 
viola 
alignment maximization mutual information ph thesis mit ai lab 
watt watt 
advanced animation rendering techniques addison wesley reading ma 
zhao prentice 
statistical modeling large microarray data sets identify pro les 
pnas 
zhu spellman 
yeast genes regulate cell cycle growth 
nature 
address correspondence ziv bar joseph mit laboratory computer science technology square cambridge ma mail mit edu 
