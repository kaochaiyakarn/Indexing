technical report ic epfl september 
artificial immune system approach misbehavior detection mobile ad hoc networks jean yves le boudec sa epfl ic isc lca ch lausanne switzerland jean yves epfl ch 
mobile ad hoc networks nodes act terminals information relays participate common routing protocol dynamic source routing dsr 
network vulnerable routing misbehavior due faulty malicious nodes 
misbehavior detection systems aim removing vulnerability 
investigate artificial immune system ais detect node misbehavior mobile ad hoc network dsr 
system inspired natural immune system vertebrates 
goal able build system natural counterpart automatically learns detects new misbehavior 
describe step design employs negative selection algorithm natural immune system 
define map natural immune system concepts self antigen antibody mobile ad hoc network give resulting algorithm misbehavior detection 
implemented system network simulator glomosim detection results discuss system parameters impact results 
steps extend design analogy innate system danger signals costimulation memory cells 
problem statement detecting misbehaving nodes dsr mobile ad hoc networks self organized networks infrastructure user terminals equipped radios 
communication transmission range possible having nodes act terminals information relays 
turn requires nodes participate common routing protocol dynamic source routing dsr 
problem dsr works nodes execute protocol correctly difficult guarantee open ad hoc environment 
possible reason node misbehavior faulty software hardware 
classical non ad hoc networks run operators equipment malfunction known important source unavailability 
ad hoc network routing performed user provided equipment expect problem exacerbated 
reason misbehavior stems desire save battery power nodes may run modified code participate dsr example forward le boudec packets 
nodes may truly malicious attempt bring network internet viruses worms 
extensive list misbehavior 
main operation dsr described section 
simulation implement faulty node time time forward data route requests respond route requests cache 
consider problem detecting nodes correctly execute dsr protocol 
actions taken detecting node misbehaves range forbidding node relay excluding node entirely participation network :10.1.1.42.559
focus detection misbehavior discuss actions taken detection 
chose dsr concrete example protocols considered standardization mobile ad hoc networks 
routing protocols parts mobile ad hoc networks routing need misbehavior detection example medium access control protocol 
believe main elements method apply detailed analysis 
traditional misbehavior detection approaches traditional approaches misbehavior detection knowledge anticipated misbehavior patterns detect looking specific sequences events 
efficient targeted misbehavior known advance system design powerful statistical algorithms :10.1.1.13.9006
detect misbehavior dsr buchegger le boudec reputation system 
node calculates reputation node hand observations second hand information obtained 
reputation node determine countermeasures node undertaken 
key aspect reputation system second hand information order avoid false accusations 
countermeasures misbehaving node aimed isolate packets sent node packets sent node ignored 
way nodes stimulated cooperate order get service maximize utility network benefits cooperation 
authors artificial immune system reputation system example non bio inspired immune system 
contains interactions healthy elements behaving nodes detection exclusion reactions non healthy elements misbehaving nodes 
compare natural innate immune system section sense hardwired nodes changes new versions protocol 
traditional approaches ability learn adapt new misbehavior 
target misbehavior imagined advanced explicitly addressed detection system 
motivation artificial immune system approach 
artificial immune system ais approaches ais uses analogy natural immune system vertebrates 
approximation described self non self model follows give details section 
ais mobile ad hoc thought able classify cells body self non self cells 
distinct sets components innate adaptive innate hard wired detect non self destroy cells contain contain specific patterns surface 
adaptive complex 
produces large number randomly created detectors 
negative selection mechanism eliminates detectors match cells protected environment bone marrow thymus self cells assumed 
non eliminated detectors naive detectors die time match assumed pathogen case memory cells 
detectors match pathogen quickly multiplied clonal selection accelerate response attacks 
clones exact replicates mutated mutation rate increasing function affinity detector antigen provides focused response pathogen affinity maturation 
provides adaptation changing non self environment 
self nonself model crude approximation adaptive important aspect danger signal model 
model matching innate adaptive mechanism sufficient cause detection additional danger signal required 
danger signal example generated cell dies old 
danger signal model better explains adapts changing non self changes self 
aspects fully understood see section 
nodes appendix bone marrow nodes thymus spleen patches nodes isa isa isa isa isa isa isa isa artificial immune system agent fig 

natural ais making dsr immune node misbehavior 
artificial immune systems related forrest uses ais intrusion detection wired local area networks 
negative selection part self nonself model form danger signal 
tcp connections play role self nonself cells 
connection represented triplet encoding sender destination address receiver destination address receiver port number 
detector bit sequence le boudec length triplet 
detector matches triplet contiguous bits equal fixed system parameter 
candidate detectors generated randomly learning phase detectors match correct self triplets eliminated 
done offline presenting correct tcp connections 
non eliminated detectors finite lifetime die match non self triplet danger signal sent humans confirmation case potential detection 
drawback human intervention required eliminate false positives allows system learn changes self 
terminology statistical pattern classification danger signal viewed form supervised training 
similarly dasgupta gonz lez ais approach intrusion detection negative selection genetic algorithms 
major difficulty building artificial immune system framework mapping biological concepts computer network elements 
kim bentley show straightforward mappings computational problems lead poor performance introduce efficient representation self nonself 
show computational weakness negative selection add clonal selection address problem 
subsequent papers examine clonal selection negative selection operator dynamical clonal selection showing different parameters impact detection results 
overview ais see book de castro de castro von 
contribution organization long term goal understand previous traditional approach benefit ais approach introduces learning adapting mechanisms 
step direction 
problem solve mapping natural concepts framework 
key issue strongly influences detection capabilities 
describe solution section 
representation self nonself matching functions start general structure proposed kim bentley adapt case 
define resulting algorithm step negative selection 
main contribution phase definition mapping construction ais adapted case implementation glomosim simulator performance analysis 
rest organized follows 
section gives background terminology dsr natural immune system 
section gives mapping detection system dsr misbehavior detection detailed definition detection system 
section gives simulation specific assumptions constraints simulation results discussion results 
section draws describes learned exploit steps 
background dsr basic operations dynamic source routing protocol candidate standards routing mobile ad hoc networks 
source route list nodes intermediate relays reach destination 
written data packet header source intermediate relays simply look determine hop 
ais mobile ad hoc dsr specifies sources discover maintain source routes 
discover source route node broadcasts route request packet 
nodes receive route request add address source route collecting field packet broadcast packet cases 
case route request received node node discards packet 
received route requests considered belong route discovery identified value source destination sequence number fields request packets 
second case receiving node destination route discovery route destination cache node sends route reply message contains completed source route 
links network bidirectional route replies sent reversed collected routes 
links bidirectional route replies sent initiator route discovery included new route request generated answering nodes 
new route requests destination source initial route request 
node initiate original route request gets usually route replies containing different route 
replies arrive earlier expected indicate better routes node send route reply required wait time proportional number hops route answer 
node hears neighbor node answers waiting time supposes route worse neighbor answer 
avoids route reply storms unnecessary overhead 
initiator route discovery gets route reply sends data obtained route 
packets sent route route maintained way node route responsible link sends packets 
link route breaks node detects send link send error messages source 
additionally salvage packets destined broken link reroute alternate partial routes destination 
mechanisms just described basic operation dsr 
additional mechanisms gratuitous route replies caching routes forwarded overheard packets dsr flow state extension 
natural immune system main function protect body different types pathogens viruses bacteria parasites clear debris 
consists large number different innate acquired immune cells interact order provide detection elimination attackers 
short overview self nonself danger models 
functional architecture line defense body consists physical barriers skin membranes respiratory reproductive tracts 
prevents body entered easily pathogens 
innate immune system second line defense 
protects body common bacteria worms viruses clears debris 
interacts adaptive immune system signaling presence damage self cells activating adaptive le boudec adaptive immune system learns invaders tunes detection mechanisms better match previously unknown pathogens 
provides effective protection viruses enter body cells 
adapts newly encountered viruses memorizes efficient fast detection 
innate immune system consists cells complement proteins natural killer cells 
big cells attracted bacteria process called 
complement proteins destroy common bacteria 
complement proteins send signals immune cells attack 
adaptive immune system consists main types lymphocyte cells cells cells 
cells covered antibodies 
antibodies proteins capable chemically bind nonself antigens 
antigens proteins cover surface self nonself cells 
chemical binding happen antibody antigen depends complementarity dimensional chemical structures 
antigen antibody said cognate 
complementarity exact antibody may different cognate antigens 
happens binding depends additional control signals exchanged different cells explain 
cell covered type antibody cells may different antibodies 
cells fresh cells created daily healthy human large number different antibodies time 
diversity antibodies created antibodies match self antigens answer process creating cells 
cells created stem cells bone marrow rearrangement genes immature cells 
stem cells generic cells immune cells derive 
rearrangement genes provides diversity cells 
leaving bone marrow cells survive negative selection antibodies cell match self antigen bone marrow phase cell dies 
cells survive self tolerant 
cells fully self tolerant self antigens bone marrow 
self tolerance provided cells created way cells thymus organ 
cells self tolerant self antigens cells negative selection thymus 
antibodies cell match antigens pathogen self cell call event signal antigens processed surface cell 
major complex mhc molecules function 
antibodies cell bind antigens cell activated additional control signal detection verified confirmation signal sent cell cell call event signal 
signal starts process producing new cells able match pathogen better 
process called clonal selection 
signal absent means detected antigens probably self antigens cells tolerant 
case cell die self reactive antibodies 
ais mobile ad hoc cells clonal selection confirmation signal case matching cell antibodies antigens strong 
occurs high probability memory cells cells verified past match nonself antigens 
clonal selection phase cell divides number clones similar strictly identical antibodies 
statistically clones match pathogen triggered clonal selection better original cells match worse 
pathogens antigens triggered clonal selection continue trigger new cells match pathogen clone 
process continues reproducing cells specific pathogens 
cells specific memory cells need costimulation signal 
process positive feedback produces large number cells specific pathogen 
additionally cells chemicals pathogens 
process stops pathogens cleared body 
debris produced process cleared innate immune system 
memory cells live long ready react promptly cognate pathogen 
time encountered pathogens require weeks learned cleared secondary reaction memory cells takes usually days 
danger signal additional control activating cells 
cell antibodies bind antigens mhc cell signal cell activated sends signal cell receives confirmation signal signal antigen presenting cell apc 
apc give signal cell nonself antigens happens apc receive danger signal self cells innate immune system 
danger signal generated damage self cells usually due pathogens 
example danger signal generated cell dies old cell debris different cell dies old age killed pathogen 
subtle mechanisms fully understood 
particular time constants regulation system lifetime cells probability reproduction play important role performance 
expect tune similar parameters carefully ais 
design detection system mapping natural elements detection system elements natural detection system mapped follows 
body entire mobile ad hoc network self cells behaving nodes non self cells misbehaving nodes antigen sequence observed dsr protocol events recognized sequence packet headers 
examples events data packet sent data packet received data packet received followed data packet sent route request packet received followed route reply sent 
sequence mapped compact representation explained section 
le boudec antibody pattern format compact representation antigen section 
chemical binding binding antibody antigen mapped matching function explained section 
negative selection bone marrow antibodies created offline learning phase 
bone marrow protected environment mapped network certified nodes 
deployed system testbed nodes deployed operator simulation environment preliminary simulation phase 
antigen antibody matching function antigens represented traces observed protocol events 
low bit rate networks rapidly generates sequences long seconds observation interval single sequence may gbit long making generation large number patterns prohibitive 
recognized analyzed kim bentley follow adapt case describe 
node system monitors neighbors collects protocol trace monitored neighbor 
protocol trace consists series data sets collected nonoverlapping intervals activity time monitored neighbor 
data set consists events recorded time interval duration default additional constraint maximum ns events data set ns default 
data sets transformed follows 
protocol events mapped finite set primitives identified labels 
simulation list 
rreq sent rrep sent rerr sent data sent ip source address monitored node rreq received rrep received rerr received data received ip destination address monitored node data set represented sequence labels alphabet defined example 
second number genes defined 
gene atomic pattern matching 
list 
gene sequence gene sequence gene sequence gene sequence sub pattern number sub patterns sub pattern sequence representing label 
example number sub patterns long labels genes map sequence intermediate representation gives ais mobile ad hoc values different genes data set 
example mapped antigen consists genes gene value encoded bits follows 
range values gene bellow threshold value uniformly divided intervals 
position interval gene value belongs gives position bit set gene final representation 
threshold expected reached exceeded rarely 
values threshold encoded belong interval 
bits set 
example threshold value defined genes equal mapped final antigen format antigen seconds monitored node activity time monitored node 
bit representation called nucleotide 
antibody matching function 
antibodies format antigens may number nucleotides equal antigen exactly gene 
antibody matches antigen cognate antibody position antigen 
advocated method allows detection system coverage large set possible nonself antigens relatively small number antibodies 
antibodies created randomly uniformly set possible antibodies 
negative selection antibodies match self antigen discarded 
genes defined intention translate raw protocol sequences meaningful descriptions 
node detection classification matching antigen decide monitored node misbehaves expect ais false positives occur 
say monitored node detected suspicious data set interval duration corresponding antigen matching antibody 
detection done interval duration monitored node classified misbehaving probability node suspicious estimated sufficiently large number data sets threshold 
threshold computed follows 
assume processed data sets monitored node 
mn number data sets node detected suspicious 
max bound probability false positive detection detection behaving nodes misbehaving willing accept consider node detected probability max correct node take default take max 
default classification error willing accept 
classify monitored node misbehaving mn max max max le boudec quantile normal distribution example 
long equation true node classified behaving 
default parameter values condition mn derivation equation appendix 
detection classification algorithm detection classification algorithm executed node addition standard dsr code start collecting data sets learning phase start phase timer collecting data sets learning phase new packet sent received overheard collecting data sets interval started start new collecting data sets interval start interval timer create update neighbors list create update collecting data sets neighbors sent received packet collecting data sets interval timer expired close current open data sets max 
number collected data sets reached finish collecting data sets learning phase collecting data sets learning phase timer expired finish collecting data sets learning phase finished start negative selection phase negative selection phase generate antibody random antibody matches self antigen delete antibody memorize antibody update number antibodies counter max 
number antibodies reached finish negative selection phase start detection classification phase true new packet sent received overheard collecting data sets interval started start interval timer create update neighbors list create update collecting data sets neighbors sent received packet collecting data sets interval timer expired close current open data sets create antigens data sets collected interval check newly created antigens detection antibodies update detection data check detection data nodes classification classification criterion section equation system parameters ais mobile ad hoc maximal number self antigens collected learning maximal time collecting self antigens number antibodies number genes antigen number nucleotides gene maximal number sent received events recorded data set maximal time collecting data set accepted misbehavior threshold max classification error tolerance 
implementation values parameters shown parenthesis chosen extensive pilot simulation runs compromise detection results small memory computation usage detection system 
simulation results description simulation implemented pass system glomosim simulated environment mobile ad hoc networks :10.1.1.48.4634
simulate network nodes 
simulation area rectangle dimensions nodes initially deployed grid distance neighbors equal mobility model random way point fixed speed radio range traffic generated constant bit rate packets length bytes sent inject misbehaving node 
simulations parameters default value number self antigens collected learning number antibodies taken parameters 
simulation results generated static network types misbehavior defined 
misbehavior implemented modifying dsr implementation glomosim 
implemented misbehavior non forwarding route requests non answering route cache non forwarding data packets 
misbehaving node misbehave 
contrast fixed probability simulation parameter 
performance metrics show simulation results metrics true positive detection percentage successfully detected nonself antigens false positive detection percentage mistakenly detected self antigens correct classification time time misbehaving node classified sufficiently large number positive detections occurred see equation false classification percentage behaving nodes mistakenly classified misbehaving 
false positive detection classification uses evidence antigens 
performed independent replications experiments order obtain confidence intervals 
graphs confidence intervals 
le boudec simulation results shows dependence detection results probability misbehavior packet misbehaving nodes behaving nodes probability zero 
number antibodies number self antigens collected learning 
small probability misbehavior difficult distinguish misbehaving nodes case impact misbehavior small 
node misbehave probability equal greater distinguished nodes observed antigens 
high probability misbehavior percentage true positive detection decreased 
neighbors misbehaving node collect data behavior send packets distinguish nodes 
shows effect number self antigens collected percentage detection misbehavior probability percentage detection true positive detection false positive detection true positive detection false positive detection percentage detection number antibodies true positive detection false positive detection number self antigens fig 

probability correct detection misbehaving nodes true positive behaving nodes false positive data set collected interval versus probability misbehaving node number self antigens collected learning number antibodies 
psfrag replacements target ais mobile ad hoc learning 
number antibodies probabilities misbehavior equal types misbehavior 
number self antigens collected learning small self nonself antigens mainly detected antibodies antibodies possibility learn detect 
mainly random coverage self sets antigens 
false positive detection decreases fast increasing number self antigens learning reaches saturation self antigens 
unwanted effect true positive detection decreased little nonself antigens similar self antigens detected cases remains high value 
shows impact number antibodies 
number self antigens collected learning probabilities misbehavior equal types misbehavior 
number antibodies small coverage self nonself antigens antibodies small 
increasing number increases coverage increases true positive detection 
false positive detection remains small antibodies mainly self tolerant 
saturation curves reached increasing number antibodies increases processing cost improve detection 
compromise optimal value chosen 
time target false classification target false classification fig 

time correct classification misbehaving nodes false classification ratio versus target false positive classification probability 
shows decreasing targeted upper limit false classification probability price increased average time correct classification misbehaving nodes 
range targeted upper limits false classification probability values false classification ratio target smaller values case 
reason may correlation detection results consecutive detection intervals 
important show parameter may chosen compromise low delay classification small ratio 
complete ais done automatically 
false classification ratio le boudec designed method apply artificial immune system approach misbehavior detection mobile ad hoc network 
simulations show detection capabilities early phase premature draw performance ais approach 
need experiments extend initial misbehavior traffic patterns 
focus experience designing phase tells 
mapping ais difficult problem encountered mapping concrete problem dsr misbehavior detection 
followed approaches large number fundamental issues remain unclear 
highest level wonder best choice target unit detected node sequence messages message 
choice large impact design challenges possible detection system 
stay mapping designed things remain vastly open 
definition genes 
defined ad hoc way trying guess definitions best detection capabilities 
sure correlated genes misbehavior order capture efficiently 
propose correlation genes important criterion selecting genes defined antigen structure 
phase planning automate process selecting genes 
correlation genes offered set genes computed experimental data normal operation network misbehaving nodes 
pairs triples tuples genes score high cross correlation selected automatically 
final selection candidate genes require screened human expert intervention considerably simpler designing genes scratch 
observe gene selection process part natural view accelerated selection process 
alternative define genes arbitrary low level bit patterns negative clonal selection job keeping relevant antibodies 
line original motivation ais 
problem approach require genes processing effort needed generate detectors increases exponentially number genes 
possible angle attack observation resource management system 
mechanisms multiply cells send parts body attack resources needed 
analog randomization steady state small random subset protocol event sequences create antigen 
attack signalled danger signal see events analyzed regions danger 
innate system danger signal model implemented step able learn changing self problem constant dsr protocol case mobility traffic patterns similar learning phase 
order able adapt mobility model traffic pattern changes eventually changes dsr model ais mobile ad hoc additional mechanisms danger signals 
danger signals defined network performance indicators packet loss delay 
natural danger signal intimately linked innate system 
innate system mapped traditional approach set pre defined detection mechanisms developed :10.1.1.13.9006
new attacks accompanied symptoms new 
innate system source danger signal 
free resources focus adaptive immune system detection truly new unexpected misbehavior 
clonal selection memory effects implemented step straightforward 
expected benefit better reaction misbehavior repeats 
regulation translation non self antigen matching detection done classical statistical way 
compared regulation cell cell clonal division algorithmically different 
parameter tuning appropriate mapping ais remains performance sensitive parameters parameters carefully tuned 
unclear today dependency exists natural selection takes care choosing values inherently stable control mechanisms accurate tuning important 
understanding key designing ais large class controlled systems 

sergio marti giuli kevin lai mary baker 
mitigating routing misbehavior mobile ad hoc networks 
proceedings mobicom pages 

buchegger 
le boudec robust reputation system mobile ad hoc networks 
technical report ic epfl di ica lausanne switzerland july 

buchegger 
le boudec 
performance analysis confidant protocol cooperation nodes fairness distributed ad hoc networks 
proceedings ieee acm symposium mobile ad hoc networking computing mobihoc lausanne ch june 
ieee 

buchegger 
le boudec 
effect rumor spreading reputation systems mobile ad hoc networks 
proceedings modeling optimization mobile ad hoc wireless networks sophia antipolis france march 

hofmeyr 
immunological model distributed detection application computer security 
phd thesis department computer sciences university new mexico april 

hofmeyr forrest architecture artificial immune system 
evolutionary computation 


kim bentley 
artificial immune model network intrusion detection th european conference intelligent techniques soft computing aachen germany 
le boudec 
kim bentley 
evaluating negative selection artificial immune system network intrusion detection genetic evolutionary computation conference gecco san pp 
july 

kim bentley 
artificial immune system network intrusion detection investigation clonal selection negative selection operator 
evolutionary computation cec seoul korea pp 
may 

kim bentley 
artificial immune system network intrusion detection investigation dynamic clonal selection 
congress evolutionary computation cec honolulu pp may 

tolerance danger extended family 
annual review immunology 


danger model historical 
scandinavian journal immunology 


immune system works nd edition 
blackwell publishing 

tak mak 
order disorder recognition regulation immune system 
phil 
trans 
soc 
lond 
may 

xiang zeng bagrodia mario gerla 
glomosim library parallel simulation large scale wireless networks 
proceedings th workshop parallel distributed simulations pdas may banff alberta canada 

johnson maltz 
dynamic source routing protocol mobile ad hoc networks 
internet draft mobile ad hoc network manet working group ietf february 

iannaccone 
chuah bhattacharyya diot 
analysis link failures ip backbone 
proceeding 
acm press 
marseille france 
november 
de castro von 
artificial immune systems part basic theory applications technical report rt dca 
de castro jonathan artificial immune systems new computational intelligence approach springer verlag berlin 
dasgupta fabio gonz lez immunity technique characterize intrusions computer networks ieee trans 
evol 
comput june pp derivation equation model outcome behavior node random generator unknown fixed probability data set interpreted suspicious 
assume outcome fictitious generator iid 
classical hypothesis framework 
null hypothesis max node behaves 
maximum likelihood ratio test rejection region form mn function 
function type error probability condition mn max best obtained solving equation mn max distribution mn binomial approximated normal distribution mean variance 
algebra gives max max max equation derives immediately 
