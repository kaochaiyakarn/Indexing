image similarity mutual information regions daniel carlo tomasi torsten calvin maurer jr department computer science stanford university stanford ca usa daniel cs stanford edu image guidance laboratories stanford university stanford ca usa department computer science duke university durham nc usa 
mutual information mi emerged years effective similarity measure comparing images 
drawback mi calculated pixel pixel basis meaning takes account relationships corresponding individual pixels pixel respective neighborhood 
result spatial information inherent images utilized 
propose novel extension mi called regional mutual information rmi 
extension efficiently takes neighborhood regions corresponding pixels account 
demonstrate usefulness rmi applying real world problem medical domain intensity registration ray projection images ct image 
gold standard spine image data set show rmi robust similarity image registration mi 
mutual information mutual information mi variables concept roots information theory essentially measures amount information variable contains 
put way reduction uncertainty variable know 
mi introduced similarity measure images simultaneously viola maes 
similarity measure number advantages 
particular assumes prior functional relationship images 
assumes statistical relationship captured analyzing images joint entropy 
mutual information closely related joint entropy 
specifically image image joint entropy calculated pab log pab pab joint probability distribution pixels associated images joint entropy minimized mapping matas eds eccv lncs pp 

springer verlag berlin heidelberg image similarity mutual information regions pixels counterparts increases statistical relationship weakens 
dealing discrete images express entropies sums integrals 
general divine probability distribution associated image binning values histograms 
mutual information considers joint entropy individual entropies px log px mi defined intuitively viola notes maximizing mutual information images try find complex overlapping regions maximizing individual entropies explain minimizing joint entropy 
similarity measure mutual information enjoyed great deal success particularly medical imaging domain 
robust outliers efficient calculate generally provides smooth cost functions optimize 
important drawback mutual information way comparing images fails take geometry account considers pixel values pixel positions 
previous number extensions mutual information 
overlap invariant extension called normalized mutual information introduced 
different methods calculating entropy 
extensions continues ignore important spatial information images 
researchers begun extend mutual information include spatial information 
particular mutual information multiplied term compares local gradients images 
second order mutual information defined 
formulation involves calculating marginal joint entropies pixel neighbor single pixel 
cases add amount spatial information existing framework mutual information cases validate metrics problem medical image registration 
papers report final accuracy registrations essentially mutual information 
real improvement incorporating spatial information lies robustness measure 
robust similarity measure smooth convex landscape respect misregistration specifically local extrema way global optimum 
report improved robustness metrics standard mutual information 
important limitations 
neighbor time considered leaves great deal spatial information 
extend mutual information mi multiplied different term accounts neighborhood information 
regional mutual information rmi extension mutual information incorporates spatial information way leads smoother robust energy functions previously reported 
organized follows section presents formulation justification rmi details algorithm calculating 
section presents results testing algorithm vs mi medical image registration problem clinical gold standard validation 
sections discuss related research directions 
regional mutual information formulation mutual information compare images actual probability distributions associated image known 
marginal joint histograms usually calculated approximate respective distributions 
logical way extend mutual information extend dimensionality histograms 
example standard mutual information set pixel occurrences joint distribution represented entry dimensional joint histogram 
consider corresponding pixels immediate neighborhoods 
entry joint histogram 
calculate mutual information exactly time histograms marginal probabilities histogram joint distribution 
way think dimensional histogram set points mutual information treats images distributions pixel values 
formulation rmi begins recasting problem treat image distribution multi dimensional points point represents pixel neighborhood depicted 
curse dimensionality point run curse dimensionality 
essentially space points reside grows exponentially new dimension added 
offers look problem 
done created multi dimensional distributions known entropies normal exponential estimated entropies varying number samples 
important thing notice dimensionality increases samples needed populate space get reasonable estimate entropy 
distributions samples image similarity mutual information regions fig 

illustration relationship image region corresponding multi dimensional point 
corresponding image neighborhoods multi dimensional point representing joint distribution 
percentage true number samples fig 

illustration curse dimensionality pertains sampling entropy 
axis number samples axis percentage true entropy get samples approximate entropy 
dimensionality increases linearly need exponentially increasing number samples get reasonable estimate distribution entropy 
sufficient approximate entropy correctly 
samples correspond roughly comparison images resolution impractical real world applications image similarity 
simplifying assumption take advantage fact entropy discrete distribution invariant rotations translations order problem tractable 
specifically try rotate translate high dimensional distribution space dimension independent 
restatement independent components analysis ica problem defined bell sejnowski 
unfortunately ica extremely underdetermined problem computationally expensive purposes 
simplifying assumption high dimensional distribution approximately normally distributed 
case need transform points space uncorrelated normal assumption implies independence 
independence dimension allows decouple entropy calculation involving dimensional distribution involving independent dimensional distributions 
specifically entropy normally distributed set points covariance matrix hg log det 
mathematically equivalent transforming points new basis bu dimension uncorrelated projecting data new axes summing entropies independent dimensional distributions 
practice high dimensional distribution represented set data points pn calculate approximation entropy centering data respect mean diagonalizing covariance matrix summing entropies dimension 
process principal components analysis pca essentially doing summing entropies orthogonal principal modes variation 
algorithm method efficiently calculating entropy highdimensional histogram calculate rmi pair images 
algorithm proceeds follows 
images corresponding pair pixels aij bij create vector vij representing occurrences pixels neighbors specified square radius vector point pi dimensional space image margins handled number ways 
chose simply ignore pixels edges assume pronounced effect final entropy 
radius images distribution points represented matrix pn 

subtract mean points centered origin pi 
calculate covariance points image similarity mutual information regions 
estimate joint entropy hg 
estimate marginal entropies hg ca hg cb ca matrix top left cb matrix bottom right 

calculate rmi hg ca hg cb hg asymptotically rmi performance standard mutual information 
images performance standard mutual information 
similarly rmi performance represents required calculate covariance matrix 
remains constant choice neighborhood radius asymptotically rmi performance converges 
justification general dimensional projections data vectors independent identically distributed values tend normally distributed 
high level observation derived appeal central limit theorem 
unfortunately case vectors data independent pixel values close generally independent central limit theorem hold 
forms central limit theorem allow weak dependence data 
form proven holds central limit theorem applies case dependent variables 
sequence random variables xn dependent positive integer inequality sets xk xs xs xn independent 
data dependent vectors central limit theorem apply implies dimensional projections data tend normally distributed 
demonstrate data independent dependent tend support assumption projections normal 
intuitively dependence requires variables far away sequence independent 
case data point represents sequence pixels 
pixel values locally dependent pixels far apart sequence neighborhood drawn independent 
size neighborhood increases pixels far apart sequence representing neighborhood independent 
mentioned earlier calculating rmi equivalent projecting data axes new uncorrelated basis bu summing entropies 
test validity assumption projections generally normal generated random pairs medical images amorphous silicon detector ray images type expect see typical registration problem 
calculated rmi usual projected data axes bu kolmogorov smirnov normality test percentage normal projections neighborhood radius fig 

random ray images plot mean percentage projections bu normal vs radius neighborhood 
predicted central limit theorem percentage projections considered normally distributed increases radius increases 
determine projections considered normal 
pair images performed test neighborhood radii ranging 
results seen suggest tradeoff time calculate rmi accuracy assumption 
experimentally radius low works quite practice 
results validation mentioned mutual information image similarity measure enjoyed large degree success medical image registration applications 
chose validate rmi just problem specifically medical image registration 
registration problem involves xray projection images patient anatomy projections determine rigid transformation rotation translation aligns coordinate system ct image ray projection images operating room 
registration important primitive applications image guided spine surgery 
validate rmi means performing intensity registration experimental set clinical gold standard 
archived clinical data system sunnyvale ca includes preoperative contrast ct image similarity mutual information regions table 
spine image target registration error similarity tre mm unsuccessful measure mean registrations rmi mutual information rueckert scan orthogonal intraoperative amorphous silicon detector ray images built gold standard calculated bone implanted fiducial markers 
compared rmi mutual information implemented histograms implementations aforementioned similarity measures spatial information rueckert 
number similarity measures problem including cross correlation gradient correlation measures take neighborhood relationships account 
focus mutual information real data shown accurate 
experiments experiment involved initial transformation generated perturbing gold standard transformation adding randomly generated rotations translations 
initial transformations characterized computing target registration error tre transformation grouped initial tre intervals mm 
patients lesions lesions similarity measure registrations performed misregistration intervals 
tre value computed registration transformation difference positions target mapped evaluated transformation gold standard transformation 
tre values computed voxel inside rectangular box bounding vertebra closest lesion averaged 
registrations characterized successful tre mm unsuccessful tre mm 
results listed table 
see slightly accurate real win rmi lies robustness success rate respect misregistration 
take detailed look robustness plot percentage successful registrations vs initial tre similarity measures 
measures perform started close initial solution initial tre increases rmi performs better 
time initial tre range mm rmi performs better best measure 
terms cpu time difference standard mutual information rmi quite small 
average registrations mutual information took sec rmi took sec 
percentage successful mi rmi rueckert robustness initial tre mm fig 

percentage successful registrations initial transformations different initial tre values 
data point represents mm range initial tre values centered coordinate 
noisy ct data intensity registration requires accurate ct scan 
usually means patients required hold breath scan breathing artifacts don introduce noise data 
patients able hold breath sufficient period time 
don usually leave cts noisy severely affect performance image registration algorithm 
performed experiments patients ct scans contained severe breathing artifacts 
results seen show basic trends dramatic 
initial transformations close gold standard rmi succeeds time performance drops gradually measures 
discussion get closer look rmi robust mi analyzed specific situation data set mi fails 
particular considering independent parameters looked misregistration respect axis plotted rmi varying neighborhood sizes vs mi 
results shown illustrate advantages rmi 
mi clearly shows strong local maximum right global percentage successful image similarity mutual information regions patients noisy ct mi rmi rueckert initial tre mm fig 

percentage successful registrations initial transformations different initial tre values 
data point represents mm range initial tre values centered coordinate 
mi rmi mi pixels translated fig 

plot mutual information function misregistration axis 
includes plots rmi neighborhoods varying sizes 
maximum large affect success optimization 
consider rmi larger larger neighborhoods spatial information brought metric get stronger peak global optimum smoother accurate similarity landscape away 
mutual information image similarity measure enjoyed great deal success variety fields medical image registration particular 
extended mutual information principled way arrive rmi incorporates spatial information inherent images 
demonstrated rmi improved robustness similarity measure validated real clinical data medical imaging domain 
hope validate rmi extensively larger clinical data sets 
addition re interested applying rmi non rigid registration clinical data 
apply rmi problems domains creation image mosaics querying image databases tracking human motion 

cover thomas elements information theory 
wiley interscience new york 
viola wells iii alignment maximization mutual information 
international journal computer vision 
maes collignon marchal suetens multimodality image registration maximization mutual information 
ieee transactions medical imaging 
maintz viergever mutual information registration medical images survey 
ieee transactions medical imaging 
hill hawkes overlap invariant entropy measure medical image alignment 
pattern recognit 

rodriguez weighted deterministic entropy measure image registration mutual information 
medical imaging image processing proc 
spie 
ma hero gorman michel image registration minimal spanning tree algorithm 
ieee int 
conf 
image processing vancouver bc 
maintz viergever image registration maximization combined mutual information gradient information 
ieee trans 
med 
imaging 
rueckert clarkson hill hawkes non rigid registration higher order mutual information 
medical imaging image processing proc 
spie 
shannon mathematical theory communication 
bell system technical journal image similarity mutual information regions 
bell sejnowski information maximization approach blind separation blind deconvolution 
neural computation 
duda hart stork pattern classification 
john wiley sons 

diaconis freedman asymptotics graphical projection pursuit 
annals statistics 
hoeffding robbins central limit theorem dependent random variables 
duke mathematical journal 
computer assisted spinal surgery anatomy registration 
taylor eds computer integrated surgery technology clinical applications 
mit press cambridge ma 
hill hawkes voxel registration images ct scans image guided surgery 
ieee trans 
inform 
technol 
biomedicine 
murphy adler jr forster hai le martin image guided spine 
comput 
aided 

ryu chang kim murphy le martin adler jr image guided hypo spinal lesions 
neurosurgery 
maurer jr fast intensity image registration clinical data light fields 
proc 
th ieee int 
conf 
computer vision iccv 
little desmedt hill hawkes comparison similarity measures medical image registration 
ieee trans 
med 
imaging 
ho kim adler jr maurer jr evaluation intensity spine image registration clinical gold standard data 
gee maintz eds proc 
second int 
workshop biomedical image registration 
lecture notes computer science 
springer verlag berlin 
maurer jr fitzpatrick registration head ct images physical space weighted combination points surfaces 
ieee trans 
med 
imaging 
