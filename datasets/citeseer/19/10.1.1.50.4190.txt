reasoning belief cryptographic protocols li gong roger needham raphael yahalom university cambridge computer laboratory cambridge cb qg england february 
analysis methods cryptographic protocols focused information leakage seeing protocol meets goals 
protocols fall far short meeting goals quite subtle reasons 
introduce mechanism reasoning belief systematic way understand working cryptographic protocols 
mechanism captures features protocols proposals substantial extension 
solutions computer security problems years brought forth need rigorous analysis methods 
formal tools provided determine solution solves problem enable comparisons proposed solutions 
propose method reasoning cryptographic protocols distributed environment 
described inspired development modal logic reason authentication protocols refer ban logic 
seen new approach framework proposed 
ban aim analyze protocol step step explicit assumptions required draw final position attains 
new approach offer important advantages ban approach 
require universal assumptions ban 
example assume redundancy encrypted messages incorporating new notion recognizability captures recipient expectation contents messages receives 
published proceedings ieee symposium security privacy oakland california may pp 
raphael yahalom supported ibm uk academic systems marketing british government overseas research students award 
assume principal determine message originated 
distinguish possesses believes 
allows treat separately content message information implied message 
possible separate reasoning physical world reasoning principals beliefs consider different levels trust reasoning 
set notions expanded additional properties messages incorporated reasoning process 
existing notions modified correspond naturally execution states intuitive 
example encrypted plaintext formulae treated similarly permitting reasoning multiply encrypted messages 
plaintext messages considered ban approach useful cases derive 
new approach allows analyze wider range protocols 
summary significant differences ban appears 
rest organized follows 
section outline model computation 
section introduce notions corresponding notation 
section selected logical postulates underlying reasoning process 
complete set postulates descriptions included appendix section reasoning process described 
section introduce reasoning principals beliefs 
section needham schroeder protocol example highlights characteristics approach 
section discuss 
model computation model computation similar ban possesses characteristics models knowledge theoretic 
outline significant aspects model 
formal presentation appendix distributed environment consists principals essentially state machines connected communication links 
messages links constitute means communication principals 
principal place message link 
see alter message passed link 
protocol distributed algorithm 
protocol determines messages sent participating principals function internal states 
run particular execution protocol 
refer protocol run session 
principal session maintains sets belief set includes current beliefs principal possession set includes formulae available principal 
particular includes principal received principal generated random numbers current session 
principals start session certain initial beliefs initial possessions 
point principal obtain new beliefs expand belief set result receiving new messages 
inference rules described enable derivation new beliefs current beliefs incoming messages 
similarly principal increase possessions 
beliefs possessions monotonic session 
say belief possession member respective set phase session member set subsequent phase session 
claim sessions 
particular belief possession principal session necessarily member corresponding set past sessions principal participates 
universal assumption require principals reveal secrets 
fact convenience 
principals choose part initial beliefs trust respect 
basic trust principal limited ability attain new beliefs 
notions notation section introduce basic notions underlying reasoning process corresponding notation 
description informal aims providing intuitive understanding 
postulates section semantics appendix provide precise definition 
formulae formula name refer bit string particular value run 
name variable 
range formulae 
kinds special formulae shared secrets encryption keys denoted respectively 
formulae conjunction formulae 
treat conjunctions sets properties associativity commutativity 
fxgk fxg gamma conventional encryption decryption des 
assumed cryptosystems resistant ciphertext attacks 
addition bit ciphertext depends bits plaintext key way change plaintext causes random change ciphertext vice versa 
satisfy gamma necessarily gamma gk fxg fxg gammak public key encryption decryption 
addition requirements stated conventional cryptosystems satisfy gammak public key schemes rsa satisfy gammak way function required computationally feasible compute infeasible compute infeasible compute 
xn computationally feasible function constants cn gamma gamma cn gamma computationally feasible function inverse computationally feasible 
example exclusive function 
denotes computationally feasible function inverse computationally feasible 
statements basic statement reflects property formula 
range principals 
basic statements 
told formula receives possibly performing computation decryption 
formula told message computable content message 
possesses capable possessing formula particular stage run includes formulae told formulae started session ones generated run 
addition possesses capable possessing computable formulae possesses 
conveyed formula message content computable message formula conveyed implicitly 
jj believes entitled believe formula fresh 
purpose time current run protocol 
example counter random number generator sufficient quality serve produce formulae principal believes fresh called nonces 
jj oe believes entitled believe formula recognizable 
recognize certain expectations contents receiving may recognize particular value identifier particular structure format timestamp particular form redundancy 
jj believes entitled believe suitable secret may properly mutually prove identity 
may derive key communicate 
discovered principal principal trusted case trusted principal proof identity key communicate 
notation symmetrical interchangeably 
jj 
believes entitled believe suitable public key matching secret key gammak discovered principal principal trusted case trusted principal prove identity communicate 
range statements 
statements conjunction 
treat conjunctions sets properties associativity commutativity 
jj believes entitled believe statement holds 
originated formulae formula regarded originated formula denoted prefixing star formula statement indicates told formula convey previously current run 
suppose shared secret key constructs conveys formula fxgk told exact packet possibly encrypted keys reason conveyed reason sent 
originated formula implies conveyed recipient session conveyed previous sessions principal believe conveyed formula receives originated formula believes formula fresh 
pattern scanner screen normal protocol description insert stars correct places 
algorithm discussed section 
appendix discuss reasoning environments principals may believe identify messages originated session 
logical postulates section introduce logical postulates underlying reasoning process 
categories postulates 
describe category representative postulates 
complete list logical postulates description included appendix told rules set rules deals formulae principal receives 
regard formula principal receives certain manipulations formula decryption certain keys told principal 
examples told rules 
told formula implies told concatenated components 

fxgk principal told formula encrypted key possesses considered told decrypted contents formula 
possession rules set rules specify formulae principal capable possessing manipulating formulae possesses 
examples rules principal capable possessing told 
principal possesses formulae capable possessing concatenation formulae function 
freshness rules freshness rules specify formulae principal believe fresh beliefs freshness formulae 
recall principal belief freshness formula represents belief formula value previous run protocol 
jj jj jj believes formula fresh entitled believe formula component fresh computationally feasible function fresh 
convenience jj denote jj jj 
jj jj fxgk jj fxg gamma believes formula fresh possesses key entitled believe encryption decryption key fresh 
recognizability rules recognizability rules specify formulae principal believe recognizable beliefs recognizability formulae 
examples recognizability rules jj oe jj oe jj oe principal believes formula recognizable entitled believe formula component recognizable computationally feasible function recognizable 
jj oe jj oe fxgk jj oe fxg gamma principal believes formula recognizable possesses key entitled believe encryption decryption recognizable 
message interpretation rules rules enable principals advance beliefs principals examining messages receive 
postulate appendix includes freshness requirement may surprising 
consequence fact key shared principals secret construct formula 
principal convinced message shared secret replay messages message originated star associated believes message fresh 
fx gk jj jj oe jj jj jj fxgk jj principal conditions hold receives formula consisting encrypted marked originated mark possesses key believes suitable secret believes formula recognizable believes fresh 
entitled believe conveyed conveyed formula encrypted possesses example rules permit reasoning state sender jj jj jj believes conveyed formula believes fresh entitled believe possesses rationality rule supplement postulates rule call rationality rule 
informally states set postulates expanded permit reasoning principal beliefs regarding state principals 
precisely postulate principal jj jj example postulate obtain postulate jj jj jj believes capable possessing formulae believes capable possessing concatenation formulae function 
rationality rule represents view principals capable deriving rational state principals 
issues associated reasoning principals beliefs discussed section 
protocol analysis protocol parser protocols typically described listing messages sent principals symbolically showing source destination contents message 
form intuitively easy understand 
require simple transformations attain form suitable direct manipulation logic 
main point related fact typical protocol description distinction denotes fact convey current run protocol fact implicitly included description 
design parser explicitly inserts stars protocol description avoiding complex form logic required 
sketch general description parser algorithm 
line description error reported parser produces lines followed principal parser examines lines form scans 
pattern complete formula line appear line protocol parser inserts star parser mark 
completed parser drops lines form addition private key encryption parser replaces patterns form gamma similar replacements performed public key encryption 
annotated assertions protocol analysis consists annotating protocols statements manipulating statements postulates 
protocol sequence told statements delta delta delta cn form annotation protocol consists sequence assertions conjunctions statements inserted told statement told statement 
assertion contains assumptions contains 
understood formulae hoare logic 
ban assumptions hold assertion hold execution respective protocol prefix 
assertions derived syntactic application postulates statements 
goal analysis derive final positions principals protocol 
final position represented corresponding assertions 
example voting protocol simple voting protocol outline characteristics demonstrate reasoning process described far 
environment consists coordinator participants communication performed message passing 
participant shares secret denoted goal protocol elect principal position 
participant vote coordinator determines winner certain rules 
protocol requirements specify coordinator able identify votes current election principal possesses result protocol convinced generated coordinator current run 
protocol consists messages coordinator participant 
correspond request vote voting result announcement phases 
nonces generated respectively 
secret identification purposes denoted 
see appendix 



parser algorithm produce description protocol 



protocol analysis assume holds run protocol jj jj jj jj participants possesses secret believes coordinator 
possesses nonce believes freshness 
similarly coordinator possesses secrets believes principal 
possesses nonce believes fresh 
run protocol message applying obtain possesses message applying obtain 
possesses applying obtain jj 
believes fresh 
generated current run protocol replay message previous runs 
applying obtain jj 
applying obtain jj 
believes conveyed current run 
similarly message believes conveyed current run 
final position coordinator participant attain correspond specification goals outlined earlier 
particular coordinator position recognize fresh valid vote messages participants properly determine winner 
participants possess result generated coordinator current session 
reasoning process postulates considered physical level reasoning process 
principal advance beliefs increase possessions physical content messages receives 
consequently principal attain beliefs sent sender beliefs time message sent 
voting protocol participants convinced result originated coordinator way deriving coordinator believes validity result 
far formal protocol description include notions 
discussed section 
beliefs beliefs reasoning process described far permits kind jj jj jj 
principal beliefs physical world 
allow jj jj draw beliefs held principals 
choose separate types beliefs reasons 
examining contents messages quite directly derive possessor formula conveyor message reason physical world 
level need reasoning principals beliefs 
secondly principal expresses beliefs sending messages choose interpret beliefs sender part preconditions message sent 
recipient interpret receiving message 
message form may carry different context dependent meanings different protocols 
having believed message genuine recipient choose believe sender beliefs trusts sender honesty competence protocol specification 
words require universal assumption principals honest competent reason beliefs held trust different levels 
thirdly typical protocol specifications include verbal description effect principal proceed certain conditions hold holds certain beliefs 
regarded precondition 
feel approach natural 
precondition formula conveyed represented statement described protocol call message extension 
message contain number formulae destined different principals possibly different meanings 
clearly express scope 
recall parser may find pattern appears line form may indicate new formula conveyed certain precondition 
shall take example verbal explanation protocol descriptions translate language logic insert formula 
condition replicated pattern reappears messages 
lines form 
kept 
simplicity formula star prefix conditions attached principal derive new formula 
extension message considered part message principal conveyed formula augmented conveyed formula extension extension associated formula 
trust jurisdiction notion jurisdiction represent trust delegation 
jj believes jurisdiction statement believes principal authority trusted matter 
postulate describes jurisdiction formally jj jj jj jj states believes jurisdiction statement believes ought believe 
construct special case jurisdiction 
jj jj believes jurisdiction beliefs 
principal considered completely honest competent 
states believes honest competent receives message originated ought believe really believes special case 
jj jj jj jj jj jj jj jj jj jj jj jj jj levels trust defined reasoning 
example introduce notion representing fact principal protocol 
words relationship contents messages sends meaning maintained 
consequently similar postulate notion conclude jj jj jj jj clearly represents lower level trust enables weaker derived 
levels trust applied aspect principal behavior 
reflects fact principals trusted differently respect different tasks perform 
recall rationality rule introduced section enables principals increase beliefs concerning principals beliefs 
consistency protocol description approach reasoning principals states enables detect invalid inconsistent protocol descriptions 
particular principal include message formulae possesses time message constructed 
similarly principal imply beliefs reasoning holds time message sent 
note discussion refers protocol description protocol execution principals may lie 
checks performed possession consistency principal able include message sends formula possesses belief consistency message extension include beliefs held sender time message sent 
needham schroeder protocol section apply reasoning process needham schroeder authentication protocol 
choose protocol example influenced design significant number existing systems published protocols serves examples ban logic 
analysis provide insight differences approaches advantages offers 
rest section describe protocol analyze investigate modifications protocol affect final position participants 
protocol description general goal protocol principals provided shared secret 
secret consequently session key 
exists trusted authentication server shares common secrets potential participants generate quality sessions keys 
different authentication protocols may differ final positions principals attain 
different positions suffice different environments 
usually assumed minimum requirement run principal possess session key convinced validity quality key 
addition principal required believe state principal 
vary believing principal operational principal possesses key principal believes validity possessed key 
needham schroeder protocol consists messages 

fn fk 
fk 
fn gk 
fn gamma gk nonces respectively ps qs secrets respectively 
session key generated description add message extensions reflects verbal explanation protocol execution 
validity extensions discussed analysis protocol 
denote decrement computation 
parser produce output 



fn fk jj jj 
fk jj 
fn gk 
ff jj protocol analysis listing initial assumptions ps jj kps jj jj oe qs jj jj jj oe principal possesses secret believes secret authentication server 
possesses nonce believes fresh 
addition believes identifier recognizable believes recognizable 
jj jj jj jj jj jj jj jj jj jj believe jurisdiction quality secrets shared 
believe honest competent 
believes competent honest vice versa 
assumptions essential 
protocol attain useful final position principals completely trust tell truth 
shall see added trust represented assumptions enables attain stronger final positions 
ps qs jj kps jj jj believes possesses valid keys believes suitable secret run protocol message applying obtain 
possesses message note extension message jj valid holds message sent evident initial assumptions 
sure recipient mistake key principal name included message 
applying get fk 
possesses message contents 
applying obtain possesses new key applying obtain jj fk 
believes message replay 
applying obtain jj oe fk 
believes contents message recognizable 
applying obtain jj fk 
believes message originated applying obtain jj jj believes believes key applying obtain jj believes suitable key message extension message jj valid 
applying obtain possesses postulates enable derive new useful beliefs possessions message 
particular derive freshness message 
far concerned replay message previous runs 
ban logic rules provide sent message 
reason know replay message sent principal identify messages originated 
sure conveyed message fresh obviously convince current beliefs extension message 
message applying obtain possesses derived 
know originator message possesses key 
reason random number generated recognizable sufficient redundancy convinced decrypted content 
message postulates derive useful belief possession message 
particular convinced sent draw state 
contents accessible possess contents recognizable postulate convinced shares key include notion somebody derive believes somebody possesses sent message 
conclude reasoning leads messages protocol messages attain eliminated weakening final position 
modifications enable derivation improved final position originally intended protocol authors 
enhanced needham schroeder protocol needham schroeder suggested modification original protocol 

fp 
fp 
fn fk 
fk 
fn gk 
fn gamma gk believes nonce fresh 
difference versions enhanced version begins exchange provide nonce server includes nonce response forwards message 
similar reasoning message original protocol leads derive message obtain jj believes suitable key enables add belief extension message 
fn gk jj deduce message contain recognizable noted previous section 
gain possession postulates 
message message modified protocol identical message original 
ff jj usual check extension valid 
concluded holds belief sends message 
applying obtain jj ff applying obtain jj oe 
applying obtain jj ff applying obtain jj jj modification modification required attain desired final position include formula message recognizable propose modified version message 
fn jj recalling believes identifier recognizable initial assumptions similar reasoning described lead conclude jj jj trust competence honesty jj analysis summary summarize difference final positions protocols attain 
original protocol attains weak position jj possesses believes mutual secret possesses secret believe 
believe 
extended protocol attains stronger position trust competence honesty 
jj jj jj possess key believe believes possesses 
addition trusts competence honesty reasoning process allows conclude extended protocol attains jj jj jj jj jj possess key believe believes possesses believes 
modified version attains jj jj jj jj jj jj jj jj possess key believe believes possesses believes assuming trust 
note yahalom protocol attain final position messages 
new approach reasoning cryptographic protocols 
inspired ban logic offers significant advantages 
main differences approaches summarized 
notion possession incorporated approach assumes principals include messages data believe merely possess 
enables derive possesses shared key example previous section 
ban approach hand requires principals include messages formulae believe allows derivation stronger kind believes shared key hold 
approach places strong emphasis separation content meaning messages 
increase consistency analysis importantly introduce ability reason level 
final position run depend level mutual trust specific principals participating run 
notion recognizability important 
notion possible express ability recipient identify messages expects 
ban logic assumes encryption component provides redundancy may necessary 
fact undesirable 
originated notion allows determine certain messages replays recipient previous messages session 
ban assumes encryption provides information identifies sender 
achieved example embedding sender unique permanent identifier message 
believe property required case needs specified explicitly protocol description level 
additional constructs rules introduced extend scope protocols analyzed 
new approach requires assumptions seen general 
limited authentication protocols analyze example cryptographic protocols way functions 
ban choose include elaborate temporal notions form negation 
helps simplify analysis process sufficient derivation important characteristics cryptographic protocols 
extending model subject current investigation 
note beliefs associated guarantee truth respect real world state represent 
beliefs appropriate notion environment potential mutual suspicion assume 
acknowledgments martin abadi mike burrows dec systems research center bill harbison mark lomas david wheeler university cambridge computer laboratory referees valuable comments 
wills helped improve presentation 
burrows abadi needham logic authentication proceedings th acm symposium operating systems principles park arizona december 
published acm operating system review vol pp december 
fuller version published dec system research center report palo alto california february 
halpern moses knowledge common knowledge distributed environment proceedings rd acm symposium principles distributed computing pp vancouver british columbia august 
hoare axiomatic basis computer programming communications acm vol pp october 
lomas gong saltzer needham reducing risks poorly chosen keys proceedings th acm symposium operating systems principles park arizona december 
published acm operating system review vol pp december 
merkle way hash functions des advances cryptology proceedings crypto santa barbara california october 
needham schroeder encryption authentication large networks computers communications acm vol pp december 
needham schroeder authentication revisited operating systems review vol january 
rivest shamir adleman method obtaining digital signatures public key cryptosystems communications acm vol pp february 
logical postulates appendix list logical postulates description 
postulate applies formula applies necessarily vice versa 
recall postulates supplemented rationality rule 
informally states set postulates expanded permit reasoning principal beliefs regarding state principals 
precisely postulate principal jj jj told rules told originated formula special case told formula 

told formula implies told concatenated components 

fxgk principal told formula encrypted key possesses considered told decrypted contents formula 

fxg gammak principal told formula encrypted public key possesses corresponding private key considered told decrypted contents formula 
principal told result function possesses arguments considered told argument see definition section 
rsa public key system property gammak postulate holds 
fxg gammak principal told formula encrypted private key possesses corresponding public key considered told decrypted contents formula 
possession rules principal capable possessing told 
principal possesses formulae capable possessing formula constructed concatenating formulae computationally feasible function 
principal possesses formula capable possessing concatenated components formula 
principal possesses formula capable possessing way computationally feasible function formula 
principal possesses function defined section formulae possesses formula capable possessing formula 
fxgk fxg gamma principal possesses formula key capable possessing encryption decryption formula key 
fxg principal possesses formula public key capable possessing encryption formula key 
gammak fxg gammak principal possesses formula private key capable possessing decryption formula key 
freshness rules convenience jj denote jj jj 
jj jj jj believes formula fresh entitled believe formula component fresh computationally feasible function fresh 
jj jj fxgk jj fxg gamma believes formula fresh possesses key entitled believe encryption decryption key fresh 
jj jj fxg believes formula fresh possesses public key entitled believe encryption key fresh 
jj gammak jj fxg gammak believes formula fresh possesses private key entitled believe decryption key fresh 
jj jj gammak believes public key fresh entitled believe corresponding private key fresh 
jj gammak jj believes private key fresh entitled believe corresponding public key fresh 
jj oe jj jj fxgk jj fxg gamma believes formula recognizable possesses key believes fresh entitled believe encryption decryption fresh 
jj oe jj jj fxg believes formula recognizable possesses public key believes fresh entitled believe encryption public key fresh 
jj oe jj gammak gammak jj fxg gammak believes formula recognizable possesses private key believes fresh entitled believe decryption private key fresh 
jj jj believes formula fresh possesses entitled believe way function fresh 
jj jj possesses believes fresh entitled believe fresh 
recognizability rules jj oe jj oe jj oe believes formula recognizable entitled believe formula component recognizable computationally feasible function recognizable 
jj oe jj oe fxgk jj oe fxg gamma believes formula recognizable possesses key entitled believe encryption decryption recognizable 
jj oe jj oe fxg believes formula recognizable possesses public key entitled believe encryption key recognizable 
jj oe gammak jj oe fxg gammak believes formula recognizable possesses private key entitled believe decryption key recognizable 
jj oe jj oe believes formula recognizable possesses entitled believe oneway function recognizable 
jj oe possesses formula entitled believe recognizable 
message interpretation rules secret identification purposes denoted 
way distinguished secrets transmitted data message 

fx gk jj jj oe jj jj jj fxgk jj suppose principal conditions hold receives formula consisting encrypted key marked mark possesses believes suitable secret believes formula recognizable believes fresh fresh 
entitled believe conveyed conveyed formula encrypted possesses 
fx gammak jj 
jj jj oe jj jj jj fx jj suppose principal conditions hold receives formula consisting concatenated encrypted public key marked originated mark possesses corresponding private key believes public key believes suitable secret believes concatenated recognizable believes fresh 
entitled believe conveyed formula concatenated conveyed formula concatenated encrypted public key possesses public key 
jj jj jj jj 
suppose principal conditions hold receives formula consisting oneway function marked mark possesses believes suitable secret believes fresh 
entitled believe conveyed formula concatenated conveyed way function concatenated understand way functions helps compare previous 
recall definition mean necessarily included transmitted explicitly message conveyed postulates hold rsa publickey schemes similar property described section 

fxg gammak jj 
jj oe jj jj fxg gammak suppose principal conditions hold receives formula consisting encrypted private key possesses corresponding public key believes public key believes recognizable 
entitled believe conveyed formula conveyed formula consisting encrypted private key 

fxg gammak jj 
jj oe jj jj gammak suppose principal conditions hold receives formula consisting encrypted private key possesses corresponding public key believes public key believes recognizable believes public key fresh 
entitled believe possesses string consisting concatenation private key 
jj jj jj believes conveyed formula believes fresh entitled believe possesses jj jj believes conveyed formula consisting concatenation entitled believe conveyed jurisdiction rules jj jj jj jj believes authority statement believes ought believe 
jj jj jj jj jj jj believes honest competent receives message believes conveyed ought believe really believes jj jj jj jj jj jj jj believes honest competent believes believes believes ought believe believes originated messages originated notion section refers messages current session 
principals may able identify certain messages originated current previous sessions 
suppose jj omega denote believes identify messages add postulates 

fxgk jj jj oe jj omega jj jj fxgk suppose principal conditions hold receives formula consisting encrypted key marked mark possesses believes suitable secret believes formula recognizable believes identify message originated 
entitled believe conveyed conveyed encrypted 
fx gammak jj 
jj jj oe jj omega jj jj fx suppose principal conditions hold receives formula consisting concatenated encrypted public key marked originated mark possesses corresponding private key believes public key believes suitable secret believes concatenated recognizable believes identify message originated 
entitled believe conveyed formula concatenated conveyed formula concatenated encrypted public key 

jj jj oe jj omega jj jj 
suppose principal conditions hold receives formula consisting oneway function marked mark possesses believes suitable secret believes concatenated recognizable believes identify message originated 
entitled believe conveyed formula concatenated conveyed way function concatenated possible worthwhile refine notion associating assumption particular formulae 
example replace jj omega jj omega fxgk 
semantics semantics similar ban 
semantics operational 
principals develop new beliefs accumulate possessions applying inference rules beliefs possessions received messages 
ffl local state principal consists sets 
set formulae pp set statements bp intuitively pp set formulae principal possesses bp set beliefs principal 
sets closure properties reflected inference rules 
ffl global state tuple containing local states principals 
suppose global state local state pp bp corresponding sets possession beliefs 
satisfaction relation global states statements jj holds state bp holds pp 
set statements holds state members holds 
ffl run finite sequence states bp bp pp pp gamma 
belief set possess set decrease run 
ffl protocol finite sequence expressions form pn qn xn cn ffl run protocol messages protocol communicated 
run length qi pp gamma cn bp gamma ffl annotation protocol holds run protocol statements annotation hold corresponding states 
annotation valid holds runs protocol set annotation assumptions holds 
