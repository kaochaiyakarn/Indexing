real time volumetric deformable models surgery simulation finite elements condensation morten bro nielsen stephane cotin dept mathematical modelling technical university denmark bldg 
dk lyngby denmark mail bro imm dtu dk www www imm dtu dk bro inria project sophia antipolis france discusses application solid volumetric finite element models surgery simulation 
particular presents new approaches problem achieving real time performance models 
simulation system developed described demonstrate real time deformation methods developed 
keywords virtual surgery real time deformation solid volumetric deformable models virtual reality finite element models 
speed overriding concern surgery simulation years real time surgery simulation practically possible 
big problem surgery simulation modeling deformation solid volumetric objects complex forms real time 
frames second 
human organs tissue complex elastic behaviour possible model simplistic models 
attempts surface models basic modeling method realistic tissue models applied specialized simulators eye surgery simulator 
problem surface models obvious non solid behaviour lack defined interior surgical procedures modeled 
surgeon cut virtual organ modeled surface model inside surface 
simple cuts modeled cutting artery thin structures general surgical impossible 
attention turning solid volumetric models model complete volumetric behaviour object unfortunately complexity models rises volumetric models real time performance difficult achieve 
issue way elastic behaviour simulated 
simulation performed global parametric models local mesh models 
finite element models 
believe need accommodate surgical demand mesh models 
simplistic cuts achieved global parametric models 
emphasize believe models mentioned find surgery simulation application 
discusses real time simulation deformable objects solid volumetric finite element fe models result linear matrix systems 
theory fe models linear elasticity discuss various aspects models 
particular new improvements previous applications fe 
improvement called condensation practice allows compress linear matrix system resulting volumetric fe model system complexity fe surface model object 
complexity surface model models volumetric behaviour object 
second improvement concerns way linear matrix system simulation 
contrast normal approach advice finite element people explicitly invert system matrix matrix vector multiplication matrix achieve low calculation time 
third improvement call selective matrix vector multiplication exploit sparse structure force vector 
addition describe simulation system developed surgery simulation 
system able simulate solid volumetric deformation relatively large objects video frame rates 
theory section describe model simulate elastic deformation volumetric solid real time 
develop model formulate number requirements model fulfil 
speed 
deformation calculated smallest amount time possible 

care time taken time pre calculation setting equations inverting matrices takes hours extra pre calculation stage save second simulation stage 

elastic model visually convincing 
model may physically incorrect looks right 

long run want able cuts model accommodate surgical procedures 
involves changing topology model importantly requires models defined interiors 
volumetric models 
particular requirement lead select mesh finite element fe models 
alternative parametric models 
models provide needed freedom perform topology changes allow cutting 
models handle simple cuts aim able completely general cuts models 
convinced mesh models allow 
meet requirements choose linear elastic deformation model known hooke law 
linear elasticity basic model involves number assumptions regarding physical material modeled 
importantly linear elastic models valid small deformations strains 
typically correct rigid structures metal beams buildings extensively modeling visual result large deformation modeling linear elasticity seldom satisfying 
fe models lead linear matrix systems easy solve fast 
trade speed system visual deformation result 
linear elastic models modeling general elastic volumetric deformation fe just possible todays computers 
faster computers expect realistic models incompressible mooney rivlin material models 
linear elastic material model define elastic solid omega positions omega see 
displacement particle defined particle moved deformation solid elastic object 
boundary gamma gamma gamma gamma gamma gamma fixed displacements forces applied gamma strain energy linear elastic solid omega defined omega ffl strain vector ffl ffl ffl ffl fl xy fl xz fl yz consists ffl ffiu ffix ffl ffi ffiy ffl ffi ffi fl xy ffiu ffi ffiv ffix fl xz ffi ffi ffi fl yz ffi ffi ffi ffi rewrite ffl bu ffi ffix ffi ffiy ffi ffi ffiy ffi ffix ffi ffi ffix ffi ffi ffiy stress vector oe related strain vector hooke law oe dffl symmetric theta material stiffness matrix 
homogenous isotropic material matrix defined lam material constants relations rewrite strain energy add done external forces yield potential energy function omega dx gamma gamma da gamma part surface gamma gamma gamma external forces applied 
fixed displacements applied gamma 
left discretization domain finite elements illustration right tetrahedral finite element 
discretization fe model assume domain omega volumetric solid discretized number finite elements omega form tetrahedrons nodes defined see 
deformation node specified deformation vector addition stack vectors compound vectors nodes finite element omega denoted local number node unrelated global numbering nodes 
finite elements node tetrahedrons linear interpolation displacement field nodes basis functions defined natural coordinates tetrahedron natural coordinates volume coefficients defined appendix find solution deformation problem potential energy system assumes minimum value 
happens variation functional vanishes 
ffie 
fact ffiu ffix ffin ffix ffiu ffiy ffi ffi ffi ffin ffi ffin ffix ffin ffiy ffin rewrite equilibrium equation element omega db dx gamma discretized force vector element constant matrix appendix theta theta theta inside integration sign constant equilibrium equation finite element linear matrix equation db called stiffness matrix volume tetrahedron see appendix 
remaining step assembly global stiffness matrix element stiffness matrices transfer function element node numbers global node numbers 
result large sparse linear system ku condensation linear matrix system ku models behaviour solid object 
includes surface nodes internal nodes model 
simulation purposes usually interested behaviour surface nodes visible nodes 
condensation remove internal nodes matrix equation 
matrix equation condensed problem size result fe surface model 
important understand show exactly behaviour surface nodes original solid volumetric system 
loss generality assume nodes fe model ordered surface nodes followed internal nodes 
ordering rewrite linear system block matrix system surface internal ss si ii block matrix system create new linear matrix system ss involves variables surface nodes ss ss gamma si gamma ii gamma si gamma ii displacement internal nodes calculated gamma ii gamma notice forces applied internal nodes generally new stiffness matrix dense compared sparse structure original system 
intend solve system inverting stiffness matrix pre calculation stage important 
simulation section discuss different simulation methods available 
linear matrix equations 
nodes fe model sparse stiffness matrix 
reduced version surface nodes dense stiffness matrix 
solving linear matrix system implicit solution linear system performed iterated algorithms conjugate gradient cg algorithm 
principle algorithm performs sparse matrix vector multiplication vector updates inner products iterative loop 
complexity roughly seen theta mv vv mv vv time required operations iteration theta number iterations 
seldom practice predicted 
especially system response come specific frame rates unpredictable solution time unfortunate 
alternative explicitly inverting stiffness matrix 
normally done linear systems resulting fe models solved 
precision result suffers numerical errors amount storage needed store dense inverted stiffness matrix huge compared sparse stiffness matrix 
stated concerned precision memory size speed 
time inversion considerable solution time small involves dense matrix vector multiplication gamma 
performed numerical tests library solve linear system generated fe model 
experiments included explicit inversion cg preconditioner gauss elimination factorization techniques qr cholesky 
pre calculation time ignored solution matrix vector multiplication inverted stiffness matrix times faster method 
stated actual numerical results implementations different algorithms library properly optimized 
timings different implementations general result 
dynamic system order physically correct model solid add mass damping model 
formulating lagrangian equation motion object ku mass damping stiffness matrix system 
calculated shown 
assuming lumped masses nodes diagonal damping mass matrices ii aev ii ffm ii ae mass density ff scaling factor 
global element matrices assembled global matrices 
mass damping matrices diagonal block diagonal 
lagrangian equation motion reduced system simply ss ss ss ss finite difference estimates time write lagrangian equation full system deltat deltat gamma gamma deltat deltat deltat gamma gamma deltat ku deltat deltat ku deltat deltat deltat deltat deltat deltat gamma deltat gamma deltat gamma deltat deltat leave reader formulate equations condensed system 
static system selective matrix vector multiplication generally deltat vector full vector contribution previous displacement vectors gamma deltat contrast original force vector deltat sparse vector cases voxel data visible human data set 
forces applied surface nodes 
case simulation inspired develop alternative simulation method sparse force vectors considerably faster 
cost simulation method loss dynamics 
idea original static linear system ku condensed version lagrangian dynamic system exploit sparse structure force vector 
formally solving system inverted stiffness matrix performed gamma positions force vector non zero clearly standard matrix vector multiplication involve large number superfluous multiplications 
note gamma gamma gamma th column vector gamma th element majority zero restrict run positions 
positions non zero reduce complexity times time normal matrix vector multiplication 
call approach selective matrix vector multiplication smvm 
smvm method dynamic model converge slow changes forces applied solid body 
simulation system summarize theory section simulation system developed surgery simulation 
addition describe generate fe mesh model physical organ limb summary simulation methods previous theory section number ideas related simulation fe models 
general separate possible algorithms full fe model contra condensed fe model dynamic simulation contra selective matrix vector multiplication smvm 
dynamic simulation smvm full fe model fd fs condensed fe model cd cs choice algorithm depends requirements application 
chooses dynamic simulation smvm question speed requirement size problem 
problem processed fast dynamic simulation best choice 
choice full fe model versus condensed model necessary modify fe model simulation 
model surgical cut model 
modification necessary standard full system probably easier modify condensed system step refinement 
need modification condensed model clearly 
implemented cs cd fs methods simulation system 
mesh generation addition range simple box structures data visible human project model lower leg 
visible human data set voxel see necessary generate mesh model 
software manually draw contours boundary skin bone voxel data see 
applied software create tetrahedral mesh model leg 
result fe mesh model shown 
model simulation system described section 
sgi performer parallel pipe lining system simulation system implemented silicon graphics onyx mips processors sgi performer graphics library 
sgi performer allows programmer create parallel pipe lining software quite easily providing basic tools communication shared memory currently system run processes application culling drawing processes 
application process handles actual simulation deformable solid 
calculates displacements culling process analyzes scene simulation process provides determines parts visible current window 
pipes visible parts drawing process renders scene 
notice entire system parallel system actual deformation simulation system runs single processor 
parallel features separate rendering simulation plan implement parallel version simulation process 
shows screen dump virtual operating room environment leg lying operating table 
shows surface fe mesh shown simulator 
described methods real time simulation elastic deformation volumetric solid linear elastic finite elements 
described simulation system developed surgery simulation methods 
performance dynamic simulation methods determined solely size linear system 
achieved frames second models nodes system equation 
full linear system includes nodes internally surface 
condensed system includes surface nodes 
number internal nodes model matter condensed system removed system equation 
contours created left fe mesh created contours right 
simulation system implemented sgi performer 
wireframe model lower leg simulator 
simulation pushing lower leg 
top default shape 
bottom deformation leg push applied black triangle 
difficult predict performance methods selective matrix vector multiplication smvm 
comments concerning full contra condensed systems apply 
addition number nodes forces applied important 
example leg visible human data set system nodes condensed system surface nodes ran comfortably frame frames second forces applied nodes 
included calculation deformation basic processing 
nodes surface nodes forces applied increase time requirement believe bigger models accommodated smvm method 
shown real time simulation solid volumetric deformable models possible done realistic surgery simulation performed 
importantly currently working implementation cutting fe mesh 
addition realistic tissue models need detailed segmentation organs limbs allow different material properties models 
current parallel research digital atlas significant step direction 
linear tetrahedral finite element assume nodes tetrahedron numbered illustrated 
natural coordinates tetrahedron related global coordinates ignore element superscripts equation inverted give fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi gamma fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi fi gamma fi fi fi fi fi fi fi fi fi fi fi fi fi fi coefficients cyclic interchange indices 
matrix templates solution linear systems building blocks iterative methods www www netlib org templates templates ps bro nielsen interactive medical image graphics visualization software submitted car bro nielsen modelling elasticity solids active cubes application simulated operations proc 
computer vision virtual reality robotics medicine cvrmed pp 
ciarlet mathematical elasticity vol 
dimensional elasticity north holland cotin delingette bro nielsen ayache cl ement geometric physical representations simulator hepatic surgery proc 
medicine meets virtual reality cover brien rowe palm interactively deformable models surgery simulation ieee computer graphics applications pp 
nov geiger dimensional modeling human organs application diagnosis surgical planning inria tech 
rep dec 
thalmann thalmann simulation object human skin deformations grasping task schubert anatomical atlas volume model ieee computer graphics applications finite element method engineers john wiley sons isbn finite element handbook mcgraw hill isbn hunter hunter virtual environment model eye surgical simulation proc 
siggraph pp 
stewart matrix computations www ftp anu edu au pub html terzopoulos fleischer deformable models visual computer terzopoulos waters analysis synthesis facial image sequences physical anatomical models ieee trans 
pattern analysis machine intelligence terzopoulos metaxas dynamic models local global deformations deformable ieee trans 
pattern analysis machine intelligence visible human project www www nlm nih gov research dir visible human html 
