penalized likelihood smoothing robust state space models ludwig fahrmeir rita seminar fur statistik universitat munchen munchen fahrmeir stat uni muenchen de stat uni muenchen de march likelihood approaches state space models gaussian error distributions replaced non normal alternatives heavier tails 
observation models appropriate time series additive outliers state transition equations heavytailed error distributions lead filters smoothers cope structural changes trend slope caused innovations outliers 
consequence conditional filtering smoothing densities analytically intractable 
various attempts deal problem reaching approximate conditional mean type estimation fully bayesian analysis mcmc simulation 
article consider penalized likelihood smoothers means estimators maximize penalized likelihoods equivalently posterior densities 
filtering smoothing additive innovations outlier models carried computationally efficient fisher scoring steps iterative kalman type filters 
special emphasis student family em type algorithms estimate unknown hyperparameters developed 
operational behaviour illustrated simulation experiments real data applications 
keywords additive outliers em algorithm innovations outliers iterative kalman filtering non gaussian state space models 
state space models filtering smoothing algorithms considered various authors 
follow approach martin west errors assumed non gaussian longer normal tails 
known exact closed form solutions filtering smoothing problem generally longer available 
approximate filtering smoothing algorithms early state space modelling example approximate conditional mean acm type smoothers see martin martin raftery 
kitagawa uses numerical integration computing posterior means method infeasible higher state dimension 
fully bayesian mcmc simulation methods models finite gaussian mixtures developed tackle problem see instance carter kohn 
shephard pitt durbin koopman discuss models student errors additive outliers 
consider posterior mode filters smoothers alternative supplementary tool avoids numerical monte carlo integration 
computational solutions understood efficient algorithms nonlinear maximization problems 
approach leads gauss newton fisher scoring smoothing algorithms maximize posterior densities equivalently certain penalized likelihood criterion modifying extending arguments fahrmeir kaufmann 
alternatively algorithms written iteratively weighted kalman filters smoothers applied working observations similar way dynamic generalized linear models compare fahrmeir ch fahrmeir 
models heavy tailed observation error distribution obtain filters smoothers robust additive outliers 
innovations outliers leading instance distinct changes level slope time series modelled heavy tailed error distributions transition equation 
resulting smoothers edge preserving react quite flexibly change points edges provide smooth fits regions 
approach useful large class heavy tailed error distributions special emphasis student family 
concerns particular estimation unknown hyperparameters scale factors degrees freedom 
suggest em type algorithm tailored student family combined smoothing algorithms joint estimation state hyperparameters 
illustrate performance simulation experiments application real data section 
robust state space models simplicity consider standard linear state space model univariate observations 
extensions complex models instance nonlinear models multivariate observations obvious 
model consists linear observation equation fi ffl observations states fi fi supplemented linear transition equation fi fi gamma fi design vectors transition matrices vector nonrandom 
errors ffl assumed zero mean densities twice piecewise differentiable 
furthermore errors mutually independent 
densities normal common linear gaussian state space model 
say form robust state space model densities heavy tailed 
models additive outliers ao observation densities heavy tailed gaussian form important subclass 
deal innovations outliers io choice heavy tailed densities errors transition equation 
io robust state models quite useful fitting time series change points instance sudden shifts level slope 
resulting filters smoothers edge preserving provide smooth fits regions small local variation blur edges change points 
known univariate examples heavy tailed densities cauchy distribution logistic distribution discrete mixtures normals student family huber family 
multivariate distributions handled generated independent univariate variables multivariate distribution discussed lange little taylor 
pointed appendix may serious problems concerning estimation dispersion parameter 
focus student family particular concerning estimation hyperparameters 
large parts development valid generally 
derivations formulations filters smoothers convenient introduce negative log densities derivatives influence score function second derivatives random information ae gamma log ae psi ae gamma log defined analogously 
ensure positive definiteness may necessary consider expected information psi psi psi generic symbols observed expected second derivatives 
distribution scale factor oe degrees freedom density normalizing constant oe gamma oe score function random information oe oe gamma psi oe oe gamma gamma oe expected information see lange little taylor psi oe gamma assume design vectors transition matrices known 
unknown hyperparameters densities instance scale factor oe degrees freedom distribution estimated practical applications sequence unknown states 
number data driven methods choosing hyperparameters conceivable instance simple heuristic methods acm type smoothing martin cross validation 
develop em type algorithm combines suggestions lange little taylor static robust regression fahrmeir dynamic generalized linear models 
penalized likelihood estimation fi fi fi fi denote vector observations parameters time smoothing posterior density 
fully bayesian methods mcmc simulation developed tackle problem see instance shephard pitt carter kohn 
pointed posterior mode smoothers useful alternative 
obtained maximizing equivalently fi 
logarithms model assumptions section obtain penalized log likelihood criterion pl fi log log fi log gamma fi log fi gamma log fi gamma fi gamma ae gamma log gamma log gamma log defined section maximization equivalent minimizing ae gamma fi fi gamma fi gamma fi gamma term robust measure distance data fit familiar estimation static robust regression 
second term acts robust smoothness prior penalizing roughness sequence states 
ae get penalized squares criterion leading non robust classical linear kalman filtering smoothing see instance fahrmeir section 
noted arrived penalized loglikelihood criterion bayesian framework maximizing posterior density 
forget bayesian approach start directly regarding ffi fixed unknown sequence estimated subject smoothness restrictions 
furthermore may allow ae proper negative log density ae functions popular robust statistics leading posterior 
maximizing minimizing score function fi pl fi fi observed expected information matrix fi gamma pl fi fi fi fi fi interest 
score function partitioned pl fi fi avoid special formulas define 
straightforward differentiation shows psi gamma psi derivatives ae evaluated gamma fi fi gamma fi gamma information matrix block tridiagonal delta delta delta 


gamma delta delta delta gamma tt tt psi gamma psi expected second derivatives ae evaluated gamma fi fi gamma fi gamma setting psi psi gamma expressions second derivatives formally identical formulas exponential family state space models fahrmeir kaufmann 
factorization inversion information matrix covariance matrix recursion developed remain formally identical 
filtering smoothing estimation hyperparameters summarize resulting fisher scoring filters smoothers known hyperparameters 
gauss newton smoother initialize choose starting sequence fi fi jt fi jt fi tjt fi jt example acm type smoother 
iterate gauss newton steps fi fi 
fl sigma gamma evaluated fi 
compute sigma tjt gamma sigma gamma jt gamma gamma sigma tjt sigma gamma tjt gamma psi gamma sigma gamma jt gamma sigma gamma tjt gamma expressions evaluated fi set fl fl gamma 
filter correction fi jt fi jt sigma jt fl 
smoother corrections sigma gamma jt sigma gamma jt gamma sigma tjt gamma sigma tjt gamma fi gamma jt fi gamma jt fi tjt gamma fi tjt sigma gamma jt sigma tjt fl gamma iterate steps 
till convergence obtain conditional mode smoothers fi jt fi tjt fi jt curvatures sigma jt sigma tjt sigma jt approximate error covariance matrices 
equivalent computationally alternative form filtering smoothing iterative kalman filters smoothers applied working observations 
derived line argument fahrmeir 
assumed hyperparameters error distributions scale factors degrees freedom known 
estimation hyperparameters general concepts cross validation maximum likelihood 
developed em type algorithm approximate ml estimation 
tailored student family fact distributed random variable generated mixture zero mean normal mixture variable distributed degrees freedom 
treat states approximative em algorithm mixture variables missing 
steps analogous robust regression models see lange little taylor posterior expectations substituted posterior modes 
compared em type algorithm dynamic generalized linear models see fahrmeir taylor series expansions necessary 
details appendix 
complete algorithm summarized follows 
set hyperparameters 
compute penalized likelihood smoother 
compute em steps updating variances maximization degrees freedom 

set iterate steps 
till convergence 
simulations applications gain experience practical performance smoothing algorithm applied number simulated real data 
gauss newton smoothing combined fisher scoring expected information observed information matrix positive definite 
combine states parameter estimation complete gauss newton algorithm single em type step alternated convergence 
subsection report typical simulation results 
real data examples follow subsection 
simulation additive outliers dimensional states computed fi sin held fixed simulation runs 
scalar observations obtained fi ffl errors ffl drawn distribution scale 
gauss newton smoothing estimates ffi tj computed second order random walk model ao fi fi gamma gamma fi gamma fi gamma fi ffl ffl distributed unknown scale oe ffl positive definiteness required set diag gamma 
approximative confidence bands ffi tj sigma delta oe tj computed corresponding diagonal elements oe tj curvatures sigma tj illustrate advantages robust smoothing linear smoothing normality assumptions pick run th best mean squared error criterion 
results shown 
gauss newton estimates affected additive outlier em type robust smoother em linear smoother bias mse bias mse oe ffl table hyperparameter estimation simulation 
confidence bands considerably smaller 
em type algorithm yielded oe ffl 
em algorithm combined linear smoother computed oe ffl 
overestimation oe ffl typical linear smoothers case ao compare table 
boxplots figures show empirical distributions gauss newton resp 
linear smoothing estimates fi tj simulation runs 
points indicate outlying estimates whiskers drawn nearest value half times inter quartile range 
comparing figures respect bias particular variability provides clear evidence mse superiority robust smoothing agreement table 
simulation innovations outliers analyzing io chose fi gamma gamma gamma fixed simulations runs generated scalar observations fi 
gauss newton smoothing estimates computed assuming steady state model io fi fi gamma fi ffl distributed unknown ffl oe ffl 
shows run mean squared error criterion 
comparison linear smoother normality assumption gauss newton algorithm able track level shifts quite yields smooth estimates smaller confidence bands 
em type algorithm yielded oe ffl 
em algorithm combined linear smoother computed oe ffl typically greater robust estimate case io 
boxplots figures constructed analogy simulation behaviour simulation runs 
show dynamic models robust smoothness priors clearly outperform gaussian dynamic models presence discontinuities promising candidates edge preserving smoothing 
real data examples penalized likelihood smoothing applied suspended deposit data tukey see martin raftery show io year foundation federal deposit insurance usa 
data results illustrated 
steady state model io em type algorithm computed estimates oe ffl 
gauss newton smoothing exhibits level shift immediately yields smooth track year 
monthly cp sales data west harrison shown contain ao december indicating change point io january 
assuming steady state model io penalized likelihood smoothing clearly indicates level shifts gives smooth estimates especially ignoring ao 
hyperparameter estimates oe ffl 
outlook linear state space models heavy tailed error distributions provide flexible tool curve estimation presence additive outliers 
proposed penalized likelihood posterior mode smoothers avoid numerical integration monte carlo techniques provide useful alternative supplement mcmc simulation 
special emphasis laid student distribution 
case em type algorithm data driven estimation unknown scale factors degrees freedom developed 
state space models innovations outliers lead robust smoothness priors edge preserving smoothing algorithms cope discontinuities change points underlying curve 
extensions spatial models particular image analysis promising considered research 
appendix assume independent univariate distributions observation errors ffl components tj errors tp transition equation 
ffl ju oe ffl tj tj mixture variables tj assume simplification starting values known oe ffl vector unknown hyperparameters 
current iterate em algorithm computes iterate maximizing posterior expectation complete data log likelihood flog fi jy fi vectors observations state vectors mixture variables respectively 
due model assumptions equivalent log fi log log log fi fi fiy gamma 
max implies separate maximization problems components 
suppressing index outline derivation em type algorithm unknown scale factor degrees freedom omitting constants consider maximization problems gamma log gamma fff jy gamma 
max ff component fi gamma fi gamma flog jy gamma 
max iterated conditional expectations summand written ff fi fi fiy ff jfi fi fi fiy ff delta ff fi fi fiy delta ff ff compare lange little taylor property 
taylor series expansion ff ff jy get ff jfi ff delta ff gamma ff var ff jy ff gamma ff ff setting derivative zero get ff delta var ff jy approximating posterior expectations variances posterior modes curvatures available smoothing algorithm em type step estimating similarly get iteration step oe ffl fl delta fl fl sigma tjt oe ffl fl gamma fi delta fl fl defined analogous 
similar approximations step independently distributed log gamma log gamma gamma log jy gamma jy suppressing iterated conditional expectations yield fi fi fiy fi fi fiy ff fi fi fiy taylor series expansion ff ff ff obtain ff gamma gamma ff ff var iterating conditional expectations gives log log fi fi fiy log fi fi fiy dg gamma ae log ff fi fi fiy oe dg delta digamma function 
equation lange little taylor 
taylor series expansion ff log ff obtain final approximation log dg gamma ff gamma gamma ff ff var conditional variances var approximated curvatures differentiation estimate dimensional search algorithm 
obtain estimate degrees freedom observation error distribution proceed analogously especially conditional fi fl oe ffl distributed fig fl oe ffl 
carter kohn 

markov chain monte carlo conditionally gaussian state space models 
biometrika 
carter kohn 

robust bayesian nonparametric regression 
statistical theory computational aspects smoothing 
eds 
heidelberg verlag 
durbin koopman 

monte carlo maximum likelihood estimation non gaussian state space models 
biometrika 
fahrmeir kaufmann 

kalman filtering posterior mode estimation fisher scoring dynamic exponential family regression 

fahrmeir 

posterior mode estimation extended kalman filtering multivariate dynamic generalized linear models 
journal american statistical association 
fahrmeir 
multivariate statistical modelling generalized linear models 
new york springer 
fahrmeir 

penalized likelihood estimation iterative kalman smoothing non gaussian dynamic regression models 
computational statistics data analysis 

kitagawa 

non gaussian state space modeling nonstationary time series comments 
journal american statistical association 
lange little taylor 

robust statistical modeling distribution 
journal american statistical association 
martin 

approximate conditional mean type smoothers 
smoothing techniques curve estimation edited gasser rosenblatt 
berlin springer 
martin 

robustness time series estimating arma models 
handbook statistics edited hannan krishnaiah rao 
amsterdam elsevier 
martin raftery 

robustness computation non euclidian models comment 
journal american statistical association 


kalman filter models 
journal american statistical association 
shephard pitt 
likelihood analysis nongaussian measurement time series 
biometrika 
tukey 

exploratory data analysis 
london addison wesley 
west 

robust sequential approximate bayesian estimation 
journal royal statistical society 
west 

outlier models prior distributions bayesian linear regression 
journal royal statistical society 
west harrison 

bayesian forecasting dynamic models 
new york springer 
time time time time true parameters ffi indicated smoothing estimates naive oe confidence bands obtained robust smoother linear smoother 
observations fy indicated diamonds fitted values fy resulting robust smoother linear smoother 
time 
boxplots visualizing empirical distribution gauss newton smoothing estimates simulation 
true values ffi indicated 
time 
boxplots visualizing empirical distribution linear smoothing estimates simulation 
true values ffi indicated 
time time time time true parameters ffi indicated smoothing estimates naive oe confidence bands obtained robust smoother linear smoother 
observations fy indicated diamonds fitted values fy resulting robust smoother linear smoother 
time 
boxplots visualizing empirical distribution gauss newton smoothing estimates simulation 
true values ffi indicated 
time 
boxplots visualizing empirical distribution linear smoothing estimates simulation 
true values ffi indicated 
transformed suspended deposit data diamonds indicating log suspended deposits mio 
dollar robust smoothing estimates oe confidence bands 
cp sales indicated diamonds robust smoothing estimates oe confidence bands 
