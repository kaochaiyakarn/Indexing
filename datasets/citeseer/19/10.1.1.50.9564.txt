proceedings th international workshop network operating system support digital audio video nossdav durham new hampshire april 
meeting arbitrary qos constraints dynamic rate shaping coded digital video eleftheriadis dimitris department electrical engineering center telecommunications research columbia university new york ny usa ctr columbia edu 
introduce concept dynamic rate shaping technique adapt rate compressed video bitstreams mpeg mpeg jpeg dynamically varying rate delay constraints 
approach provides interface filter encoder network encoder output perfectly matched network quality service characteristics 
algorithms require interaction encoder fully applicable stored video example video demand systems 
providing decoupling encoder network universal interoperability achieved 
set algorithms dynamic rate shaping optimal extremely fast designs discussed 
simple allow software implementation 
experimental results provided actual mpeg bitstreams 
applications digital video communications cases control bit rate video needed encoding taken place 
example video demand services transmission material may occur wide variety channels multiresolution coding layers undesirable due loss coding efficiency 
example transmission real time video material channels limited quality service guarantees csma cd lans 
techniques developed employ rate control live sources network feedback solution currently available prerecorded material 
similarly consider variable bit rate vbr video source fed atm virtual circuit due difficulties modeling vbr video traffic traffic characterization admission control policing necessarily match source 
dropping vital information source internal network nodes operation manipulate bitstream complies network deliver extremely useful proactive measure resource exhaustion 
environment potentially benefit post encoding rate control operation multipoint communication mobile hosts mobile link typically lower bandwidth wired ones reducing video rate base mobile link wired participants able utilize full bandwidth available compromised presence wired ones 
argument holds heterogeneous terms bandwidth internetworks 
environment continuously grows importance general purpose computers 
due variety network transport mechanisms employed potential video non communication applications general purpose transport independent video codecs 
desirable provide mechanism gracefully interface codec particular transport facilities 
cases common theme need manipulate coded bitstream complies bandwidth availability underlying communication resources 
general manipulation performed transmitting host just transport layer interfaces coded video bitstream transport service 
refer rate dynamic rate shaping drs 
term dynamic refers possibility rate constraints time varying shaping rate control differentiate classical encoder rate control variable rate entropy coded bitstream matched fixed channel rate accurately capture posterior respect coding nature operation 
note drs quite different traffic shaping drs traffic average rate change 
drs new types hybrid guaranteed best effort services ones described 
order rate shaping viable implementable reasonable complexity yield acceptable visual quality 
respect complexity straightforward approach decoding video bitstream recoding target rate obviously unacceptable delay incurred important deterrent 
algorithms complexity cascaded decoder encoder sought 
terms quality noted recoding necessarily yield optimal conversion fact optimal encoder operational rate distortion sense impractical due complexity recoding serve indicator acceptable quality range 
shown regular recoding quite lacking terms quality drs providing significantly superior results 
set algorithms solve problem dynamic rate shaping possibly motion compensated block transform coders including mpeg mpeg jpeg 
formulating drs problem operational rate distortion context derive optimal fast approximate algorithm 
shown perform db optimal ones typically non perceptible difference providing tradeoff algorithmic complexity visual quality 
complexity optimal algorithm shown encoder fast approximations shown significantly decoder 
approach applicable motion compensated block transform codec mpeg draft international standard simulation results 
structure follows 
section formulate problems general constrained dynamic rate shaping 
section discuss optimal fast approximate algorithms constrained rate shaping pictures 
section generalize approach tackle mixed mode coding case 
section 
concluding remarks 
dynamic rate shaping define rate shaping operation input video bitstream set rate constraints produces video bitstream complies constraints 
purposes bitstreams assumed meet syntax specification assume possibly motion compensated block transform coding scheme 
includes mpeg mpeg called motion jpeg 
rate constraints allowed vary time operation called dynamic rate shaping 
assume mpeg video coding syntax 
benefit non expert reader section briefly review mpeg main characteristics overview actual standard detailed 
mpeg overview algorithmic foundation mpeg motion compensated block transform coding falls category 
picture frame field interlaced sources decomposed hierarchical structure consisting blocks macroblocks slices see fig 

block theta array pixels unit transform coding 
macroblock array theta luminance blocks yuv format corresponding blocks chrominance components additional blocks depending chroma format 
macroblocks units motion compensation quantizer selection discussed 
horizontal strip macroblocks forms slice unit bitstream resynchronization recursively computed quantities reset slice 
block transformed discrete cosine transform dct subsequently quantized 
quantization sole source quality loss mpeg course major source compression efficiency 
quantized coefficients converted dimensional string zig zag pattern breakpoint picture slice macroblock dct block run length fig 

mpeg picture structure dct coefficient zig zag scanning pattern 
fig 
run length encoded 
run length codes jointly encode number consecutive zero dct coefficients value non zero coefficient 
motivation approach typical pictures contain large sequences zeros zig zag pattern quantization run length coding efficiently represent 
fig 

mpeg sequence structure motion compensated prediction pictures 
types pictures video sequence intra pictures individually coded fully self contained 
pictures predicted previous picture bidirectional pictures interpolated closest past pictures 
fig 
shows typical pattern including pictures prediction 
prediction motion compensated encoder finds best match macroblock past picture prespecified range 
displacement motion vector sent side information decoder 
order increase coding efficiency mpeg relies heavily entropy coding 
huffman codes variable length codewords represent various bitstream quantities run length codes motion vectors 
result output mpeg encoder inherently variable rate bitstream ratio bits pixel varies block 
order construct constant bit rate bitstream needed rate control 
achieved connecting buffer output encoder emptied constant rate channel rate 
buffer occupancy fed back encoder control selection quantizer current macroblock 
high buffer occupancy leads coarsely quantized coefficients bits block vice versa 
self regulation technique achieve constant output rate clever design needed order avoid buffer overflows underflows required channel allocate bits best possible image quality achieved 
dynamic rate shaper mbps mbps constraint mpeg mpeg bitstream bitstream fig 

operation dynamic rate shaper 
drs problem definition rate shaping operation depicted fig 

note communication path exists rate shaper source input bitstream ensures access encoder necessary 
particular interest source rate constraints 
simplest cases may just constant known priori bandwidth circuit switched connection 
possible priori known statistical characterization policing function 
alternative bt generated network output bitstream transmitted potentially provided network management layer may result bandwidth availability estimates 
objective rate shaping algorithm minimize conversion distortion min bt gamma note assumption rate properties input bitstream arbitrary 
attainable rate variation practice limited depends primarily number pictures bitstream original rate 
assuming mpeg generally motion compensated transform coding technique generate input bitstream decode output fundamental ways reduce rate modifying quantized transform coefficients employing coarser quantization eliminating transform coefficients 
general schemes perform rate shaping leads recoding algorithms amenable fast implementation see perform selective transmission ones 
consequently rest consider selective transmission algorithms specifically address particular case truncation set dct coefficients block eliminated 
approach referred constrained dynamic rate shaping 
number dct run length codes block kept called breakpoint fig 

assuming mpeg avoid certain syntax complications require dct coefficient remain block 
consequently breakpoint values range 
rate shaping intra coded pictures intra picture rate shaping temporal dependence pictures 
consequently shaping error simply consist dct coefficients include recoding coded block patterns dc prediction loops 
dropped 
shown drs problem expressed follows min bt gamma min bt kb breakpoint value block run length codes eliminated number blocks considered value dct coefficient th run th block denotes rate required coding block breakpoint value constrained minimization problem converted unconstrained lagrange multipliers minimizing minimize min note problems equivalent value algorithm find solutions identical 
unconstrained minimization problem solved iterative bisection algorithm step separately minimizes block 
similar algorithmic approach different context 
short description complete algorithm follows 
denote optimal rate distortion respectively block particular minimize 
denote breakpoint value achieves optimum 
lagrangian optimization algorithm step initialization set 
inequality budget holds equality side exact solution 
hold problem infeasible happen target rate small 
go step 
note initial correspond minimum maximum possible breakpoint values minimizes distortion minimizes rate 
step bisection pruning compute fi fi fi fi fi gamma gamma fi fi fi fi fi find 
step convergence test solution budget bisection algorithm operates convex hull curve slice 
consequently points lie optimal considered algorithm 
easily verify actual curves real sequences significant degree convex points convex hull particularly pictures 
cases curve slice sufficiently misbehaved bisection algorithm set track resulting underutilization target bit budget 
order mitigate effect speed operation iteration considers continuously shrinking interval possible breakpoint values pruning 
result convergence algorithm smaller set non convex points 
computational overhead algorithm small convergence achieved iterations 
collection necessary data requires parsing bitstream inverse quantization dct coefficients 
represents small fraction complete decoding process algorithm complexity decoder 
window algorithm operates design parameter 
rate shaping performed top encoding necessarily time desirable minimize additional delay introduced extra processing step 
plausible selection single picture frame field 
target bit budget budget picture set budget gamma size bits currently processed picture number bits spent coding components bitstream subject rate shaping 
immediately available complete picture parsed 
allocated bits left picture carried subsequent picture 
full resolution picture theta may contain blocks format processing required iteration order find breakpoint value minimizes significant 
consequently worth examining clustering approaches common breakpoint value selected set macroblocks 
refer algorithms number sequential macroblocks contained cluster 
additional benefit clustering distortion defined luminance part signal greatly simplifying implementation 
clustering course degrade performance example algorithm reduces quality db substantial decrease complexity 
mixed mode rate shaping types picture coding types problem significantly complex 
decoding process original rate shaped signal described gamma gamma denotes th decoded picture coding order denotes rate shaped decoded picture delta denotes motion compensation operator picture denote coded original rate shaped prediction errors respectively 
picture assumed intra coded simplicity single picture shown motion compensation expression trivially extended cover general case includes pictures 
rewrite min bt fl fl fl fl fl gamma gamma gamma gamma fl fl fl fl fl number pictures optimization takes place 
note general gamma gamma gamma gamma gamma gamma motion compensation non linear operation involves integer arithmetic truncation away zero 
observe contrast intra case optimization involves accumulated error gamma gamma gamma 
furthermore due error accumulation process rate shaping decisions picture effect quality partitioning decisions subsequent pictures 
result optimal algorithm examine complete group pictures breakpoint decisions initial picture may affect picture 
computational overhead extremely high delay unacceptable 
attractive alternative algorithm solves picture basis error accumulated past pictures taken account algorithm referred causally optimal 
note order accurately compute prediction loops maintained decoder receives complete signal decoder receives partition 
nonlinearity motion compensation involves integer arithmetic truncation away zero 
penalty lack arithmetic accuracy loops collapsed 
causally optimal problem formulated follows min bt kb complete picture covered th dct coefficient zig zag scan order th block accumulated error delta maps run length positions prediction error delta actual zig zag scan positions 
minimization problem solved lagrangian multiplier approach section new definition distortion frame number optimal memoryless recoding rate fig 

results various rate shaping algorithms mobile sequence mpeg coded mbps rate shaped mbps 
important issue mixed mode coding target bit budget set picture 
typical situation picture dct coding requires significant number bits picture sizes dominated header motion vector coding bits 
consequently pictures provide flexibility data partitioning 
order accommodate behavior pictures assigned proportional bit budgets section pictures done resulting bit budget negative case set 
negative budget accounted bits spent recoding optimal memoryless rate bit rate mbps fig 

results various rate shaping algorithms mobile sequence mpeg coded mbps rate shaped various different target 
picture subtracted budget immediately picture 
note optimal bit allocation picture direct product optimal non causal algorithm 
complexity solving significant shown decoder encoder 
order examine benefit error accumulation tracking apply intra algorithm section mixed mode case difference accumulated error term surprisingly results memoryless mixed mode partitioning algorithm identical 
fig 
shows relevant psnr values mobile sequence difference general db curves hardly distinguished 
turns holds wide range bit rates fig 
difference increases slightly db 
important result implies dispense completely error accumulation calculation associated computational complexity minimal cost performance quality degradation causally optimal memoryless algorithms perceptually insignificant spectrum cluster sizes partition rates 
comparison purposes examine performance purely optimization algorithm 
breakpoint selection performed proportionally number bits originally code block 
fig 
depicts results obtained mobile sequence coded mbps rate shaped mbps fig 
shows average psnr values wide spectrum rates 
fixed input output rates selected simplicity similar results obtained complex rate characteristics 
algorithms recoding clustering breakpoint selection performed macroblock basis 
important note regular recoding gives inferior results optimal memoryless algorithms wide range rates hardly distinguished 
concluding remarks section concept dynamic rate shaping introduced adaptation mechanism coded video rate characteristics transport service capabilities analyzed operational rate distortion context 
case constrained drs optimal algorithm lagrangian multipliers derived intra coding 
mixed mode case pictures optimal algorithm shown possess significantly high complexity delay causally optimal algorithm introduced 
shown memoryless version algorithm performs identically significantly simplifying implementation complexity compromise terms quality 
shown drs approach outperform regular recoding wide range rates 
due relative simplicity algorithm particularly clustered versions implemented software operate real time high general purpose cpus 

generic coding moving pictures associated audio mpeg 
itu draft recommendation iso iec draft international standard 

campbell 
dynamic qos management scheme adaptive hierarchically coded flows 
proceedings th international workshop network operating system support digital audio video nossdav april 

eleftheriadis 
optimal data partitioning mpeg coded video 
proceedings st ieee international conference image processing pages august 

eleftheriadis 
architecture algorithms multimedia communication system 
acm springer verlag multimedia systems journal august 

ramchandran vetterli 
rate distortion optimal fast thresholding complete jpeg mpeg decoder compatibility 
proceedings picture coding symposium march 

kanakia mishra reibman 
adaptive congestion control scheme real time packet video transport 
proceedings acm sigcomm conference pages september 

didier 
mpeg video compression standard multimedia applications 
communications acm april 

shoham gersho 
efficient bit allocation arbitrary set quantizers 
ieee transactions acoustics speech signal processing 
