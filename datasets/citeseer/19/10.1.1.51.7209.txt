probabilistic evaluation counterfactual queries alexander balke judea pearl cognitive systems laboratory computer science department university california los angeles ca balke cs ucla edu 
judea cs ucla edu 
evaluation counterfactual queries true true important fault diagnosis planning determination liability 
formalism uses probabilistic causal networks evaluate belief counterfactual consequent true antecedent true 
antecedent query interpreted external action forces proposition true consistent lewis analysis 
formalism offers concrete embodiment closest world approach properly reflects common understanding causal influences deals uncertainties inherent world amenable machine representation 
counterfactual sentence form true true counterfactual antecedent specifies event contrary real world observations counterfactual consequent specifies result expected hold alternative world antecedent true 
typical instance oswald shot kennedy kennedy alive presumes factual knowledge oswald shooting kennedy contrary antecedent sentence 
majority philosophers examined semantics counterfactual sentences goodman harper stalnaker pearce nute meyer van der hoek resorted form logic worlds closest real world consistent counterfactual antecedent 
ginsberg ginsberg similar strategy suggested logic counterfactuals applied problems planning diagnosis artificial intelligence 
papers ai focussed counterfactual sentences jackson pereira alferes boutilier adhered logics closest world approach 
real world seldom adequate information verifying truth indicative sentence truth counterfactual sentence 
small set relationships variables modeled physical laws relationships knowledge base nondeterministic 
practical ask truth falsity counterfactual degree belief counterfactual consequent antecedent 
account uncertainties lewis generalized notion closest world device imaging closest worlds assigned probability scores scores combined compute probability consequent 
drawback closest world approach leaves precise specification closeness measure unconstrained 
specifically tell encode distances way conform perception causal influences lend economical machine representation 
viewed concrete explication closest world approach satisfies requirements 
target investigation counterfactual queries form true probability true know 
proposition stands actual observations real world oswald shoot kennedy kennedy dead explicit facilitate analysis 
counterfactuals intertwined notions causality typically express counterfactual sentences assuming causal relationship counterfactual antecedent counterfactual consequent 
example safely state sprinkler grass wet contrapositive form sentence counterfactual form grass dry sprinkler strikes strange think state grass causal influence state sprinkler 
likewise state blocks table green white block table green 
fact say people counterfactual statements aimed precisely conveying generic causal information specific transitory observations real world 
observed facts reflect strange combinations rare eventualities blocks green general traits influence behavior 
counterfactual sentence emphasizes law necessary component relation considered 
reason speculate find frequent counterfactuals ordinary discourse 
importance equipping machines capability answer counterfactual queries lies precisely causal reading 
making counterfactual query user intends extract generic necessary connection antecedent consequent regardless contingent factual information available moment 
tight connection counterfactuals causal influences algorithm computing counterfactual queries rely heavily causal knowledge domain 
leads naturally probabilistic causal networks networks combine causal probabilistic knowledge permit reasoning causes effects conversely effects causes 
emphasize causal character counterfactuals adopt interpretation pearl counterfactual sentence states prevail forced true unspecified action exogenous relationships considered analysis 
action interpretation permit inferences counterfactual antecedent events lie past 
example action interpretation counterfactual kennedy alive today country better shape counterfactual kennedy alive today oswald alive 
admitted causal influence kennedy country presumed remain valid kennedy alive act god 
second sentence disallowed kennedy alive perceived having causal influence oswald alive 
information intended second sentence better expressed indicative mood kennedy alive today killed dallas jack ruby reason kill oswald oswald alive today 
interpretation counterfactual antecedents similar lewis lewis analysis contrasts interpretations require counterfactual antecedent consistent world analysis occurs 
set closest worlds delineated action interpretation contains coincide factual world possible consequences action taken 
probabilities assigned worlds determined relative likelihood consequences encoded causal network 
show causal theories specified functional form pearl verma druzdzel simon poole sufficient evaluating counterfactual queries causal information embedded bayesian networks sufficient task 
bayes network represented functional specifications yielding different evaluations counterfactual 
problem deciding factual information deserves undoing antecedent query requires model temporal persistence noted pearl model part static bayesian networks 
functional specification implicitly contains temporal persistence information needed 
section introduces useful notation concisely expressing counterfactual sentences queries 
example demonstrating plausibility external action interpretation adopted 
demonstrate bayesian networks insufficient uniquely evaluating counterfactual queries functional model sufficient 
counterfactual query algorithm followed re examination earlier example quantitative analysis algorithm 
final section contains concluding remarks 
notation set variables describing world designated fx xn part complete specification counterfactual query real world observations background context 
observed values represented standard form xn addition represent value variables counterfactual world 
distinguish value counterfactual world denote asterisk value counterfactual world represented need notation distinguish events true counterfactual world referenced explicitly counterfactual antecedent 
interpreted forced counterfactual value external action denoted hat 
typical counterfactual query form ja read observed real gamma gamma psi gamma gamma psi ann party bob party carl party causal structure reflecting influence ann attendance bob carl attendance influence bob carl attendance 
world probability party example illustrate external force interpretations counterfactuals consider interpersonal behaviors ann bob carl ffl ann goes parties 
ffl bob likes ann party scene 
save rare circumstances bob party ann 
ffl carl tries avoid contact ann broke month really likes parties 
save rare occasions carl party ann party 
ffl bob carl truly hate meet 
situation may represented diamond structure 
variables domains ae ann party 
ann party 
oe ae bob party 
bob party 
oe ae carl party 
carl party 
oe ae bob carl 
bob carl 
oe consider discussion friends laura scott go party called bob home laura ann party bob home 
scott mean carl party 
laura bob party bob carl surely 
scott 
bob carl ann party 
laura true 
bob party ann bob carl 
scott agree 
ann see 
fourth sentence scott tries explain away laura claiming bob presence evidence ann party imply carl party 
scott analyzes laura counterfactual statement indicative sentence imagining observed bob presence party allows observation abductive reasoning 
laura subjunctive counterfactual statement interpreted leaving past including obtained abductive reasoning real observations forcing variables counterfactual values 
gist statement 
example demonstrates plausibility interpreting counterfactual statement terms external force causing bob party regardless prior circumstances 
variables expect impacted counterfactual assumption descendants counterfactual variable words counterfactual value bob attendance change belief ann attendance belief prompted real world observation 
probabilistic vs functional specification section demonstrate functionally modeled causal theories pearl verma necessary uniquely evaluating counterfactual queries conditional probabilities standard specification bayesian networks insufficient obtaining unique solutions 
reconsider party example limited variables representing ann bob attendance respectively 
assume previous behavior shows ja ja 
observe bob ann absent party wonder bob ann ja 
answer depends mechanism accounts exception bob behavior 
reason bob occasionally misses parties ann goes unable attend sick having finish aaai answer query 
reason bob occasional absence ann goes angry ann case exactly opposite answer query ann bob current absence party proves bob angry 
see information contained conditional probabilities observed variables insufficient answering counterfactual queries uniquely information mechanisms responsible probabilities needed 
functional specification provides information models influence deterministic function ffl ffl stands unknown factors may influence prior probability distribution ffl quantifies likelihood factors 
example bob grounded parents bob angry ann possible components ffl specific value ffl deterministic function value ffl domain specifies response function maps value value domain 
general domain ffl contain components replaced equivalent variable minimal partitioning domain equivalence regions corresponding single response function pearl 
formally equivalence classes characterized function dom ffl follows ffl ffl ffl ffl ffl ffl ffl ffl ffl obviously regarded random variable takes values functions refer variable response function variable 
closely related potential response variables rubin model counterfactuals rubin introduced facilitate causal inference statistical analysis balke pearl 
example response function variable valued domain functional specification ae ae specify mappings individual response functions 
prior probability response functions conjunction fully parameterizes model 
uniquely evaluate counterfactual query ja 
probability 
interpretation counterfactual antecedents implies disturbance ffl unaffected actions force counterfactual values learn response function observed evidence applicable evaluation belief counterfactual consequent 
observe certain event having prior probability 
evidence leads updated posterior probability hp ja eqs 
forced probability 
exactly solution counterfactual query ja analysis consistent prior propensity account 
provided conditional probability bja functional model 
specifications related ja ja show general uniquely determined conditional distribution bja 
counterfactual query functional model leads unique solution bayesian network seldom leads unique solution depending conditional distributions bayesian network sufficiently constrain prior distributions response function variables corresponding functional model 
practice specifying functional model daunting think example 
fact argued subjective judgments needed specifying bayesian networks judgments conditional probabilities generated mentally basis stored model functional relationships 
example mechanism model causal interactions conditional probabilities derivatives functional model involving gates corrupted independent binary disturbances 
model fact simplify specification conditional probabilities bayesian networks pearl 
observation heckerman personal communication evaluating counterfactual queries section see algorithm evaluating counterfactual queries consist compute posterior probabilities disturbance variables observed evidence remove observed evidence enforce value counterfactual antecedent evaluate probability counterfactual consequent conditions set steps 
important point remember compute posterior distribution disturbance variable ffl separately treat variables independent quantities 
disturbance variables initially independent evidence observed tends create dependencies parents observed variables dependencies need represented posterior distribution 
efficient way maintain dependencies structure causal network 
represent variables counterfactual world distinct corresponding variables real world separate network world 
evidence instantiated real world network solution counterfactual query determined probability counterfactual consequent computed counterfactual network counterfactual antecedent enforced 
reader may ask key networks real counterfactual worlds linked 
exogenous variable ffl influenced forcing value endogenous variables model value disturbance identical real counterfactual worlds single variable represent disturbance worlds 
ffl common causal influence variables representing real counterfactual networks respectively allows evidence real world network propagate counterfactual network 
assume causal theory hd theta defined pearl verma 
directed acyclic graph dag specifies structure causal influences set variables fx xng 
theta specifies functional mapping pa ffl pa represents value parents prior probability distribution ffl disturbance ffl assume ffl domain discrete transform discrete domain response function variable 
counterfactual query ja obs posed specifies counterfactual values set variables ae specifies forced values set variables counterfactual antecedent obs specifies observed evidence 
solution evaluated algorithm 
known causal theory create bayesian network explicitly models disturbances variables distinguishes real world variables counterparts counterfactual world 
dag defined set variables ffl fx xn original set variables modeled fx counterfactual world representation ffl fffl ffl ffl ng represents set disturbance variables summarize common external causal influences acting members set conditional probability distributions jpa parameterizes causal structure pa pa pa pa set parents addition ffl pa ffl pa conditional probability distributions bayesian network generated causal theory jpa ffl ae pa ffl pa set values variables pa 
jpa ffl jpa ffl pa pa 
ffl specified functional causal theory 
observed evidence 
observed evidence obs instantiated real world variables corresponding obs 

counterfactual antecedent 
forced value counterfactual antecedent specification apply action semantics set see pearl spirtes glymour scheines amounts severing causal edges pa instantiating value specified 
belief propagation 
instantiating observations actions network evaluate belief standard belief update methods bayesian networks pearl 
result solution counterfactual query 
section noted conditional distribution jpa variable constrains uniquely determine prior distribution ffl disturbance variable 
composition external causal influences precisely known subjective distribution response functions may 
reasonable distribution selected relevant disturbance variable implementation algorithm straightforward solution unique bounds solution obtained convex optimization techniques 
balke pearl demonstrates optimization task deriving bounds causal effects partially controlled experiments 
network generated algorithm may simplified 
variable counterfactual world causal descendant variables mentioned counterfactual antecedent identical distributions causal influences functionally determine identical 
may treated variable 
case conditional distribution jpa sufficient disturbance variable ffl prior distribution need specified 
party revisit party example 
assuming observed bob party want know bob carl bob party 
suppose supplied causal theory model ra rs ae ae ae response functions take form eq 

omega omega omega omega ae omega omega omega omega ae omega omega omega omega ae omega omega omega omega ae pq phi phi phi phi phi hj gamma gamma psi pq bayesian model evaluating counterfactual queries party example 
variables marked counterfactual world factual world 
variables index response functions 
ffifl fflfi omega omega omega omega ae omega omega omega omega ae omega omega omega omega ae pq phi phi phi phi phi hj gamma gamma psi pq evaluate query network instantiated observation action links pointing severed 
numbers reflect authors understanding characters involved 
example choice represents belief bob usually party ann 
believe bob time unable go party sick grounded parents exception represented 
addition bob time go party ann bob mood exception represented 
represents understanding slight chance bob carl regardless attendance chance take place outside inside party shows 
shows bayesian network generated step algorithm 
instantiating real world observations actions specified counterfactual antecedent accordance steps network takes configuration shown 
propagate evidence bayesian network arrive solution consistent laura assertion bob carl bob party bob party 
compare solution indicative query scott thinking jb observed bob party bob carl probably 
emphasizes difference counterfactual indicative queries solutions 
special case linear gaussian models assume knowledge specified structural equation model ffl triangular matrix corresponding causal model dag mean ffl covariance sigma ffl ffl disturbances ffl assumed gaussian 
mean covariance observable variables ffl sigma sigma ffl ffl gamma gamma model known formulas whittaker evaluating conditional mean covariance observations sigma sigma gamma gamma sigma sigma gamma sigma sigma gamma sigma pair sub vectors sigma sub matrix sigma entries corresponding components singularities sigma terms handled appropriate means 
similar formulas apply mean covariance action replaced matrix ij defined ij ae ij mean covariance evaluated eqs 
replaced ffl sigma sigma ffl ffl gamma gamma evaluate distribution action conditioning value action eqs 
xja xja sigma sigma gamma gamma sigma xja sigma xja sigma gamma sigma sigma gamma sigma evaluate counterfactual query ja update prior distribution disturbances observations ffl ffl sigma ffl ffl sigma ffl ffl gamma gamma sigma ffl ffl sigma ffl sigma ffl ffl gamma sigma ffl ffl sigma ffl ffl gamma sigma ffl ffl evaluate means ja variances sigma ja variables counterfactual world action eqs 
sigma replacing sigma 
ja xja sigma sigma gamma gamma sigma ja sigma xja sigma gamma sigma sigma gamma sigma eqs 
ffl sigma sigma ffl ffl clear procedure applied matrices long non singular 
fact response function formulation opens way incorporate feedback loops bayesian network framework 
evaluation counterfactual queries applicable tasks 
example determining liability actions pushed table glass broken liable 
diagnostic tasks counterfactual queries determine tests perform order increase probability faulty components identified 
planning counterfactuals goal regression determining actions performed avoided observed unexpected failure 
counterfactual reasoning essential component plan repairing plan compilation explanation learning 
formal notation semantics representation scheme inference algorithms facilitate probabilistic evaluation counterfactual queries 
world knowledge represented language modified causal networks root nodes unobserved correspond possible functional mechanisms operating families observables 
prior probabilities root nodes updated factual information transmitted query remain fixed 
antecedent query interpreted proposition established external action pruning corresponding links network facilitating standard bayesian network computation determine probability consequent 
time algorithm implemented subjective prior distribution response variables new computational tasks introduced formalism inference process follows standard techniques computing beliefs bayesian networks pearl 
prior distributions relevant response function variables assessed developed methods standard conditional probability specification bayesian networks compute upper lower bounds counterfactual probabilities balke pearl 
semantics methodology introduced adopted nonprobabilistic formalisms long support essential components abduction plausible functional mechanisms factual observations causal projection infer consequences action antecedent note license keep response function variables constant stems unique feature counterfactual queries factual observations presumed occur earlier counterfactual action 
general observation takes place action constancy response functions justified environment remains relatively static observation action disturbance terms ffl represent unknown pre action conditions 
dynamic environment subject stochastic shocks full temporal analysis temporally indexed networks may warranted alternatively canonical model persistence invoked pearl 
acknowledgments research partially supported air force afosr nsf iri micro rockwell micro 
alexander balke supported fannie john hertz foundation 
benefitted discussions david heckerman 
balke pearl 
nonparametric bounds causal effects partial compliance data 
technical report ucla cognitive systems lab 
balke pearl 
bounds probabilistically evaluated counterfactual queries 
technical report ucla cognitive systems lab 
boutilier 
logic revision subjunctive queries 
proceedings tenth national conference artificial intelligence 
menlo park ca aaai press 
druzdzel simon 
causality bayesian belief networks 
proceedings th annual conference uncertainty artificial intelligence uai 
ginsberg 
counterfactuals 
artificial intelligence 
goodman 
fact fiction forecast 
cambridge ma harvard university press th edition 
harper stalnaker pearce eds 

ifs conditionals belief decision chance time 
boston ma reidel 
jackson 
semantics counterfactuals 
proceedings eleventh international joint conference artificial intelligence vol 

palo alto ca morgan kaufmann 
lewis 
probability conditionals conditional probabilities 
philosophical review 
lewis 
counterfactual dependence time arrow 
nous 
meyer van der hoek 
counterfactual reasoning means defaults 
annals mathematics artificial intelligence 
nute 
topics conditional logic 
boston reidel 
pearl verma 
theory inferred causation 
principles knowledge representation reasoning proceedings second international conference 
san mateo ca morgan kaufmann 
pearl 
probabilistic reasoning intelligent systems networks plausible inference 
san mateo ca morgan kaufman 
pearl 
adams conditionals default expressions causal conditionals counterfactuals 
technical report ucla cognitive systems lab 
appear festschrift ernest adams cambridge university press 
pearl 
bayesian networks causal networks 
technical report lll ucla cognitive systems lab 
short version statistical science 
pearl 
conditional qualitative decision theory 
uncertainty artificial intelligence proceedings ninth conference 
morgan kaufmann 
pereira alferes 
counterfactual reasoning revising assumptions 
logic programming proceedings international symposium 
cambridge ma mit press 
poole 
probabilistic horn abduction bayesian networks 
artificial intelligence 
rubin 
estimating causal effects treatments randomized studies 
journal educational psychology 

prior propensity account subjunctive conditionals 
harper stalnaker pearce eds ifs 
reidel 

spirtes glymour scheines 
causation prediction search 
new york springer 
whittaker 
graphical models applied multivariate statistics 
new york john wiley sons 
