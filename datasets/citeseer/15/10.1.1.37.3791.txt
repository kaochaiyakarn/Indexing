genetic programming feature detection image segmentation 
riccardo poli school computer science university birmingham mail poli cs bham ac uk genetic programming method program discovery optimisation consisting special kind genetic algorithm capable operating non linear chromosomes parse trees representing programs interpreter run programs optimised 
describe set terminals functions parse trees handled genetic programming enable develop effective image filters 
filters highly enhance detect features interest build pixel classification segmentation algorithms 
experiments medical images show efficacy approach reported 
genetic programming gp extension genetic algorithms gas structures population optimisation fixed length character strings encode possible solutions problem programs executed candidate solutions problem 
programs expressed gp parse trees lines code 
example simple expression max represented shown 
set possible internal non leaf nodes gp parse trees called function set ff delta delta delta nf functions arity number arguments greater 
set terminal leaf nodes parse trees representing programs gp called terminal set ft delta delta delta table shows typical functions terminals gp 
merged uniform group terminals considered arity functions 
search space gp set possible recursive compositions functions basic search algorithm gp classical ga mutation crossover specifically designed handle parse trees 
gp applied successfully large number difficult problems automatic design pattern recognition robotic control synthesis neural networks symbolic regression music picture generation relatively small number application gp domain image processing computer vision reported literature 
short description follows 
max parse tree representation expression max 
functions kind examples arithmetic mathematical sin cos exp boolean conditional looping repeat terminals kind examples variables constant values arity functions rand go left random constants random table typical functions terminals genetic programming 
koza chapter applied gp problem classifying theta binary patterns representing character character noise 
terminals experiments low level operators moving cursor bit map returning intensity pixels cursor 
account koza reported despite population individuals perfect classifier discovered basic gp paradigm 
contrary gp automatically defined functions adfs playing role problem dependent higher level feature detectors recognition task easier 
similar approach adopted andre solve slightly complicated task classifying digits represented theta bit maps noise 
andre hybrid algorithm classification programs digit optimised gp automatically defined feature detectors represented arrays characters ternary alphabet optimised ga exploitation relatively large scale features andre obtained results reasonable computational effort 
johnson applied gp fiducial point localisation problem problem involve recognising presence absence structure image localisation structure known 
problem find left right hands bitmap silhouette person obtained real images segmentation 
high level functions terminals incorporating knowledge task authors able obtain programs correctly locate left arm images right arm 
tackett report gp applications non binary images cluttered environments 
gp determine target tank set overlapping large sub windows ir images 
different terminal sets classification image features average intensity variance higher level feature obtained bitmaps resulting segmentation window 
tackett showed large database training testing samples gp performed better multi layer perceptrons binary classification trees 
system called pado parallel algorithm discovery orchestration teller veloso combination gp linear discrimination obtain classification programs signals images 
pado programs groups programs called systems group recognise instances class 
system highest output determines output pado 
output system linear combination output programs included system 
function set pado quite comprehensive including example memory read write primitives large scale image operators mean variance intensity window min max pixels adfs library functions 
experiments images different objects pado shown correct classification rate 
applications described concerned problem recognising structure represented image 
different objective described harris buxton gp discover optimum linear filters edge detection signals 
approach gp evolve functions sampled build masks linear fir filters 
masks convolved set signals desired output known 
results obtained method better obtained canny edge detector best operators described literature 
extending approach image analysis possible computation involved convolving large masks different new individual set images extremely large 
recognition structure image concerned design effective problem specific filters capable highly selectively emphasise characteristics image 
ground behaviour filters coupled simple thresholding strategies detect features interest edges texture build pixel classification segmentation algorithms 
organised follows 
section describe approach lowlevel image analysis properly designed filters 
section set terminals functions enable gp develop efficient linear non linear filters 
section report experiments medical images show efficacy functions terminals 
section draw 
low level image analysis filtering approach gp image analysis idea low level image analysis tasks image enhancement feature detection image segmentation image filtering problems gp discover optimal filters solve problems 
case image enhancement objective improve actual quality image example removing noise reducing blurring due optics camera 
alternatively objective emphasise structures interest image example help visual perception structures 
cases image enhancement normally performed kind filter applied image transforms image desired characteristics 
feature detection objective usually locate position possibly shape kinds usually small structures image 
examples structures edges ridges lines bars corners textural elements various kinds problem specific item 
cases feature detection involves steps pre filtering image enhances features interest followed decision phase thresholding maxima detection techniques locate features interest enhanced image 
general image segmentation consists labelling pixels image small number labels pixels belonging regions homogeneous gray level label pixels belonging regions significantly different gray level different labels 
techniques available literature solve problem 
number consider problem segmenting image pixel classification problem pixel assigned class considering local information usually gray levels pixels neighbourhood pixel classified information derived 
number classes known advance hand segmented images available neural networks statistical classification techniques purpose 
case neural networks approach net outputs class assign pixel class output neuron maximally active different nets single output number classes select class net provides maximum output 
cases input neurons pixels neighbourhood net kind non linear filter possibly multiple outputs 
quite practical applications objective segmentation specific difficult achieve label pixels belonging structures interest foreground rest background conspicuous inhomogeneities inter class similarities 
cases segmentation possible requires exploitation statistical information gray levels structures interest possibly importantly large scale regularities typical shape structures interest 
regularities captured giving filter information contained large neighbourhoods pixels 
noted problems mentioned image segmentation difficult standard filtering techniques particular linear fir iir filters usually provide insufficient discriminative power reliable classification 
methods capable considering available sources information combining strongly non linear way artificial neural networks ad hoc combinations filters able give relatively results 
neural networks operators offer peculiar kinds non linearities 
relatively performance derives large neighbourhoods presence non linearities arguable larger space methods exists features 
space explored unbiased machine learning technique genetic programming impose specific form non linearity fixed shape neighbourhoods 
gp image segmentation feature detection terminal set idea gp image filtering successively pixel classification adopt nn strategy variables number pixels neighbourhood fixed size apply filter run program pixel image appropriately shifting neighbourhood run 
variables represent gray level pixels neighbourhood current pixel 
output program root node taken output filter 
large set preliminary experiments various combinations functions terminals tried reached approach simply 
believe reason neighbourhoods modest size lead large terminal set including tens hundreds variables 
consequence large sub programs necessary order extract form large scale statistical descriptor determine correct output program 
finding big subtrees impossible clearly computational power available 
consequence decided try concise efficient set variables having features ffl set capable capturing information image different scales 
ffl run gp process binding variables evaluation program require complex calculations fitness functions image analysis see include thousands fitness cases 
ideal set require memory accesses 
possible example operations necessary evaluate terminals performed initialisation phase gp results stored separate arrays 
ffl efficiency programs discovered gp sought computation load necessary evaluate aforementioned arrays light possible 
requirement met different sets terminals second third constrain considerably possible choice 
addition classic random constant generator selected set terminals shown table gray level pixel coordinates coordinates current pixel centre neighbourhood 
terminals value taken convolution image box operators constant masks different sizes 
set terminals meets requirements listed terminals name definition dx gamma dy gamma dx gamma dy gamma dx gamma dy gamma table terminal set image processing experiments 
functions name arity definition add sub gamma mul theta div ae ja max max min min macros name arity definition xcp eval eval gamma eval eval gamma table function set image processing experiments 
ffl captures fine scale broader scale information 
fact known image processing combining properly shifted scaled box operators filter including gaussians derivatives gaussian laplacians canny approximated desired degree accuracy 
ffl moving averages computed efficiently initialisation phase algorithm requiring additions pixel 
terminals stored appropriate arrays evaluation runtime requires memory access 
function set requirements similar terminal set apply function set 
order meet requirements experiments preferred include function set functions require image processing operations 
reason computation performed functions depend values arguments 
values may vary considerably different individuals single individual importantly pixel pixel functions terminals 
result impossible pre compute store values returned functions evaluation fitness individual may require computation load orders magnitude bigger functions 
experiments functions set shown table dummy arguments 
worth noting macros xcp allow construction filters complexity provided terminal set 
addition presence min max div mul allows construction highly non linear filters mathematical morphology operators 
functions conjunction add sub allow creation necessary constants 
fitness functions objective develop filters image enhancement possible fitness function output program location compared desired output 
sum absolute errors program pixels images training set transformed fitness function usual scaling mapping techniques 
availability desired output images huge number gamma runs necessary evaluate fitness program problems hampering approach 
second problem reduced considerably sampling images training set say gamma random points running program locations 
problem remains hand unacceptable real world images 
solution expensive filtering techniques say kalman filter different image acquisition technologies provide desired output 
objective develop filters feature detection image segmentation symbolic regression fitness function forces output program exactly match binary values representing structures segmented detected set training images inappropriate 
reasons 
reason output filter passed decision algorithms cases simply apply threshold order decision class assign pixel 
computational effort spent gp build programs binary outputs unnecessary case 
tried search gp considerably easier wrapper filtering program 
cases wrapper sufficient simply sets output filter output positive 
second reason sensitivity specificity dilemma segmentation detection algorithm face real world images algorithm detect segment points belonging structures interest true positives tps wrongly detecting points belong uninteresting structures false positives fps missing points false negatives fns 
algorithm sensitivity number tps divided number points detected specificity number true negatives divided number points detected smaller 
changing settings parameters algorithm increase specificity decrease sensitivity vice versa 
optimum setting algorithm usually sensitivity specificity big possible 
fitness function symbolic regression essentially sum number fps fns fp fn fixed training set fp fn determine sensitivity specificity program 
optimising sum necessarily mean achieve optimum sensitivity specificity trade 
contrary cases gp tends discover algorithms sensitive poorly specific vice versa 
experiments tried different ways optimise sensitivity specificity trade considering depending particular detection task fps fns completely different impact quality results 
example tasks may totally unacceptable false detections fps better false detections misses fns think example detection micro breast 
fitness function giving best results fp fn exp fn gamma ff number pixels belonging structures detected ff domain dependent parameter represents maximum percentage misses number misses considered unacceptable typically ff gamma 
basically fn sufficiently smaller ff fp gp tries minimise number false detections fn slightly bigger ff fn gp tries minimise number misses 
experimental results section describe small set experiments performed functions terminal described previous section 
objectives obtain filters perform optimal segmentation detection complex real world gray scale images try apply gp simplified problems involving filtering binary images synthetic images small size images 
contrary decided real images difficult domains medical imaging 
segmentation brain magnetic resonance images experiments considered problem segmenting brain pairs magnetic resonance images image representing map intensity different physical property tissue imaged 
pixel classification strategies neural networks statistical approaches past task limited success 
difficulty resides fact kinds tissue brain physical properties tissues skin see 
consequence brain segmentation small neighbourhoods basically impossible 
mean large neighbourhoods task easy 
show provide comparison gp performed experiments neural networks conjunction medium large neighbourhoods 
shows results obtained neural nets trained backpropagation algorithm having architecture squared retinas theta input neurons input image fed gray levels pixels neighbourhood hidden neurons output neuron activation determines pixel centre retinas belongs brain 
different sizes retinas tried theta theta corresponding medium coarse scale original images head 
theta pixel wide images 
figures show output produced nets 
despite optimum adjustment thresholds large number degrees freedom networks smaller net larger segmentations shown figures disappointing 
particular suggest small retinas provide insufficient information avoid fps skin region large retinas lead fns due inability correctly classify brain edges 
feed forward neural nets better results obtained exploiting anatomical information 
shows results obtained task program fitness discovered gp fitness evaluations sub max max max mul max max mul max sub mul add mul max max mul add mul div max max mul max max mul mul mul max mul add max max mul max mul max mul add mul mul add mul mul min mul div add mul mul add mul mul min mul max mul max mul sub mul div add mul add mul mul min mul max max add sub mul max max add sub mul add mul understandability program minimum comparable neural net performances significantly closer desired ones 
detection blood vessels ray ray blood vessels appear elongated relatively thin structures connected form tree see 
detection coronary arteries relatively simple line detection task 
contrary presence noise segmentation images produced neural nets output net theta input retinas output net theta input retinas segmentation optimum thresholding image segmentation optimum thresholding image 
segmentation images produced gp output filtering program segmentation produced wrapper applied image 
original theta ray 
variability background low varying contrast vessels reliable automatic semi automatic vessel detection difficult task 
order provide comparison gp tried develop train set neural networks solve problem 
particular networks structure similar described previous section single retina theta input neurons 
different retina sizes tried theta theta theta theta 
shows output obtained theta neural network best see applied images 
order obtain better results kind images decided apply sophisticated detection algorithms known hysteresis thresholding exploit connectedness vessels 
despite optimum adjustment algorithm large number degrees freedom networks segmentations results summarised table disappointing networks 
problem images contain thin vessels need small theta retina properly detected 
larger vessels partially detected retina 
theta retina detects optimally large vessels properly detect thin ones 
cases number false detections comparable number correct ones 
shows vessels detected images 
results obtained applying gp problem quite different 
gp rapidly relatively high values specificity derives large number non vessel representing pixels image 
value means pixels taken representing vessels poor result 
output neural network theta retina 
hysteresis thresholding applied images 
network sensitivity specificity theta theta theta theta table results neural network vessel detection 
discovers eliminate background variations obtain maximum wrapper hysteresis thresholding algorithm 
example run program sub fitness sensitivity specificity discovered fitness evaluations 
run approximately fitness evaluation gp discovered filter mul sub add add sub mul sub sub add add add sub mul sub sub add add add sub mul sub sub add sub sub sub sub fitness sensitivity specificity 
program outperforms neural networks described 
results produces shown hysteresis thresholding give vessels shown 
approach image analysis idea gp discover optimal image filters 
gp applied naive way problem outlined criteria terminal sets function sets fitness functions satisfy order search feasible produce efficient filters 
ground criteria proposed simple terminals functions fitness functions experiments medical images enabled gp outperform neural nets believe techniques reported image analysis literature 
research genetic programming image analysis hampered tremendous demand computational resources involved fitness evaluation 
despite efforts efficiency prevented believe anybody able produce result documentation plots probability reaching certain fitness value vs generation number minimum computation effort required typical genetic programming literature 
impressive performances shown learning gp compared nns experiments reported suggest huge space image analysis tools powerful image processing nowadays gp start exploring space 
gp ultimate tool certainly open question 
results obtained researchers certainly suggest putting research efforts area investment 
output filter discovered gp 
hysteresis thresholding applied images 
author wishes aaron sloman members evolutionary emergent behaviour intelligence computation group useful discussions comments 
research partially supported british agreement 
john koza genetic programming programming computers means natural selection mit press 
john koza genetic programming ii automatic discovery reusable programs mit pres cambridge massachusetts 
david andre automatically defined features simultaneous evolution dimensional feature detectors algorithm advances genetic programming kenneth kinnear jr ed chapter 
mit press 
michael patrick johnson pattie maes trevor darrell evolving visual routines artificial life iv proceedings fourth international workshop synthesis simulation living systems rodney brooks pattie maes eds mit cambridge ma usa july pp 
mit press 
walter tackett genetic programming feature discovery image discrimination international conference genetic algorithms 
astro teller manuela veloso pado learning tree structured algorithms orchestration object recognition system tech 
rep cmu cs department computer science carnegie mellon university pittsburgh pa usa 
christopher harris bernard buxton evolving edge detectors research note rn ucl gower street london wc bt uk jan 
lawrence hall laurence clarke robert martin james bezdek comparison neural network fuzzy clustering techniques segmenting magnetic resonance images brain ieee transactions neural networks vol 
pp 

poli valli neural network architecture understanding scenes medical imaging computer biomedical research vol 
pp 

poli valli artificial vision system xray images human coronary trees ieee transactions pattern analysis machine intelligence vol 
pp 

john francis canny finding edges lines images tech 
rep artificial intelligence laboratory massachusetts institute technology june 

