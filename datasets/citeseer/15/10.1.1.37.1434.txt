contour tracking stochastic propagation conditional density michael isard andrew blake department engineering science university oxford oxford ox pj uk 
abg robots ox ac uk 
proc 
european conf 
computer vision pp 
cambridge uk problem tracking curves dense visual clutter challenging 
trackers kalman filters limited gaussian densities unimodal represent simultaneous alternative hypotheses 
extensions kalman filter handle multiple data associations satisfactorily simple case point targets extend naturally continuous curves 
new stochastic algorithm proposed condensation algorithm conditional density propagation time 
uses factored sampling method previously applied interpretation static images distribution possible interpretations represented randomly generated set representatives 
condensation algorithm combines factored sampling learned dynamical models propagate entire probability distribution object position shape time 
result highly robust tracking agile motion clutter markedly superior previously attainable kalman filtering 
notwithstanding stochastic methods algorithm runs near real time 
problem tracking curves clutter purpose establish stochastic framework tracking curves visual clutter propose powerful new technique condensation algorithm 
new approach rooted strands statistics control theory computer vision 
problem track outlines features foreground objects modelled curves move substantial clutter close video frame rate 
challenging elements background clutter may mimic parts foreground features 
severe case background may consist objects similar foreground object instance person moving past crowd 
framework aims dissolve resulting ambiguity applying probabilistic models object shape motion analyse video stream 
degree generality models pitched carefully sufficiently specific effective disambiguation sufficiently general broadly applicable entire classes foreground objects 
modelling shape motion effective methods arisen computer vision modelling shape motion 
suitable geometric models moving object available matched effectively image data usually considerable computational cost 
object located approximately tracking subsequent images efficient computationally especially motion modelled shape 
important facility modelling curve segments interact images image sequences 
general modelling entire objects clutter resistant applying signal processing low level corners edges 
methods discussed applied level segments parametric curves tracking image sequences 
spline curves theory parameterised control points 
practice allows degrees freedom stable tracking necessary restrict curve low dimensional parameter example affine space generally allowing linear space non rigid motion 
probability densities defined class curves motions constitutes powerful facility tracking 
reasonable default functions chosen densities 
obviously satisfactory measure actual densities estimate data sequences 
algorithms assuming gaussian densities known control theory literature applied computer vision :10.1.1.37.7017
sampling methods standard problem statistical pattern recognition find object parameterised prior data single image 
simplified static form image sequence problem addressed 
order estimate information needed conditional distribution zjx measures likelihood hypothetical object configuration give rise image data just observed 
data entire grey level array set sparse features corners curve fragments obtained edge detection 
posterior density xjz represents knowledge deducible data 
evaluated principle applying bayes rule obtain xjz kp zjx normalisation constant independent general case zjx multi modal xjz evaluated simply closed form iterative sampling techniques 
iterative solution proposed geman geman restoration image represented mixed variables continuous pixels discrete line process 
sampling methods recovery parametric curve sampling generally spatial markov processes underlying probabilistic model 
basic method factored sampling 
useful conditional observation probability zjx evaluated pointwise sampling feasible conversely prior sampled evaluated 
algorithm estimates means properties moments posterior xjz generating randomly sample density weighting zjx jz sn zjs zjs asymptotically unbiased estimate 
example mean estimated variance xx spatial gauss markov process gibbs sampling generate random variates 
low dimensional parameterisations standard direct methods gaussians rejection sampling 
note case density zjx normal mean obtained factored sampling consistent estimate obtained conventionally efficiently linear squares estimation 
multi modal distributions approximated normal linear estimators unusable estimates mean factored sampling continue apply 
sampling methods proved remarkably effective recovering static objects notably hands galaxies clutter 
challenge addressed time estimating time varying images 
kalman filters data association spatio temporal estimation tracking shape position time dealt thoroughly kalman filtering relatively clutter free case zjx satisfactorily modelled gaussian applied curves 
solutions relatively poorly clutter easily spatio temporal estimate 
simple discrete features points corners combinatorial data association methods effective including jpdaf ransac algorithm 
allow hypotheses data elements belong tracked object held simultaneously plausible hypotheses progressively pruned 
data association methods apply moving curves features continuous objects general methodology demanded 
temporal propagation conditional densities kalman filter recursive linear estimator special case applying gaussian densities general probability density propagation process 
continuous time described terms diffusion governed fokker planck equation density drifts spreads action stochastic model dynamics 
random component dynamical model leads spreading increasing uncertainty note presence clutter causes zjx non gaussian prior may happily gaussian assumed experiments 
deterministic drift stochastic diffusion reactive effect measurement fig 

probability density propagation 
propagation depicted occurs discrete time step 
phases drift due deterministic component object dynamics diffusion due random component reactive reinforcement due measurements 
deterministic component causes drift mass density function shown 
effect external measurements superimpose reactive effect diffusion density tends peak vicinity measurements 
simple gaussian case diffusion purely linear density function evolves gaussian pulse translates spreads reinforced remaining gaussian 
kalman filter describes analytically exactly process 
clutter measurements non gaussian multi modal conditional distribution evolving density requires general representation 
leads powerful new approach tracking developed sparse representation density carried forward time 
mean position variance computed explicitly properties computed time desired 
discrete time propagation state density computational purposes propagation process set terms discrete time state modelled object time denoted history 
similarly set image features time history 
note functional assumptions linearity gaussianity densities general treatment particular choices due course order demonstrate approach 
stochastic dynamics somewhat general assumption probabilistic framework object dynamics form temporal markov chain jx jx new state conditioned directly immediately preceding state independent earlier history 
allows quite general dynamics including stochastic difference equations arbitrary order second order models details 
dynamics entirely determined form conditional density jx 
instance jx exp gamma gamma gamma represents dimensional random walk discrete diffusion step length standard normal variate superimposed rightward drift unit speed 
course realistic problems multi dimensional density complex applications learned training sequences 
measurement observations assumed independent mutually respect dynamical process expressed probabilistically follows jx jx jx note integrating implies mutual conditional independence observations jx jx observation process defined specifying conditional density jx time computational examples take time independent function zjx 
details shape function applications image stream analysis section 
propagation continuous valued markov chain independent observations rule propagation conditional density jz time jz jx jz jz jx jz normalisation constant depend propagation rule interpreted simply equivalent bayes rule inferring posterior state density data timevarying case 
effective prior jz prediction taken posterior jz previous time step superimposed time step dynamical model fokker planck drift plus diffusion expressed 
multiplication conditional measurement density jx bayesian manner applies reactive effect expected measurements 
condensation algorithm contrast static case prior may gaussian effective prior jz dynamic case gaussian clutter 
particular known form apparently represented exactly algorithm 
condensation algorithm solves problem doing altogether explicit representation density function 
proceeds generating sets samples jz time step 
sample considered pair value corresponding sampling probability 
suppose particular drawn randomly jz choosing probability set samples time draw randomly jx time step dynamical model starting gaussian density standard sampling methods apply 
value chosen way fair sample jz 
retained pair set time jx 
sampling scheme basis condensation algorithm details 
practice random variates generated efficiently binary search storing probabilities store cumulative probabilities shown 
time expected values jz properties state density jz evaluated applying rule factored sampling algorithm 
probabilistic parameters curve tracking order apply condensation algorithm general tracking curves image streams specific probability densities established dynamics object measurement process 
mentioned earlier parameters denote linear transformation spline curve affine deformation non rigid motion 
dynamical model learning algorithm follow established methods 
model stochastic differential equation discrete time ax defines deterministic component model vector independent standard normal random variables scaled bb iterate time step construct th samples follows 
generate random number uniformly distributed 

find binary subdivision smallest 
draw random variate density jx assumed gaussian direct sampling possible 
store samples jx gamma normalise dividing cumulative probabilities 
required mean properties estimated time jz example mean configuration required graphical display rule fig 

condensation algorithm 
process noise covariance 
model clearly re expressed temporal markov chain follows jx exp gamma kb gamma gamma ax practice second order models replaced respectively 
coefficients learned sequences images 
untrained tracker follow training motions relatively clutter free background 
tracked sequence form analysed maximum likelihood estimation generate estimates defining model condensation algorithm 
set sample values time step supplied initialise algorithm 
prior density gaussian direct sampling may initialisation possible simply allow density settle steady state absence object measurements 
observations measurement process defined jx assumed stationary time condensation algorithm require static function zjx specified 
capability estimate data ideal reasonable assumptions 
measurements arising curve image edge fragments obtained edge detection curve normals 
assume noise distortions imaging local order determine zjx necessary examine image pixels near image curve denote mild abuse notation 
corresponding measurement sequence denoted detected edge normal lies closest curve allow measurement failures clutter measurement density modelled robust statistic truncated gaussian zjx exp ae gamma oe oe ds oe oe jx gamma jx gamma ffi ae ae penalty constant related probability failing find feature curve background 
note oe constant distances greater ffi curve ffi acts maximum scale unnecessary search features 
practice course integral approximated sum discrete sample intervals applying condensation algorithm video streams tracking multi modal distribution order test condensation algorithm ability represent multimodal distribution collected frame second sequence showing cluttered room people facing camera 
person initially right image moves left front 
template drawn interactive package fit head shoulders person constructed affine space deformations template 
motion model learned tracking single person walking room background subtraction necessary ensure accurate tracking past clutter 
results running condensation algorithm shown 
feature interest primarily translation distribution parameter corresponding coordinate plotted clear people slightly different sizes heights modelled full distribution 
background subtraction preprocessing input raw video stream 
initialisation performed simply iterating stochastic model absence measurements seen corresponds roughly gaussian distribution coordinate time step 
distribution rapidly collapses peaks image tracks correctly despite temporary difficulties people occlude 
time step tracking frame rate ms motion fairly slow distributions plotted ms clarity 
stationary person left highest peak distribution expected standing clutter free background outline consistently detectable 
experiment run distribution samples 
time ms ms ms ms ms ms ms ms fig 

tracking multi modal distribution 
histogram horizontal translation component distribution plotted time 
initial distribution roughly gaussian peaks rapidly detected tracked person walks front 
tracking rapid motions clutter collected field second sequence showing girl dancing vigorously scottish reel highly cluttered background order test condensation algorithm agility rapid motions 
drew head shaped template constructed affine space represent allowable deformations 
collected training sequence dancing uncluttered background trained motion model condensation tracker applied test data including clutter 
shows stills clutter sequence tracked head positions preceding fields overlaid indicate motion 
contours plotted field ms field ms fig 

maintaining tracker agility clutter 
sequence fields seconds captured showing dancer executing rapid motions cluttered background 
dancer head tracked sequence 
representative fields shown preceding tracked head positions give indication motion 
tracked positions shown ms intervals 
distribution consists samples 
ms intervals 
model parameters estimated mean distribution time step 
distribution consists samples 
distribution initialised hand near dancer position field samples sweep prior locate initial peak reliably 
equally feasible larger number samples field reduce size distribution dancer technique section 
shows centroid head position estimate tracked condensation algorithm kalman filter 
condensation tracker correctly estimated head position sequence fields kalman filter distracted clutter recover 
expected posterior distribution largely unimodal sequence dancer illustrates point important robustness tracker able represent distributions peaks 
ms distinct peaks caused clutter corresponding dancer head 
point clutter peak higher posterior probability unimodal tracker kalman filter discard information second peak rendering unable recover condensation algorithm recover dancer true position localised ms tracking complex jointed objects preceding sequences show motion place model space dimensions order investigate tracking performance higher dimensions collected field second sequence hand translating rotating condensation tracker kalman filter tracker time time fig 

condensation tracker succeeds kalman filter fails 
centroid state estimate sequence shown plotted time entire field sequence tracked condensation tracker kalman filter tracker 
condensation algorithm correctly estimates head position sequence 
kalman filter initially tracks correctly rapidly distracted clutter feature recovers 
field ms field ms field ms fig 

recovering tracking failure 
detail fields sequence illustrated 
sample distribution plotted image intensity scaled indicate posterior probability 
samples distribution low probability visible 
field distribution split distinct peaks larger attracted background clutter 
distribution converges dancer field 
fingers independently highly cluttered desk scene 
constructed twelve degree freedom shape variation model accompanying motion model help kalman filter tracking real time plain white background signed edges help disambiguate finger boundaries 
fig 

tracking hand cluttered desk 
representative stills field second sequence hand moving highly cluttered desk scene 
fingers thumb flex independently hand translates rotates 
distribution consists samples fields decreases samples aid initialisation 
distribution initialised automatically iterating motion model absence measurements 
shows detail series images tracked field sequence 
distribution initialised automatically iterating motion model absence measurements 
initialisation performed samples dropped gradually fields rest sequence tracked 
occasionally section contour locks shadow finger slightly misaligned system recovers 
shows just severe clutter problem hand immersed dense field edges 
condensation algorithm succeeds tracking hand despite confusion input data 
tracking clutter hard essential multi modality conditional measurement density zjx 
case curve tracking tracking inapplicable new approach needed 
condensation algorithm fusion statistical factored sampling algorithm static non gaussian problems stochastic differential equation model object motion 
result algorithm tracking rigid non rigid motion demonstrated far effective clutter comparable kalman filters 
performance condensation algorithm improves sample size parameter increases computational complexity log 
impressive results demonstrated models degrees freedom 
performance cases condensation edge detector fig 

hand dense edge map 
detail field hand sequence 
result running directional gaussian edge detector shows clutter edges distract system 
condensation algorithm succeeds tracking hand clutter 
improved increased 
system currently runs real time hz desk top graphics workstation indy sc mhz 
authors acknowledge support epsrc 
grateful discussions roger brockett brian ripley david reynard simon rowe andrew experimental assistance sarah blake 

astrom 
stochastic control theory 
academic press 

bar shalom fortmann 
tracking data association 
academic press 

bartels beatty barsky 
splines computer graphics geometric modeling 
morgan kaufmann 

baumberg hogg 
generating spatiotemporal models examples 
proc 
bmvc 

blake curwen zisserman 
framework spatio temporal control tracking visual contours 
int 
journal computer vision 

blake isard 
position attitude shape input video tracking hands lips 
proc 
siggraph 
acm 

blake isard reynard 
learning track visual motion contours 
artificial intelligence 

cipolla blake 
dynamic analysis apparent contours 
proc 
rd int 
conf 
computer vision 

cootes taylor lanitis cooper graham 
building flexible models incorporating grey level information 
proc 
th int 
conf 
computer vision 

fischler bolles 
random sample consensus paradigm model fitting application image analysis automated cartography 
commun 
assoc 
comp 
mach 

stuart geman donald geman 
stochastic relaxation gibbs distributions bayesian restoration images 
ieee trans 
pattern analysis machine intelligence 


visual tracking known dimensional objects 
int 
journal computer vision 

goodwin sin 
adaptive filtering prediction control 
prenticehall 

grenander chow keenan 
hands 
pattern theoretical study biological shapes 
springer verlag 
new york 

grenander miller 
representations knowledge complex systems discussion 
roy 
stat 
soc 


harris 
tracking rigid models 
blake yuille editors active vision 
mit 

hogg 
model vision program see walking person 
image vision computing 

huttenlocher noh rucklidge 
tracking non rigid objects complex scenes 
proc 
th int 
conf 
computer vision 

kass witkin terzopoulos 
snakes active contour models 
proc 
st int 
conf 
computer vision 

lowe 
robust model motion tracking integration search estimation 
int 
journal computer vision 

press teukolsky vetterling flannery 
numerical recipes cambridge university press 

rao 
data association methods tracking systems 
blake yuille editors active vision 
mit 

rehg kanade 
visual tracking high dof articulated structures application human hand tracking 

eklundh editor proc 
rd european conference computer vision 
springer verlag 

ripley sutherland 
finding spiral structures images galaxies 
phil 
trans 
soc 
lond 



bayesian approach dynamic contours stochastic sampling simulated annealing 
ieee trans 
pattern analysis machine intelligence 

sullivan 
visual interpretation known objects constrained scenes 
phil 
trans 
soc 
lond 


terzopoulos metaxas 
dynamic models local global deformations deformable superquadrics 
ieee trans 
pattern analysis machine intelligence 

ullman basri 
recognition linear combinations models 
ieee trans 
pattern analysis machine intelligence 

yuille hallinan 
deformable templates 
blake yuille editors active vision 
mit 
article processed macro package eccv style 
