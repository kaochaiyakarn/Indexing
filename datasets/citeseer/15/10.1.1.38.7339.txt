locally adaptive density estimation stephan david scott january theoretical practical aspects sample point adaptive positive kernel density estimator examined 
closed form expression mean integrated squared error obtained device preprocessing data binning 
expression exact behavior optimally adaptive smoothing parameter function studied time 
approach differs earlier techniques bias adaptive estimator remains improved rate 
practical algorithm constructed modification squares cross validation 
simulated real examples including comparisons fixed bandwidth estimator fully automatic version abramson adaptive estimator 
results promising 
key words kernel function variable bandwidth binning cross validation 
stephan research associate department statistical science southern methodist university pob dallas tx 
david scott professor department statistics rice university pob houston tx 
research supported part national science foundation dms national security agency mod 
authors readers helpful suggestions 

precise theoretical understanding adaptive density estimators availability sound practical algorithms proven surprisingly difficult 
note term adaptive setting refer automatic data bandwidth selection local smoothing estimated density order obtain improved global estimate 
local smoothing achieved varying functional form kernel bandwidth 
consider variable bandwidth function data points 
gamma gamma 
data fx fixed kernel estimator nh gamma gamma kernel finite variance oe generally satisfies gammax 
smoothing parameter held constant data points 
research literature focused choosing proper value information details concerning fixed bandwidth kernel estimators density estimators see silverman scott wand jones 
general intuitive formulations adaptive variable bandwidth estimators considered jones 
varies fixed bandwidth estimation point referred balloon estimator 
form nh gamma hx gamma 
balloon estimator introduced particular form kth nearest neighbor estimator 
define oe oe dt 
standard approximations mean squared error lead optimal error rate gamma optimal choice bandwidth form noe defined points inflection see rosenblatt scott 
scott demonstrated kth nearest neighbor general balloon estimators show promise higher dimensions formulations suffer severe drawbacks univariate bivariate settings 
second variable bandwidth procedure referred sample point estimator bandwidth varied data point estimation point 
functional form sample point estimator gamma gamma 
type estimator introduced breiman purcell suggested gamma dimension data 
clear advantage procedure balloon estimator sample point estimator integrate 
abramson suggested gamma regardless dimension showed adaptive choice outperform fixed bandwidth estimator pointwise estimation 
fact abramson including silverman termed estimators adaptive shown square root law yields local bias clearly superior bias exhibited usual fixed bandwidth approach positive kernels 
rate consistent higher order kernels bartlett remove restriction non negativity 
research scott hall hu marron shows certain cases square root law fact perform significantly worse fixed bandwidth approach 
improved bias properties abramson square root law promising finding reasonable global implementation abramson approach proven elusive 
adaptive procedures practical studied scott jones 

modifies bias kernel estimator obtain global bias estimator 
research centered characterizing improved bias properties square root law studying global properties general sample point estimator difficult knowledge form optimal bandwidth function 
binning preprocessor utilized order characterize estimate mean integrated squared error mise sample point estimator determine behavior optimal adaptive bandwidth function study resulting adaptive estimates 
addition cross validation procedure proposed estimate unknown smoothing parameters 
philosophy differs substantially previous algorithms 
seek degrees freedom adaptivity order eliminate bias term 
wish optimize family bias believe constructed adaptive procedure practical graphical appeal algorithms 
note methodology extended construct adaptive algorithms 

binning kernel density estimation scott silverman scott sheather jones describe notion binned kernel density estimator practical approach fixed bandwidth kernel density estimator 
bin counts fn bins fb computed equally spaced mesh bin centers ft ffi bin width gamma ffi practice ffi binned kernel density estimator gamma gamma gamma reality finite number bins contain data summation taken nonempty bins 
hall derives pointwise mse kernel estimator rounded truncated data 
scott sheather expand hall result rounded data give asymptotic form mise binned estimator nh oe ffi oe note binning inflates bias term 
scott sheather note relatively insensitive reasonable amounts binning 
hall wand shown fractional binning datum partially split adjacent bin reduces bias inflation ffi ffi 
binned version sample point estimator gamma binning fixed kernel estimator effort ease computational burden 
binned version solely obtain set bandwidths fh 
form facilitates derivation useful approximate expression adaptive mise 
efforts usual asymptotic error approximations directly adaptive estimator proven futile 
scott give asymptotic expression mse general sample point estimator calculating exact expressions asymptotic approximations mise sample point estimator study global properties impossible form bandwidth function unknown 
straightforward exercise derive exact mise 
alternative described involves modeling data finite normal mixture density mixing parameters chosen maximum likelihood 

mise calculations normal kernel mise binned sample point estimator derived closed form mise gamma dx dx gamma dx dx oe gamma dx oe gamma oe gamma dx gamma oe gamma dx random quantities bin counts multinomial parameters bin probabilities dx evaluating expectations trivial exercise 
expectations integrating see wand jones appendix final form exact mise mise gamma np gamma oe gamma gamma oe gamma dx mise expression study characteristics sample point estimator 
partitioning support known density distinct bins bin probabilities integral cross product term evaluated criterion optimized space possible smoothing parameters fh mg 
shows behavior optimal binned sample point estimator number bins sample size increase 
dotted line shows mise optimal fixed bandwidth estimator 
note bins binned estimator performs poorly respect fixed bandwidth estimator terms absolute improvement fixed rate mise goes zero 
number bins increases binned estimator closely approximates behavior sample point estimator fixed mise versus sample size levels binning standard normal density 
dotted line represents mise optimal fixed bandwidth estimator 
yields considerable improvement fixed bandwidth estimator reasonable sample sizes 
example binned estimator outperform fixed bandwidth estimator 
furthermore lines essentially parallel large mise binned estimator shares gamma rate fixed bandwidth estimator 
mise reduced slightly adaptive scheme 
particularly noteworthy significant adaptive balloon estimator shown scott afford theoretical reduction mise setting regardless sample size 
reasons unexpected improvement explored 
displays set optimal smoothing parameters bins sample sizes standard normal density 
interesting aspects pattern optimal smoothing parameters deserve attention 
optimal bandwidths follow general rule having small values data neighborhood modes larger values tails distribution 
gets larger behavior smoothing parameters different optimal adaptive binned smoothing parameters 
plot versus top bottom symmetry bins quite different shown 
smoothing parameters near mode distribution appear going zero approximate rate gamma similar optimal fixed bandwidth choice rate smoothing parameters tails going zero times slow 
fact clear figures values go zero 
note behavior reminiscent zero bias bandwidths associated balloon estimators discussed scott 
authors show theoretically optimal pointwise bandwidths regions underlying density convex regions example tails converge zero constant positive bandwidths yielding zero bias 
interesting feature apparent transition bins intervals jxj optimal bandwidths switch larger values tails smaller values near mode 
examples optimal estimates samples standard normal data size adaptive fixed estimates standard normal data binned estimator fixed kernel estimator 
displayed 
note binned sample point estimator estimate densities 
optimal smoothing parameters numerical optimization procedure splus smoothing parameter associated bin assigned data point particular bin 
sample point estimator equation calculate estimates 
sophisticated implementation levels binning estimating fh estimating density 
adaptive estimates procedure shown top frame corresponding fixed bandwidth estimates shown minimizes standard normal data 
improvement predicted reflected entire range estimates displayed 
compares theoretical behavior bandwidths binned approach abramson square root proposal 
top plot uses equally spaced bins standard normal density bottom plot uses bins bimodal mixture density oe oe gamma 
solid line represents bandwidth normal bimodal plots optimal binned smoothing parameters circles bimodal mixture densities 
solid line indicates optimal abramson bandwidth function dotted line represents optimal fixed bandwidth 
function defined abramson proposal unknown true density find constant minimizing numerically integrated form mise 
horizontal dotted lines locate optimal fixed bandwidths see exact mise formulas marron wand 
may obvious error adaptive dotted line 
example imply severely biased downward 
adaptive estimate increased mode contributions unusually large bandwidths tails 
compare optimal bandwidths binned abramson procedures 
standard normal case optimal binned bandwidths near mode slightly larger abramson method tails bandwidths flatter opposed continued rapid increase abramson proposal 
suggest clipping procedures originally suggested largely ignored abramson beneficial proper amount form clipping determined see mckay 
noted significant improvement mise square root law implementing clipping procedures proposed mckay 
bimodal case variable bandwidth functions increasingly dissimilar 
neighborhood left hand mode gamma bandwidth functions fairly consistent standard normal discussed 
near right mode smaller scale parameter left mode optimal binned bandwidths neighborhood mode significantly smaller abramson 
true mixture density selected levels modes equal curvature greater right mode 
magnitude bandwidth chosen square root law determined solely height density near mode account differences curvature scale 
formula suggests relevant 
case abramson method lacks certain flexibility part accounting poor large sample performance scott 
differences bandwidth functions result quite different estimates shown 
estimates bimodal mixture density binned sample point estimator abramson square root law fixed kernel estimator shown top bottom 
optimal smoothing parameters 
note abramson estimator fairly job smoothing left mode fails adequately emphasize right mode level curvature accounted 
sample size fixed bandwidth procedure obvious trouble exhibiting large amount variability near left mode optimal fixed bandwidth reflects compromise optimal fixed bandwidths mode 
general fixed bandwidth procedure simultaneously different regions 
study differences binning procedure abramson approach figures display mise function sample size standard adaptive abramson fixed estimates bimodal mixture density binned sample point estimator abramson square root law fixed bandwidth estimator 
mise second order fixed abramson binned sample point mise second order fixed abramson binned sample point sample size versus mise various methods standard normal data bimodal data 
height vertical line left side plot represents factor magnitude mise factor 
normal bimodal mixture study convergence mise 
cases small samples binned sample point estimator abramson approach outperform fixed bandwidth 
gains abramson square root law fixed kernel procedure diminish sample size increases proportional gain mise continues binned sample point estimator 
fact binned estimator mise half fixed bandwidth estimator normal case third bimodal case 
version abramson estimator shown plots similar results obtained implementing clipping proposals abramson mckay 

practical cross validation approach practical algorithm utilizing binning approach address crucial issues 
selecting proper number bins second accurate estimation smoothing parameters associated bins 
section squares unbiased cross validation ucv criterion bowman shown accomplish tasks simultaneously 
fact discussed estimating adaptive histogram bin widths 
ucv seeks minimize estimate integrated squared error ise ise gamma dx gamma dx note third term constant respect unknown values smoothing parameters ignored minimization solely function binned sample point estimator normal kernel oe gamma dx oe gamma oe gamma dx oe gamma ise cross product term dx estimated unbiased manner leave estimator gammai gammai gamma ij gamma ij gamma combining adaptive cross validation criterion function ucv hm gamma gammai estimates optimal smoothing parameters numerically minimizing ucv criterion fh mg integer bowman showed ucv unbiased nonrandom choice smoothing parameter sense ucv mise 
alternate terminology unbiased cross validation 
straightforward show true case binned sample point estimator 
cross validation criterion bimodal data example 
local minima indicated dotted lines global minima shown solid line 
theorem ucv 
binned sample point estimator defined 
ucv squares cross validation criterion defined 
ucv unbiased sense ucv mise proof see appendix 
practical procedure utilizing cross validation bins achieve sufficient approximation adaptive sample point procedure gain edge fixed bandwidth approach limiting number bins achieve reasonable approximations optimal smoothing parameters depending sample size avoid numerical optimization instabilities small 
achieve tradeoff data binned fixed size mesh optimal smoothing parameters minimizing cross validation criterion 
number bins increased optimization repeated 
selection proper number bins accomplished choosing number bins yielding smallest cross validation criterion evaluated optimal set smoothing parameters 
study behavior procedure sample size drawn bimodal normal mixture oe oe gamma binned estimates smoothing parameters local minima ucv 
bin locations indicated plot 
interval gamma 
maximum number bins limited largest number non empty bins 
optimal values cross validation criterion number bins displayed showing local minima global minima 
fluctuations ucv criterion due part interaction locations bin edges modes shifting meshes considered 
ucv criterion pick number bins shift experience indicates general appearance final density estimate affected choice bin edge see discussion example 
estimates optimal smoothing parameters local minima ucv criterion shown 
little difference optimal estimates near right mode increased flexibility larger number bins gives better estimate near right mode expense slightly variability near left mode 
increased flexibility larger number bins incurs higher cost terms results simulation study bimodal density solid lines indicate optimal mise bandwidth function dashed lines indicate mean bandwidth function calculated replications dotted lines represent empirical confidence bands 
variability estimated smoothing parameters 
illustrate samples size drawn bimodal density estimated smoothing parameters calculated number bins 
results shown 
number bins increase variability associated estimation bandwidths 
number bins considered smoothing parameter attempts balance flexible estimation unknown bandwidth function accurate estimation unknown smoothing parameters 
direct examination estimates resulting local minima necessary gain insight structure data 

examples section examples utilizing actual data shown illustrate bins ucv adaptive abramson fixed best old faithful example ucv criterion bandwidth functions ucv filled circles abramson open circles fixed dashed line density estimates 
methodology outlined previous sections 
example shown uses measurements length minutes old faithful taken 
frame data clearly bimodal separated modes 
modes approximately height differ scale 
frame shows number bins versus value adaptive ucv cross validation criterion 
interval interest taken fixed maximum number bins restricted empty bins allowed 
global minima achieved 
middle frame shows estimated bandwidths bin solid circles final bin boundaries 
note bandwidth data point plotted binned estimator estimation 
observe difference bandwidth near modes 
data points near left mode smaller scale larger curvature significantly smaller bandwidth near right mode larger scale smaller curvature 
estimates density shown bottom frame 
fixed bandwidth estimator bandwidth chosen ordinary ucv abramson style estimator shown comparison 
abramson estimator utilizes fixed kernel pilot estimator calculating bandwidths smoothing parameter pilot estimator jointly chosen minimizing squares crossvalidation criterion 
note fixed abramson estimates remarkably similar estimated bandwidths methods roughly equal 
procedures adequate job estimating left mode leaving right mode 
adaptive binning procedure appears better job estimating modes 
second example shown buffalo data 
choosing appropriate number bins bit difficult shown top plot 
mesh shifting affect due ties small sample size 
data set exhibit evidence rough nature ucv criterion function number bins results placement bin edges near modes 
choice reasonable best ucv occurs shift 
solution bins shifting introduces extra nonempty bin left 
bandwidth functions shown middle plot 
binned procedure shows clear evidence smaller bandwidths near finding considerable larger bandwidths modal bins 
bins adaptive abramson fixed buffalo data example see legend previous 
frame equally shifted meshes evaluated addition original mesh 
best original ucv values connected solid dotted lines respectively 
abramson procedure fixed bandwidth procedure shown 
abramson method yields bandwidth function show evidence bumps pronounced binned procedure 
estimates shown bottom frame 
conservative fixed bandwidth procedure barely hints data may 
abramson method emphasizes primary mode exhibiting shoulders bumps additional modes 
adaptive procedure gives clearer evidence data 
parzen speculated reflect overfitting 
adaptive abramson fixed suicide data example see previous legend 
data set suicide example see silverman 
density strongly skewed exhibiting long right tail 
case leads empty bins 
unfortunately bins yield improvement fixed bandwidth estimator 
case procedure partitions locally cells studied employed 
data partitioned equally spaced bins 
bins split equally spaced bins splitting reduces ucv criterion 
result splitting corresponding bandwidths shown 
note bins required additional splitting 
shown top frame estimated bandwidth functions abramson procedure fixed bandwidth procedure 
abramson bandwidth function represents compromise procedures 
adaptive fixed economic data example 
estimates shown 
adaptive procedure smoothes roughness tail including spurious modes near adequately smoothing mode 
adaptive procedure indicates shoulder near clear mode shown procedures 
abramson fixed methods dominated large curvature near mode giving smaller smoothing parameters range estimated density larger noise levels tails 
final example larger sample economic data income survey taken uk 
data normalized average 
data analyzed authors example park marron wand 
stone 
fixed kernel estimate adaptive estimate displayed 
adaptive estimate able capture bimodal structure adequately smooth tail opposed fixed bandwidth estimate leaves distribution 

discussion advocated binning approximate adaptive sample point density estimator 
simple device allows theoretical study powerful alternative fixed bandwidth estimator 
long overdue study elusive literature 
heart binning procedure discussed adaptive variable bandwidth procedure seek eliminate bias term proposed procedures deliberate construction stay family improving fixed bandwidth approach important cases 
practical side cross validation algorithm powerful simplicity performs theory predicts 
dimension optimization problem reduced unknown bandwidths estimated 
furthermore ucv criterion relatively easy calculate primarily function bin counts 
shown ucv procedure excellent job estimating unknown parameters examples demonstrate algorithms superior performance real data 
believe may possible prove notorious variability ucv fixed kernels reduced binned variable estimators 
procedure shows real promise low dimensional multivariate setting binning practical solution problems scarcity data higher dimensions 
continued properly choosing form mesh including variable sized meshes important multivariate case 
related practical idea define adaptive smoothing parameter function cubic spline ucv sense procedure variety zero order spline 
simple closed formed theoretical mise expressions available adaptive ucv algorithm 
formulation proposed independently fan 

relative performance ideas thoroughly tested date 
alternative smooth estimated bandwidth function fitting spline binned estimates manner similar suggested regression marron findings implications adaptive approaches wavelet density smoothing 
appropriate smoothing estimates determined applying thresholding function wavelet coefficients donoho 
wavelet smoothing local nature quality balloon algorithm algorithm optimally requires non local smoothing tails 
extending non local algorithm wavelet thresholding interesting project 
appendix proof theorem proof proceeds examining terms mise ise ucv verifying equal term term 
note terms criterion identical 
second term examined detail 
recall bin counts fn multinomial parameters fp dx oe gamma dx expectation cross product term ucv gammai gamma ij oe gamma expectation noting ij multinomial parameters ii ij gamma iii ij independent bin counts ij include ith observation 
expectation reduces gammai oe gamma dx equals 
cross product terms agree completes proof 
abramson 
bandwidth variation kernel estimates square root law annals statistics 
bartlett 
statistical estimation density functions series 
bowman 
alternative method cross validation smoothing density estimates biometrika 
breiman purcell 
variable kernel estimates multivariate densities technometrics 
donoho johnstone kerkyacharian picard 
density estimation wavelet thresholding technical report department statistics stanford university 
fan hall martin patil 
local smoothing nonparametric curve estimators technical report department statistics stanford university 
hall 
influence rounding errors nonparametric estimators density derivatives siam journal applied mathematics 
hall hu marron 
improved variable window kernel estimates probability densities annals statistics press 
hall wand 
accuracy binned kernel density estimators unpublished manuscript 
marron 
fast simple scatterplot smoothing discussion du roman pays louvain la neuve 
jones mckay hu 
variable location scale density estimation annals institute statistical mathematics press 
jones 
discretized interpolated kernel density estimates journal american statistical association 
jones 
variable kernel density estimates australian journal statistics 

asymptotically optimal cells histogram annals statistics 
stone 
study density estimation computational statistics data analysis 

nonparametric estimate multivariate density function annals mathematical statistics 
marron wand 
exact mean integrated squared error annals statistics 
mckay 
note bias reduction variable kernel density estimates canadian journal statistics 
park marron 
comparison data driven bandwidth selectors journal american statistical association 
parzen 
nonparametric statistical data modeling discussion journal american statistical association 

adaptive mixtures journal american statistical association 
rosenblatt 
remarks nonparametric estimates density function annals mathematical statistics 

empirical choice histogram kernel density estimators scandinavian journal statistics 

adaptive kernel density estimation unpublished dissertation department statistics rice university 
scott 
zero bias bandwidths locally adaptive kernel density estimators unpublished manuscript 

improvement kernel type density estimators journal american statistical association 
scott 
computer binned data density estimation computer science statistics proceedings th symposium interface eddy ed springer verlag new york pp 

scott 
multivariate density estimation theory practice visualization new york john wiley 
scott sheather 
kernel density estimation binned data communications statistics theory methods 
silverman 
kernel density estimation fast fourier transform applied statistics 
silverman 
density estimation statistics data analysis london chapman hall 

study effectiveness simple density estimation methods computational statistics 
scott 
improving convergence rates nonnegative kernel density estimators annals statistics 
scott 
variable kernel density estimation annals statistics 
wand jones 
kernel smoothing london chapman hall 

applied linear regression new york john wiley 

