heuristics internet map discovery ramesh govindan tangmunarunkit usc information sciences institute admiralty way marina del rey ca usa mercator program uses hop limited probes primitive traceroute infer internet map 
uses informed random address probing carefully exploring ip address space determining router adjacencies uses source route capable routers possible enhance fidelity resulting map employs novel mechanisms resolving aliases interfaces belonging router 
describes design heuristics experiences mercator presents preliminary analysis resulting internet map 
obtaining router level map internet received little attention research community 
unsurprising perceived difficulty obtaining high quality map minimal support exists infrastructure 
show useful possible get approximate map internet 
map step trying understand macroscopic properties internet physical structure 
potential uses internet maps described repeat 
documents collection heuristics known obscure inferring map internet 
possible definitions word map choose purposes graph nodes represent routers internet links represent adjacencies routers 
routers adjacent exactly ip level hop away 
section iv discuss implications definition describe map collection heuristics allow infer complete internet map 
inferring number ip addresses internet hosts explicit non goal 
ubiquitously available primitive infer router adjacencies hop limited probe 
probe consists hop limited ip packet corresponding icmp response indicating expiration ip ttl field error indicators 
traceroute tool uses primitive infer path destination 
generally speaking earlier mapping efforts computed router adjacencies sequence traceroutes different internet destinations 
destinations direct traceroutes usually derived databases routing tables dns precomputed table host addresses exception earlier mapping efforts attempted map internet sending hop limited packets single location network 
section ii describes greater detail efforts mapping internet 
describe heuristics employed internet mapper program mercator 
written entirely scratch mercator requires input external database order direct hop limited probes 
uses heuristic call informed random address probing targets hop limited probes informed results earlier probes ip address allocation policies 
technique enables mercator deployed assumptions availability external information direct probes 
mercator uses source routing direct hop limited probes directions radially sender 
enables mercator discover router adjacencies discovered 
describe heuristics result aliases interface ip addresses single router 
mercator contains heuristics resolving aliases 
section iii describes heuristics greater detail discusses limitations resulting map 
section iv discuss experiences deployment mapper 
describe various techniques validate map resulting deployment 
preliminary estimates size map analyze graph theoretic properties map 
section summarizes main contributions indicates directions 
ii 
related internet mapping projects currently attempting obtain router level map internet 
earliest attempt know traced paths destinations single network node 
destinations obtained database internet hosts sent electronic mail particular organization 
addition small number destinations intermediate nodes source routed traceroutes remaining destinations 
source routing result greater map fidelity unclear complete resulting map chosen destinations essentially represent arbitrary subset hosts internet 
researchers bgp backbone routing tables order determine destinations traceroutes 
prefix table repeatedly generate randomly chosen ip address prefix 
traceroutes address determine router adjacencies building router adjacency graph manner 
show section iii result internet map defined 
particular techniques may backup links proposes report results tracing locations internet 
furthermore traceroutes may discover interfaces belonging router projects propose techniques resolving aliases 
skitter tool uses database web servers determine traceroute targets 
techniques collecting representations internet autonomous system topology documented literature 
approach traces backbone routing activity period days infer inter links 
link represents inter isp peering customer isp connection 
instantaneous dumps backbone routing tables infer level links 
cases router support determine router adjacencies 
example builds list router adjacencies recursively interrogating routers snmp mibs 
similar technique internet multicast overlay network mbone 
routers mbone support igmp query returns list neighbors 
interest heuristics internet mapping motivated desire understand network structure better 
preliminary results analyzing resulting map 
generally high quality internet map validate compact topology models proposed 
models resulting internet map input simulations 
high quality internet maps validate hypotheses scaling limits real networks 
iii 
mapping heuristics section discuss design heuristics mapping internet 
design driven goals requirements discuss 
challenge challenge set outset project find collection heuristics allow map internet single arbitrary location hop limited probes 
interesting formulation mapping problem 
chose restriction reasons 
deployment mapping software trivial especially heuristics require specific topological placement exchange points backbone infrastructures 
fact results described obtained running mercator software workstation edge campus network 
second certainly feasible design distributed mapping scheme chose defer complexity implementing scheme explored centralized mapping solution 
glance requiring mapping software run single node restrictive 
appear single perspective provided restriction result large inaccuracies map 
show section iii source routing help alleviate inaccuracies 
second restriction hop limited probes minimal assumptions availability network functionality 
restriction follows allowing mapping software deployed network 
implies explicitly chose external databases dns routing table dumps drive map discovery 
choice pose interesting question map ip network starting nearly zero initial information lead robust heuristics map discovery 
show backbones routing table entries internet addresses section iii router interfaces populated dns section iv 
secondary requirements inform design map discovery heuristics 
obviously resulting map complete 
clearly requirement conflicts single location restriction hop limited probes single location possibly reveal router adjacencies 
section iv argue heuristics give nearly complete maps transit portion internet 
map discovery heuristics impose significant probing overhead network 
informally heuristics result significantly slower map discovery compared existing approaches 
quantify requirement chose sacrifice map discovery favor completeness reduced overhead necessary 
choice interesting consequences described section iv 
informed random address probing mercator uses hop limited probes infer router adjacencies external databases derive targets probes 
absence external information possible heuristic obvious convergence implications infer adjacencies probing paths addresses randomly chosen entire ip address space 
section describe different heuristic informed random address probing 
goal heuristic guess portions entire ip address space contain addressable nodes 
addressable node ip level connectivity public internet 
ip addresses assigned prefixes mercator informed guesses prefixes contain addressable nodes 
addressable prefix uniformly randomly selects ip address target probes described section iii 
mercator uses techniques guess addressable prefixes 
sees response hop limited probe ip address mercator assumes prefix contain addressable nodes 
sense mercator informed map discovery process 

addressable prefix mercator guesses neighboring prefixes neighboring prefixes addressable technique assumption address registries delegate address spaces sequentially 
paragraphs describe details informed random address probing 
instance mercator repeated application techniques leads gradually increasing prefix population 
order techniques prefix population seeded prefix 
mercator uses ip address host running infer seed prefix 
technique ensures prefix population eventually covers entire address space 
technique attempts ensure addressable prefixes explored early leading note mercator rely neighboring prefixes topologically related assigned isp rapid map discovery 
technique insufficient complete map discovery 
choices seed prefix technique result campus local map 
technique need heuristic infers length addressable prefix router ip address terms class class address mercator assumes prefix length respectively 
heuristic pre cidr address allocation policies 
class mercator assumes prefix length 
assumption practice top level address registries allocating cidr blocks length greater 
simplicity chose relatively coarsegrained guesses size addressable prefixes 
result small portion addressable prefix contain addressable nodes 
probe randomly repeatedly described section iii choice prefix length affect completeness resulting map discovery 
need heuristic determines technique invoked addressable prefix neighbor chosen 
window application technique resulted increase prefix population mercator selects neighbor existing prefix implementation chosen minutes 
chosen prefixes population neighbors population 
prefixes selected lottery scheduling algorithm 
number lottery tickets prefix proportional fraction successful probes section iii prefix 
heuristic attempts explore neighbors prefixes densely populated addressable nodes 
path probing discover internet map mercator repeatedly selects prefix manner described subsection population probes path address selected uniformly prefix 
traceroute mercator sends udp packets successively increasing ttl minimize network traffic path probe self clocking udp packet sent response previous received 
probing stops reached probe fails elicit response loop detected path 
traceroute termination conditions appropriate mercator interest inferring router adjacencies 
path probe results sequence routers responded icmp time exceeded udp probe ttl 
sequence mercator inserts map nodes corresponding links nodes links map 
reduce path probing overhead path probes start ttl 
results path probe prefix mercator computes furthest router path map time probe completed 
subsequent path probes start ttl corresponding response mercator continues path probe backtracks path probe ttl 
technique allows mercator avoid possible rediscovering router adjacencies 
reduces probing overhead routers vicinity host mercator executes 
order prefixes selected probing 
selecting prefixes round robin fashion mercator uses lottery scheduling algorithm prefix lottery tickets proportional fraction successful probes addressed prefix 
probe deemed successful discovers previously unknown router 
lottery scheduling mercator probing biased created prefixes densely populated addressable nodes 
heuristic attempts speed map discovery 
mercator designed allow multiple path probes proceed concurrently 
configurable number tradeoff map discovery increased overhead 
source routed path probing intuitively shortest path routed network expect path probing section iii results tree rooted host running mercator 
reasons path probing discovers richer view topology inter domain routing internet policy 
policies result widely divergent paths topologically contiguous routing domains 
mercator continuously probes addressable prefix days 
potentially discover backup paths addressable prefixes 
mercator attempts discover internet topology single location may cross links internet map 
obvious approach increasing likelihood discovering links internet map run mercator different nodes network 
section describe different solution problem source routed path probing 
essentially percentage source route capable nodes node topology degree node topology degree node topology degree node topology degree fig 

relatively sparse random networks capable nodes links 
plot doesn satisfy criterion dense random graph node graph degree 
serves illustrate intuition source routed path probing 
technique directs path probes discovered routers source route capable routers internet section 
routers internet source route capable 
fact small fraction see section iv support source routing 
cases routers located small isps neglected disable capability routers 
number large backbone provider routers source route capable 
presumably providers source routed traceroutes diagnose connectivity problems infrastructures 
small number source route capable routers help discover cross links 
roughly speaking source route capable router give perspective instance mercator running location 
effective small fraction routers helping discover entire map depends factors including structure internet location host running mercator placement source route capable nodes 
see plausible argument efficacy source routed path probing conducted experiment 
generated random graphs different sizes different average node degrees 
graph computed percentage links discovered function fraction capable nodes randomly placed network 
relatively sparse graph small ratio average node degree total number nodes source route capable routers discover links 
detect source route capability router attempt send source routed udp packet randomly chosen routers map 
udp packet directed randomly chosen port usually mercator host path path routing policy lead richer topology views 
mercator host backup path path backup paths mercator host path source route capable router source routed path source routing provide different perspective probing fig 

continuous path probing result shortest path tree routed host running mercator 
ellipses represent autonomous systems 
available source routing lead richer topology views 
elicit icmp port unreachable message target router 
receive response mark source route capable 
conduct test router discovered path probing heuristic 
furthermore router repeatedly test source route capability limit overhead small number tests run concurrently 
test may fail reasons lack source route capability may unreachable time test conducted may route 
router deemed source route capable repeatedly attempt send path probes randomly chosen routers map 
method choosing probe targets different path probing section iii 
chose approach avoid targeting hosts setting alarms host implementations automatically log source routed packets 
probing activity noticed system administrators section iv 
order reduce probing overhead source routed path probe starts initial hop count inferred response obtained discovered 
initial hop count guess incorrect path changed affect correctness map discovery 
send hop limited probes successively increasing ttl terminating reach destination loop detected path small number implementation consecutive hop probes failed 
criterion empirically chosen carefully balance overhead probing map discovery 
alias resolution simplify preceding discussion said path probes source routed discover routers 
path probes discover router interfaces 
single mercator instance discover interface belonging router multiple aliases router 
example policy differences paths mercator host different destinations intersect 
similarly primary backup paths destination overlap 
source routed path probe probes different perspective discover additional router interfaces 
resolving aliases important step obtaining accurate map 
unfortunately aliases resolved examining syntactic structure interface addresses 
router interfaces may numbered entirely different ip prefixes commonly occurs administrative boundaries 
dns equally ineffective purposes interfaces assigned dns names different interfaces assigned different names 
administrative boundaries different interfaces router may assigned names belonging different dns domains 
solution leverages suggested required feature ip implementations 
suppose host addresses udp packet interface router 
suppose packet addressed non existent port 
follows call packet alias probe 
corresponding icmp port unreachable response packet contain source address address outgoing interface unicast route interface verified behavior ip stacks belonging major router vendors 
feature suggests simple heuristic alias resolution 
send alias probe interface source address resulting icmp message assuming aliases router 
heuristic suggested earlier 
mercator uses additional refinements necessary correctly implement alias resolution 
mercator host alias probe response exits router source address alias probe mercator host source route capable router source routed alias probe alias probe fails route source routed alias probe fig 

repeated alias probing resolve router aliases 
cases source routed alias probes necessary alias resolution 
refinement repeatedly sends alias probes interface address 
see necessary consider scenario 
suppose router interfaces suppose instant alias probe returns 
implies instant router route sending host exits interface possible instant alias probe returns happen instant second probe sent router route sending host exits interface mercator repeatedly sends alias probes known interface 
limit probing traffic small number alias probes run concurrently 
efficacy repeated alias probing observation exist dominant paths routes internet 
high likelihood eventually large fraction alias probes returned router dominant path sending host 
second refinement uses source routed alias probes 
explains necessary 
practice large backbones complete routing tables 
backbone sending host eventually connected may able forward alias probe eventual destination 
circumvent mercator attempts send alias probes source route capable routers 
random combinatorial search capable routers time consuming process 
absence information find route interface believe option left 
mercator software design probing primitives mercator uses available traceroute program chose implement mercator scratch 
doing allowed flexibility trying different probing heuristics different termination conditions source routed path probing section iii 
enabled carefully tune overhead imposed probing sacrificing map discovery path probing optimization described section iii 
mercator implemented top collection classes written authors provides non blocking access file system communication facilities 
allows mercator outstanding probe packets independently tune number outstanding path probes source routed path probes alias probes 
mercator lines code 
mercator periodically checkpoints map disk 
completely restartable latest checkpoint 
heuristic revisions implementation mercator feature allowed avoid re discovering sections internet topology 
allowed recover buggy implementations heuristics 
iv 
experiences preliminary results heuristics described section iii plausible questions remain unanswered resulting internet map complete 
techniques validate resulting map 
heuristics 
map look 
section attempts answer questions 
implications methodology careful examination heuristics described section iii reveals important implications methodology 
map discovered mercator topology map enumerate router interfaces depict shared media 
uses path probing mercator discover interface addresses belonging router 
discovers interfaces paths mercator host enter router 
source routed path probing help increase number interfaces discov ered source routed path probing guarantee routers discovered 
second mercator implement heuristics discovering shared media 
infer subnet mask assigned router interfaces 
unfortunately potential probing techniques inferring subnet masks 
icmp query returns subnet mask associated interface widely implemented 
sending icmp echo requests different broadcast addresses corresponding different subnet masks inferring subnet mask broadcast request elicits responses capability disabled routers response smurf attacks 
may possible infer shared media isolating highly meshed sections internet map remains 
mercator map instantaneous map internet 
reduce probing overhead mercator limits number outstanding path probes 
result takes weeks section iv discover map internet 
interval course new nodes links may added mercator unable distinguish pre existing nodes 
reason resulting map time averaged picture network 
furthermore mercator discovers time averaged routed topology 
router adjacency backup link backup link traversed mercator run adjacency discovered 
similarly routers physical neighbors lan exchange traffic policy reasons adjacency discovered 
mercator produce complete map internet 
particular mercator discover details stub campus networks 
single run mercator sends large number path probes campus network probed frequently discover entire campus topology 
believe campuses source routing turned mercator unable discover cross links 
higher confidence degree completeness mercator map respect transit portion internet 
probes traverse transit portion frequently true greater extent core internet 
obtain complete map running multiple instances mercator correlating results 
left 
experiences implemented heuristics section iii ran instance mercator pc running linux 
configured limit concurrent path probes mercator takes weeks discover nearly interfaces nearly links 
numbers greater corresponding numbers obtained serving simple validation completeness run 
discuss validated internet map map reveals terms macroscopic internet structure describe early experiences running mercator analyzing data 
techniques inferring addressable prefixes 
answer question obtained list prefixes contain backbone routing table compared prefixes inferred mercator 
prefixes routing table covered prefix inferred mercator 
conversely prefixes inferred mercator overlapping prefix routing table 
surprising assumption neighbor addressable prefix addressable section iii result overestimation addressable space 
numbers validate efficacy heuristic near completeness exploration address space 
path probing 
perception isps disable traceroute capability infrastructures 
true major backbones clearly able see routers belonging map 
fact 
perception isps configure routers decrement ttls infrastructures 
true map contain routers large outdegree entire isp appears large router 
possible instance evidence practice widespread 
conjecture traceroute availability higher supposed researchers isps capability debug infrastructures 
instances obvious misconfiguration 
mercator received icmp time exceeded message source address class multicast address 
able successfully probe path net addresses addresses reserved private globally routable 
experience alias resolution mixed 
mercator able resolve nearly interfaces 
interfaces unreachable mercator host 
mercator determine interfaces aliases discovered routers 
causes may attributed interfaces numbered private address space minor exceptions space public route server route views oregon ix net 
globally routable 
interfaces alias resolution procedure applied 
assigned non private addresses corresponding isp propagate routes interfaces border 
interfaces alias resolution procedure applied 
interfaces assigned addresses parts internet core particular backbone isp mercator host defaults carry routes interfaces 
addresses attempted source routed alias resolution section iii 
heuristic works slow involves random search capable routers 
writing able resolve interfaces technique 
date mercator discovered distinct private addresses 
total interfaces directly reachable mercator unclear reached source routing 
widely held belief source routing experiences source routing path probing section iii probably interest 
summarize experiences nearly routers internet source route capable 
routers belong large backbones implying actively presumably debug isp infrastructures traceroutes 
source routed path probing works reasonably see bullet traceroute intermediate hops respond respond 
sufficient purposes goal infer router adjacencies study paths 
nearly links map discovered source routed probing direct path probing subsequently re discover links 
encounter bugs source routing 
router internet responds source routed packets packet sent directly 
router completely ignores ip loose source route option 
second earlier versions router vendor operating system non deterministically fail decrement ttl udp packets loose source route packet 
know extent bugs 
bugs potential corrupting map 
appropriately account potential analyses map characteristics section iv 
private addresses definition required globally unique physical interface assigned physical address 
experiences social consequences sending traceroutes similar reported 
tens system administrators largely corporate sites containing firewalls log udp packets non existent ports noticed activity registered abuse complaints institution 
validating map validate resulting internet map 
previous section discussed simple validation tests map 
data carefully compare link link basis maps 
theoretically feasible comparison required significant additional programming effort 
data set gathered different location internet 
consequently discovered different interface addresses mercator compare data sets resolve aliases section iii sets interface addresses 
deferred validation 
currently validating subgraphs internet map 
strategy compare published isp maps isp subgraphs extracted map 
extract isp subgraphs infer routers belonging isp dns names assigned router interfaces router addresses corresponding names assigned dns failed complete inverse mapping nearly discovered interfaces 
technique nam network animator able visualize isp structures 
cases isps naming conventions allow infer inter city links core routers customer connections 
isolate core portions isp networks studying structure isp networks left 
extraction isps tedious validation map harder fact commercial isps publish router level connectivity regarded proprietary information 
date compared discovered topology backbone structures local isp part research educational network mercator discovered routers link respective networks 
networks topology close host ran mercator probably irrelevant probing informed topological closeness expect mercator show similar fidelity distant similarly sized isps 
validation results somewhat encouraging 
los respectively 
small isp medium sized isp large national backbone fig 

mercator visualize analyze isp structures 
degree degree distribution degree distribution number nodes degree degree distribution source route discovered links source route discovered links fig 

degree distribution mercator map 
technique appears give fairly complete picture isps considered edge internet transit portion 
gives greater confidence hypothesis mercator map transit portion reasonable fidelity 
caveat 
connectivity structure networks relatively simple consist simple rings small number spur links 
easy see mercator map sparse isps quite 
clear successful mercator mapping meshed isp structures consist atm core private virtual circuits established routers 
currently validating structures map 
discussion results previous subsections indicated reasons mercator internet map may incomplete parts incorrect 
hope run mercator different locations internet see improve fidelity map 
believe map generated uses 
provides representative realistic topologies protocol simulations heuristics service proximity provide visual context isolating faults networks 
graph understanding large scale structure internet 
hand mathematical bounds degree inaccuracy mercator map 
furthermore graph theoretic properties estimates neighborhood sizes sensitive missing links 
argue able draw reliable network structure 
hand believe internet infrastructure improves greatly sense capability icmp services widely available routes router interfaces widely propagated difficult obtain map significantly higher accuracy 
argue able confidently analyze statistical properties internet topology 
despite particularly re number hops hop pair distribution hop pair distribution source route discovered links hop pair distribution number nodes number hops hop pair distribution hop pair distribution source route discovered links hop pair distribution log log scale fig 

hop pair distribution mercator map 
cent interest trying understand network structure analyze degree distribution hop pair distribution mercator map 
understand source routing bug described section iv maps computing distributions complete mercator map map source route discovered links 
plots degree distribution log log scale 
plot interesting 
node degrees plot linear lending support conjecture power law governs degree distribution real networks 
starting degree distribution significantly diffuse 
indicate different law governs distribution high degree nodes nodes usually closer core network 
plots number pairs nodes hops function distribution intriguing shape 
small number pairs nodes hops increases relatively slowly 
artifact methodology 
believe explanation small number nodes reachable hops increases dramatically nodes stub domain reach stub domains 
interesting feature curve hop pairs hops 
plots hop pair distribution log log scale 
distribution described power law especially 
quite possibly slight non linearity lower leads believe question remains open ignoring methodological inaccuracies 
show source route discovered links skew qualitative draw distributions 
distributions hold possibly different numerical values map discovered links 
knowledge extensive attempt date map internet 
documents techniques infer internet map reports experiences designing experimenting different heuristics increasing fidelity map 
clearly results mixed 
able explore internet previous efforts process revealed reasons exceedingly difficult obtain highly accurate map existing internet infrastructure 
intend explore directions running mercator location evaluating heuristics inferring topological elements shared media validating sections map help isps order try bound degree inaccuracy map 
deborah estrin scott shenker provided motivation gave valuable advice 
alaettinoglu suggested significant improvement earlier versions draft 
sandeep bajaj lee breslau deborah estrin kevin fall sally floyd mark handley ahmed helmy john heidemann polly huang satish kumar steven mccanne reza rejaie sharma kannan varadhan ya xu yu daniel zappala 
improving simulation network research 
technical report university southern california march 
braden 
requirements internet hosts communication layers 
request comments internic directory services october 

braun claffy 
global isp interconnectivity number 
nlanr net 
hal burch bill cheswick 
mapping internet 
ieee computer april 
case 
simple network management protocol snmp 
request comments internic directory services may 
claffy 
measurement visualization internet connectivity performance 
www caida org tools skitter 
dartmouth university 
intranet mapping snmp monitoring program macintosh 
www dartmouth edu 
deborah estrin mark handley john heidemann steven mccanne ya xu yu 
network visualization vint network animator nam 
technical report university southern california march 
faloutsos faloutsos faloutsos 
internet look 
empirical laws internet topology 
appear acm sigcomm 
francis jamin paxson zhang jin 
architecture global internet host distance estimation service 
proceedings ieee infocom march 
fuller li yu varadhan 
classless inter domain routing cidr address assignment aggregation strategy 
request comments internic directory services september 
govindan reddy 
analysis internet inter domain topology route stability 
proc 
ieee infocom kobe japan apr 

grad 
routes multicast trees internet 
acm sigcomm computer communication review january 
paxson 
routing behavior internet 
proceedings acm sigcomm symposium communication architectures protocols san francisco ca september 
phillips tangmunarunkit shenker 
scaling multicast trees comments chuang scaling law 
appear acm sigcomm 
postel 
internet protocol 
request comments internic directory services september 
sharma keshav 
discovering internet topology 
unpublished manuscript 
reddy estrin govindan 
large scale fault isolation 
technical report computer science department university southern california march 
submitted publication 
rekhter li 
border gateway protocol bgp 
request comments internic directory services march 
waldspurger weihl 
lottery scheduling flexible proportional share resource management 
symposium operating systems design implementation osdi pages 
usenix association 
