optimizing classi er performance wilcoxon mann whitney statistic yan robert michael mozer richard csg systems circle point rd suite department computer science university colorado boulder boulder cross entropy mean squared error typical cost functions optimize classi er performance 
goal optimization usually achieve best correct classi cation rate 
class real world problems roc meaningful performance measure 
demonstrate minimizing cross entropy mean squared error necessarily maximize area roc curve auc 
consider functions training classi er maximize auc directly 
propose objective function approximation wilcoxon mann whitney statistic whichis equivalent auc 
proposed objective function di erentiable gradient methods train classi er 
discussing improved results new objective function uci data sets apply new objective function real world customer behavior prediction problems wireless service provider cable service provider achieve reliable signi cant improvements roc curve 
classi ers neural networks typically trained minimizing mean squared error mse cross entropy ce objective function maximizing likelihood function 
class problem maximizing likelihood equivalent minimizing cross entropy 
performance measure classi ers usually classi cation accuracy 
class real world problems classi cation accuracy sucient metric provost 
consider problem predicting churn customers switch service provider 
telecommunications industry typical monthly churn rates neighborhood mozer 
trivial solution labeling customers yields correct classi cation rate 
general classi cation accuracy misleading class problem class distribution highly imbalanced 
elaborate consider simple example data set consisting positive negative examples 
suppose classi er outputs binary errors 
regardless examples misclassi ed classi cation accuracy mean square error 
consider di erent cases leading total errors 
case errors negative examples false positive rate rate negative examples labeled positive false negative rate rate positive examples labeled negative 
case errors positive examples false positive rate false negative rate 
cases yield quite di indistinguishable measure classi cation accuracy 
alternative means evaluating classi er performance confound false positive false negative error rates receiver operating characteristic roc curve provost swets pickett 
roc curve depicts performance classi er plotting true positive rate false positive rate 
assuming classi er produces continuous output class posterior probabilities output thresholded label example positive negative 
setting decision threshold true positive false positive rate obtained 
varying decision threshold range roc curve produced 
left graph includes roc curves true false positive rates axes respectively 
upper left corner better classi er ability discriminate classes 
area roc curve auc general robust measure classi er discrimination performance regardless decision threshold unknown vary depending classi er 
show section auc mse ce performance measure 
auc quantity concern train classi er directly optimize auc 
unfortunately auc nondifferentiable easy compute 
alternatively wilcoxon mann whitney wmw statistic mann whitney wilcoxon provides equivalent metric auc hand 
wmw statistic pairwise comparisons sample random variable sample random variable statistic estimator 
identify classi er outputs positive examples classi er outputs negative examples obtain proxy auc classi er 
simplify expression merged sorted ascending order yielding rank 
assume classi er produces high outputs positive classi cations rank lowest output 
erentiable optimization methods 

authors recognized limitation mse optimize roc curve proposed numerically calculate auc trapezoidal integration rule maximize auc simulated annealing 
reported simulated annealing approach improve results mse criterion 
roc curve utilized extensively assess performance provost little research addressed problem practical importance optimizing roc curve 
mozer 
approaches proposed improve speci point roc curve 
approaches assume decision threshold misclassi cation costs known 
focus improve roc curve measured auc 
caruana 
recognized mse model relative ranking explicit discrimination required 
proposed algorithm called rankprop tried learn rankings iteratively 
convergence properties algorithm questionable wehave experimentally dicult obtain convergence 
information retrieval eld related exists optimizing ranks bartell vogt cottrell 
bartell di erentiable function guttman point alienation statistic measure correlation target estimated ranking 
vogt cottrell showed measure seen scaled version mean mean standard deviation explored variations training neural network classi ers improve auc real world data sets yan 
classi cation accuracy auc section explain auc classi cation accuracy criteria auc sensitive quite di erent aspects classi er classi cation accuracy 
argue point alternative classi er assign positive negative label example manner 
assume classi er produces continuous output run data set consisting positive negative samples 
set samples ranked classi er output rank varies rank lowest output 
examples identical output assigned average rank 
threshold samples rank labeled positive examples labeled negative determine examples labeled correctly errors 
total number errors data set classi cation accuracy 
contrast wmw statistic depends ranks examples classi ed incorrectly 
depending ranks misclassi ed examples possible values wmw statistic 
eq 
mean variance set wmw statistic values associate classi cation accuracy obtained positive sample percentage standard deviation wmw statistic mean value wmw statistic number epochs mse wmw statistic left increases decrease classi cation accuracy xed 
right wmw statistic mse variation training uci credit approval data 
left shows example relationship proportion classi cation accuracy xed 
see wmw statistic increasingly classi cation accuracy class distribution imbalanced 
generally minimizing mse ce optimizing classi cation accuracy guarantee maximization wmw statistic auc especially imbalanced data sets 
right demonstrates wmw statistic necessarily increase mse decrease mse minimized training 
direct optimization auc section propose alternative objective function training classi ers directly optimize roc curve 
proposed objective function applied parametric classi er 
results apply proposed objective function typical multilayer perceptron mlp softmax outputs single hidden layer direct connection input output layers 
new objective function directly optimize auc try maximize wmw statistic eq 

function eq 
erentiable 
intuitive di erentiable approximation eq 
sigmoid function 
small 
large close brings numerical problems optimization steep gradients 
large data sets experiments wehave seen optimization proceed successfully 
alternatively di erentiable function approximate 
gradient methods limited memory bfgs method liu nocedal train classi er minimizing objective number epochs wmw statistic training data mse ce number epochs wmw statistic test data mse ce wmw statistic variation training set left test set right heart data function number epochs training 
training positive sample higher output negative sample margin pair samples contribute objective function 
essentially uence training samples adaptively adjusted pairwise comparisons training 
results discussion look training process di erent objective functions uci data set heart prede ned training test sets 
shows variation wmw statistic function number epochs training training test sets objective functions 
see objective function eq 
obtains largest wmw statistic training test 
ce achieves wmw statistic training set obtains lowest wmw statistic test data 
tting observed mse ce training training incur obvious tting 
early stopping applied mse ce training value wmw statistic test test reaches maximum maximum value smaller nal wmw statistic objective function eq 

see true experiments 
obvious inferior 
left panel presents roc curves uci credit approval data set fold cross validation 
gure shows objective function eq 
generates signi cantly better roc curve mse training 

natural question 
shown right wmw statistic auc test data quite large range 
general 
false positive rate true positive rate ce mse margin parameter gamma wmw statistic test data left roc curves fold cross validation credit approval 
mlp structure insensitive number hidden units curves hidden unit 
right wmw statistic test data di erent credit approval 
test data union sample subsets fold cross validation 
applications churn prediction wireless telecommunications industry costs times sign new subscriber retain existing 
crucial predict customer behavior proactively build lasting customer relationships 
build neural network models predict churn static customer data demographics application information time series data historical usage billing customer service 
year worth past usage billing customer service data predict customers churn months 
example model trained input data june september class label churn october 
trained model data july october class predictions november 
training test data extracted di erent time windows problem dicult data yan 
results study data sets major wireless service provider 
number customers training set close test set forward shifted time window customers 
months past usage billing customer service data available training test sets 
task predict churn month window average churn rate roughly 
raw features extracted variety data sources 
preprocessing raw data dimensional feature vector represent customer 
left compare roc curves test data di erent training methods 
model trained minimizing new objective function eq 
achieves better roc curve models trained mse ce 
ensemble averaging models di erent values outperforms best individual model 
show training process right compares wmw statistic variation training training false positive rate true positive rate mse ce ensemble number epochs wmw statistic training data mse training data test data mse test data left roc curves churn prediction major wireless service provider 
mlp structure hidden units 
right wmw statistic variation training test sets training churn prediction model 

test sets new objective function eq 
mse 
similar previous results new objective function obtains larger wmw statistic training test data mse training data 
note largest value test set wmw statistic mse criterion epoch smaller new objective function nal wmw statistic 
cross sell acceptance prediction application build models cable service provider predict customers accept cross sell er particular new service 
accurate prediction acceptance signi cantly save service provider campaign costs dramatically improve er acceptance rate targeting customers accept new service 
similar data sources churn prediction raw data elds extracted transformed features neural network inputs 
study months worth past usage billing customer service data predict customers accept new service month 
training test sets extracted di erent time windows test data window month 
training customers positive sample rate 
test set consists similar number customers positive sample rate 
left demonstrates new objective function eq 
achieves substantial curve mse ce training 
right shows di erence training processes new objective function eq 
ce 
wehave demonstrated mean squared error cross entropy appropriate objective functions training classi er goal maximize discriminative ability classi er range decision thresholds 
proposed new objective function di erentiable approximation wmw statistic area roc curve 
results data sets real world customer behavior prediction problems demonstrate false positive rate true positive rate mse ce wmw statistic number epochs training data ce training data test data ce test data left roc curves predicting internet service acceptance major cable service provider 
mlp structure hidden units 
right wmw statistic variation training test sets training acceptance prediction model 

consistent signi cant improvements achieved new algorithm 
acknowledgments authors uc berkeley cesar minnesota state university valuable help discussions 
bartell cottrell belew 
optimizing parameters ranked retrieval system multi query relevance feedback 

caruana baluja mitchell 
sort rankprop multitask learning medical risk evaluation 
hand 

john wiley sons lane england 
liu nocedal 
limited memory bfgs method large scale optimization 
pp 

mann whitney 
test random variables stochastically larger 
pp 

mozer 
roc curve constrained optimization classi er performance 
mozer grimes johnson 
predicting subscriber dissatisfaction improving retention wireless telecommunications industry 

provost fawcett kohavi 
case accuracy estimation comparing induction algorithms 
pp 
yan 
variations train neural network classi ers 
internal research note advanced technology group csg analytics 
swets pickett 
academic press new york 
moreau vandewalle 
multilayer perceptron predict ovarian tumors 
vogt cottrell 
optimize rankings 
technical report san diego cse department 
cs 
wilcoxon 
individual comparisons ranking methods 
pp 

yan miller mozer 
improving prediction customer behavior nonstationary environments 
pp 

