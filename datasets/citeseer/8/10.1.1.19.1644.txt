hybrid propagation junction trees philip dawid kj ste en lauritzen university college london gower street london wc bt england aalborg university fredrik vej dk aalborg denmark 
introduce methodology performing approximate computations complex probabilistic expert systems components handled exactly require approximation simulation 
illustrated means modi ed version familiar chest clinic problem 
markov chain monte carlo mcmc methods decade increasingly popular computational tool complex stochastic systems various type gelfand smith thomas gelman rubin geyer smith roberts 
methods exible easy implement computing time tends scale size problem consideration 
main disadvantages associated reliance pseudorandom number generators ripley diculty deciding necessary equilibrium reached fact moderately sized problems compute slowly 
alternatively fast exact methods developed computation particular types graphical models lauritzen spiegelhalter shenoy shafer jensen dawid lauritzen spiegelhalter implemented example shell hugin andersen 
exact methods apply usually preferable weakness exact methods precisely limitations problems currently able deal appropriately 
development exact methods stopped limit interesting problems appropriately dealt means exact analysis 
currently situation just single variable bayesian network continuous distribution exact analysis performed entire network handled monte carlo methods special cases lauritzen 
concerned establishing basic ideas scheme enables combination virtues types methods 
idea split graphical model submodels universes favourite method computation organise universes junction tree done case exact methods letting communicate 
hope produce scheme exibility mcmc methods exploits speed correctness exact methods feasible 
research horizon general schemes involving combination belief functions objects uncertainty formalisms appear interesting possibilities 
basic example illustrate scheme chosen modi ed version chest clinic problem lauritzen spiegelhalter 
directed acyclic graph fig 
shows independence graph associated model variables visit asia 
smoker 
tuberculosis 
lung cancer 
bronchitis 
tuberculosis lung cancer 
positive ray 


variables states denoted respectively 
convenience shall notation fig 

independence graph junction tree original chest clinic model original conditional probabilities associated model reproduced table 
table 
conditional probabilities chest clinic model junction tree corresponding graph fig 
constructed operations moralization edges triangulation edge lauritzen spiegelhalter shown fig 
belief universes cliques marked ovals separators rectangles 
initial evidence marginal probabilities individual variables calculated appropriate clique potentials propagation conducted 
result operations appear table 
table 
marginal probabilities individual variables chest clinic model modi ed chest clinic model illustrating hybrid propagation scheme follows 
assume want relax constraint bronchitis absent able express degrees bronchitis continuous scale 
accomplish de ning conditional distribution acquiring bronchitis smoking habits standard continuous distribution 
beta distribution johnson kotz appropriate de ne yields mean values respectively complying original speci cation see table 
speci ed beta distribution need conditional probabilities su ering shortness breath bronchitis lung cancer tuberculosis 
accomplished logit logit log 
get logit logit logit logit numbers parentheses corresponding conditional probabilities obtained logit logit 
note probabilities somewhat di erent table closest get expression 
modi cation model introduced sucient destroy possibility computing marginal probabilities nodes exact methods 
example small direct monte carlo numerical methods exploited obtain marginal probabilities 
exploit fact check calculations 
example supposed illustrate scheme practical interest problems larger size 
modi cations mean 


marginal distribution calculated 
result numerical integration 
propagation message passing brie recall general idea propagation message passing junction tree described dawid 
notation terminology 
belief universe clique separator junction tree initially equipped potential joint density satis es ac evidence received potentials changed universes expression form continues valid 
messages sent universe universe separator way 
calculates marginal potential 

potential receives message changing ad ad 
separator potential changes important points noted 
firstly message sent correctness ected 
secondly messages scheduled appropriately nite number message passes messages neutral change 
say junction tree equilibrium 
happens marginals subsets universe calculated potential identical marginals calculated joint expression 
basic idea consider potentials purely formal objects allowing computer represent directly discrete probability tables current implementation hugin programs numerical integrators monte carlo machines draw random distribution density proportional potential 
practical interest think terms universes large networks complex objects just cliques graph 
think objects sets organised junction tree usual type 
diculties encountered general approach concerned elaboration theory speci description types universes scheduling messages 
theory discussed subsequent aspects sections 
aspect theory brie mentioned explain developments potentials replaced measures functions ratios interpreted radon nikodym derivatives 
avoid technical details 
point general may happen scheme marginalised measure absolutely continuous respect separator measure second version rst 
rst case say receives message update ratio second case measure 
universe types section describes general terms main types universes dealt scheme communicate 
distinguish main types 
de discrete exact archetype belief universe 
de universe simply list possible con gurations associated weights real numbers 
term exact refers fact knows computation needs exact way 
exact types universes exact computations 
examples universes hugin universe discrete variables represented hugin sense junction tree de universes 
universe possibly discrete continuous conditional gaussian variables hugin sense 
de universes hugin universes special cases 
formula universe discrete variables belief potential expressed exact formulae 
computations example handled form computer algebra program 
numerical type universe way calculates approximately 
universe typically int universe computations numerical integration universes discussed nd important point possibility 
mc universe calculations form monte carlo method example gibbs sampling moral graph forward sampling directed acyclic graph direct sampling exploiting graphical structure 
calculations involve importance weights 
di erent kinds universes way send receive messages described detail sects 

returning example choose implement tle ex universes type de universe type mc universe type formula shorthand fa tg universes connected junction tree displayed fig 

de de mc formula de fig 

junction tree modi ed chest clinic model de universes mc universe formula universe belief potentials universes instantiated shown table universe universes evidence assumed 
shall explain precise meaning potentials speci cases 
table 
initial instantiation belief potentials universes univ kind initial potential de tle de mc formula ex de discrete exact universes de universe represented nite subset fx xu possible states product space xu set associated weights wn weight associated universes potential positive measure function integral respect represented universe space xu xa ax just adding weights points marginal 
messages received update ratios messages sent neighbouring universes measures transformed update ratios division separator measures 
receiving update ratio revised weights obtained 
de universes receive send messages requested 
basic example universe states weights potentials obtained multiplying appropriate numbers table 
similarly de universes example 
exact universes universe representation probability measure xu computed exact form separators associated assume computable uns severe restriction 
described sub types hugin 
kind universe send exact messages receive message 
receiving update ratio revised measure obtained 
receiving measure obtained uns 
may change type type may allow exact calculations 
basic example potential universe represented table de algebraic expressions involving standard functions displayed table 
numerical universes universe equipped representation probability measure de ned xu calculate separator marginals exactly approximate calculation 
type int approximation obtained numerical integration possibly approximating entire universe measure xu discrete de universe suitable weights 
integration performed may changed type int de 
table 
initial exact potentials universe type mc approximation obtained program performs forward sampling dag drawing gibbs sampling undirected graph drawing sampling directly exploiting graphical structure 
assume program returns discrete de universe points equal sample 
function di ers unity samples weighted sample importance weight 
third argument determines sample size 
program terminates changed type mc de 
universe receive kind message update ratio measure revised measure obtained described 
particular instance speci ed program representing universe takes message changing changing importance weights 
may change monte carlo sampling procedure forward gibbs de universe sending messages sent described sect 

basic example implemented universe mc universe forward sampling receives messages importance factors 
initial potential samples rst choosing uniformly distribution beta distribution correct parameters determined sampled value nally uniformly 
gives rst point approximating space procedure repeated times 
messages received neighbouring universes points weighted appropriately 
note way optimal implementation network chosen illustrate exibility methods 
network architecture certain sense possibilities scheduling messages general case 
novel element fact propagation process universes may change type particular may change approximating universes drastically di erent original ones 
happens example universe continuous state space changes discrete universe 
may destroy property marginal universe absolutely continuous respect separator measure 
sent message property restored separator may destroyed separators neighbouring universe requiring messages property restored 
refer phenomenon cascade messages 
noting messages destroy correctness representation see essentially usual message schedule carries modi cation 
shall illustrate possible correct scheduling example 
recall message termed active sent universe received active messages neighbours 
active messages passed pair universes equilibrium reached 
scheduling example follows 
tle 

ex 
tle 
tle 
tle 

ex messages active equilibrium reached 
indicate detail messages sent 
tle standard message 
potential marginalised summing table numbers values placed new potential separator multiplied initial tle table 
division needed separator initially contained neutral potential 
ex message standard message 
universe ex sends potential axe mc universe 
result stored importance factor forward sampling 
particular case factor turns unity chest ray taken 
tle message type 
universe tle sends separator potential le tle mc universe function multiplied existing importance factor 
message sent rst forward sample described sect 
obtaining values weights calculated importance factor potential 
continuous variable arrange samples contingency table need store samples see table send information pertaining universe 
sampling ended universe changed type de 
send usual way 
table marginalised ignoring values receives message table 
sample values universe 
type de weights obtained table multiplication appropriate values functions table 
message sent universes standard messages sent usual way 
hybrid propagation method scheduling messages described implemented programming language 
forward sampling procedure implemented run example 
marginal distributions individual variables obtained running methods sample size displayed table exact values obtained direct calculation variables numerical integration variables 
observe signi cant di erence precision distributions provided forward sampling provided hybrid propagation method 
implemented hybrid method inecient way example gives promise developments 
table 
exact marginal distributions approximate ones obtained forward sampling hybrid propagation sample size 
variable rst number displayed mean second variance 
variable forward hybrid exact research supported esprit basic research action project drums ii programme danish research councils 
grateful ross providing numerical integrations mathematica 
andersen olesen jensen jensen hugin shell building bayesian belief universes expert systems proceedings th international joint conference arti cial intelligence 
reprinted shafer pearl dawid applications general propagation algorithm probabilistic expert systems statistics computing gelfand smith sampling approaches calculating marginal densities journal american statistical association gelman rubin inference iterative simulation single multiple sequences discussion statistical science geyer practical markov chain monte carlo discussion statistical science jensen lauritzen olesen bayesian updating causal probabilistic networks local computation computational statistics quarterly johnson kotz distributions statistics 
continuous univariate distributions vol 
wiley sons new york lauritzen propagation probabilities means variances mixed graphical association models journal american statistical association lauritzen spiegelhalter local computations probabilities graphical structures application expert systems discussion journal royal statistical society series ripley stochastic simulation wiley sons shafer pearl 
eds readings uncertain reasoning morgan kaufmann san mateo california shenoy shafer axioms probability belief function propagation shachter levitt kanal lemmer eds uncertainty arti cial intelligence iv north holland amsterdam smith roberts bayesian computation gibbs sampler related markov chain monte carlo methods journal royal statistical society series spiegelhalter dawid lauritzen cowell bayesian analysis expert systems discussion statistical science thomas spiegelhalter gilks bugs program perform bayesian inference gibbs sampling bernardo berger dawid smith eds bayesian statistics clarendon press oxford uk article processed macro package llncs style 
