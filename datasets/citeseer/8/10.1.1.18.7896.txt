building optimal statistical shape models davies carole daniel allen tim 
cootes chris 
taylor imaging science biomedical engineering building university manchester oxford road manchester pt uk tel 
fax 
method automatically building optimal statistical shape models 
statistical shape models widely basis segmenting images 
major drawback approach need establish set dense correspondences training set segmented shapes 
posing problem minimising description length model intro parametric approach manipulating correspondences develop ef ficient method automatically finds optimal correspondences set shapes 
results training sets shapes showing automatic method constructs significantly better models built hand current gold standard 
corresponding author man ac uk preprint submitted elsevier science april key words statistical shape modelling minimum description length active shape models statistical models shape show considerable promise basis segment ing interpreting images 
basic idea establish training set pattern legal variation shapes spatial relationships structures class images 
statistical analysis give efficient parameterisation variability providing compact representa tion shape allowing shape constraints applied effectively image interpretation 
main drawbacks approach need establish dense correspondence shape boundaries reasonably large set training images 
important establish correct correspondences apparent shape variability exaggerated application shape constraints interpretation comes effective see 
practice correspondence established manually defined landmarks time consuming subjective 
problems exacerbated approach applied images 
previous attempts automate model building :10.1.1.16.1712
problem establishing dense correspondence set training bound aries posed defining parameterisation alignment shape training set leading dense correspondence equivalently parameterised boundary points 
arbitrary parameterisations training boundaries proposed guarantee correct correspondences 
shape features regions high curvature establish point correspondences boundary length lation points 
approach corresponds human intuition clear sense optimal 
third approach followed treat finding correct parameterisation training shape boundaries explicit optimisation problem 
optimisation approach described authors discussed detail section 
basic idea find parameterisations training shapes yield sense best model 
taylor describe approach best model defined terms compactness measured determinant variance matrix 
parameterisation set training shapes explicitly represented genetic algorithm search optimise model respect parameterisations 
showed promise laid important theoretical groundwork sev eral problems objective function reasonably intuitive rigorously justified method manipulate parameterisation shapes crude extend optimisation failed converge acceptable solution 
new objective function rigorous theoretical basis describe new representation correspondence parameterisation extends results improved convergence 
objective function defined information theoretic framework 
key insight best model describes entire training set efficiently possible adopt minimum description length criterion 
section briefly introduce statistical shape models outline model building problem 
section reviews previous attempts automate model building process 
section provides summary derivation minimum description length objective function 
section show shape parameterisations explicitly represented manipulated build best model 
section presents experimental results running method training sets object outlines 
statistical shape models statistical shape model built aligned parameterised train ing set example outlines 
shape ns loss generality represented set points sampled boundary equal intervals defined parameterisation oi boundary path 
allows shape represented rip dimensional shape vector xi formed concatenating coordinates sample points 
principal component analysis shape vector expressed linear model form xi 
probe mean shape vector matrix eigenvectors covariance matrix corresponding eigenvalues describe set orthogonal modes shape variation tm vector shape parameters control modes variation 
training shapes continuous interested limit np 
leads infinitely large covariance matrix note ns eigenvalues identically zero may computationally zero 
means summation index takes values range ns 
calculate non zero eigenvalues consider np ns data matrix constructed set vectors xi ns 
np np variance matrix ww eigenvectors eigenvalues hm dp 
define eigenvectors eigenvalues ns ns matrix wrw ps mp 
pre multiplying wp wp 
wp eigenvector non zero eigen value 
wp eigenvector eigenvalue 
deduce eigenvectors non zero eigenvalues mapped eigenvectors eigenvalue 
similarly show converse true conclude non zero eigenvalues placed correspondence 
assign indices ns eigenvalues identically zero obtained directly eigenvectors weighted sum training shapes 
shown ij th element inner product shapes nij dt oi di oj dj wi mean shape si global scaling ri planar rotation di translation si oi continuous representation parameterised oi 
integral evaluated numerically 
new examples class shapes generated choosing values tm range training set 
utility linear model shape shown depends appropriateness set boundary parameterisations chosen 
inappropriate choice result need large set modes corresponding shape parameters approximate training shapes accuracy may lead legal values tm generating illegal shape instances 
example consider models generated set hand outlines see 
model uses set parameterisations outlines cause natural landmarks tips fingers correspond 
model uses correspondence uses simple arc length parameterisation position sample points 
pose parameters ri di shapes models determined procrustes alignment 
variance significant modes models respectively 
suggests model compact model example shapes generated model values tm range training set legal examples hands whilst model generates examples seen 
set parameterisations model obtained marking natural landmarks manually training example sim ple arc length parameterisation sample fixed number equally spaced points 
manual mark time consuming tive process 
previous various methods described construct statistical shape models sets example training outlines 
simplest approach select starting point equally space land marks boundary shape shown previ ous section result poor models 
similar scheme advocated baumberg hogg equally space spline control points shape contours :10.1.1.16.1712
kelemen spherical harmonic descriptors parame training shapes equivalent equally spaced points coefficients harmonics computed linear combinations positions equally spaced surface points 
cootes manually identify small number anatomical landmarks boundary length interpolation sample shapes 
varia tion procrustes alignment performed align points 
approach intuitive error prone subjective time consuming 
furthermore specialist knowledge required place landmarks correct place 
rueckert method non rigid registration maximise normalised mutual information set biomedical images 
non rigid registration performed manipulating grid spline control points 
principal component analysis performed resulting deformation field build statistical shape model 
tends variance model correspondences essentially arbitrary 
goldgof wang shape features select landmark points 
clear corresponding points lie regions similar curvature 
methods consider pairwise correspondences may find best global solution 
direct approach automatic model building treat task optimisation problem 
hill taylor attempt total variance shape model measured sum eigenvalues covariance matrix 
choose iterative local optimisation scheme re building model stage 
approach prone coming trapped local minima consequently depends initial estimate correct parameterisation 
rangarajan describe method shape correspondence total model variance simultaneously determining set correspondences similarity transformation required register pairs contours 
bookstein describes algorithm landmarking sets continuous con tours represented polygons 
points allowed move contours bending energy term 
obvious optimising energy term lead statistical shape models 
taylor describe objective function deter model covariance 
favours compact models small number significant modes variation rigorous theoretical jus formulation offered 
explicit representation set shape parameterisations optimise model directly respect genetic algorithm search 
representation problematic guarantee diffeomorphic map ping 
correct problem arises reordering correspondences workable shapes obvious extension 
results produced method better hand generated models algorithm converge 
previously described derivation information theoretic ob function combined genetic algorithm select corre 
method optimising correspondence took hours run converged sub optimal correspondences scale large training sets 
remainder provide brief overview objective function show coupled novel representation parameterisation efficient optimisation method automatically produce statistical shape models 
information theoretic objective function choice objective function measure quality model idea best description training set simplest compact generalise unseen examples 
formalised minimum description length mdl principle 
mdl idea transmitting training data set coded message coding pre arranged set parametric statistical models 
full transmission data set include encoded data values information required spec ify exact statistical model chosen encode data parameter values 
mdl attempts balance model complexity expressed terms transmission cost specifying parameters quality fit model data expressed terms coding length data 
comparison description lengths calculated models different classes way solving model selection problem 
emphasis selecting class model description length single class model linear model described previous section objective function optimising correspondence shapes 
simple part coding formulation mdl 
give coding absolute minimum length gives func tional form computationally simple implement suitable objective function numerical optimisation 
calculation codeword lengths fundamental result shan non 
set discrete possible events statistical model assigns normalised probability event ideal coding codeword length transmitting fact occurrence event log pi 
form mean codeword length prob ability event occurring identical model probability pi 
choose model set shape vectors multivariate gaussian model 
initial step constructing model change coor system axes aligned principal axes data set 
corresponds orientation linear model defined earlier 
data set rotated origin new coordinate axes lie directions set eigenvectors pm multivariate gaussian model corresponds gaussian model new coordinate axes 
description length model decomposed ra ras codeword length transmitting parameters dimensional gaussian direction ta codeword length transmitting set data coordinates direction 
order apply shannon result reduce continuous prob ability density function gaussian model set discrete probabilities 
done allowed values coordinate quan ha number bins limited setting bound range coordinates 
estimated original data 
original shape vectors lie hypercube side length ns lowest upper bound rv pp data quantisation parameter determined coordinates original sample points 
comparison original shape quantised shape allows maximum permissible value determined 
example boundaries obtained images typically order pixel size 
gaussian model direction possesses parameters quan mean quantised variance transmitting set corresponds transmitting quantised mean shape code word length shown depend removed objective function 
data direction bounded quantised see strict upper bound possible values ax 
choose lower bound modelled variance grain 
optimal quantisation parameter ns ne analytically see details 
terms original quantised data values objective function written function quantities erin ns sum contributions direction ym defined ma mi ym log log ml ns log log rcr am bin ns lies ma mi log log mil ns log min log rcr consider form objective function 
linear model defined earlier 
ts ts limit quantised values approach continuum values ns sufficiently large find ns ns loga 
ns ns loga ns function depends ns 
see dual limit part objective function depends am contains terms similar determinant covariance matrix log objective function taylor 
objective function described defined limit hm fact direction contribution objective function 
form previously addition artificial correction terms fact infinitely large contribution 
selecting correspondences order build statistical shape model need sample number points shape 
demonstrated section choice correspondences determines quality model 
choose cast correspondence problem defining pose parameters si ri di parameterisation function shape 
pa function explicitly defines points sampled shape see 
aim value manipulating training shapes represented parametrically curves sx sv order constrain point ordering correspondences parameterisation el shape monotonically increasing function range si si si si :10.1.1.16.1712
function represented cumulative distribution function normalised positive definite density function dx set suitable kernel functions construct functions simple sum 
kernels chosen property reduce dirac delta function suitable limit set kernel functions form basis functions 
kernel decomposition integrated get parameterisation function 
see simple example 
sections explain may represented open closed curves 
section demonstrates si ri di manipulated description length training set 
open curves open curves diffeomorphism line 
consequently represented sum nk gaussian kernels nk exp normalisation term 
coefficients ak control height kernels ak specify widths positions centres 
constant term set unchanged zero 
note limit infinitesimal width normalised gaussian kernel approaches dirac delta function 
gaussian kernel representation function basis possible functions limit infinitesimal kernel widths infinitely large number kernels 
representation nk erf iv erf erf error function erf xt dr ation clo ed curve closed curves diffeomorphism unit circle 
formulation section treating closed curves open curves joined general differentiable smooth point 
address deriving alternative representation wrapped cauchy function 
wrapped cauchy kernel circle form re cos 
width kernel 
limit infinitesimal width kernel approaches form dirac delta function defined cir cle plus constant 
representation forms basis limit manner gaussians described 
kernel closed form indefinite integral gives cumulative distribution cauchy centered sin arctan inverse tangent defined range 
see cumulative distribution cauchy function centred ak sign ak 
ak sign 
collection nk cauchy functions centres ak widths cok heights ak cumulative distribution rt cok ak inclusion constant term expression nk 
setting constant term parameterisation remains unchanged kernels zero magnitude 
note closed curves position origin free parameter 
optimizing wish find set oi si ri di build best model measured description length 
previously described brute force approach parameters optimised simultaneously approach slow scale satisfactory large training sets 
describe iterative approach fast robust scales approximately linearly size training set 
initial approximation values oi si ri di set shapes shape select position origin procrustes transformation align shape calculate squared distance re aligned shape shape select position origin squared distance shape ensure defined select shape values oi si ri di change optimisation 
select ref parameterisation initially define long consistently 
results reported arc length parameterisation 
erence shape smallest point point distance mean 
wish optimise respect si ri di 
shown pre satisfactory results obtained general purpose optimisation method full set parameters describe scheme faster robust 
perform optimisation re cycling training shapes optimising parameters shape current values 
order training set randomised pass remove bias 
decoupling optimisation pose si ri di parameterisation substantially speeds convergence 
shape manipulate parameterisation randomly selecting value ak closed curves uniform distribution range 
width kernel ak chosen positive half gaussian distribution zero mean standard deviation ag 
convergence algorithm relatively insensitive choice ag 
experiments reported value free parameter left ak magnitude cauchy chosen minimise value mdl objective function ak determined pose parameters si ri di chosen minimise general purpose optimisation algorithm purpose 
nelder mead simplex algorithm obtain results reported objective function 
algorithm single pass follows shape ordering shape shape randomly assign values ak ak optimise value optimise values si ri di steps repeated convergence 
reduce computation time optimise model reduced form objective function refining full form 
results qualitative quantitative results applying method synthetic example sets outlines biomedical objects 
synthetic data tested method described synthetic data examples shown 
shapes exhibit single mode shape variation semi circular bump moves top box 
correct correspondences chosen described linear model parameter 
naive attempt build model data setting origin top left hand corner box arc length parameterisation sample corresponding points 
behaviour resulting model shown shape parameters tm 
varied 
shows model generate invalid instances object 
optimised initial model algorithm described 
resulting model illustrated shows intrinsic shape variation captured correctly 
results biomedical objects tested method set hand outlines left ventricles heart hip prostheses cross sections cartilage 
training examples segmented hand represented polygons 
number sample points np chosen number nodes define polygon typically 
integral calculated trapezoidal numerical integration linear interpolation evaluate function nodes 
compared optimised models hand built arc length parame models 
hand built models produced identifying set natural landmarks shape procrustes analysis align common ordinate frame 
arc length model correspond ing point chosen manually origin shapes aligned procrustes analysis 
show qualitative results displaying variation captured modes model varying values tm 
standard deviations observed training set 
give quantitative results tables value total variance variance described mode leave mean squared approximation error mse 
quantitative results show automatically generated models significantly compact variance mode models built manual landmarking arc length parameterisation 
illustrated shows cumulative variance hand outline model 
order test generalisation ability models performed leave tests determine accuracy model able approx unseen examples class 
results tables show optimised model performs significantly better manual arc length parameterised models number retained modes indicating better generalisation ability 
illustrate plotting point point mean squared approximation error number modes 
interesting note model produced arc length hip prostheses lower value objective function hand built model 
salient anatomical land marks errors manual annotation add extra noise captured statistical variation 
discussion results reported show automatically produced mod els significantly compact exhibit better generalisation ability models built hand current gold standard 
optimisation method describe converges robustly suitable practical application 
method scales approximately linearly cope large training sets 
noted earlier optimisation scheme described sig faster robust brute force approach parameters optimised simultaneously 
main reasons sequential scheme adopted allows origin parame shape selected afresh pass 
origins fixed remain correspondence difficult parameterisation local origin change significantly 
positions origin included parameter optimisation global effect disrupt locally optimised correspondences 
scheme avoids fixing particular points correspondence whilst retaining localised behaviour optimisation process 
advantage sequential optimisation approach suited situation desirable build models incrementally example system needs learn class shapes line 
shown extend method intrinsic approach restricts shapes 
initial results shapes extension method described 
problems moving practice sufficiently complex details merit separate publication 
strategy optimising mdl objective function possessing sound theoretical basis provides unified framework dealing aspects model building 
example procedures alignment shapes application linear principal component analysis ti deter mine axis linear model explicit included expanded mdl objective function 
conventional alignment pca strategies recovered extended mdl objective function truly optimal 
authors alan brett contribution 
davies financial support 
carole funded epsrc daniel allen funded 
baumberg hogg learning flexible models image sequences european conference computer vision stockholm sweden :10.1.1.16.1712


ayache cohen 
adaptive meshes nonrigid motion computation 
international conference pattern recognition 

jerusalem israel 
bookstein landmark methods forms landmarks group differences outline shape 
medical image analysis 

cootes hill taylor active shape models locating structures medical images 
image vision computing 

pharmaceuticals park cheshire uk cootes taylor cooper graham active shape models training application 
computer vision image understanding 

rh 
davies cootes taylor information theoretic approach statistical shape modelling british machine vision conference bmvc volume rh 
davies cootes taylor description length approach statistical shape modelling appear ieee transactions medical imaging rh 
davies cootes taylor statistical shape models direct optimisation description length appear th european conference computer vision eccv goodall procrustes methods statistical analysis shape 
journal royal statistical society 

hansen yu model selection principle minimum description length technical memorandum bell labs murray hill 
hill taylor 
automatic landmark generation point distribution models 
british machine vision conference 


hill taylor framework automatic landmark identification new method non rigid correspondence 
ieee transactions pattern analysis machine intelligence 
goldgof point correspondence recovery non rigid motion ieee conference computer vision pattern recognition 


kelemen szekely gerig elastic model segmentation data sets 
ieee transactions medical imaging 

taylor automatic construction models direct optimisation 
medical image analysis 

mardia statistics directional data academic press 
press teukolsky vetterling flannery numerical recipes cambridge university press rangarajan chui bookstein 
softassign procrustes matching algorithm ipmi 


rissanen fisher information stochastic complexity ieee transactions information theory vol 
pp 

rissanen universal prior integers estimation minimum description length annals statistics vol 
pp 

rissanen stochastic complexity statistical inquiry world scientific series computer science vol 
world scientific publishing singapore 
rueckert schnabel automatic construction statistical deformation models non rigid registration miccai 

shannon mathematical theory communication bell system technical journal vol 
pp 

shape non rigid correspondence application heart motion analysis 
ieee transactions medical imaging 
wang peterson staib 
shape surface correspondence geodesics local geometry 
cvpr 

table quantitative comparison hand outline models 
hand outlines mode automatic hand built arc length generalisation ability mse variance mode total variance table quantitative comparison heart ventricle models 
heart ventricles mode automatic hand built arc length generalisation ability mse variance mode total variance table quantitative comparison hip prostheses models 
hip prostheses mode automatic hand built arc length generalisation ability mse variance mode total variance table quantitative comparison knee cartilage models 
knee cartilage mode automatic hand built arc length generalisation ability mse variance mode total variance model model fig 

modes variation rr shape models built training set hand outlines parameterised differently 
model parameterised manual model parameterised arc length parameterisation 
demonstrates model represent invalid shape instances 
ol fig 

demonstration circle sampled parameterisation 
sample points shape uniformly sample bottom axis param function values vertical axis 
correspondence vertical axis shape boundary points sampled shape parameterisation function 
set kernel functions sum kernels integral fig 

illustration representation parameterisation 
fig 

synthetic training set hm fig 

modes variation naive model built synthetic data 
fig 

mode variation optimised model built synthetic data 
significant variation remaining modes 
mode ral ii ii fig 

modes variation xm automatically generated models number modes automatic arc length manual fig 

compactness hand outline model 
graph shows cumulative variance plotted number modes 
automatic arc length manual number modes fig 

ability hand outline model 
graph shows mean squared approximation error plotted number modes 

