secure aggregation wireless networks hu department computer science university virginia charlottesville va evans cs virginia edu david evans emerging class important applications uses ad hoc wireless networks low power sensor devices monitor send information possibly hostile environment powerful base station connected wired network 
conserve power intermediate network nodes aggregate results individual sensors 
opens risk single compromised sensor device render network useless worse mislead operator trusting false reading 
protocol provides secure aggregation mechanism wireless networks resilient intruder devices single device key compromises 
protocol designed computation memory power consumption limits inexpensive sensor devices takes advantage properties wireless networking power asymmetry devices base station 

wireless sensor networks emerging technologies wide range potential applications battlefield surveillance emergency response 
research sensor networks generally assumes trusted environment sensor network applications network deployed situations adversary may motivated disrupt function network 
adversary may able position intruder nodes network transmit false messages 
adversary may compromise node network gain access key material 
focus adversary wants corrupt information produced sensor network 
regard confidentiality messages unnecessary focus integrity results transmitted base station 
acknowledge wireless networks vulnerable wide array denial service attacks consider serious threat adversary compromise network provide false readings detection operator 
adversary network designed monitor area physical intrusions fail report intrusion operator realizing wrong 
primary security challenges wireless sensor networks lie addressing conflict limited resources energy computational overhead memory security requirements 
traditional security techniques public key cryptography require expensive computations long messages quickly battery typical sensor devices 
focus lightweight security mechanisms design protocols processing possible base station 
section provide background related 
section describe assumptions cryptographic primitives overview protocol secure aggregation 
details protocol discussed section 
section analyzes possible attacks 
section evaluates costs protocol 
propose scalable variation protocol section 
background researchers dealt various security issues low energy ad hoc wireless networks 
hubaux provide summary report 
wireless networks pose interesting key management challenges lack fixed infrastructure supporting traditional certificate authority 
zhou haas propose threshold cryptography allow group ad hoc devices manage keys 
kong propose asymmetric mechanisms localized threshold signatures certificates 
assume fixed base station establish secrets ad hoc wireless nodes deployment address issues 
asymmetric algorithms require computation power feasible sensor network applications 
basagni argue clusters nodes share symmetric key design exposed single node compromise attack 
balfanz solution complete authenticated key exchange protocol wireless link public key infrastructure requires privileged side channel pre authentication :10.1.1.16.1408
routing protocols proposed ad hoc networks including dsr aodv 
secure routing wireless networks received increased attention 
marti complement dsr watchdog detection denied packet forwarding pathrater routing policy rating enable nodes avoid malicious nodes routes require extensive listening 
papadimitratos haas showed impersonation replay attacks prevented demand routing disabling route caching providing authentication hmac primitive 
focus providing hop authentication route discovery stage aodv dsr relying digital signatures 
hu absorb idea spins produce hardened version dsr suitable sensor networks 
spins suite security protocols optimized resource constrained environments achieves asymmetry clock synchronization delayed key disclosure 
directly inspired spins protocol described section 
yuval presents algorithm authenticating messages short macs 
symmetric encryption algorithms designed low power environment proposed including tea rc 
protocol requires efficient secure mac algorithms dependant particular encryption algorithm 
reduce power consumed forwarding messages researchers identified importance data aggregation :10.1.1.116.345
aggregation collects results sensors calculates smaller message summarizes important information group sensors 
example suppose operator interested average sensor reading value network 
inefficient way find sensor node send reading base station possibly multiple forwarding hops base station calculate average readings received 
efficient way collect information intermediate nodes forward calculated average value readings receive count number readings incorporates 
node calculates average descendents need send value number descendants parent 
research efforts explored different aggregation protocols sensor networks assuming trusted environment including directed diffusion leach greedy aggregation cougar 
tag network aggregation service tinyos motes supports sql language expressing aggregation queries streaming sensor data 
assume simple hierarchical tree aggregation protocol readily adapted hierarchical aggregation protocol 

secure aggregation message aggregation reduce communication overhead significantly message aggregation security difficult 
intermediate node modify forge discard messages simply transmit false aggregation values compromised node able significantly alter final aggregation value 
aggregation interferes message encryption 
encrypt messages unique key shared device base station intermediate node needs understand received messages perform aggregation 
risk storing key device enable encryption authentication adversary recovers key single device able control entire network 
design aiming providing lightweight security mechanisms effectively detect node misbehavior dropping modifying forging messages transmitting false aggregate value 
enable base station trust results sensor network adversary may able deploy intruder nodes inside network recover key material single node 
design exploits main ideas delayed aggregation delayed authentication 
aggregating messages immediate hop messages forwarded unchanged hop aggregated second hop 
increases transmission costs enable integrity guarantees networks consecutive nodes compromised 
attempting authenticate messages right away save resources authenticating messages time delay 
enables authentication keys symmetric keys revealed authenticator time delay expired 
design protocol assumptions 
base station powerful broadcast messages nodes directly 
sensor devices low power communicate nearby nodes 

low level network mechanisms place provide reliable message delivery 

network spread hops typical node base station 
network dense usually nodes hop distance particular node 

deployment node establish shared secrets base station 
encryption primitives protocol depend base station broadcasting series authenticated messages sensor nodes 
due limited power memory sensor node impractical asymmetric algorithm message authentication 
adopt protocol authentication messages transmitted base station 
protocol provides authenticated broadcast environments achieves asymmetry clock synchronization delayed key disclosure 
base station generates way key chain public way function ki ki 
device stores ko deployment ko applications secret 
imagine doing location limited channel keys established secure environment near base station deployed :10.1.1.16.1408
base station transmissions encrypted key 
messages transmitted received base station reveals key sensor nodes compute ko verify matches ko 
sensor nodes decrypt messages previously transmitted encrypted ko 
successive keys revealed similar manner kn reached 
necessary new hash sequence started point having base station send new kn original hash chain 
protocol depend sensor nodes able produce messages authenticated base station concerned confidentiality messages 
assume node initialized deployment symmetric secret key shared base station 
temporary encryption key computed encrypting counter value key 
example kao kas 
base station knows ks synchronize counter values sensor devices 
stage temporary encryption key revealed enable sensor devices authenticate messages transmitted nearby sensors 
protocol overview depicts part example sensor network comprising power limited sensor nodes powerful base station 
base station collects information sensor nodes transmits operator wired network 
sensor nodes identical acting leaves remaining nodes acting intermediate nodes 
typical network hundreds thousands nodes branch ing factor greater 
assume secure self organizing protocol form routing hierarchy node immediate parent 
leaf node transmits reading parent 
raw messages include node data reading node id uniquely identifies node 
message authentication code mac kay ra included message 
uses key known node base station known sensor nodes 
parent node store message mac key ka revealed base station 
verify mac raise alarm match 
message aggregation performed intermediate step 
nodes wait specified time receive messages children retransmit messages macs receive directly immediate children 
child contribute reading time step 
nodes aggregate data receive grandchildren children transmit mac aggregation value 
delayed aggregation ensures adversary obtains key material compromised node tamper sensor readings 
stage messages arrives base station base station reveals temporary node keys mac generated base station current key 
key revealed nodes advance temporary node key 
key reveal ed enable authentication base station advances key chain 

protocol details protocol involves separate stages sending data base station authenticating information retroactively 
describe protocol small sample network 
keep mind benefits protocol come large number nodes arranged deep tree readings aggregated single message 
simplicity presentation assume leaf nodes collecting sensor readings intermediate nodes just aggregating forwarding data 
extending protocol support sensor readings intermediate nodes straightforward 
notation describe protocol 
sensor nodes base station node sends message messages wireless local id mac aggr broadcast nearby nodes hear message 
unique id node concatenation messages 
encryption key authentication code key result aggregation function aggregation function deterministic distributive depend order readings incorporated 
unique key shared node base station data reading value node rai th key node ki th key base station hash chain 
data transmission 
assume nodes sending messages base station tree shown 
leaf nodes send messages parent 
messages include macs calculated respective temporary node keys 
example ra ida mac kai ra message need include nonce prevent replay attacks temporary mac key 

intermediate nodes receive messages children 
parent node verify mac uses child temporary key revealed parent verification phase 
parent just stores message mac 
intermediate node waits time elapsed sends message parent retransmits sensor readings macs computed mac calculated aggregate value ra ida mac kai ra rb idb mac rg mac kei aggr ra rg need transmit computed aggregate value ra rg transmitted independently computes aggr ra rg 
necessary transmit ide knows network topology determine sending node grandchild ids 
node receives messages calculates aggregate values grandchildren readings child 
aggregate value ra rb aggregate value rc re transmits aggregate values grand children children id mac values 
computes transmits mac aggregate value aggr ra rg rc re aggr aggr ra rg aggr rc re 
aggregation function deterministic known nodes mac calculated authenticate value computed sensor readings mac values received stored base station idf aggr rc ro mac kfi aggr rc ro mac kal aggr ra rc dd irr rr idc nc 
ox mac kei aggr ra mac kfi aggr rc ro ight side ida ira mac kai ra ro mac 
example sensor network 
authentication 
ide aggr ra rb mac kei aggr ra rt idr aggr rc rt mac kri aggr rc mac aggr rt rc similarly node receives messages branch transmits aggregate message base station 
note message length increase network deeper 
base station receives message calculate final aggregate value aggr rg rc rd 
aggr rg rc rd aggregate values reported children 
data validation 
protocol designed ensure single compromised node mislead network reading 
able false claims node readings produce aggregate values improperly represent state network 
base station shared temporary key sensor node verify message receives final step transmitted calculating mac aggregation calculated ki comparing mac transmitted message 
validates sent final message validate correctly reflected reading sensor nodes 
base station receives macs readings grandchildren authenticate values 
goal authenticate readings contributed aggregation value requiring reading sent base station 
validate data base station reveals temporary node keys network 
wide area broadcast base station sends temporary node key mac current key ki 
nodes advance temporary node key succeeding messages 
requiring base station reveal node key aggregate reading receives scale large sensor networks situations frequent readings desired 
section consider protocol variation addresses issue 
note node keys sent base station sensor node needs 
example node needs verify mac kay 
key broadcasts synchronized necessary listen key broadcasts find relevant ones 
sending node keys base station sends current key enable nodes check transmitted mac values advances key chain messages 
receiving nodes verify mac node keys 
nodes verify ki legitimate calculating comparing 
node detects forged message data validation stage sends alarm message 
alarms raised parent detects inconsistent mac child grandchild sent base station mac computed node temporary key 

attack analysis protocol defends attacks involving intruder nodes obtain key material limits effectiveness attacks key material stored particular node compromised 
intruder node attacks 
preventing intruder nodes access keys injecting bogus data aggregation straightforward 
delayed aggregation necessary accomplish sufficient require transmitted data include mac generated key revealed 
intruder node may attempt transmit readings id legitimate child node intruder easily obtain transmitted unencrypted unable compute valid mac bogus data 
parent node receives forwards reading grandparent node receives computes aggregate reading detect bogus transmission temporary sensor node keys revealed 
nodes generate alarm messages received base station 
note replay attacks ineffective sensor node keys change reading 
replayed message appear invalid mac previous mac calculated different key 
intruder node succeed preventing base station acquiring correct readings time stage 
applications alerting base station presence intruder sufficient goal sensor network detect presence intruders done job 
applications network continue provide valid readings 
simplest solution parent detected intruder node recognize intruder node transmission distance forwarding messages receives 
application continue function just incorporating readings vulnerable area 
compromised node attacks 
adversary obtains key material node dangerous 
sensor node devices inexpensive competent adversary physical access device able obtain key material stored device 
protocol means secure information base station keys need stored sensor devices adversary obtains key material node ability forge base station messages 
adversary ability forge node messages 
compromised node leaf node adversary transmit false readings detection 
cryptographic way prevent assuming adversary obtained key material compromised node 
ways limit effectiveness attack 
aggregation functions example calculating average temperature reading thousands nodes readings checked reasonable range single bogus value may significantly perturb final result 
cases parent nodes receiving values sensor nodes may ignore single outlying value 
cases compromised node sensors fail produce bogus values important applications handle case 
serious concern case node higher routing tree compromised 
straightforward protocol child parent message authentication delayed aggregation node generate bogus message represents readings nodes 
assuming base station determine network topology compromised node effectively descendant readings 
adversary compromises node near top routing hierarchy effectively readings large portion sensor network 
delayed aggregation limits damage adversary compromises single node 
immediate parent node expects receive macs retransmitted messages compromised node children raise alarm transmitted aggregation values inconsistent macs 
case unclear parent node detecting attack child grandchild compromised 
goal detect intrusion sufficient 
worst nodes need excluded sensor network 
attack strategy selectively drop readings prevent readings reveal intrusion reaching base station 
compromised node near base station drop aggregation results selected children 
node hops base station apparent base station readings received child 
raise concern indistinguishable normal node failure case routing tree eventually reorganize different node 
node away base station deep selective dropping accomplish attacker goals apparent base station readings missing 
possible defense involves nodes snooping parents 
child node transmits message parent readings included parent transmission child node raise alarm 
parent compromised node alarm routed network way depend parent forwarding 
protocol thwart attacker simultaneously compromises parent child node 
example attacker compromised nodes sample network able transmit bogus aggregation value ra rb legitimate reading subtree 
general attacker simultaneously compromises child parent readings node child subtree 
view success attack attacker need compromise parent node key material routing hierarchy 
parent disabled long children reorganize avoid disabled node 
situations attack serious concern thwarted adding delay stage aggregation 
retransmitting values macs children aggregating values grandchildren nodes retransmit values macs children grandchildren aggregate values great grandchildren 
substantially increase communication costs required 
realistic defense depend nodes snooping transmissions nearby nodes 

cost analysis analyze costs protocol 
focus communication costs energy required transmit listen messages tends overwhelm computational memory requirements 
protocol designed provide balance security communication costs 
provide security possible full network aggregation require substantially communication necessary networks aggregation 
consider ideal routing tree leaves hops away base station node children 
step leaf nodes sends reading parent 
represent length data reading length node id mac 
step parent retransmits readings mac values mac aggregate value 
aggregation function output length original sensor reading 
aggregation functions average example may constant factor longer aggregation useful scale number readings 
parent children need transmit bits 
second level nodes total number bits transmitted second step bd ba 
level successive level node transmits mac values child new aggregate value mac bits 
transmission size increase successive levels tree assume aggregation function length original sensor reading 
total number bits communicated protocol ba ba ba 
comparison aggregation node transmits messages descendants 
requires transmission db total bits 
insecure aggregation method messages aggregated message intermediate node node need transmit bits bd total bits transmitted 
give sense numbers mean typical applications select bytes bytes assumptions messages mac included bytes required message integrity crc 
network leaf nodes 
total communication time segment leaf node transmits reading kb aggregation kb protocol reduction kb full insecure aggregation 
depth tree increases relative advantages protocol aggregation increase 
protocol requires times amount communication insecure aggregation protocol communication necessary aggregation 
total communication secure aggregation protocol significantly method roughly little times communication required insecure aggregation 
base station needs periodically broadcast temporary keys sensor nodes 
requires substantial communication base station connected power grid pose serious problem 
time sensor nodes spend listening serious concern 
synchronized communication time windows costs acceptable 
computational memory costs insignificant compared communication 
intermediate node needs compute aggregate values grandchildren readings requiring aggregation function applications 
intermediate node needs authenticate children grandchildren nodes keys disclosed base station mac computations needed 
memory requirements important constraint 
nodes need store messages received children keys disclosed base station 
data values associated mac values grandchildren children 
ideal routing tree leaf node need store level node needs store bits higher level intermediate node needs store cb bits 
values bytes bytes level node needs store bytes higher level nodes store bytes 

scalable variation original protocol requires base station transmit temporary sensor node keys stage 
reasonable small sensor networks sensor networks thousands nodes 
data received base station validated sensor node keys transmitted base stations waited long nodes verify macs transmit alarm messages base station 
section describe variant protocol addresses issues increases amount communication required sensor nodes 
relying base station broadcast temporary node keys key chains reveal authenticate keys locally 
deployment node establish shared secret key base station kas original protocol 
case determine successive temporary node keys calculating kai kas 
deployment node needs establish key chain parent securely revealing kao 
know nodes loca ted deployment example may involve dropping nodes airplane store keys sensor nodes requires transmission base station authenticated key 
key chains established transmit messages keys 
node sends message parent node containing reading revealing key ida ira ka mac ka ra node authenticate ka immediately checking kao matches kao 
message reveal ka validate mac 
intruder node attempts forge message detected immediately intruder know kay transmitted value fail kao kao check 
sophisticated intruder node may attempt transmit message overheard ka value different ra value 
knowing ka adversary unable produce correct mac value forged message detected stage 
depends synchronization nodes know keys revealed 
base station broadcast stage update messages feasible 

heretofore designers sensor network applications faced choice ting sensor messages aggregating readings network save power 
protocol offers new tradeoff resistance single node compromises network data aggregation 
sensor network applications operate hostile environments providing way increase confidence integrity sensor readings giving opportunity aggregate intermediate results network valuable design option 
funded part national science foundation ccr eia nasa langley research center 
dirk balfanz paul stewart chi wong :10.1.1.16.1408
talking strangers authentication ad hoc wireless networks 
proceedings isoc network distributed systems security symposium february 
basagni 
secure 
proceedings acm international symposium mobile ad hoc networking computing 
jean pierre hubaux 
report working session security wireless ad hoc networks 
mobile computing communications review volume number 
november 
levine shields royer 
secure routing protocol ad hoc networks 
technical report department computer science university massachusetts august 
deborah estrin ramesh govindan john heidemann satish kumar 
century challenges scalable coordination sensor networks 
mobile computing networking 


taxonomy routing protocols mobile ad hoc networks 
technical report swedish institute computer science october 
rabiner heinzelman chandrakasan hari balakrishnan 
energy efficient communication protocol wireless microsensor networks 
proceedings hawaii international conference system sciences maui hawaii january 
yih chun hu adrian perrig david johnson 
ariadne secure demand routing protocol ad hoc networks 
mobicom 
chalermek intanagonwiwat ramesh govindan deborah estrin 
directed diffusion scalable robust communication paradigm sensor networks 
mobile computing networking august 
intanagonwiwat estrin govindan heidemann 
impact network density data aggregation wireless sensor networks 
proceedings international conference distributed computing systems november 
johnson maltz 
dynamic source routing ad hoc wireless networks 
mobile computing 
kong petros luo lu lixia zhang 
providing robust ubiquitous security support mobile ad hoc networks 
ieee th international conference network protocols 
large scale networking coordinating group working group information technology research development report workshop new visions large scale networks research applications 
march 
www 
gov pca isn isn workshop mar samuel madden michael franklin joseph hellerstein wei hong 
tag tiny aggregation service ad hoc sensor networks 
osdi december 
marti giuli lai baker 
mitigating routing misbehavior mobile ad hoc networks 
proceedings sixth annual acm ieee international conference mobile computing networking august 
national institute standards technology nist 
keyed hash message authentication code hmac 
fips 
panagiotis papadimitratos zygmunt haas 
secure routing mobile ad hoc networks 
scs communication networks distributed systems modeling simulation conference cnds january 
charles perkins elizabeth royer 
ad hoc demand distance vector routing 
milcom november 
adrian perrig robert szewczyk victor wen david culler doug tygar 
spins security protocols sensor networks 
wireless networks journal wine september 
rivest 
rc encryption algorithm 
proceedings leuven workshop fast software encryption springer verlag 
wheeler needham 
tea tiny encryption algorithm 
lecture notes computer science 
yong yao gehrke 
cougar approach query processing sensor networks 
sigmod record volume number september 
yuval 
reinventing encryption mac rom bytes 
fast software encryption workshop springerverlag 
zhou zygmunt 
securing ad hoc networks 
network magazine 
