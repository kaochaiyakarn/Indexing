anonymity ring ahmed advisor mohamed gouda gouda cs utexas edu department computer sciences university texas austin www cs utexas edu computer science research writing cs fall vast amount practical applications internet exists class applications require anonymous communications 
sec 
sec 
briefly discuss closely related existing methods anonymous communications mixer networks onion routing advantages limitations 
explain method anonymous communication termed anonymity ring ar proceed develop formal specifications protocol notation 
provide advantages limitations anonymity ring protocols areas research proceed 


issue outline 
mixer networks 
core theory details protocol configurations advantages limitations 
onion routing 
core theory details protocol configurations advantages limitations 
architecture anonymity ring 
organization anonymity ring initialization message composition anonymity ring 
message processing anonymity ring 
types message details message processing 
process specification 
main process functions 
message buffering 
description interface procedure configurations simple fifo configuration 
specification 
advantages limitations ii 
random pick configuration 
specification 
advantages limitations iii 
priority queue configuration 
advantages limitations iv 
intensifying probability configuration 
specification 
advantages limitations 
walkthrough 
message ar implementation suggestions 
concluding remarks 
advantages limitations anonymity ring areas research 
appendix 
anonymity ring issue rapid unprecedented growth internet utilized diverse tasks mere electronic communication individuals commerce 
wide application domains comes need secure communications furthermore certain communications require just content fact communication exists hidden 
situations termed anonymous communication anonymous connections respectively 
seek develop formal specifications ap notation protocol provides anonymity aforementioned situations 
protocol termed anonymity ring presents communication system presents solution abovementioned problems trusting single third party 
anonymity ring incorporates various ideas mixer networks onion routing discussed section respectively 
outline start brief mixer networks section followed onion routing section 
discussion structure organization functionality anonymity ring follows section 
complete process specification anonymity ring protocol section 
section presents various configurations message buffering system discusses advantages disadvantages associated 
brief analysis implementation details sections 
various figures appendix visually demonstrate concepts 

mixer networks core theory concept mixes mixer networks telecommunication networks david chaum 
research mixes various variations suggested mixes 
mix allows communication entities concealing transmitted message content identity communication partners having trust third party 
nutshell mix accomplishes task public key encryption technology message permutation 
public key encryption works having functions transform data say called cryptographic functions 
functions certain characteristics 
produce value parameters number called key data needs encrypted decrypted 
secure communications communications message content concealed receiver sender 

function key say inverse function key say 
decryption knowing correct key encryption impossible impractical 
process wishes participate combination keys conditions true 
key process said public key known 
key known private key known single process process issued 
mix participant process private public keys 
furthermore public keys published accessible chooses access 
recipient public key encrypt message recipient knows correct private key decrypt message 
public key encryption provides secure message content allowing sender encrypt message destination public key 
avoid source destination linking communication pipes intermediary routers source destination encrypted type symmetric key encryption 
provide resistance source destination linking long continuously high network traffic trust intermediary routers 
mixer networks intended allow communicate similar degree anonymity having trust intermediary routers 
typical mixer network setup multiple mixes cascaded 
cascading provides stronger resistance sustained repeated attacks network allowing route variation providing multiple nodes transform message order content 
public key encryption technique provides resistance eavesdropping message content message reordering provides resistance source destination linking 
provide visual depiction mix operations appendix 
details protocol section describe setup behavior mixer network 
discuss transformation message time leaves source time reaches destination 
furthermore single mix trusting third party 
avoid multiple mixes cascaded mix knows predecessor successor mix 
case mix knows sender mix knows receiver messages traced mixes mix preserve fifo ordering information source destination activity hardly useful source destination linking 
mixer network certain machines designated mixes identity public keys available machines identities public keys rest participants similarly publicly available 
utilize mixer network sender mixes intermediaries message route destination 
encode message destination process public key 
encrypted message address destination process encrypted public key mix series obtaining public private key combinations distributing public keys done certification authorities discussed 
see developer netscape com docs manuals security information 
mixes route destination 
data address mix encrypted public key nd mix 
discussed encryption details snapshot message route 
hide content messages traveling source destination source repeatedly encrypt message described 
final data sent form kn rn kb message encryption address destination rx random data avoid detection encrypted message actual message kx encryption public key number designating mix 
labels mixes chosen source process intermediary mixes destination 
algorithm pick mixes source process 
mix processes message reaches mix form kb 
eventually mix able access necessary data kb destination address forward appropriate destination 
technique prevent message content revealed message decrypted final destination encrypted destination machines public key 
furthermore mixer networks allow receiver respond sender identity sender receiver 
accomplish sender address wants able receive reply attaches kx kx 
notation encryption public key mix 
label mix closest mix 
kx public key serves random data encryption 
kx public key chosen occasion 
address destination replying virtual address kx message kx mentioned encryption algorithm 
final mix response path closet receives information decrypts part message kx realizes actual destination message composes message encrypting kx sends kx kx 
public keys kx kx provided necessary private keys access message 
analysis experimentation mixer network done tool called 
tool written java allows model mix network perform various actions network 
provides detailed results perform analysis 
configurations mixes operate different modes pool mode batch mode 
variations discussed 
pool mode mixes setup providing threshold designates wait time specifying number messages wait 
designated number messages arrived mix functioning pool mode selects messages delivers mix appropriate destination appropriate 
method guarantee bounded waiting time message delivery 
batch mode batch mode performs similar pool mode 
mode mix waits designated number messages arrive 
designated number messages arrived mix batch mode messages delivers appropriate destinations 
mode guarantees steady progress message route reaches destination 
advantages limitations numerous variations mixes advantages limitations mixes vary variations 
section discuss key advantages limitations mixes 
adversary attack particular mix sending messages possible adversary aware threshold mix 
determining threshold mix hard task traffic analysis analysis incoming outgoing messages target mix easily reveal number 
attack called flood flush blend attack 
intention attack isolate target message knowledge messages mix target message 
way mix fires delivers messages adversary monitor outgoing messages 
author messages just needs identify odd message outgoing messages trace target message 
furthermore comprised mix mount similar attack waiting right time sending messages mix 
sort attack allow adversary trace message source process destination overcoming provided mixes having mixes compromised 
similar attacks easily mounted mix time threshold 
pool mode provides better resistance type attack mode guaranteed upper bound message delay mix 
attacks batch mode certain exact attacks pool mode uncertain accomplished greater cost batch mode 
pooling mode resource intensive mount attacks leaves open possibility detect attempted attack successful allows retry attack 
improvement making detection results attack harder 
pool mode mix advantage flood attacks draw back upper bound number round message delay 
pool mode reaching threshold single message randomly picked sent mix destination 
selection process random potentially infinite time delay message gets delivered 
type attack mounted mix network message replay 
mix overcomes attack discarding duplicate messages try pass mix 
checking message resource intensive messages pass particular mix logged 
avoid intensive resource consumption periodic key changes announced mixes allow discard earlier message logs 
impressive advantage mix network allows anonymous communications having trust single third party 
cases messages fully easily traced analyzed entire set intermediary mixes compromised 
general encrypted connection message encrypted sent destination 
case compromised machines route source destination cooperate link source destination 
furthermore sniffing network packets comparing data allows adversary trace message 
case mixes data changes route mix cooperating compromised mixes link source destination intermediaries compromised 
interesting characteristic mix network determination route intermediary mixes sender 
attribute mix networks provides source flexibility choose route alongside exists overhead encryption 
repeated encryption public keys entire set intermediary mixes fairly exhaustive operation adds delay message transmission communication latency 
advantage mix networks low bandwidth requirement 
mixes triggered message time thresholds part activity going mixes needed 
certain cases mixes generate fake message cause activity aside real communication activity 
cases overhead traffic due fake messages determined trigger mechanism generating fake messages 
advantage low traffic cases serves disadvantage 
due limited traffic mixes guarantee realtime communications 
batch mode provides faster communication pool mode triggered arrival certain predefined number messages 
triggered batch mode deliver messages bind message delay delay arrival predetermined number messages 
situation gets worse pool mode due random message selection process receipt threshold number messages 
type attack prevented mixes re encryption attack 
mix concatenates random data actual message content prevent mounting attack 
re encryption attack works applying brute force 
mounted adversary sniffing network packets 
common data sets messages encrypted compared encrypted text 
test message say encrypted machine public key says meet john doe place pm text meet john doe place pm encrypted public key compared 
concatenating random data harder mount attack increasing message size things try common messages random text 

onion routing core theory onion routing seeks provide system resistant traffic analysis source destination linking 
incorporates public key cryptography hiding message content 
provides anonymous connections having trust third party implying technique mixer networks 
provides various onion routers behave mixes seek de link messages receive ones send 
important difference onion routers real time waiting certain number messages wait certain length time mix output messages 
case onion router receive messages chance linking input output 
usually expect minimum amount traffic onion routers operate probability leading source destination linking low 
details protocol onion routing communication proceeds follows source directly connecting destination connects local application proxy turn connects onion routing proxy provides destination address predefined format 
job application proxy filter source identifying information data stream provide fault tolerance flag error reported onion router format information provided source application readable onion proxy 
onion routing proxy function allow sender communicate onion routers 
receiving connection request onion routing proxy sets connection sender receiver series onion routers 
connection setup time onion routing proxy receives message intended routes various onion routers connection route 
allow content anonymity onion routing proxy repeatedly encrypts message usually encrypted destination public key public keys onion routers connection route source process mixer networks 
layers encryption form onion 
onion passed various onion routers connection route decrypting layer encryption finding destination padding onion compensate layer onion forwarding destination 
eventually onion reaches final onion router forwards responder proxy 
function responder proxy pass data onion network receiver 
source send encrypted copy real address destination allow response receiver 
done similar fashion done mixer networks 
mixes onion router knowledge adjacent onion routers 
furthermore mixes hard link data received data sent particular onion router data shuffled decrypted onion router 
factors provide resistance source destination linking 
onion routing provides fixed message size fixed number messages network channel provides resistance network analysis 
configurations major configurations onion routing 
network identity protection configuration model goal protect identity domain message originator 
case onion routing proxy may installed gateway firewall may seek provide anonymity computers gateway firewall 
onion routing proxies onion routing proxy service requests computers 
organization qualities onion routing proxy trusted knows source destination 
receiver outside onion network data contain information identifying actual sender identify onion router sender tcp header identifying sender 
individual identity protection configuration customer isp model configuration identity individual concealed 
scenario similar user connecting isp runs onion routers links onion routers 
model onion routing proxy customer machines 
onion routing proxy onion routing proxies service connection requests 
trusted component onion network onion routing proxy customer computer provides security 
customer onion routing proxy generates various onions traverse onion routers linked user isp possible reach destination 
scenario onion routers know just sender just receiver 
provides stronger protection source destination linking source proxy resides trusted machine 
remote proxy configuration configuration identity initiator concealed initiator control onion proxy models 
case initiator secure connection remote onion routing proxy 
long initiator trusts remote onion routing proxy sender able communicate anonymously 
case sender activity established eavesdropper establishing link observer hard task 
long remote onion routing proxy compromised establish route onion network responder proxy allow initiator communicate recipient 
configuration possible source anonymously communicate destinations long trust remote onion routing proxy 
advantages limitations concept onion routing mixer networks advantages limitations mixer networks inherited onion routing 
certain differences onion routing mixer network alleviate certain problems 
section initially discuss key differences mixer networks onion routing advantages disadvantages 
onion routing mixer networks share key characteristics observed behavior similar loose sourced routing onion routing provide set router 
order data flows routers pre defined 
network static topology dynamic topology published available entities anonymous communications 
way source source proxy completely responsible determining order number nodes visited message traverses network 
see message progress steps anonymity ring predetermined ar behave 
decentralized trust points networks configurations exist allow communication trusting single party 
trust distributed onion routers source destination making trust distributed 
systems anonymous communications compromised intermediary machines mixes onion routers compromised 
uncorrupted causally delivered data protocols defined onion routers depend data communicated uncorrupted ordered 
computer sends message destination receive 
realistic assumption network protocols tcp guarantee causal delivery certain algorithms exists utilized recovery corrupted data 
resistance eavesdropping traffic analysis aforementioned protocols aim provide resistance source destination linking content message transmitted 
fundamentally resistance source destination linking achieved mixes 
resistance eavesdropping achieved public key cryptography 
important note protocols provide resistance traffic analysis utilizing trivial techniques linking incoming outgoing messages machine monitoring message order message size message data bits 
talk back sender systems message data destination identify sender message data contains sender identifying information 
utilized receiver respond back sender 
technique utilized sender intends divulge true identity recipient 
mechanisms exist see sec onion routers connections recipient communicate sender knowing sender true identity 
properties limited onion routing connections connections established source destination communication take place onion routing 
entity called onion routing proxy responsible setting connection 
entity aware source crux allowing anonymous communications 
function proving initiator ability define loose path message take reach destination 
ability onion routing onion routing proxy easier integration existing applications 
onion routing proxy responder proxy designated machines exists called onion routing proxy responder proxy perform task communicating outside world onion routing network 
onion routing proxy transfers message source onion routing network responder proxy transfers message onion routing network destination 
notion exist 
communication characteristics onion routing provides real time bidirectional setup communications 
provide unidirectional communication pathway provide sender ability allow receiver talk back 
furthermore communications mixes real time non real time communication provide additional security 
onion routing hand real time due fake messages employed generate fake traffic messages potentially traced observing network traffic 
application independence onion routing provides complete application independence proxy aware application 
proxy aware application connections onion routing proxy destination rest details anonymous communications handled onion routing system 
furthermore redirector seamlessly integrate onion routing tcp ip 
connection establishment frequency mixes establish close connections needed onion routers connected longstanding socket connections 
variable route static connections factors contributes anonymity 
key advantage onion routing seamless integration various applications modifications applications 
demonstrates flexibility onion routing practical applicability 
onion routing provides real time bidirectional communications 
highly practical great leap loose non temporal delay guarantees provided mixer networks 
furthermore various configurations onion routers convenient various individuals corporations 
remote proxy configuration highly practical anybody utilize public onion routing networks effort 
drawback onion routing requires trust placed onion routing proxy 
certain configurations cause onion routing proxy proxies focal points adversary attacks 
drawback static topology setting inability distribute update public keys 
drawback overhead connection setup 

architecture anonymity ring purpose presentation anonymity ring define protocol incorporates beneficial qualities onion routing presents formal definition protocol 
section describe basic communication infrastructure anonymity ring assumptions infrastructure provide brief overview participant expected behavior 
anonymity ring aims provide anonymous communication having trust single third party 
uses structure similar pooling mode mix ring participant machines 
data communicated neighbors send receive keys frequently changed 
duplicate messages discarded ar done mixes frequent changes symmetric keys neighboring ring participants decrease severity problem ar 
ar provides message delays system 
ar applications structure similar application proxy onion routing seamless integration current systems 
organization anonymity ring anonymity ring composed computers communicate anonymously 
group designated computer called ring participants unidirectional connections form ring see appendix 
machines exactly connections distinct ring participants send connection receive connection 
additionally machines open send receive connections computer 
addition participants anonymity ring public key previous ring participant address ring participant address message clearing cycle number handle handle map clearing cycle number current round number unique identifier anonymity ring belong publicly available 
data allows non ring participants determine size anonymity ring 
numbers published message clearing cycle handle map clearing cycle specify numbers leave remainder division current anonymity ring round number clear data stored transit messages handle map respectively 
message clearing cycle number handle map clearing cycle number ring participant round number anonymity ring handle map get cleared round handle map message data gets cleared 
published data implications values anonymity ring discussed section 
participant responsibility available handle process wishes receive messages 
handle nickname participant 
ring participant machines know translate handle real destination 
message sent destination divided parts purpose transmission content message trigger message 
call original message needs sent split actual message split parts transmission component messages 
component messages proceed independently anonymity ring set terminate machine 
content message contains actual data received destination routing information 
set terminate trigger message idle cache ring participant 
cache cleared trigger message set arrive ring participant cause idling content message sent destination 
note trigger message contain actual message content intended destination just information trigger idling content message 
mapping message message destined ring participant provides mapping destination handle actual destination address fake message 
type message transmitted split content trigger message 
case content message contains mapping trigger message causes mapping stored destination ring participant 
mappings mapping messages generate required actual message reach destination translation destination handle actual destination exist actual message discarded 
anonymity ring recommended non participant machines regularly send fake messages addressed self mock destination handle invalid message content 
accomplished sending just component messages content message trigger message needed successful communication 
solitary component messages counterparts ignored serve purpose fake messages 
note messages labeled publicly fake avoid detection fake 
ring participants aware messages fake messages serve purpose confusing compromised ring participants 
assume messages delivered destination specified message header uncorrupted state 
furthermore assume messages causally delivered 
trivial assumption operate private keys system uncompromised 
additionally assume condition holds send sk key ring participant receive rk key neighbor dec rk enc sk dec sk enc rk 
terminology onion routing structure anonymity ring described follows ring participant machines considered responder proxies onion routing proxies exist message initiator machines 
initialization anonymity ring non ring participant computers machines usually need communicate anonymously 
ring participants exist facilitate communications 
order computer handle communicate computer handle preparatory steps involved 
pick starting ring participants say 
utilized starting ring participant content component communication utilized starting ring participant trigger part message 

pick number say num hops max hops max hops maximum number allowed hops anonymity ring 
max hops greater number ring participants anonymity ring 
number determine number ring participants utilized intermediaries inclusive ring participant content component communication reaches final ring participant machine 
concept extended ring communications see sec 

best value greater number ring participants ar ensure message traverses ring participants compromised information communication revealed 

pick multiplier 
utilized identify number rounds trigger message perform anonymity ring reaching intended destination 
purpose size ring determined data published anonymity see sec 
standard exponential distribution utilized picking number satisfy conditions ring size dist max hops 
ring size number anonymity ring dist defined number hops takes reach traversing anonymity ring neighbors 
return value dist range ring size 
pick numbers max hops num hops max hops ring size dist respectively say start start statistical distribution similar standard gamma distribution designate starting hop array indices message components 
value value read variable process specification section 
step designed provide random starting point component messages 
random initial hop number hops determine exit point dictate encoding message traverses anonymity ring 
step described serves provide number hops content message take route destination 
anonymity ring gives possibility content message delayed certain amount time trigger messages reaches router 
delaying ensured message content mapping handle actual destination get cleared trigger message causes sent 
requires timing analysis source process dispatch messages appropriate times 
step determines amount delay identifying number additional rounds trigger message take anonymity ring reaching intended destination 
important note time determined amount delay generated extra cycle trigger message anonymity ring exceed message clearing delay 
assume content message delivered router round time constraint assured assuring trigger message reaches router message clearing cycle mod message clearing cycle cycles content message 
alongside anonymity ring cycle number mapping message reached ring participant route destination assure translation destination handle actual address exists ring participant assured trigger message actual message reaches router handle map clearing cycle mod handle map clearing cycle cycles mapping message reaching 
appendix provides structure messages 
step random index start value keeps ring participant hop trivially realizing received message message source computer 
note possible ring participant computer identify sender analyzing header message received comparing preceding machine discover received message preceding neighbor outsider 
best establish sender activity 
initiator machines generate fake messages see sec 
harder ring participant hop establish presence valid sender activity 
ring routing see sec 
elude detection sender activity 
message composition anonymity ring completing preliminary tasks generating various values source process needs generate messages mapping message actual message 
messages split consists content message trigger message 
mapping message sent ring participant route source destination 
source process send fake messages see sec 
avoid message activity detected 
mentioned mentioned messages divided content message trigger messages 
discuss construction content trigger message actual message 
parallel algorithm construction content trigger messages mapping message data sent destination handle actual destination address messages destined ring participants 
discussion content trigger messages actual message constructed 
message type msg fire respectively 
see sec 

mapping message message add map entry destination handler actual destination address destined ring participant machine 
dynamic property maps allow resistance traced 
types messages destined ring participants transmitted split content trigger messages 
protocol specification mapping stored array 
index content trigger messages values generated source process initialization start start respectively 
values hop bits index start start content message trigger message respectively irrelevant 
actual message content message values start index start num hops index hops array hops array indicate ring participants keep content message ring forward message ring participant 
start num hops index hops array value indicate ring participant decode fields send information actual destination 
trigger message values start index start ring size dist index hops array hops array indicate ring participants keep trigger message ring forward message ring participant 
start ring size dist index hops array value indicate ring participant decode fields send corresponding content message actual destination 
content message contain data message content encrypted form 
place trigger message contain destination handle padded random data 
message digest messages message digest unencrypted data 
message index unique index message source 
message index value content message corresponding trigger message 
constructing messages source process goes process encoding message 
follows algorithm encoding content message assuming data sent dh destination handle intended recipient dst destination handle ring participant hop array hop bits see sec 
definition variables enc dh int start num hops start hop md enc dst hops ni hop md enc sk hop md preparation content message trigger message prepared follows int start num hops start hop md dh enc dst hops ni hop md dh enc sk hop md dh notice fields fixed size 
expect encryption preserve content length data assigned various fields assumption 
addition algorithm initiator process perform addition tasks executing algorithm 
example choose embed information allow destination process talk back providing destination handle write back unique id anonymity ring ring participant start number hops traverse start time communication happen 
information needed destination source process adding mapping ring participant reverse route 

message processing anonymity ring types message anonymity ring identifiable message types anonymity ring 
msg message type message send data destination 
fake sender activity 
message able route destination 
contains data sent destination encrypted repeatedly public keys intermediary processed see sec 

stalls ring participant identified fire message reaches ring participant triggers msg message send appropriate destination 
content message identified sec 

fire message fire message accompany msg message trigger idling msg message identifying destination handle appropriate router 
generate fake traffic 
trigger message discussed sec 
theoretically types message needed system 
mapping message actual message 
actual message original data needs communicated 
mapping message exists add handle actual destination mapping ring participant facilitate actual message see sec 

fake message generate traffic see sec 

visual depiction appendix details message processing mentioned earlier neighboring process ar send key sk receive key rk 
sk rk satisfy properties dec rk enc sk msg msg time message forwarded router ar encrypted sk source router decrypted destination rk 
protects data specifies type message value second fields message 
furthermore ring participant knows send receive keys neighbors 
keys widely known public keys ring participant eavesdropper able identify information 
ring participants identify information compromised ring participants try misuse information 
fake activity generated available message types hard compromised router conclusively conclude information available 
messages anonymity ring broadly classified different categories fake message content message trigger message system message 
fake message generate fake activity anonymity ring confusing eavesdroppers 
content message serves transfer data content initiator anonymity ring see sec 
destination machine 
trigger message exists cause content message fired destination hop see sec 

actual message comprised content trigger message original message needs communicated anonymously 
mapping message destined compromised content trigger message serves add mapping entry destination handle destination address 
system message intended correspondence ring participant ring participant 
allows ring participants inform updated symmetric keys administrative things internal anonymity ring 
different kinds messages exist anonymity ring selected ring participants able identity type message 
process specification see sec 
ring participant able identify type message process accordingly 
awareness intermediary routes message type information negative impact 
example intermediary routers aware message traversing fake message essentially provide simple way compromised router discard fake activity 
information mind behavior anonymity ring protocol intermediary ring participant proceeds follows discussed earlier neighboring process utilizes symmetric key pair allow secure quick communications 
message received recipient ring participant decrypts receive key 
decryption performed follows see sec 
variable declarations hop dt dec rk decryption recipient access index hop counter value 
value allows anonymity ring identify appropriate hop bit determine destination message 
value encrypted values recipient public key protect accessing 
recipient proceeds decrypt value follows hop md dt dec pk hop dt decryption destination process access correct hop bit hop determine processing message 
important note point hop false guaranteed value 
hop bit false implies message transit anonymity ring forwarded ring participant 
case index bit incremented ring participant able access correct hop bit 
responsibility incrementing value taken away ring participants additional security see sec 

additionally hop bit utilized currently overwritten random data process depend information 
new message encrypted send key part symmetric key destination neighbor passed buffering system destination needs sent 
buffering system depending configuration order message sent return message destination needs sent 
current process waits feasible message sent traffic amount allowed sends message destination 
steps represented ap notation follows hop random enc sk hop md dt sleep ch send msg hop bit true implies message reached terminating point anonymity ring 
messages treated message type 
details message processing follows categorized occurrence ap notation specification content message fake message received message content message recipient ring participant extracts data message received storage index data needs placed 
storage index provided source process formed appending message index message digest provided source 
index invalid assumed fake tampered message discarded 
see sec 
see protocol advanced detect tampered messages receipts 
ap notation behavior appear follows md continue md md dt fi trigger message mapping message fake message ring participant received trigger message analyze message content identify destination handle 
destination handle indexes storage array mentioned store data content message see data exists 
data exists assumes message received fake message discards data 
data exists recipient ring participant analyzes destination handle compares destination handle see intended destination 
mapping message mapping added ring participant map array destination handle actual destination address provided stored message 
implies current ring participant hop message delivered destination 
case received message prepared size received message encrypted send key 
added send buffer 
mentioned message returned function message sent destination soon traffic channel falls maximum traffic limit 
ap notation processing messages follows dh pad dt dt md dh dt mapping message dh dec pk dt decrypt mapping dh isn fake message store mapping usually unique number provided source process specifications zero index invalid dh dh continue fi dh dt md dt continue dt dh dt readable values hop random dt enc sk hop md dt dt dh sleep ch send msg fi fi complete specifications protocol section 
behavior send buffer reordering tailored desired options provided section 
process specification main process functions complete protocol specification anonymity ring protocol notation 
process inp integer max hops message integer max msgs link integer size message buffer rk sk pk integer rcv snd private keys process array integer integer buffer translate destination handle pk specified destination handle 
sentinel indicating invalidity destination handle 
maintained updated necessary outside process 
var integer encrypted message array integer integer buffer translate handle address original destination 
sentinel indicating router translation handle values array provided computer 
frequently reset periods time lack activity 
array integer integer buffer translate md provided source process message actual message content 
sentinel message existing indexing message digest 
index zero invalid source process index zero messages sends 
index zero array constant value 
furthermore data data structure periodically cleared avoid resource exhaustion 
regular clearing interval set specific entry activity specified rounds results cleared 
integer index provided source process 
msg fire identifies type received message 
fake messages messages sent self invalid information 
confuse processes esp adversaries 
see hop counter bit 
identifies bit hops array indicate send msg ultimate destination keep ar 
referred index value dh md dt integer dest 
handle msg digest data integer msg destination hop array boolean hop bits ctr start address fake message 
pad integer read ignore padding par integer machine rcv msg hop dt dec rk hop md dt dec pk hop dt msg hop true store message md continue md md dt fi fire hop true dh pad dt dt md dh dt mapping message dh dec pk dt decrypt mapping dh isn fake message store mapping dh dh continue comment point hop false guaranteed value comment fake msg 
ignore 
timeout action take care sending messages necessary 
continue implies rcv action 
similar break looping constructs 
comment validate send message destination message 
comment fake message 
jump rcv action 
fi dh dt md dt continue dt dh dt readable values hop random dt enc sk hop md dt dt dh sleep ch send msg fi fi hop false hop random enc sk hop md dt sleep ch send msg fi timeout ch hop md dt dh random random random random ctr dh random dh mod send fake message ring participants hop ctr true ctr dh nc halt bad happened 
outgoing neighbor exist dh nc hop ctr md dt enc dh nc hop ctr md dt fi ctr ctr od hop ctr md dt enc dh hop ctr md dt enc sk hop md dt dh send msg comment clear entry data structure 
comment indirect data verification performed message digest index 
value dt indicates data tampering occurred fake message generated 
invalid values regularly cleared message tampering shouldn cause resources eventually exhausted 
furthermore value utilized allow inter ar routing 
comment send message destination comment process thread blocks long condition specified parameter sleep function true 
comment send sending message anonymity ring inter ar routing 
see sec 

comment message router 
hop router 
comment process thread blocks long condition specified parameter sleep function true 
comment 
comment halting implies complete halt operation current process 

message buffering description interface procedure interface adding message buffer follows message enqueue destination enqueued message 
message sent 
destination message sent 
anonymity ring message buffer full 
message enqueued message dequeued sent 
message buffering important part anonymity ring 
configuration message buffering determines amount traffic resistance provided 
furthermore determines delay transmission caused due reordering 
aims usually conflict 
want message buffering system provide optimal balance 
note anonymity ring protocol specifications allow ring participant identify message type optimizations done function considering message type information ordering messages 
possible detects hop message convey information function information function optimize certain extent see sec 

requires input values param param follows adds param buffer updating priority array entry message appropriate depending configuration 
updates destination array entry message value param 
updates depending configuration organize messages arrays order tries put higher priority messages front arrays 
execution returns message destination address message needs sent 
provide various versions message buffering discuss advantages disadvantages 
configurations simple fifo configuration 
specification message buffering system configured behave simple queue 
protocol describes behavior 
procedure local static var bff array integer buffer stored messages init 
fake messages priority array unnecessary var case dst array hop stored messages init 
indicates index message stayed queue longest bff dst bff dst 
advantages limitations protocol provides strictly bounded waiting rounds waiting practical provides linkage messages sent received 
observer trace messages source destination configuration 
ii 
random pick configuration 
specification configuration message randomly picked sent enqueued message placed position 
ap notation protocol follows procedure local static var bff array integer buffer stored messages init 
fake messages priority array unnecessary case dst array hop stored messages init 
var indicates index randomly picked message random bff dst bff dst 
advantages limitations configuration similar proposed behavior mix pool mode 
serve anonymity ring provides clear linkage incoming outgoing messages 
protocol provide kind strict bound transmission delay provides probabilistic bound 
true expected value number rounds required pick message enqueued guarantee bound 
configuration conceivable message stuck buffering system long time causing huge delay communication 
iii 
priority queue configuration 
advantages limitations look behavior process tweak simple fifo configuration behave priority queue enqueues messages queue provided priority 
assigning priorities incoming messages possibilities possibility priority data messages constant start decreases time new message arrives 
messages proceed fifo order 
system similar fifo configuration impractical 
possibility ii assign random priority incoming data messages 
messages dequeued front queue 
round priority messages existing queue decreases 
configuration provide anonymity display clear association received sent messages 
furthermore expected value number rounds message wait configuration 
ap specification behavior similar fifo configuration provided 
iv 
intensifying probability configuration 
specification protocol specifications intensifying probability configuration follow procedure local static var bff array integer buffer stored messages init 
fake messages pri array priorities stored messages init 
dst array hop stored messages init 
var buff array integer buffer messages update reorder buff priority dest arrays pri array stores priorities stored msgs 
dst array integer destinations msgs 
free array boolean init false stores boolean values indicate particular spot buffer free done boolean init false indicates message dealing reordered tmp tmp integer loop control variables buff msg sent dst destination message sent buff store message dst pri update priorities existing messages tmp tmp pri tmp pri tmp pri tmp pri tmp skip fi od done inserting new elements updating priorities 
reordering tmp tmp tmp done false done false tmp random mod pri tmp tmp free tmp true free tmp false buff tmp buff tmp pri tmp pri tmp dst tmp dst tmp done tmp true exit loops free tmp false tmp tmp fi od od tmp tmp message reordered od go update buff dest pri tmp tmp pri tmp pri tmp dst tmp dst tmp buff tmp buff tmp od 
advantages limitations configuration works manner message front queue dequeued sent 
priority messages existing buffer decreased highest priority 
incoming message placed front queue assigned priority 
message buffer random number generated ranges priority message dealt 
number specifies place message placed 
specified index full array traversed starting number generated free spot 
index message 
higher priority low number implies higher priority associated message closer front queue 
messages higher priority usually sent delayed 
protocol provide relationship incoming outgoing message ring participant 
protocol provide bounded waiting 
expected number rounds message wait protocol 
just case random pick priority queue configuration possible message gets delayed indefinite period time buffer highly 

walkthrough message ar section provide detailed walkthrough message travel source destination 
start listing assumptions utilized walkthrough proceed detailed overview communication anonymity ring 
simplistically thoroughly demonstrate behavior anonymity ring utilize anonymity ring ring participants 
assumptions 
source process generating periodic fake messages incomplete component messages 
see sec 
destined self 
provides greater resistance adversaries seeking establish source destination activity seeking link source destination 

initially current round number published ring participant zero updated incremented rounds progress 

source process may anonymity ring discussed sec 
demonstration deal message traversal anonymity rings 

ring participant exists anonymity ring ar unique identifier anonymity ring public key bk previous ring participant ring participant message clearing cycle number destination handle self handle map clearing cycle number 
ring participant exists anonymity ring ar unique identifier anonymity ring public key bk previous ring participant ring participant message clearing cycle number destination handle self handle map clearing cycle number 
ring participant exists anonymity ring ar unique identifier anonymity ring public key bk previous ring participant ring participant message clearing cycle number destination handle self handle map clearing cycle number 
mapping message hop ring participants content message trigger message 
content message picked hops 
value see sec 

case hops content message hops trigger message 

actual message hop ring participants content message trigger message 
content message picked hops 
value see sec 

case hops content message hops trigger message 
processing simulating case source process needs communicate destination process 
initially source process analyzes publicly published information different anonymity rings decides anonymity ring say ar ring participants step source process compose mapping message 
mapping message composed content message trigger message 
provides view content trigger messages form mapping message seen destination ring participant 
content trigger message prepared described section 
mmc refer content trigger messages respectively 
parameters utilized preparation provided assumption 
mmc case layers encryption public key encryption outer layer formed encrypting public key 
layers encryption public key encryption outermost layer formed encrypting public key 
similarly actual message defined sec prepared comprising content trigger message 
amc amt refer content trigger messages respectively 
parameters preparation provided assumption 
amc case layers encryption public key encryption outermost layer formed encrypting public key 
amt layers encryption public key encryption outermost layer formed encrypting public key 
preparing message sender dispatch message exactly right time keeping mind storage mapping clearing rounds assumptions 
diagram shows messages need sent relevant information 
message destination hop number hops route mmc amc amt timeline depicts messages dispatched received round 
mmc source source sent processed processed processed source sent processed processed processed processed amc source source sent processed processed processed amt sent processed processed processed processed processed messages reach destination time events happen 
firstly mapping message add mapping destination handle actual message actual destination address 
mmc processed accomplish 
secondly amc reaches ring participant data extracted message added storage map 
lastly amt processed utilizes entry storage map destination handle mapping added mmc cause content message associated appropriate destination 
destination message pair added send buffer sent time processing function 
simulation assume message steadily moves anonymity ring hop round 
long constant traffic channels connecting ring participants steady progress assumption allow adversary establish source destination linking 
furthermore discussed earlier behavior steady progress determined function change function imply changes timings discussed 
additionally introducing concept receipts see sec 
anonymity rings alleviate overhead associated timing messages sending destination receiving response 
example behavior hop ring participant modified send message back source source handle provided encrypted format acknowledge receipt mapping content message 
turn cause source take actions required source send trigger message receiving receipt corresponding content message 
implementation suggestions section discuss key hurdle encountered implementation anonymity ring 
underlying implementation communication protocol achieved tcp ip 
tcp ip protocol deal various underlying details message reordering message loss little concern 
tcp ip protocol communications manner non ring participants want communicate create message send ring participant machine tcp ip 
ring participant machines tcp ip communicate anonymity ring 
message dispatched final destination ring participant machine uses tcp ip send message final destination 
implementation tcp ip essentially instances 
send message non ring participant machine ring participant machine anonymous delivery 

ring participant machine communicate successive 

ring participant machine deliver message final destination 
communication pipes cases encrypted provide resistance eavesdropping 
done cost effectively symmetric keys 
mapping storage maps regularly cleared avoid excessive resource consumption 
concluding remarks advantages limitations anonymity ring section list various advantages limitations anonymity rings concisely elucidate 
key characteristics anonymity ring advantages 
anonymity ring aims provide anonymous communication having trust single third party 
uses structure similar pooling mode mix ring participant machines 

data communicated neighbors send receive keys frequently changed 
provides tolerance replay attacks 
message repeats occur change symmetric keys ar choose discard duplicate messages done mixes changing symmetric keys 

ar provides message delays anonymity ring 
particularly useful resistance eavesdropping 
allows change cancel sent message period time decide 

applications structure similar application proxy onion routing seamless integration current systems 

ar uses array contains data transmitted associated destination 
separates message data routing information 
saves valuable encoding time cutting amount repeated public key encryptions actual message 
independence allows inter anonymity ring routing see sec 
separated nature message content destination ar message come ar destination information message come ar 
adds resistance eavesdropping traffic analysis 

fake traffic frequently generated hide communications ring participants non participants 
lets source processes easily insert fake messages cleared regularly 
provides constant traffic communication pipes fake messages avoid detection activity 
provides resistance eavesdropping traffic analysis 
ar uses pool mode type configuration fairly hard mount successful flooding attack lot fake traffic 

provides initiator flexibility add mappings destination handles actual destination ring participants allows clear mappings 
allows single computer addressed multiple handles 

allows dynamic changes topology anonymity ring long changes published 
furthermore allows anonymity ring networks dynamically list public utilization 

provides initiator allow response destination bounded time frame see sec 
dictate terms conditions response 
frequent clearing mapping lists ring participant allows source dictate receive reply 
example recipient talk back sender sender provide recipient destination handle write back unique id anonymity ring ring participant start number hops traverse start time communication happen 
sender uses destination handle just provide recipient just destination handle sure ring participants contain mapping times 
reset frequently sender mapping messages generate fake activity 
furthermore suspects information compromised overwrite entry point 

ar extended allow receipts isolate malfunctioning ring participants see sec 


structure anonymity ring graph structure usually hold topology communication network onion routing cut simple list ar 
disadvantages 
splitting actual message different parts inherently causes timing details handled 
example trigger message actual message precede content message actual message turn preceded mapping message 
loosing timing cause loss message adds overhead communication overhead resend 
function important role play determines transmission delay boundaries ring participant 
receipts delays account important ensure delivery message destination 

limits established number hops allowed anonymity ring efficient communications 
additionally conserve resource usage storage mapping destination handle mapping periodically cleared 
attempt efficiency adds complexity source timings messages 

maintaining constant traffic channels anonymity ring conserves great amount bandwidth 
furthermore constantly publishing information see sec 
ring participant conserves lot bandwidth 
bandwidth source process conserved resends 
enhancements see sec 
concept receipts anonymity rings 
implies guaranteed message delivery enters anonymity ring 
receipts repeated sends message executed ensure delivery messages 
consequently anonymity ring drawback conserving lot bandwidth 
areas research listed areas anonymity ring improved frequent changing send receive keys new message type introduced process specification sys 
indicate system administrative message intended carry activities internal anonymity ring 
messages frequently changing symmetric keys neighboring ring participants 
application proxy application proxy installed source machine handle details communications 
behavior application proxy similar application proxy onion routing network 
goal proxy allow easier integration existing proxy aware applications 
optimization ring participant able identify type message received 
information efficiently queue messages identifying fake messages 
similar queuing done fake messages generated ring participant 
queuing provide faster transmission valid messages low priority transmission fake messages efficient faster communications 
anonymity ring changed provide receipt delivery 
allow source confirm message delivered destination 
additionally help compromised ring participants allowing source process seek receipts intermediary ring participants 
currently ar provide facility receipts message delivery provided 
utilized guaranteeing message delivery making communications fault tolerant 
messages routed anonymity ring 
provide additional resistance source destination linking 
accomplished having destination message ring participant different anonymity ring route 
routing messages layered various anonymity rings hops anonymity ring 
provide stronger resistance traffic analysis come price timing bandwidth encryption calculation overhead source 
index value designated sec 
encrypted repeatedly source relieving ring participants task incrementing hop 
provide resistance compromised routers tampering index value incrementing properly cause message discarded route 
logic added detect low network traffic source traffic 
implication cause anonymity ring shutdown causing neighboring process witnesses traffic shutdown 
reduce chances user utilizing anonymity ring compromised ring participants 
currently destination able talk back source source encrypts handle provides destination 
anonymity ring attuned provide facility inherent feature 
alleviate overhead source process allow response 
research possible help dr gouda 
guided right directions research helped development organization 
supervision support 
additionally friends peers contributed proof reading identifying things inconsistent needed improvement 
gouda elements network protocol design 
john wiley sons 

chaum david untraceable electronic mail return addresses digital pseudonyms communications acm 
uwe kai 
teaching security virtual university proceedings ifip tc wg world conference information security education 
michael reed paul syverson david goldschlag 
anonymous connections onion routing ieee journal selected areas communication special issue copyright privacy protection 

serjantov andrei dingledine roger syverson paul 
trickle flood active attacks mix types th workshop information hiding 
oct 
lncs public key cryptography 
developer netscape com docs manuals security 
oct 
nist handbook statistical methods www itl nist gov div handbook eda section eda htm 
nov 
onion routing 
www onion router net 
jan 
appendix mix input mix operations actions performed mix 
receives messages 
decrypts data get hop destination address message content 
discards repeats 

shuffles message order 

threshold delivers messages hop destination repeats mix output messages sent appropriate destinations 
trash 
