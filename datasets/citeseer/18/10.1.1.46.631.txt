stable local computation conditional gaussian distributions steffen lauritzen aalborg university frank jensen hugin expert september article describes propagation scheme bayesian networks conditional gaussian distributions numerical weaknesses scheme derived lauritzen 
propagation architecture lauritzen spiegelhalter 
addition means variances provided previous algorithm new propagation scheme yields full local marginal distributions 
new scheme handles linear deterministic relationships continuous variables network specification 
new propagation scheme ways faster simpler previous schemes method implemented version hugin software 
key words artificial intelligence bayesian networks cg distributions gaussian mixtures probabilistic expert systems propagation evidence 
bayesian networks developed important tool building systems decision support environments characterized uncertainty pearl jensen cowell 
exact computational algorithms developed concerned networks involving discrete variables 
research report department mathematical sciences aalborg university 
lauritzen developed computational scheme exact local computation means variances networks conditional gaussian distributions 
unfortunately scheme turned fatal numerical difficulties basically due computationally unstable transformation different representations distributions 
motivation remedy numerical instability 
fundamental idea developments times keep interesting quantities represented units direct meaning probabilities means regression coefficients variances 
necessarily reasonable order magnitude 
computational scheme developed remote computational architecture deal discrete variables hugin software similar schemes represented example form shenoy shafer lauritzen jensen 
difference partly related fundamental operations combination marginalization partially defined handling evidence quite different 
scheme closest original scheme developed lauritzen spiegelhalter considerations shafer necessary embed scheme unifying framework 
additional benefits scheme includes deterministic linear relationships continuous variables represented difficulty show calculate full local marginals continuous variables computational effort 
represent major improvements original scheme lauritzen 
cg distributions regressions bayesian networks considered distributions conditionally gaussian family distributions introduced lauritzen wermuth 
shall briefly review standard notation refer reader lauritzen details 
set variables partitioned delta gamma variables discrete delta continuous gamma type joint distribution continuous variables discrete assumed multivariate gaussian gammaj sigma pfi ig denotes continuous variables discrete gammaj denotes cardinality gamma sigma positive semidefinite 
say follows cg distribution 
symbol gammaj sigma denotes multivariate gaussian distribution mean covariance matrix sigma 
case sigma positive definite distribution density sigma gammaj det sigma gamma exp gamma gamma sigma gamma gamma sigma singular multivariate gaussian distribution density implicitly determined property vector linear combination univariate gaussian distribution sigmav interpreted distribution degenerate 
see example rao chapter description gaussian distribution level generality 
note slight difference terminology lauritzen allow equal entries avoid called canonical characteristics cg distribution numerical instability scheme lauritzen associated switching moment characteristics sigma 
additional benefit allow singular covariance matrices sigma 
occasionally interest describe cg distribution depends additional variables 
dependence set discrete variables vector continuous variables determined refer dependence simple cg regression 
note covariance matrix discrete part depends continuous variables conditional expectation continuous variables depends linearly continuous variables fixed values discrete variables 
general cg regression permitted depend specific way lauritzen relevant 
mixed bayesian networks consider probabilistic networks directed acyclic graph dag known bayesian networks pearl 
mixed bayesian network conditional gaussian distributions specified set nodes variables partitioned delta gamma discrete continuous variables 
dag associated network satisfy restriction discrete nodes continuous parents 
conditional distributions discrete variables discrete parent variables specified usual conditional distribution continuous variables cg regressions ff fi fl note dimensional fl just nonnegative real number 
fl conditional distribution specifies linear deterministic dependence assumptions imply joint distribution variables bayesian network cg distribution 
computational task addressed computing joint distribution interesting subsets variables particular single variable possibly specific evidence known values arbitrary subsets variables network 
distribution general mixture conditional gaussian distributions 
propagation scheme described involves usual steps construction junction tree strong root initialization junction tree incorporation evidence local computation marginals cliques 
potentials operations cg potentials basic computational object cg potential 
cg potential represented oe 
denotes partitioning continuous variables domain oe head tail gamma denote variables head tail assume dimensional 
arbitrary configuration discrete variables domain denoted potential domain discrete nodes head nodes tail nodes absent 
expression ffl fp table nonnegative numbers usual potential discrete case ffl fa table theta vectors ffl fb table theta matrices ffl fc table theta positive semidefinite symmetric matrices 
potential represented specifies cg regression notion potentials head tail due shafer 
ways natural partition discrete variables head tail variables reflecting potentials represent conditional distribution head variables tail 
partitioning discrete variables exploited propagation scheme chosen 
propagation scheme lazy type madsen jensen exploit partitioning 
initial conditional distribution continuous variable parent nodes pa mixed bayesian network corresponds cg potential ff fi fl fvg pa gamma discrete part domain equal pa delta 
similarly specification conditional distribution discrete variable parents corresponds cg potential gamma gamma gamma gamma gamma determined conditional probability tables 
discrete part domain equal family fa pa hyphens indicate corresponding parts potential void 
extension reduction cg potential extended adding discrete variables domain continuous variables tail 
adding discrete variables domain parts oe extended adding continuous variables tail matrices extended adding zero columns new tail variables fb similarly columns identically zero values corresponding variables removed tail potential say tail reduced 
columns identically zero tail potential said minimal 
marginals propagation scheme lauritzen marginals cg potential defined certain conditions marginals groups discrete continuous variables calculated marginals continuous variables calculated 
marginals continuous variables calculated head variables 
decomposed corresponding partitioning head variables marginal oe oe say marginals strong correspond calculating ordinary marginals relevant conditional gaussian distributions 
head variables removed marginalization tail reduced empty discrete potential emerges 
leads indirectly marginalization tail variables 
marginals discrete variables defined tail potential empty continuous conditioning variables matrix 
marginal cg potential oe gamma gamma discrete domain partitioned oe gamma gamma ae gamma gamma oe 
marginalization said weak correspond calculating full marginal distribution 
general full marginal distribution discrete mixture cg distributions distribution represented weakly marginalized potential cg distribution closest kullback leibler distance true marginal see lauritzen lemma 
direct combination combination operation cg potentials defined arbitrary pair potentials scheme quite different propagation schemes 
direct combination cg potentials oe defined head disjoint domain oe satisfies assume potentials reduced tails minimal 
fulfilled reduced potentials subsequently extended extensions done extending partitioned theta theta matrices corresponding 
define direct combination apparently non commutative product ae omega ae pq cf cf combination operation corresponds ordinary composition conditional distributions 
note oe omega omega oe exist equal 
direct combination satisfies oe omega omega oe omega omega sense combinations side defined side resulting potentials 
shafer called type algebraic structure partial commutative semigroup 
notation reflects operation direct combination sense similar forming disjoint union sets 
unfortunately direct combination cg potentials sufficient propagation scheme arbitrary mixed bayesian network 
define general combination need introduce notion complement 
complements head cg potential oe partitioned strong marginal oe define complement oe jh cg potential gamma gamma gamma gamma gamma gamma gamma gamma denotes arbitrary generalized inverse matrix penrose arbitrary matrix gamma satisfying mm gamma see rao pp 
rao mitra 
omega easily checked formulae combination fact generalized inverse gamma holds gamma see rao formula 
note expressions 
decomposition potential strong marginal complement corresponds exactly decomposition probability distribution marginal conditional 
recursive combination define general combination cg potentials 
required initialization process described section 
consider potentials oe minimal tails 
combination remain undefined 
heads potentials disjoint oe omega oe omega oe omega omega oe right hand side expressions defined 
oe omega omega oe defined ambiguity definition 
direct combinations defined empty combination defined 
decompose factors say oe assuming oe oe nd omega oe nd oe omega oe attempt combine oe oe omega oe omega omega oe equation understood recursively sense procedure described repeated product oe omega direct combination expression defined construction 
recursion terminates unsuccessfully potentials minimal tails satisfy combination oe remains undefined 
initialization setting computational structure involves steps forming strong junction tree strong root assigning potentials cliques transforming potentials specific form sending messages root away root 
junction tree strong root constructed usual way see example cowell 
chapter 
assume computational scheme point specified mixed bayesian network associated junction tree cliques root neighbouring cliques closer root delta gamma residual contains discrete variable separator consists discrete variables 
holds variables fa contained clique junction tree 
assignment potentials cliques cg potential corresponding specification conditional distribution node parents assigned arbitrary clique junction tree contains family 
potentials assigned clique subsequently combined order 
done direct combination dag acyclic continuous node head exactly potential 
collecting messages root step initialization process involves sending messages leaves junction tree root way similar process known standard hugin architecture jensen messages sent slightly different 
clique allowed send message leaf junction tree received messages neighbours away root 
process stops root received messages neighbours 
term collect operation 
collect message sent clique neighbour root separator potentials oe oe modified oe oe oe oe js oe oe omega oe oe complement oe marginalization separator oe obtained combining original potential marginal oe remains argued combination defined 
see realize heads potentials combined necessarily disjoint variable occurs head 
potentials involved holds tail variables parents dag induced conditional specifications combined possibly marginalized form potential 
potential reduced minimal tail directed path variable tail potential variable head potential 
holds tail variable conditionally independent head remaining tail variables 
trail connects variable head 
tail variables parents trail initially directed away leave tail immediately 
tail variables conditioning set head head nodes active trail form directed path head 
assume satisfied nonempty 
implies deduce directed path variable implying variable implying directed path variable directed path nonempty finite contradict acyclicity dag 
illustrate recursive combination necessary initialization process consider simple examples 
example consider dag 
potentials assigned cliques nodes assigned fb remaining nodes fa dg 
combining potentials cliques leads potentials head tail fc fbg fb fb dg fcg fa dg 
marginalized separator fb cg result head tail fcg fbg directly combined potential root clique fa dg 
mixed bayesian network associated junction tree 
variable discrete variable strong root fa dg 
root clique potential decomposed potentials head tail fdg fb cg fbg fcg 
reduced fbg gamma dependence spurious 
potentials combined directly 
example potential receiving clique decomposed 
combined potentials receiving clique combining incoming message combination performed directly 
example illustrates may incoming message needs decomposed way avoid computation decomposition 
example consider dag 
potentials assigned cliques nodes assigned fc fg fa fa dg 
choices node choose assign clique fa dg chosen root 
collecting root message fc marginal potential fc fg 
calculated combining assigned potentials head tail fd fg fcg marginalizing fd fcg 
directly combined potential neighbouring clique head tail fcg feg 
incoming potential decomposed potentials head tail fdg fc feg fcg 
reduced feg gamma dependence spurious 
potentials combined directly 
root received messages neighbours root potential contains correct root marginal tail empty 
evidence incorporated normalization discrete part root potential may necessary see section 
mixed bayesian network associated junction tree 
variable discrete variable strong root chosen fa dg fa 
potential oe representing joint distribution variables equal combination clique potentials oe oe oe fact marginals computed collect phase strong holds subset contains root forms connected subtree junction tree oe oe complements stored cliques collect separators playing specific role process computation similar process forming set chain lauritzen spiegelhalter 
inward computation type called lauritzen spiegelhalter architecture shafer see lauritzen jensen 
distributing messages root step calculation marginals involves sending messages away root similar standard hugin architecture 
root begins sending messages neighbours clique allowed send message soon received neighbour closer root 
term distribute process slightly different messages standard hugin architecture 
distribute message sent clique neighbour away root separator just received message neighbour root 
inductive assumption separator root contains weak clique marginal joint potential oe oe sending message new potential oe created follows 
weak clique marginal calculated oe oe omega oe formula correct seen exactly lauritzen 
potential marginalized separator oe oe oe combination defined collect operation complements stored cliques head oe disjoint weak marginal defined tail oe contained head oe implying combination empty tail 
distribute separators contain weak marginals separator nodes 
note chosen store weak clique marginals calculated distribute preferred keep original complement potentials 
minor variation lauritzen spiegelhalter architecture 
initialization process completed 
cliques junction tree contain complement potentials separators contain weak marginals joint potential joint potential recovered 
computation marginals junction tree initialized described previous section various types marginals easily calculated 
marginals variables single clique stored separately weak clique marginals recalculated needed marginalized subsets cliques particular single nodes 
circumstances weak marginals happen strong give correct full marginal distribution variables involved 
clearly true desired marginal involves discrete variables 
cases interest true 
mentioned root clique contains correct full marginal distribution variables 
example true marginal set continuous variables root clique easily calculated gaussian discrete mixture weights root potential gamma gamma gamma 
marginalization easily performed 
holds clique satisfies slightly restrictive condition tail potential empty 
example case separator clique root contains discrete variables 
see argue follows 
true marginal union cliques path root combination relevant potentials oe oe cliques path continuous variables conditionally independent remaining discrete variables path separator variables tail potential assumed empty holds just discrete separator variables 
proposition lauritzen yields weak marginal equal full marginal proceed root clique 
rearranging junction tree obtain marginal set variables subset clique junction tree obtain strong marginals group variables single variable clique having potential empty tail junction tree rearranged 
fortunately simple operation achieve necessary rearrangement denote push 
acts group variables contained clique neighbour root corresponding separator operation push variables 
potential oe decomposed oe oe omega oe jm 
clique extended similarly 
potentials changed oe oe omega oe oe oe omega oe oe oe jm push operation variables come closer strong root extended junction tree represents joint potential initialization 
price paid clique increased example illustrate push operation mixed bayesian network assuming chosen fa dg root 
initialization clique fa contains potential representing conditional distribution variables fc fa dg having head tail fc fdg 
push fcg potential decomposed marginal head tail fcg fdg complement head tail feg fc dg 
root clique extended variable marginal combined root potential complement kept clique fa 
marginals variables different cliques weak marginal desired set variables subset clique original junction tree form smallest connected subtree original junction tree contains variables 
clique subtree closest strong root original junction tree 
repeated push operation eventually achieve variables question members desired weak marginal computed directly 
strong marginals strong marginal group variables desired push operation yields appropriate rearrangement junction tree 
computation weak marginals form smallest connected subtree original junction tree contains variables 
clique subtree closest strong root original junction tree 
push operation variables question members performing push operations potential empty tail compute desired strong marginal potential 
need push variables question closer eventually variables contained clique having potential empty tail potential clique compute desired potential 
necessary may need push variables way calculation strong marginal single continuous variable important special case discussion follows marginal calculated limited additional effort potential junction tree extended single continuous variable part calculation 
incorporating evidence point assume initialization process completed cliques junction tree contain complements separators contain weak marginals 
discrete evidence incorporated usual matter necessary insert discrete evidence clique 
describe incorporate continuous evidence realize continuous node necessarily appears head exactly clique clique appears closest strong root 
clique potentials appears tail node 
neighbouring cliques closest root continuous variables separator constitute superset tail potential complement stored convenient incorporate evidence continuous nodes single node time 
evidence entered cliques appears 
assume clique appears head potential empty tail 
case push operation described subsection achieve 
proceed follows 
cliques tail node tail clique potential decreased unchanged changed removing column corresponding modified 
clique head node partition head nodes marginalization 
potential inserted evidence denoted oe 
head obtained removing tail empty 
distinguish cases ae gamma gammaa gamma gamma intuitively operation reflects deterministic explanation evidence infinitely non deterministic available 
calculation case simply fact standard density calculation appropriate case 
correctness operation formally proved small calculation elementary probability 
simplicity give argument case void denote kernel obtained normalizing dependence explicit need show interval real line satisfies relation dy marginal distribution denoting normal distribution nfa degenerate 
dy ae 
get dy ae ae similarly get dy dy dy piece continuous evidence inserted representation complement representation insertion bayesian network strong junction tree waste example 
variables type waste filter state burning regimen metals waste filter efficiency emission emission dust emission metals light 
variables discrete 
piece evidence take place 
evidence inserted collect root initialization 
collection involve proper computations discrete part potentials 
normalizer root clique equal joint density evidence 
example final example waste example described lauritzen cowell 
section refer details numerical specifications 
example concerned control emission heavy metals waste emission waste differs compositional differences incoming waste 
important factor waste burning regimen monitored measuring concentration emission 
filter efficiency depends technical state amount composition waste 
emission heavy metals depends concentration metals incoming waste emission dust general 
emission dust monitored measuring light 
essence description represented bayesian network shows junction tree 
strong root chosen fb cg fb 
way assign potentials corresponding continuous variables cliques junction tree assigned fb cg fb dg fb fl dg fw fd exactly potential involving continuous variables assigned clique continuous components potentials corresponding continuous components clique potentials initialized strong junction tree 
collect operation particular junction tree change continuous components clique potentials initialization process 
incorporation evidence done invoking push operation variables appear head root clique discrete separator root 
incorporating evidence requires pushed fb evidence incorporated 
similarly incorporation evidence require pushing fb separator path fl dg fb empty fully discrete incorporation evidence incorporation evidence clique fw potential head fm empty tail 
incorporating evidence point done invoking push operation 
hand evidence incorporated potential clique fw head tail fm fdg incorporating evidence point require pushing closer fb 
incorporation evidence requires pushing fw evidence incorporated similar considerations apply finding full mixture distributions individual continuous variables 
figures display full mixture distributions continuous variables incorporation information waste industrial type measured gamma 
hugin software displaying full marginals continuous variables waste example evidence incorporated 
hugin software displaying full marginals remaining continuous variables waste example inserting evidence waste industrial type measured gamma 
author benefited conversations glenn shafer concerning development theory local computation 
research partly supported danish research councils programme 
anders madsen provided helpful comments draft version lars nielsen prepared hugin shown figures 
cowell dawid lauritzen spiegelhalter 

probabilistic networks expert systems 
springer verlag new york 
jensen 

bayesian networks 
university college london press london 
jensen lauritzen olesen 

bayesian updating causal probabilistic networks local computation 
computational statistics quarterly 
lauritzen 

propagation probabilities means variances mixed graphical association models 
journal american statistical association 
lauritzen 

graphical models 
clarendon press oxford 
lauritzen jensen 

local computation valuations commutative semigroup 
annals mathematics artificial intelligence 
lauritzen spiegelhalter 

local computations probabilities graphical structures application expert systems discussion 
journal royal statistical society series 
lauritzen wermuth 

mixed interaction models 
technical report institute electronic systems aalborg university 
lauritzen wermuth 

graphical models associations variables qualitative quantitative 
annals statistics 
madsen jensen 

lazy propagation junction trees 
proceedings th conference uncertainty artificial intelligence ed 
cooper moral pp 

morgan kaufmann san mateo california 
pearl 

fusion propagation structuring belief networks 
artificial intelligence 
pearl 

probabilistic reasoning intelligent systems 
morgan kaufmann san mateo california 
penrose 

generalized inverse matrices 
proceedings cambridge philosophical society 
rao 

linear statistical inference applications edn 
john wiley sons new york 
rao mitra 

generalized inverse matrices applications 
john wiley sons new york 
shafer 

axiomatic study computation hypertrees 
technical report wp school business university kansas 
shafer 

probabilistic expert systems 
society industrial applied mathematics philadelphia 
shenoy shafer 

axioms probability propagation 
uncertainty artificial intelligence ed 
shachter levitt kanal lemmer pp 

north holland amsterdam netherlands 
