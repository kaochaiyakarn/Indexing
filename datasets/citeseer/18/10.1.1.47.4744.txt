electronic payments small amounts torben pedersen denmark mail tpp aau dk 
note considers application electronic cash transactions small amounts paid payee possible just pay total amount 
notable example transaction payment phone calls 
currently published electronic cash systems full payment protocol executed small amounts complexity system prohibitively large time storage communication 
note describes payments handled wide class payment systems 
solution easy adapt influences payment deposit transactions involving payments 
furthermore making verifying small payment requires little computation communication total complexity transactions comparable payment fixed amount 
public key crypto systems digital signatures dh rsa led construction different types payment systems 
payment digital signatures created verified 
advantage argued formally proved payment system secure digital signature system 
disadvantage efficiency payment system depends efficiency signature scheme 
particular time perform payment transaction closely related making verifying signature storage requirements depend length signatures 
computations users side performed small devices relatively little computation power smart cards electronic wallets see different types wallets case important user part transactions done efficiently 
research improved efficiency privacy protecting electronic payment systems inefficient certain applications 
application phone calls 
total amount paid composed payments small amounts small amounts paid real time receipt tick 
depending type phone call local long distance ticks may come relatively short time interval 
timing requirements imposed possibly met publicly suggested payment systems tick paid executing payment transaction 
furthermore approach require quite lot storage recipient side increasing linearly number ticks phone call 
may serious problem considering todays cheap storage media increase cost payment system implies large communication overhead 
settings similar payments useful include parking access electronic services 
shall general denote payments tick payments 
note describes method adding tick payments systems payer payment signature message describing recipient amount paid 
method easily explained application lamport password scheme see encode amounts payments 
earlier application repeated computations way functions described attributed 
relation payment systems similar idea bc encode amounts 
encoding suggested simplification bc specifically designed tick payments different systems 
proposed solution easily applicable payment deposit transactions involving tick payments affected 
tick payment initially requires normal payment 
certain parameter payment th tick requires gamma computations easily computable function 
verification tick requires computation function 
required number ticks paid bits normal payment stored exact number depends actual choice function mentioned 
related method described 
similar methods developed independently proposed rms rs 
contents section describes general payment system considered relates proposed systems 
section presents solution section describes simple variations 
electronic payment systems general system consider electronic payment system execution payment protocol described triple oe 
oe special messages denote messages exchanged payment 
message describe amount paid may contain additional information description recipient bits chosen random recipient 
part may depend amount paid 
situations oe signature corresponding public key certified part recognised means 
verification payment involves verification contains required information oe correct respect assumption reasonable hash value normally compute oe 
order credited received amount payee show oe possibly bank 
done payment transaction deposit transaction 
assumption system line 
furthermore payment systems pre post paid systems 
examples schemes cheque systems payer signs message transferring signed amount payer payee see line system 
anonymous counters 
systems payer gets withdrawal number permission spend certain amount setting counter 
payment payer fills cheque payee may credited amount 
pre paid systems done anonymously revealing anonymity payer 
see bc bbc examples systems 
security payment systems model depends infeasibility creating false pair oe accepted bank 
enable receiver get extra money pre paid systems enable payer spend money didn withdraw 
different systems types line electronic payment systems proposed literature 
electronic coin system user gets withdrawal number electronic coins fixed denominations guaranteed signature issuer 
payment user spend number coins values add required amount see cfn line systems line example 
requires large number coins payment leading inefficiency respect time storage communication electronic refund proposed cfn 
user obtains buys number withdrawal 
cheque upper limit spent amount limit 
possibly remaining amount cheque 
obviously flexible coin systems practical encoding amounts described section user contact bank order convert money money 
proposal oo called divisible coins 
user split coin arbitrarily cheque refund refund spend 
systems offer flexibility refund obtained level privacy protection proposed systems inefficient practical purposes 
pre paid line systems mentioned tamper resistant device trusted issuer prevent user spends money allowed 
furthermore payment systems protecting anonymity user possible identify persons break tamper resistant device spend money 
briefly price pay greater flexibility implied including amount fall back security tamper resistant protection passed 
limitation systems noted enhanced flexibility main reason encoding amount furthermore scheme relatively efficient complexity depends complexity creating verifying oe 
application tick payments sufficient full payment done tick user create payee verify store large number pairs oe 
time needed verify payment may exceed time interval allowed 
main advantage systems vanishes comes tick payments 
adding tick payments shall denote security parameter payment scheme assumed polynomial security parameter depend way polynomially related constant 
idea section shows payment system described adapted handle tick payments 
length preserving function maps bit strings bit strings 
denote evaluations 
identity gamma 
moment efficiently computable function shall impose restrictions security reasons way certain sense 
payment system described section 
system extended provide efficient tick payments 
done providing new way encoding amounts message case normal payments encoding amounts unchanged 
tick payments amount encoded follows 
message computed encodes amount 
new message computed denotes concatenation possibly fixed parameter ff computed payer ff ff ff chosen random recall message arbitrary string bits 
case pre paid systems tamper resistant device manages counter defining amounts may spent device computation ff see section 
payer computes oe sends oe 
pair verified normal payment 
payee received payment ticks 
order get payment th tick takes place 
payer sends ff gammai ff recipient 

recipient verifies ff ff gamma ff gamma received previous round ff received 
continue payment ticks 
amount corresponding ticks encoded ff satisfying ff ff ff part received value ff need remembered 
simple variation scheme allows combination normal payments tick payments just encoding non zero amount described 
furthermore tick corresponds unit currency units paid th round sending ff gamma ff security solution shown way certain sense feasible obtain larger amount received payment 
mentioned section payment systems question ways 
bank identify payer payment hold payer responsible paid amount 
case main security concern possible dishonest payee change increase encoded amount payer executed payment transaction properly protocol 
case bank able identify payer tamper resistant unit trusted bank payer decrement counter corresponding amount payment 
case main security concern possible encode different amount tamper resistant device assumption tamper resistant device part protocol properly 
cases assumed ff computed correctly 
security extended system depends security payment system properties consider property payment system described section definition 
payment system security parameter 
system said payee receives payment oe device properly payment protocol deposit received payment encoding device negligible probability probability random choices payment deposit 
ensures amounts information encoded changed 
function way iterates see definition 
length preserving function 
said way iterates probabilistic polynomial time algorithm probability randomly chosen outputs negligible probability choice random coins 
assumption gets input important guess value polynomial length preserving function consider game polynomially bounded parties 
chooses random computes sends 
gamma gamma decides latest sends 
assume value received tg 
outputs 
wins 
lemma 
way iterates polynomial probability wins negligible probability choice random choices 
proof assume polynomially bounded able win probability gammac infinitely values probability outputs pre image non negligible probability choice random choices gammad infinitely values polynomial 
consider 
consider machine finding pre image 
compute gammat 

simulate game 

stops value different algorithm outputs fails 

stops outputs algorithm outputs yb function ir negligible sufficiently large jg gammac algorithm outputs satisfying probability gammad contradict assumption way iterates 
ut technical lemma hard see encoding amounts secure way iterates 
details proposition 
proposition 
payment system satisfies definition way iterates holds negligible probability payee receives amount payment transaction negligible probability obtain amount deposit 
proof payment new system normal tick payment 
case claim follows immediately assumption original system satisfies definition 
assume tick payment transactions payee able cash payment received ticks ticks non negligible probability 
possible construct machine wins game simply simulating payment system payee obtain required pre image 
machine interacting game works follows 
setup simulate entire payment system selecting keys perform protocols described acting payer payee bank 
furthermore choose ng random 

normal payment performed follow payment dishonest payee 

payment tick payment th tick payment value received ff furthermore interact get payment required number ticks 
assume payment ticks 

payment tick payment payment correctly dishonest payee 

payments performed payee tries deposit received tick payments ticks received 
payee able get money ticks th payment messages sent possible find ff ff contained corresponding th payment 
machine outputs gammat gamma 
machine loses game machine output step non negligible probability chosen random polynomial 
property ff ff negligible probability machine output number winning game lemma contradicts way iterates 
ut proposition shows recipient increase received amount 
course decrement corresponding losing coins purse interest 
extended system secure 
variations possible choices previous section shown way iterates solution tick payments secure 
practice derived hash function restricting input bit strings shs bp 
function efficient comes free sense needed implementation payment system 
hash function distributes input sufficiently randomly assumed way iterates practical values alternatively way permutation 
function way iterates polynomial definition uniformly distributed 
leads possibility choosing trapdoor permutation 
tamper resistant device payer knows trapdoor information secret key needed compute gamma payer avoid ff ff 
ff gamma pay tick gamma ff gamma ff gamma pay th tick 
advantage priori upper limit number ticks determined 
furthermore lead better efficiency clear rsa function small public exponent hundreds see suggestions speeding repeated computations way function 
mention replaced group group operation say fi way homomorphism choice wallets observers rsa function candidate 
case observer user choose ff mutually random follows 
observer chooses fi random sends commitment fi fi user 

user chooses fl random sends fl observer 

observer opens commitment fi 
observer user compute ff fi fi fl include pay th tick observer sends fi gammai fi user user verifies fi fi gamma sends ff fi fi gammai fl recipient 
advantage approach observer control number ticks paid user blind numbers sent tick 
variations line systems proposed method applied line systems alternatives possible 
oe verified line payment tick verified line 

oe payment tick verified line 
alternative attractive obtains advantage online security keeping communication requirements independent number ticks paid 
shown tick payments done efficiently payment systems amounts encoded special message payment 
contradictory notion coins obtain property coin systems interesting question similar hack cheque systems refund described cfn 
members protocol group esprit project cafe discussions method 
particular ronald cramer showing initial suggestion independent withdrawal ronald cramer berry schoenmakers cooperation extension wallet observer setting 
rms sutherland 
practical electronic cash system 
manuscript 
bp integrity primitives secure information systems 
lecture notes computer science volume 
eds 
preneel 
bbc 
cramer mj muller pfitzmann de schoenmakers vall waidner 
esprit project cafe high security digital payment systems 
computer security esorics volume lecture notes computer science 
springer verlag 
bc bos chaum 
practical electronic payment system 
technical report cs cwi august 
brands 
untraceable line cash wallet observers 
advances cryptology proceedings crypto lecture notes computer science pages 
springer verlag 
brands 
line electronic cash secret key certificates 
proceedings latin 
available cwi technical report cs 
cfn chaum fiat naor 
untraceable electronic cash 
advances cryptology crypto volume lecture notes computer science pages berlin 
springer verlag 
chaum 
achieving electronic privacy 
scientific american pages august 
dh diffie hellman 
new directions cryptography 
ieee trans 
inform 
theory november 

see www com 
goldreich 
electronic wallet 
advances cryptology proceedings crypto pages 
plenum press 
ferguson 
single term line coins 
advances cryptology proceedings eurocrypt lecture notes computer science pages 
springer verlag 
hauser steiner waidner 
micro payments ikp 
january lamport 
password authentication insecure communication 
communications acm 
levin 
way function pseudorandom generators 
proceedings th annual acm symposium theory computing pages 
merkle 
certified digital signature 
advances cryptology proceedings crypto volume lecture notes computer science pages 
springer verlag 
oo okamoto ohta 
universal electronic cash 
advances cryptology crypto volume lecture notes computer science pages berlin 
springer verlag 
pedersen 
electronic payments small amounts 
technical report daimi pd aarhus university august 
rivest 
md message digest algorithm 
advances cryptology proceedings crypto volume lecture notes computer science pages 
springer verlag 
rs rivest shamir 
simple schemes 
manuscript november rsa rivest shamir adleman 
method obtaining digital signatures public key cryptosystems 
communications acm 
shs specifications secure hash standard 
federal information processing standards publication 
article processed macro package llncs style 
