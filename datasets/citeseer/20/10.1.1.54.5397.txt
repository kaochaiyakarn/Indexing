ieee international conference image processing austin tx november 
design multi dimensional derivative filters eero simoncelli grasp laboratory room computer information science department university pennsylvania philadelphia pa multi dimensional signal processing problems require computation signal gradients directional derivatives 
traditional derivative estimates adjacent central differences inappropriate multi dimensional problems 
replacements traditional operators design set matched pairs derivative filters lowpass prefilters 
demonstrate superiority filters simple difference operators 

wide variety problems multi dimensional signal processing require computation gradients directional derivatives 
typically requirement arises need compute local taylor series expansions characterize signals 
example image processing gradient measurements stage edge detection depth stereo optical flow algorithms 
multi dimensional derivatives usually computed dimensional signal processing differences neighboring sample values typically backward central differences 
derivative estimates highly inaccurate 
especially true applications require computation directional derivatives linear combination axis derivatives components gradient 
replacement traditional sample differences propose matched pairs derivative filters lowpass prefilters 
formulate filter design problem derive set small kernel filters 
demonstrate derivatives computed filters substantially accurate computed standard approaches 

computing derivatives sampled signals assume wish compute derivative sampled signal location sample 
derivative operator linear shift invariant operator may view application signal convolution operation 
derivatives defined continuous functions computation discrete function requires implicitly intermediate interpolation step continuous function 
derivative interpolated function re sampled points original sampling lattice 
sequence operations may written dimensional signal follows dx dx gamma dc dx gamma assume unit sample spacing discrete variables simplicity 
derivative operation equivalent convolution filter sampled derivative continuous interpolation function 
ideal lowpass sinc function function gaussian 
optimal choice depend model original continuous signal bandlimited nyquist limit 
power spectrum model noise sampled signal 
refer interpolation filter prefilter 
practical applications relatively small linear phase derivative kernel 
ideal lowpass prefilter lead infinite size kernel 
non ideal interpolator introduce distortions original signal 
specifically computing derivatives improperly interpolated signal 
situations need comparisons take combinations signal derivative suggests compute convolution signal prefilter 
computed convolution results original derivative original 
example computing directional derivative linear combination axis derivatives 
sense simultaneously design derivative kernel prefilter kernel convolution results proper relationship 

design derivative filters describe filter design problem frequency domain 

discrete time fourier transform prefilter 
derivative filter 
design method attempt meet requirements 
derivative filters approximations derivative prefilter 
derivative axis 

component frequency coordinate direction 

lowpass prefilter linear phase preferably zero phase 

computational efficiency ease design preferable prefilter separable 
case derivatives separable design problem reduced dimension 

design algorithm include model signal noise statistics 

prefilter rotationally symmetric 
attempt achieve rotational symmetry constraint coupled separability force prefilter gaussian 
write weighted squares error function frequency domain follows 
gammaj 
gamma 
frequency weighting function 
designs chosen function roughly mimic expected spectral content natural images 
simple error measure compute solutions analytically avoid complex optimization procedures may get stuck local minima 
particular minimizing kernels may easily eigenvector techniques 
containing prefilter kernel containing derivative filter kernel 
may phase gammaj acceptable producing estimates signal derivative samples 
note kernels need size 
simplicity choose 
write discrete approximation error function fi fi fiw gamma jfi fi fi matrix columns fourier basis functions similar matrix containing fourier basis functions multiplied 
diagonal matrix containing frequency weighting function 
consolidate terms equation follows jm uj wf wf minimizing vector simply minimal eigenvalue eigenvector matrix actual filters renormalizing unit response samples sum 
design technique may readily extended higher order derivatives 

example filter designs designed set filter kernel pairs different sizes method described 
cases computed solution point ffts 
prefilters forced symmetric midpoints 
corresponding derivative filters anti symmetric 
resulting filter taps table 
kernel pair shows fourier magnitude dimensional derivative kernel times fourier magnitude prefilter 
consider example upper left plot 
shows dashed graph fourier magnitude point sample difference derivative operator gamma 
plot show fourier magnitude derivative point averaging operator computed multiplying fourier magnitude function note derivative underestimated low frequencies overestimated high frequencies 
original continuous imagery bandlimited region crossing point curves filters derivative approximations 
course derivative filter may rescaled improve estimates particular frequency standard choice gamma done adaptively matched signal spectrum improve situation 
filter matched pairs prefilter derivative kernels 
shown half taps filter determined symmetry 
prefilters symmetric derivative filters anti symmetric 
length kernels anti symmetric gamma odd length filters anti symmetric 
illustration tap upper left tap upper right tap lower left tap lower right derivative prefilter pairs 
shown magnitude fourier transforms range gamma 
derivative kernel dashed line frequency domain derivative prefilter fourier magnitude multiplied 
perfect derivative prefilter pairs curves coincide 
note matches substantially worsened perform prefiltering impulse prefilter kernel 
authors pointed derivative techniques inaccurate robust noise 
example kearney noted optical flow algorithms perform poorly highly textured regions image 
believe primarily due choice standard differencing prefilter derivative pair 
gradient approaches shown surpass optical flow techniques accuracy 
considering notice tap filter substantially accurate tap filter 
accuracy improves tap filters 

experimental results tested filters designed simple orientation estimation task 
generated images containing sinusoidal grating patterns varying spatial frequency orientation 
pattern computed gradient separable convolution derivative prefilter pair 
example derivative computed convolving vertical direction prefilter horizontal direction derivative filter 
derivative measurements compute squares estimate orientation pattern 
error function written cos sin derivative image derivative image summation image pixels 
solve maximizing unit vector cos sin standard eigenvector techniques solve orientation 
errors orientation estimation function pattern orientation shown 
errors function pattern spatial frequency shown 
note errors unacceptable tap filter pair rapidly improve increase size kernels 
tested filters described applications estimating local orientation images cf freeman adelson optical flow estimation 
due space constraints results elaborated 
indicate substantial improvements conventional derivative measurements predicted plots 
barron fleet beauchemin 
performance optical flow techniques 
technical report rpl tr queen university kingston ontario robotics perception laboratory technical report july 
carlsson 
optimal stochastic signal models 
ieee trans 
signal proc february 
freeman adelson 
design steerable filters 
ieee pat 
anal 
mach 
intell 
kearney thompson boley 
optical flow estimation error analysis gradient methods local optimization 
ieee pat 
anal 
mach 
intell 
simoncelli 
distributed analysis representation visual motion 
phd thesis massachusetts institute technology department electrical engineering computer science cambridge ma january 
available mit media laboratory vision modeling technical report 
test rotation invariance filter pairs shown 
plot orientation estimation error radians function pattern orientation set pattern orientations ranging gamma axis labels arbitrary 
spatial frequency held constant 
test scale invariance filter pairs shown 
plot orientation estimation error radians function pattern spatial frequency set pattern frequencies ranging axis labels arbitrary 
orientation held constant 
horizontal lines provide zero error 
errata frequency weighting function equation giving squares error squared 
gammaj 
gamma 
