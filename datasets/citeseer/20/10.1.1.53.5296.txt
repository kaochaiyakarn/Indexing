technical report architecture design scalable intrusion detection system emerging network infrastructure darpa order number issued rome lab contract number submitted april frank jou felix wu gong rance cleaveland dept computer science information technologies division north carolina state university research triangle park raleigh contents background organization intrusion detection system architecture architecture overview components local subsystem interception redirection module prevention module detection module statistical analysis module protocol analysis module local decision module information abstraction module iam jinao management information base remote subsystem management information exchange protocol interfaces modules design objectives comprehensiveness scalability interoperability functional description local subsystem interception redirection module prevention module prevention layer extraction layer detection module statistical analysis module components statistical approach computing statistics intensity measures computing statistics audit record distribution measures computing frequency distribution deriving intensity measures deriving audit record distribution measure training updating protocol analysis module overview interface implementation local decision module ldecm functional description examples exceptions errors remarks information abstraction module iam iam functions local detection information aggregation periodic checking propagation global information interface mechanisms formats scope impact representation management information base mib management information exchange protocol remote jinao management applications ii list tables iii list figures ji system architecture 
packet formats protocol layers 
interception prevention modules relationship 
figurative description catch trap 
iv design scalable intrusion detection system emerging network infrastructure document describes design scalable intrusion detection system funded darpa contract 

year project aims designing developing software system protecting intruders breaking network routers switches network management channels 
project joint collaboration north carolina state university ncsu 
increasing popularity internet intrusion incidents common events life 
incidents simply innocuous curiosity 
due malicious attempts order compromise availability information system integrity privacy information 
despite best efforts protocol designers implementors system administrators prudent assume attacks occur unfortunately succeed 
vitally important develop means automatically detect respond attacks order maintain critical information services 
depending goals intruder targets attack may range individual hosts network routers switches 
project focus effort protection network infrastructure attacks routers switches potential disrupting large scale information services national defense economy may depend 
goal designing detection system provide comprehensive approach leverages application novel detection techniques extension existing host intrusion detection methods internetworking environment 
particular conduct logical statistical analysis network routing management protocols construct scalable distributed intrusion detection system emerging internetwork environment 
background intrusive activity occurring computer systems 
reports frequently appear media outsiders breaking computers employees computers rogue viruses worms penetrating computer systems 
due incidents seen growing interest computer system intrusion detection years 
earliest area study jim anderson 
anderson categorized threats ffl masquerader individual authorized computer penetrates system access controls exploit legitimate user account 
ffl legitimate user accesses data programs resources access authorized authorized access privileges 
ffl users individual supervisory control system uses control evade auditing access controls suppress audit collection altogether 
anderson suggested masqueraders detected auditing failed login attempts observing departures established patterns individual users 
detected observing failed access attempts files programs resources 
suggestion detecting user monitor certain system wide parameters cpu memory disk activity compare historically established usual normal facility 
approaches adopted way subsequent studies 
dorothy denning colleagues sri international undertook project developing intrusion detection expert system ides prototype 
denning proposed monitor standard operations target system deviations usage 
early research tried define activities statistical measures best suited detection 
teresa lunt colleagues continue research development ides system 
expanded original concept adding expert system component addresses known suspected security flaws target system 
ides follow generation ides nides system research served demonstrate things 
statistical analysis computer system activities provides characterization normal system user behavior activities deviating normal bounds detectable 
second known intrusion scenarios exploitation known system vulnerabilities violations system security policy detectable rule expert system 
early stage intrusion detection system designed analysis single host audit trail 
proliferation computer networks intrusion detection systems began extend techniques networks computers 
current network intrusion detection efforts taken approaches 
approach collect data separate hosts network processing centralized intrusion detection system 
approach target network traffic service protocol levels 
effort close second approach exceptions 
interested protecting network infrastructure particularly focus routing management capabilities 
target analysis mainly specific protocol traffic general data traffic 
second proposed protocol analysis approach architecture design unique analyzes logical behavior routing management protocols order identify set states indicative security attacks 
third network management functionalities part integrated system design 
functionalities intrusion detection system incorporated existing management framework extension fault management 
organization section provides overview architecture model intrusion detection system introduce components associated functional requirements 
section outlines design objectives system features experimental system implemented authors 
detailed description functional overview section 
intrusion detection system architecture section overview system architecture design 
system consists complementary functional blocks providing comprehensive detection capabilities 
incorporates standard network management functionalities lay foundation facilitating automated responses research efforts 
brief description system component functional requirements section 
architecture overview illustrates architecture design intrusion detection system 
top level subsystems local detection subsystem remote management subsystem 
remote management unit implements set network management applications probe status issue commands local detection subsystem 
design objectives management applications snmp management function easily incorporated existing snmp network management platform 
local subsystem associated router switch function security filter analyze incoming packets neighbors 
transaction record neighbor maintained separately 
neighbor routers switches behaves differently historical norm transitions improper protocol state may indication neighbor faulty compromised 
depending degree deviation nature fault attack alert alarm signal issued acquire security officer attention 
remote management subsystem oversee routers switches 
intrusions attack may difficult detect local level easier checking global status routers switches 
scope project expect detection analysis functions implemented local subsystem extended global level correlate intrusion events routers 
management capability snmp framework logically extended management nodes hierarchical fashion establish status map autonomous system 
components functional requirements components shown described sections 
local subsystem local subsystem consists modules interception redirection module rulebased prevention module protocol statistical detection modules decision module information abstraction module 
includes management information base mib remote mib agent functions provide access remote management applications 
brief description module follows 
remote mib agent management information base local decision module statistical analysis protocol analysis local detection module prevention module rule protocol engine network remote management applications management remote management applications management remote mib agent security officer local jinao local jinao protocol data unit agent extension protocol interception module statistical analysis protocol analysis statistical analysis protocol analysis information abstraction module ji system architecture 
interception redirection module responsibility interception module redirect target protocol information flow prevention layer rule checking 
possible redirected information flow timestamped 
receiving clear signal prevention module interception module release packet protocol engine execution 
interception module facilitate capability active intrusion detection catch trap explained section holding outgoing packet temporarily 
prevention module name prevention implies module implement small set administrative rules filter packet clear security violation enters router 
intent design module serve gate keeper short response time 
packets discarded include may significant damaging effect infrastructure general security guidelines special security concerns administrative domain 
mechanism module similar small rule expert system conventional intrusion detection system 
detection module packet passes prevention module forwarded protocol engine execution local detection module performs statistical protocol intrusion checks 
results checks sent local decision module 
shown architecture allows way interaction prevention detection modules decision module 
specifically allows set checking rules associated parameters prevention detection modules dynamically modified decision information response input detection information 
decision information derived input detection modules come global detection module remote management applications mib interface 
design allow certain degree automated responses adoption network management framework 
statistical analysis module intrusion detection statistical analysis founded contention behavioral signatures exist users usage profiles protocol execution patterns case network routing management protocols intrusion result abnormal signatures 
behavior deviating normal signature considered anomaly appropriate alarms triggered 
module provides capability detect intrusions exploit previously unknown vulnerabilities 
intended uncover attacks prevented set rules embedded rule component detected security analysis conducted protocol approach 
protocol analysis module protocol approach detects intrusion monitoring execution protocols router triggering intrusion alarms anomalous state entered 
specifically investigate routing protocols ospf pnni contingent availability public domain implementation pnni routing software network management information exchange protocol snmp 
ospf expected eventually replace rip primary choice interior gateway protocol pnni standardized routing protocol private atm networks 
snmp standard track internet network management protocol 
standardization snmpv currently progress ietf 
vulnerabilities protocols reported proposal 
continue effort identify potential security weaknesses propose possible attack scenarios 
local decision module decision module hand serves coordinator correlate information prevention detection modules determining intrusion occurred actions need taken 
issues commands update activate rules prevention module modify parameters options local detection modules 
local remote mib agents decision module provides local view neighbor status remote management applications identifying global scale attacks 
relays commands remote management applications local prevention module detection modules 
information abstraction module iam iam serves interface module jinao local intrusion detection subsystem remote jinao modules network management applications 
propagating local intrusion detection results outside iam aggregates local detection results converts mib format 
updating local detection prevention modules new rule sets local decision module iam receives processes requests remote subsystems jinao mib interface 
jinao management information base part network management framework jinao management information base collection mib variables interest remote management subsystems 
jinao mib variables include detection results decision information rule finite state machine configurations log access security control options 
mib variables readable writable conceptually representing interface security control management operations 
remote subsystem current scope project remote subsystem consists set management applications monitoring controlling local detection subsystems 
expected management application able re configure local detection system dynamically 
configurability local detection subsystem respond intrusion differently different situations 
ideally natural extension current scope project expect remote subsystem implement similar detection capabilities order detect larger scale orchestrated attack 
realize attacks instance door knob attack detected global scale 
approach dealing attacks management applications communicate local detection agents order form global view domain surrounding remote subsystem 
notion global detection extended cover remote subsystem distributed hierarchical fashion 
management information exchange protocol management information exchange protocol snmp provides communication channels remote management applications local mib agents manager agent pair remote subsystems manager manager 
allows management applications access local mib variables control execution protocol engines modify operation local detection system 
local mib agent issue trap command get management application attention special event occurs 
remote subsystems establish global view network exchanging detection information domains 
remote subsystems organized distributed fashion communication manager manager operation 
communication manager agent operation system hierarchical architecture 
mib agent sub divided different types master agent single processing entity sends receives snmp protocol messages agent role typically little direct access management information mib variables 
remote management applications talk snmp directly master agent 
zero processing entities called shielded snmp pdus processed master agent access management information 
master agent communicates agent extension protocols 
interfaces modules section describe communication interfaces component modules terms message format content 
information exchange modules done message passing 
module maintain message queue modules deposit messages 
incoming protocol message tagged stored message pool retrieval 
ensure proper communication modules message include source id related authentication information applicable 
instance consecutive modules executed process authentication modules may issue 
modules distributed different processes platforms information id provided facilitating authentication 
module interfaces module maintain separate input queue module 
enable implement priority mechanisms desired process messages certain modules 
input queue serve means identify module originated message 
input interface network module jinao prevention module 
input message prevention module include fields protocol data unit pdu length pdu timestamp pdu packet passes prevention rule checking sent protocol engine execution 
protocol data unit pdu length pdu routing packet passes prevention module forwarded detection modules examination 
message include original routing packet information plus information rendered prevention module 
prevention module statistical analysis module message format contain information forwarded triggered rule object id triggered rule applied similarly message format prevention module protocol analysis module include fields forwarded triggered rule object id triggered rule applied ldecm checking result prevention module forwarded local decision module facilitate decision making 
ldecm triggered rule object id triggered rule applied ldecm message received prevention module processed parallel statistical analysis module protocol analysis module 
analysis results modules sent decision module determine action needs taken 
message format defined module respectively 
interface statistical analysis module local decision module message include fields ldecm timestamp arriving decision detection output normal alert alarm source detection output type 
specific information list parameters involved alarm similarly message protocol analysis module local decision module information elements ldecm timestamp arriving decision detection output normal fault intrusion detected source detection output type 
specific information pair detection output provide detailed information support detection output rendered module 
case statistical analysis information may include list parameters associated ranges involved alarm just issued 
protocol analysis information may list input pdus reflects sequence events considered attempt intrusion 
ldecm message sent decision module prevention module insert delete activate deactivate certain rule 
ldecm command insert delete activate deactivate command dependent information rules involved timestamp message field command dependent information may related setting new threshold choosing specific mode parameter 
ldecm similar case able dynamically modify range certain parameter statistical module import new detecting sequences protocol analysis module 
message decision module statistical module fields ldecm command command dependent information timestamp message command dependent information may include array parameters associated ranges 
similarly decision module protocol analysis module message include ldecm command command dependent information timestamp message command dependent information may include table finite state machine representing new detecting sequence 
ldecm iam decision module information abstraction module message contain elements ldecm iam ldecm ldecm prot ldecm type decision normal fault intrusion decision timestamp ldecm interface take form function call 
function call provide mechanism query set various protocol defined options 
exact format general depend specific protocol implementation 
ldecm communication decision module security officer take form notification electronic mail graphical user interface 
gui permit display appropriate alarm alert message relevant information 
iam ldecm information abstraction module decision module message format iam ldecm message timestamp destination module stats protocol prevention protocol engine type global info intrusion info configuration info type specific data intrusion fault scope impact actions command new rule set add remove rules iam mib information abstraction module jinao mib message includes information iam mib aggregate flag aggregation flag local decision timestamp decision input info corresponding ldecm input decision output info normal fault intrusion aggregation flag time interval observation holds local decision timestamp decision input info corresponding ldecm input decision output info normal fault intrusion decision scope impact discussion scope impact section functional description section 
mib iam jinao mib iam mib information includes mib iam global detection results type detection intrusion fault scope impact decision source id source signature management application commands retrieve log interface source id source signature destination module config commands activate deactivate new rule set add remove rules design objectives section discuss objectives guide system design decision 
general want limit amount audit records collected processed overhead intrusion detection kept minimum 
detection capabilities provided non intrusive way target protocols operation 
avoid degradation routing management services desirable able deactivate intrusion detection process necessary 
design agent software modular fashion modification functional extension handled minimum effort 
order correctly interpret utilize design document helpful clearly understand basic assumptions target networking environment exact scope project 
target environment intrusion detection solution prototyped project applied network environment uses ospf routing protocol 
examples environments networks consisting ospf ip routers networks containing autonomous systems ospf protocol networks including atm technologies uses ospf ip level 
threat model assumes ospf routing entities may get compromised ways mis behave consequently may disrupt routing service network 
networking hardware software components may contain fault conditions manifest network operation 
way fault conditions manifest generally unknown best aim intrusion detection able detect manifestations particularly pose threat routing services 
link encryption may may implemented routing entities 
long observe behavior routing information exchange routing protocol level link level encryption irrelevant 
solution assume global collaboration hosts 
recognize orchestrated intrusion attacks detected observation systems unrealistic count global corporations systems 
scope current project solution addresses issue quickly accurately detect conditions routing infrastructure causing disruptions routing services considered potential cause disruptions 
implementing global detection modules part optional tasks project detectable conditions confined manifest local scale specifically observed neighboring entities 
project address issue host intrusions break routing entity 
better host intrusion detection security protection reduce chance routing entity compromised means attack social attack compromised system administrator lead compromises entities 
compromises threat model solution able help detect 
deployment intrusion detection system require installation ji modules routing entity network order operate wider deployment generally affords better detection capability 
comprehensiveness terms protecting system intrusion attacks desirable able detect different kinds attacks known system vulnerabilities exploitation unknown vulnerabilities 
design detection system covers intrusive attempts various time scales 
employment rule statistical approaches system fits criteria due complementary nature detection mechanisms 
rule approaches meant detect attacks known security weaknesses approach able catch attempts exploitation unknown vulnerabilities 
statistical analysis usually requires learning adapting period protocol especially rule approaches short response time 
scalability current scope project focuses development local detection capabilities expect system design easily extended regional global level 
scope project expect detection analysis functions implemented local subsystem extended global level correlate intrusion events routers 
extension global level hierarchical regional management stations aggregate detection information higher level establishing global view routing domain status 
communication extension provided snmp operations 
interoperability expect intrusion detection system part network management framework order best capitalize benefits 
snmp network management information exchange protocol implemented widely deployed existing networks 
snmp industrial de facto standard system able integrated snmp system security applications relative ease 
aspect interoperability including module reusability related questions 
identifying understood building blocks modules intrusion detection systems 
clearly defining functionality interfaces modules 
defining basic protocol inter operation appropriate modules 
currently joint effort address system interoperability module reusability issues darpa ito sponsored projects especially intrusion detection community order fully take advantage investment bring forth better synergistic effect 
architectural design consistent objectives joint effort 
strive clearly define common modules interception detection analysis decision management agent specifying functions interfaces 
member cidf common intrusion detection framework working group expect cidf joint effort progress necessary modifications enhance interoperability reusability system systems 
functional description section describe detail functional modules mentioned section 
local subsystem jinao local subsystem logically resides router just 
consists modules interception redirection module rule prevention module protocol statistical detection modules decision module information abstraction module 
includes management information base mib remote mib agent functions provide access remote management applications 
interception redirection module responsibility interception module redirect target protocol information flow prevention layer 
possible redirected information flow timestamped 
depending target protocols jinao protection interception module placed multiple protocol layers ip ipsec pdus intercepted ip layer 
operating systems linux bsd kernel level ip packet interception supported 
example package flexible implementation firewall mechanisms kernel 
certain ipsec options turned redirect pdus security checks performed ipsec layer 
eliminate immediately pdus violating protection provided ipsec 
device driver network hardware device driver ethernet device driver usually place interception ip packets fragmented large pdus encapsulated tunneled pdus authenticated encrypted pdus 
performing interception level may introduce unnecessary system complexity avoided redirection function unavailable layers 
higher layer protocols necessary perform interception layers ip 
example protecting snmp especially snmpv snmp pdu encrypted 
case intercept pdu flow authentication decryption process 
important requirement approach availability interception interface ip firewall mechanism higher layer 
possible need source code target protocols build 
notice existing protocols snmpv normally pdus encrypted 
interception redirection ip ipsec layer provide snmpv ng pdu snmpv ng pdu enc snmpv ng pdu enc ip snmpv ng pdu enc ip ether snmp ip ipsec network device packet formats protocol layers 
protocol information ids 
newer progress protocols encryption implementation mandatory option option implementation engine mandatory 
little valuable information derived ip ipsec layer 
bring important suggestion standard committee protocols assuming progress consider interception interface protocol 
example working group ietf just started current framework document drafts consider intrusion detection firewall mechanisms 
deployment products difficult consistently intercept snmp pdus active real time intrusion detection firewall protection 
currently working group considering logging facility useful passive offline intrusion detection 
feel simple logging sufficient protect target protocols 
principle apply progress networking protocols potentially interested protecting 
case routing services ospf protocol runs directly ip place interception function ip kernel space implement ospf user space 
mentioned earlier interception prevention modules acting firewall filter packet clear security violation 
putting firewall right ip kernel space allows protect set applications gated snmp modifying source codes 
done notion dynamic module loading supported linux bsd 
quite powerful flexible 
intend experiment approaches 
prevention module prevention module bridging component jinao ids agent target protocols protected jinao 
hand prevention module virtually inserted raw original target protocol information flow intercept screen protocol data units pdu 
hand prevention module offers jinao formatted information detection module protocol statistical analysis 
prevention module programmable control interface activation deactivation dynamic configuration 
prevention module separated different prevention layer extraction layer shown 
prevention layer redirected pdu flow interception module input prevention layer 
prevention layer main objective decide pdu flow back target protocol engine 
small number rules check pdu flow 
example rule specified pdus originator address xyz received eth interface forwarded ospf engine gated program 
quick decision forwarding pdu key design objective layer 
main reason purposely put layer extraction 
rule set examine raw information interception module immediately forwards valid pdus back target protocol engine 
target protocol engine observe significant delay receiving pdus 
hand real implementation layers interception module merged better performance 
decision module interact layer controlling rule set 
rules dynamically loaded unloaded activated deactivated 
flexible control interface decision module prevention layer enable run time prevention 
notice rejected pdu forwarded interesting detection module 
rule specify things 
pdu forwarded protocol engine 

pdu forwarded detection module 
answer question original pdu sent back protocol engine 
answer second question copy pdu passed extraction layer 
extraction layer information expected detection module follow formats describe 
layer main objective transform raw information jinao information pdus accepted detection module generic interface 
necessary layer correlate multiple different raw pdus multiple interception points generate single jinao pdu 
practical example related information regarding hardware interface pdu interception layer snmp ospf ip ipsec net dev prevention layer extraction layer prevention module rule set detection module decision module possible interception points interception prevention modules relationship 
received 
feel information valuable detect certain spoofing attacks collect little tricky 
depending network protocol stack implementation information ip layer 
node ip packet travel device interface 
example encapsulated packet pass dev eth dev tunnel case need record interfaces particular packet 
furthermore mentioned application layer encrypted pdus intercepted application layer 
application layer device interface information decrypted pdus lost 
recover device interface information pdu eth tunnel need possibly intercept encrypted version packet interception point ip 
represent logically single pdu 
correlated treated 
detection module incoming packet passes rule checking forwarded parallel protocol engine execution detection module analysis 
statistical analysis module area computer security statistical analysis reported various projects literature example nides project sri wisdom sense los alamos national laboratory haystack project haystack laboratories 
examples nides project sri extensive scope development 
complete available general public 
understanding statistical analysis general applicability adapt nides statistical algorithm approach starting point modify necessary 
basic statistical approach compare subject short term behavior subject historical long term behavior 
subject context dependent user computer system credit card holder neighbor routers case project 
comparing short term behavior long term behavior statistical component concerned long term behaviors appear short term behavior short term behaviors typical long term behavior 
short term behavior sufficiently long term behavior warning flag raised 
general short term behavior somewhat different long term behavior short term behavior concentrated specific activities long term behavior distributed activities 
accommodate expected deviation short term long term behavior statistical component account amount deviation seen past subject short term behaviors long term behaviors 
statistical component issues warning current short term behavior long term behavior relative amount deviation types behaviors seen past 
feature revisited explain computational aspect 
sections introduce major components algorithm describe scoring statistics computational process 
components statistical approach section introduce major components statistical approach includes various measures half life updating short term long term probability distributions scoring statistics computational algorithm obtaining statistics 
ffl measures aspects subject behavior represented measures packet lsa arrival frequencies terms types sources 
measure construct probability distribution short term long term behaviors 
example packet types received long term probability distribution consist historical probabilities different types packets received short term probability distribution consist probabilities different types packets received 
case categories probabilities attached names packet types learned system received 
classified ji measures groups activity intensity audit record distribution measures 
types measures serve different dimensional purposes 
activity intensity measures determine volume general activity generated past depending half life measure past corresponds time span half normal 
measures detect bursts activity prolonged activity abnormal primarily volume audit data generated 
audit record distribution measure determines observed activity say audit records received types actions generated neighbors normal 
example find routing packets received contained hello packets database description packets link state request packets link state update packets packets 
data compared profile previous activity generated months determine distribution activity types generated past audit records unusual 
ffl half life specification half life determine number audit records days audit record activity constitute short term long term behavior 
long term probability distributions experience nides suggests set half life profile updates typically performed daily 
setting audit records gathered updates past contribute half weight probability distribution records 
audit records gathered updates past contribute quarter weight forth 
days activity contribute distant days activity eventually long term profile forgets distant behavior 
long term profile long term aging factor applied historical data update new information folded 
short term profile short term aging factor applied profile audit record current audit record folded 
ffl statistics audit record generated subject statistical module generates single test statistic value denoted summarizes degree abnormality subject behavior near past 
statistic summary judgement abnormality measures taken aggregate 
suppose constituent measures denoted measure degree abnormality behavior regard specific feature 
statistic set equal sum squares ffl statistic degree difference long term profile short term profile measure quantified chi square statistic comparing observation short term profile expectation long term profile 
resultant numerical value call nides 
measure derived corresponding statistic 
fact measure normalizing transformation statistic degree abnormality different types measures added comparable basis 
different methods transforming statistics values 
method computing values fo corresponding intensity measures second method computing values corresponding audit record distribution measures 
computation statistics transformations statistics explained sections 
computing statistics intensity measures neighbor router brought audited router history 
consequently choose convenient value statistic history 
instance initially measure zero value close mean value routers 
statistic intensities updated time new audit record generated 
value th audit record value th audit record 
formula updating gammar gammat ffl variable represents timestamp th audit record 
ffl decay rate determines half life measure large values imply value primarily influenced audit records 
small values decay rate imply heavily influenced audit records distant past 
example half life minutes corresponds value gamma log 
security officer may set half life intensity measures values feels appropriate 
sum audit record activity entire past activities exponentially weighted current activity greater impact sum 
statistic near past behavior distant past behavior 
important property statistic necessary keep extensive information past update noted intensity measures clock time unit age calculated 
important intent measure assess extent bursts activity normal 
computing statistics audit record distribution measures suppose established activity types 
activity calculate long term historical relative frequency occurrence denoted fm activity type 
instance suppose months received packets hello packet type 
fm hello packet type 
algorithm compute fm th day equal gammab gammaj decay factor similar defined number packets received th day indicate th packet type received 
exponentially weighted total number audit records occurred router monitored 
gammar gammaj number packets received th day 
statistic compares short term distribution types packets received long term distribution types 
simplest situation value statistic th packet received defined follows gamma fm vm relative frequency th packet type received past ends th packet vm approximate variance view short term profile audit record distribution fm long term profile audit record distribution larger distribution packet types past differs substantially historical distribution packet types substantially measured terms statistical variability introduced near past contains relatively small sample size 
value formula gammar gammaj recursion gammar gamma th audit record indicates packet type received 
decay rate determines half life statistic 
sample size statistic formula gammar gammaj value vm formula vm fm gamma fm computing frequency distribution step calculating historical probability distribution define bins classified 
bins statistic 
max maximum value expect see maximum value depends particular types measures considered 
cut points bins defined linear geometric scal 
example geometric scale bin extends max bin extends max max bin extends max infinity 
pm denote relative frequency th interval bin 
statistic evaluated packet received value changed 
formula calculating pm th day router brought gammab gammaj number days occurred router monitored number audit records th day th bin exponentially weighted total number audit records occurred router monitored 
formula gammab gammaj number packets received th day 
computations simplified recursion formulas gammab gamma gamma gammab gamma updated day keep running totals day 
deriving intensity measures intensity measures value corresponding current packet represents number packets received past 
past corresponds minutes statistic half life minute hours statistic half life hour 
addition knowing current value statistical module maintains historical profile previous values current value compared historical profile determine current value anomalous 
transformation intensity measures requires knowledge historical distribution obtained section 
example find historical distribution intensity measures half life minute ffl values interval packets ffl interval ffl interval ffl interval ffl interval ffl interval statistic large value statistic interval larger relatively unusual value value occurred historically 
statistic close zero interval relatively frequently seen values algorithm deriving values statistics intensity measures follows 
pm denote relative frequency belongs th interval 
previous example interval corresponding value equals 
values pm 

th interval prob denote sum pm values smaller equal pm magnitude 
example prob interval equal 

th interval value probability normally distributed variable mean variance larger absolute value equals prob value satisfies equation jn prob phi gamma gamma prob phi cumulative distribution function variable 
example prob set equal prob equal set equal 

suppose processing audit record find value th interval set equal deriving audit record distribution measure audit record distribution measures compares short term behavior long term behavior measures extent composition records consistent long term composition 
intensity measures calculate long term profile intervals audit record distribution 
range values expressed terms degree similarity short term profile long term profile larger numbers representing similarity 
difference way defined intensity measures audit record distribution measures transformation slightly different audit record distribution measures 
prob pm pm previous example prob value interval equal 
cases simple mapping percentiles distribution percentiles half normal distribution 
practice tail probability calculation done update time daily 
interval associated single value interval takes corresponding value 
training updating training process statistical component learns normal activity subject 
consists category training component learns observed categories measure training system builds empirical distribution statistic measures measure difference long short term profiles training system establishes threshold measure statistic collected active measures 
phases minimum training period anomaly scoring begins 
training continues steady state permitting degree adaptation new behavior subject 
initially component training long term profiles created 
new profile long term short term created new subject encountered 
statistical analysis module continue train recording updating subject behavior subject long term profile 
subject long term profile considered trained measure gone training phases 
point anomalies may reported 
nides experience number updates required complete training phase training period default updates divided number phases rounded nearest number 
default training phase requires updates complete 
protocol analysis module overview protocol analysis module pam uses message traffic knowledge protocol engine detect intruder attempting attack 
pam detects attack sends alarm message local decision module describing attack containing sequence messages determining attack took place 
interface pam serves stream processor accepts stream inputs delivers stream outputs 
input submodule local detection module pam accepts kinds input packets pdu ldecm 
kinds inputs require different responses 
ffl packets form pdu come local prevention module lpm contain message network flag indicating lpm forwarded message protocol engine dropped 
pam uses packets track possibility intrusions 
ffl packets form ldecm come local decision module ldecm contain commands alter intrusions tracked pam 
current design commands consist requests add remove finite state machines collection maintained pam issue explained detail 
output pam generates output packets type ldecm 
fields packets contain 
ffl protocol id indicator protocol intrusion detected general ji able detect intrusions different protocols simultaneously ffl alarm indicator type intrusion detected 
ffl pdu list list pointers messages led detection intrusion 
implementation overview pam maintain collection finite state machines fsms protocol jinao capable monitoring 
fsm detect kind intrusion constructed line manner described section 
control flow system follows 
receiving input pam examine type 
pdu packet pam 

forwarding flag false processing performed packet forwarded protocol engine 

flag true pam perform fsm currently maintaining 
fsm current state updated form network message contained state changes inserted fsm message queue 
fsm new state initial state queue flushed attack underway case 
fsm current state indicates attack taken place output packet type ldecm generated fields initialized follows 
ffl protocol identifier copied ffl detection output initialized kind intrusion detected 
ffl message list set contents fsm queue 
ii 
message queue flushed 
iii 
fsm state reset start state 
iv 
output 
hand type ldecm pam engage 

command contained delete command command specific information includes descriptor fsms maintained pam 
case relevant fsm message queue removed 

command insert command command specific information includes descriptor new fsm maintained pam protocol identifier indicating protocol fsm intended associated 
case fsm inserted list fsms pam maintains new message queue machine 
commands contain invalid arguments ignored 
example illustrate intrusion tracking pam undertake consider attack arise adjacency establishment phase ospf protocol 
phase protocol routers attempt establish adjacency relationship eventually broadcast relevant parts rest network 
ensuring capable communicating hello protocol routers negotiate respective master slave status sequence number 
master transmits routing database slave database description dd packets tagged sequence number slave acknowledge 
attack involve intruder attempting masquerade master intent corrupting existing master database 
attempt occurs negotiation master slave relationship attempt detected 
relevant fsm detecting intrusion states behave follows 
start state represents situation master slave relationship exists 
inputs ignored involved hello protocol 
attempt init way states associated hello protocol behavior states exactly described ospf definition 
state arrival dd packet neighbor analyzed determine neighbor router master 
router enter state master enter state slave 
master state incoming dd packets 
fail sequence number incoming packet fails match current sequence number 
case enter alarm 
alarm intrusion detected 
couple things noted example 
firstly require fsm potential adjacent router fsm detects intrusion form router corrupted 
secondly description implicit counters difficult encode pure fsms 
implications representation fsms 
details chief goals ji project ji provide extensibility easy adjust kinds intrusions tracked 
requirement implications pam 

pam reconfigurable run time particular users able add remove fsms new types intrusions concern old types cease 

adding fsms require recompilation pam 
accommodate concerns envisage table driven implementation fsms generic driver routine 
adding new fsm amounts defining table loading pam driver routine compiled pam handle execution fsm 
describe concepts turn 
traditional tabular representation fsm row table represents state column represents input 
th element table means fsm state input arrives new current state states usually encoded integers range gamma total number states 
efficiency reasons propose modification scheme 
usual case states represented integers range gamma associating row table integer associate pointer function 
function take input network message compute new state transition 
allow fsms represented internally arrays pointers functions 
driver routine maintain linked list cell contain 
ffl protocol id ffl fsm 
ffl integer containing current state fsm 
ffl message queue fsm 
ffl alarm type tracked fsm 
receiving input driver routine scan linked list 
cell protocol id matches contained driver look function associated current state apply network message compute new state 
new state old state processing stops new state differs old state current state updated inserted message queue 
new state alarm state assumed state gamma appropriate output generated current state reset start state assumed 
order add new fsm user local decision module may 

design desired fsm 

implement functions processing inputs 

store representations pointers functions file 

dynamically link code containing input processing functions pam 

send type ldecm containing machine description pam 
designing fsms describe fsms module designed 
envisage approach abstracting fsm describing protocol 
general idea 

formalize section protocol affected intrusion question fsm 
done protocol definition modern protocol standards usually include fsms 

identify states messages cause fsm deviate normal functioning evident intrusion general 

hide transitions involving messages appear path start state states mentioned 

include transitions states mentioned alarm state 

efficiency minimize resulting fsm compact possible 
assist task concurrency workbench cwb tool developed ncsu analyzing correctness networks communicating fsms see www ncsu edu rance www cwb nc html details 
purposes cwb provides capabilities plan 
transition hiding labels transitions may hidden converted empty labels 
fsm minimization fsms minimized eliminate redundant states 
fsm determinization nondeterministic fsms converted deterministic ones 
propose features produce fsms pam 
local decision module ldecm ldecm required order correlate detection information provided protocol statistical analysis modules information may possess interaction global detection module decision intrusion taken place 
functionally local decision module interfaces detection modules local mib agent software 
receives input detection modules regarding local intrusion activity inferred observing neighbor behavior 
interacts local mib agent gather intrusion detection information obtained remote jinao agents uses conjunction data reported detection modules decisions intrusion 
interacts protocol engine take appropriate steps intrusion detected 
functional description key functions local decision module 
local decisions intrusion data detection modules information remote agents primary function ldecm 
stated earlier protocol statistical analysis modules look network behavior independently 
incoming routing traffic analyzed modules signs potential fault intrusion 
cases modules may able decision intrusion independently 
cases information modules needs correlated global information informed accurate decision outlined section 

provide information iam efficient detect intrusions locally far possible cases global agent determination intrusion taken place information gathered local jinao decision modules 
accomplished system specified jinao mib 
remote management subsystem issue snmp get requests information maintained ldecm want receive snmp traps certain events happen 
ldecm needs provide operations support requests jinao mib variables owns 

propagate changes mib information indicated detection prevention modules important features jinao system adaptive changing network conditions configurations 
implies set rules prevention module operates threshold parameters statistical module uses distinguish normal abnormal behavior set minimum detecting sequences employed protocol analysis module may need changed dynamically response changing network conditions 
instance new point network connectivity come normal traffic profiles need modified account traffic new connection 
new attack discovered prevented implementing new set rules rule base prevention module need updated 
jinao agents updated central location jinao mib 
ldecm propagate information affecting behavior various detection modules modules requests remote security management applications 
addition decision arrives ldecm initiate changes 
instance detected suspicious activity activate additional rules prevention module adjust thresholds statistical module 

inform local protocol engine event intrusion detected ldecm interacts protocol engine order take appropriate action intrusion suspected detected 
instance suspicious activity detected may instruct protocol engine turn certain special modes operation detailed logging messages protocol events log information relating route updates modifications 
ldecm take appropriate defensive measures 
include turning interface router connected interface detected faulty compromised issuing commands undo effects route update messages compromised router 

notify security officer appropriate management entity faults intrusion detection detection fault intrusion ldecm take steps notify appropriate network security personnel 
done gui fault intrusion information visible security personnel terminal 
critical events notification performed electronic mail 
periodic log information maintained regular basis daily weekly 
monthly reviewed suspicious activity 
examples example protocol statistical modules say intrusion consider network containing routers part network routers belong different regions far power supply concerned 
consider situation power outage portion network affecting router response protocol messages protocol analysis module router conclude neighboring router faulty compromised 
statistical analysis module notice message rate particular router dropped zero different normal profile router 
conclude router faulty compromised 
case protocol statistical modules report local decision module indicating fault intrusion condition 
local decision module aware remote agent power outage region containing router look region router belonged infer subject power outage 
decide apparent anomalous behavior router due power outage ignore detection information protocol statistical analysis modules 
incorporated software set known existing network faults checked making decision intrusion 
case ldecm instruct statistical protocol analysis modules cease monitoring router notification 
exceptions errors exceptions prevention detection modules response parameter update create message 
errors unrecognized message format message tag points non existent message null rule id reported prevention module exist decision module copy rule base 
remarks fact local decision module uses information disseminated remote jinao agents order decision intrusion leads scalable architecture 
converse situation local agents forward detection information global agent order global agent decision global agent centralized decision maker architecture scale 
system global information utilized locally globally aware local decision regarding intrusion 
architecture provides monitoring attacks detected higher network level 
system adaptive changing network conditions parameter values thresholds various detection modules dynamically changed new rules added existing rules deleted 
information abstraction module iam iam functions iam serves interface module jinao local intrusion detection subsystem remote jinao modules network management applications 
propagating local intrusion detection results outside iam aggregates local detection results converts mib format 
updating local detection prevention modules new rule sets iam receives processes requests remote subsystems jinao mib interface 
local detection information aggregation mib fication iam receives local detection decisions detection information local observation ldecm 
performs simple data reduction run length coding scheme long sequences repeated information 
reduced data converted mib format put jinao mib management applications remote intrusion detection modules 
example input ldecm includes information 
message input detection modules ldecm 
local detection decision intrusion fault normal 
normal conditions may repeated messages detection decision reporting normal situation 
iam able reduce repeated messages single message indicating normal condition lasted certain time period 
similarly reduction possible reporting persistent fault intrusion conditions 
periodic checking propagation global information potential important role iam monitor new information remote jinao mibs global intrusion detection system 
information available iam retrieve remote global convert format expected ldecm pass ldecm 
interface mechanisms formats information exchange interface iam ldecm expected message queues implementation 
particular module input queue input interface modules supplying inputs deposit messages 
receiving module remove messages queues act accordingly 
interface formats please see section 
scope impact representation section entry iam mib conveys scope impact decision module 
discussion order 
scope impact information set distributed jinao decision modules order better enhance accuracy intrusion detection decisions 
example ffl local decision module ldecm may global information power outage reduce false alarm rate respect neighbor router knows neighbor falls scope impact outage ffl higher level decision module access observations larger topological region correlate multiple detections lower levels respective scope impact reach accurate detection decision 
support objective scalable intrusion detection capability important include topological information routers affected part scope impact data 
reasonable representation graph identifies routers nodes links edges unique identifiers routers 
addition include information ospf adjacency data structure 
information useful making intrusion detection decisions general 
allow possibility topological information compiled different time detection decision need timestamp associated topology graph 
timestamp associated detection decision sufficient 
management information base mib jinao management information base standard abstraction interface jinao agent management applications interested utilizing intrusion detection services provided jinao 
management applications discussed section interact mib snmp engine 
engine receive process snmp pdus forward appropriately different mibs 
possible snmp engine communicate mib module called agent extension protocols 
words mib access request shown pass snmp channel pass agent channel get target mib 
currently agent extension protocols defined 
includes different sections rule fsm configuration rules fsms prevention module local detection module dynamically loadable trusted remote management application 
specification provide interface support feature 
rule prevention represented mib table entry set attributes 
accessing attributes activate deactivate rule 
possible adjust thresholds rules 
rule table entries placed table called 
similarly table called fsms local detection module 
please note snmp support direct table entry insertion deletion 
mib variable indirectly achieve unsupported operations 
furthermore expecting secure version snmp snmpv snmpv ng 
need worry authentication integrity access control 
mib variables restricted trusted security managers 
allow normal users having read access rule fsm tables 
allow happen potential intruder know attacks jinao trying prevent protect avoid detected 
access jinao mib authenticated encrypted 
local detection results local decision module performing analysis events messages decisions certain intrusion attacks happened 
information valuable accessed trusted security management applications mib interface 
piece information represented jinao report table entry 
reports form 
table updated jinao decision module periodically reflect health neighbor routers real time 
table read snmp interface 
access information authenticated encrypted message channel appropriate access control 
detection notifications particular trusted security management application interested knowing particular type report updated mib 
traps event notifications useful situation 
jinao security management application express interest certain types information snmp mib interface 
jinao agent receiving request start generate traps events application event occurs 
security control security control actions achieved inserting deleting rules fsms rule fsm configuration mib section 
cases provide control interfaces achieve goal 
example security control console directly connected local decision module 
trusted system administrator console access jinao information control system directly 
remote management module want directly notify administrator mib interface 
log access prevention module selected pdus logged audit trail 
logged pdus may valuable line analysis accessed snmp protocol 
apparently unrealistic provide unique object identity individual record 
search query engine directly working log database necessary 
merely snmp mib interface control search query engine 
example management application interested receiving ospf pdus originated particular router snmp set get interface submit query search engine 
search engine retrieve matched entries put table called 
requesting security management application snmp get getnext retrieve records table 
management information exchange protocol interoperability chose snmp management information protocol exchange control management information distributed entities jinao system 
current standardized version snmp version secure security concern version 
proposals snmpv security snmpv snmpv 
new ietf working group simple network management protocol generation just established march 
mission working group unify different security proposals come simple secure snmp framework 
current framework supports levels security message level security local process access control 
concerns secure authentication integrity privacy channel mib agent authenticated user 
capability resource access control 
example normal user snmp request removing route entry pass message level security denied access control mechanism local processing module lpm 
current security framework snmpv ng covers snmp pdus 
cover security concerns protocols 
rationale security checks performed master agent snmp level 
rationale fine master node running secure os located private network segment 
connected public network security important consideration 
example secure transport layer protocol secure channel master 
alice chris bob timothy interception lsa lsa lsa lsa catch trap trap remote security management application jinao alice chris jinao suspected router figurative description catch trap 
remote jinao management applications snmpv ng interface jinao ids service available authenticated authorized snmp application entities public internet 
remote management station access jinao mib different routers correlate distributed jinao results 
mib specification defined remote management applications interpret mib information correctly 
section give example remote intrusion detection catch trap mib interface 
remote jinao management application find particular router processing input protocol data units faithfully 
example compromised ospf router modifies lsa link state information originated router 
digital signature scheme hard detect attack single jinao 
way detect intrusion compare input lsa output lsa compromised router 
done different approaches jinao mib interface just described jinao log access mib delegating proper rules prevention module various types ospf pdus logged retrieved log access mib interface 
please note prevention module log incoming pdus outgoing ones 
remote management application access logs neighbors suspected router 
comparing log files remote management model tell lsas faithfully forwarded 
jinao catch trap mib checking comparing log files take certain amount time communication computation resources log contain large amount information 
ideally comparison task performed prevention module efficient 
example describe functionality catch trap interface alice bob chris routers connected shown 
remote management application timothy bob compromised 
timothy send suspend request going prevention module alice catch hold outgoing lsa lsa sent bob 
timothy catch trap interface chris 
request chris knows look ospf pdus bob check lsa point timothy notify alice release lsa chris catches lsa trap notify timothy immediately 
ffi amount time find lsa notify timothy report 
catch trap mib interface facility efficiently handle compromised routers 
anderson computer security threat monitoring surveillance fort washington pa james anderson april 
winkler unix prototype intrusion anomaly detection secure networks proceedings th national computer security conference oct 
anderson valdes generation intrusion detection expert system nides summary technical report sri csl computer science laboratory may 
denning intrusion detection model ieee transactions software engineering vol 
feb 
jagannathan lunt system design document generation intrusion detection expert system nides sri report sri international menlo park ca march 
heberlein internetwork security monitor intrusion detection system large scale networks proceedings th national computer security conference oct 
jackson dubois stallings expert system application network intrusion detection proceedings th national computer security conference oct 
rose rfc snmp mux protocol mib may 
carpenter curran waters rfc simple network management protocol distributed protocol interface version march 
daniele francisco agent extensibility protocol version internet draft nov 
javitz valdes nides statistical component description justification annual report sri march 
wisdom sense guidebook los alamos national laboratory los alamos new mexico 
haystack intrusion detection system proceeding ieee fourth aerospace computer security applications conference orlando fl dec 
cleaveland parrow steffen concurrency workbench tool verification finite state systems acm transactions programming languages systems vol pp jan 
