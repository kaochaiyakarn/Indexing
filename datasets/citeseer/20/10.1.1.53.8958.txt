hierarchical bayesian space time models christopher geophysical statistics project national center atmospheric research mark berliner national center atmospheric research ohio state university noel cressie iowa state university space time data ubiquitous environmental sciences 
case atmospheric processes data contain different scales spatial temporal variability 
data non stationary space time may involve observation prediction locations 
factors limit effectiveness traditional space time statistical models methods 
article propose hierarchical space time models achieve flexible models methods analysis environmental data distributed space time 
stage hierarchical model specifies measurement error process observational data terms state process 
second stage allows site specific time series models state variable 
stage includes large scale seasonal variability plus space time dynamic process anomalies 
interest anomaly process 
third stage parameters time series models distributed space joint distribution spatial dependence markov random fields 
bayesian formulation completed stages specifying priors parameters 
implement model markov chain monte carlo framework apply atmospheric data set monthly maximum temperature 
keywords atmospheric science dynamical systems environmental studies gibbs sampling markov random field mcmc non stationarity temperature address box boulder colorado 
email edu environmental processes involve variability space time 
example typically interested time evolution certain atmospheric variables wind temperature moisture specified spatial domains 
need examine governing equations atmosphere see dynamical processes involve complicated spatial structure temporal structure spatio temporal interactions 
statistical characterization complicated processes traditional space time approaches hampered need specify space time space time interaction components variation 
space time variability complicated notion different spatial behavior different points time different temporal variability different locations space 
difficulties plus large data sets typical environmental problems require practitioners apply potentially unrealistic simplifying assumptions 
escape curse dimensionality take advantage increases computational speed numerical advances markov chain monte carlo allow implement bayesian space time dynamical models hierarchical framework 
specifications provide simple strategies incorporating complicated space time interactions different stages model hierarchy models feasible implement high dimensions 
examples hierarchical space time models applied environmental problems 
instance hughes guttorp hidden markov models unobserved weather states model space time atmospheric precipitation 
brown 
applied hierarchical model relatively low dimensional space time air pollution problem 
similarly examples bayesian space time modeling reported literature 
hainsworth mardia extended bayesian markov random field mrf image restoration geman geman image sequences 
wallis bayesian kriging approach space time modeling meteorological fields 
addition huang cressie developed empirical bayesian space time kalman filter models investigation snow water equivalent monthly precipitation respectively 
waller 
employed hierarchical bayesian space time models mapping disease rates 
article illustrate bayesian hierarchical view space time settings 
flexible stage hierarchical model 
indexed space time represent primary variable interest 
stage model specifies measurement error model observational data denoted typically observation error 
second stage model allows site specific time series models ii incorporation space time dynamics 
dynamical terms denoted third stage parameters site specific time series models endowed priors markov random fields generate spatial dependence structures 
dynamical terms modeled third stage 
aspect central article distinguishes approach hierarchical space time formulations gelfand waller 
final stages complete bayesian formulation specifying priors parameters 
sense re pose fundamental challenge space time modeling effectively model spatial temporal structures 
bayesian hierarchical strategy propose allows complicated structure modeled terms means various stages model massive joint covariance matrix 
furthermore models proposed offer analyst various opportunities explore employ trade offs rich time lagged site specific time series models models direct specifications spatial structures short time lags 
believe class models discussed offer useful framework settings 
models general 
variety additions variants possible 
issues considered developing model include implementations large data problems characterization underlying space time dynamic processes see west harrison overview bayesian dynamic models 
particular envision space time data sets involving observation prediction locations potentially long data records models space time space time interaction structure needed 
require models capable handling variety features occurring varying space time scales 
third relative ease computation considered 
markov chain monte carlo mcmc powerful useful technique rich models high dimensions lead technical problems implementation 
large data settings consider require concessions model generality 
notation suppose denotes value process interest location time lattice grid space time 
resolution sufficiently rich allow desired predictions interpolations alternative view begins models indexed continuous space time variables 
analyze implied behaviors grid level 
assume sites time points number grid points theta notation sites refined allow spatial information specified 
example spatial dimensions write cartesian coordinates 
section convenient continue coordinate free notation 
depending modeling strategy may helpful arrange process different ways 
vector time series values site matrix spatially gridded values process time denote vectorization matrix 
fy mg hierarchical modeling involves specification series conditional models 
develop formulation subscripted stage number introduced condition represent collection model parameters 
symbols reserved primary variables focus modeling strategy 
notation popularized gelfand smith random vector represent joint probability density function represent conditional density vector hierarchical space time model casual summary stages basic hierarchical space time model table convenience 
table hierarchical model stage variables model sub model data zjy process fi large small scales fi xj fi spatial prior means spatial prior fij fi space time dynamics xj model parameters measurement variances model variances fi fi dynamical parameters hyperparameters fi stage measurement process denote observational data 
statistical measurement error model specified zjy represents collection parameters 
model tailored variety sampling plans 
simplest observe error process interest sites times 
data set fz dg ae standard example assume conditional independent case gau oe case foe dg set measurement error variances 
interesting models possible 
particular observations ae need coincide process need construct probability model observations gridded values 
reader infer believe step simple important example note spatial temporal averaging schemes modeled linear operations example spatial averaging yields data measurement errors multivariate distribution 
cases may appropriate include unknown parameters second stage large small scale features 
suggested modeling strategies process particularly relevant atmospheric processes 
processes expected display strong seasonal variations regional structures 
model conditional processes denoted fi fx mg collection parameters separate large scale temporal behavior short time scales 
assume site time point fi fl ffl represents site specific mean 
define 
ffl fi large scale temporal model site specific parameters fi 
climate data typically model seasonal monthly effects letting cosine function collection indicator variables monthly means 
define fi fi fi 
ffl represent short time scale dynamical process 
ffl fl zero mean random variables model noise 
role process account spatial temporal dynamics accounted long term means seasonal behavior 
appeal terminology atmospheric allied sciences illustrative roughly view contributions modeled climatic think adjustments climate modeled weather 
model specified attention turned fl 
quantities represent unexplained variations second stage 
key question space time structure modeled specification joint distribution fl 
principle model st theta st covariance matrix 
point hierarchical approach modeled features explain space time structure process assume conditionally independent random variables 
assume fi oe oe oe 
third stage spatial structures dynamics 
assume fi mutually independent conditional third stage parameters assume partitioned fi leading fi xj fij fi xj capture gross spatial structures envision spatial models markov random fields fij fi 
physically experimentally dynamical models possible 
popular flexible collection models step markovian time evolution models see berliner 
formally assume xj jx class statistical stochastic models common example conditional vector autoregression theta matrix regression coefficients independent sequence errors 
issues modeling similar discussed concerning fl 
crucial issue modeling spatial structures clearly involves trade offs richness matrix versus level independence elements standard default model elements spatially independent zero mean gaussian random variables having variance oe 
case oe 
clarify points raised previous paragraph note assumed diagonal entire formulation bayesian seasonal time series model autoregressive shocks spatially dependent parameters 
may confidence spatial dependencies explained sufficiently model change model non diagonal covariance matrix shocks alternatively non diagonal may natural choice 
example write models essentially regress element elements corresponding selection neighboring sites 
see cressie section related discussion 
cases strategy effective covariance matrix shocks modeled diagonal nearly 
higher order temporal dependencies readily modeled 
example certainly write step vector autoregression gammal assumptions fh kg theta matrices regression coefficients 
special case class models known space time autoregressive moving average models see cressie 
dimensionality specification rapidly limiting consideration 
partial solution dimensionality problem additional modeling possible 
example introduce various parameterizations matrices extreme assumed diagonal elements endowed spatially dependent priors stage 
interaction modeling covariance matrix noise vectors arises 
bayesian approach natural combining statistical physical modeling 
operationally may imagine basic strategies 
employ flexible classes statistical models vector discussed earlier add scientific understanding specification prior parameters model 
second approach develop explicitly physically mechanistic specifications analogs 
pursue direction 
final important comment involves identifiability issues 
depending modeling strategies third stage implied models identifiable 
intuitively source problem fl appear sum 
special sampling plans parameters distributions fl identified 
bayesian analysis proper probabilities quantities identifiability issues prohibit proceeding careful results unidentified parameters 
see besag 
general discussion section amplification example 
fourth stage priors parameters fourth stage specification priors model parameters 
problem specification collection hyperparameters 
convenient assume partition hyperparameters associated stage conditional independence relation typically partitioned fi coupled conditional independence assumption fi fi fifth stage hyperparameter priors specified 
standard assumption fi formulation simplified empty known corresponding terms right hand side drop 
example monthly averaged maximum temperature data demonstrate concepts bayesian hierarchical space time model monthly averaged maximum temperature data set portion midwest corn belt 
particular years monthly averaged temperatures stations united states historical climatology network data set considered 
locations stations shown 
wish predict monthly temperature months theta locations degree latitude degree longitude grid covering degrees longitude degrees latitude see 
note missing data observation sites 
particular interest space time dynamical structure non seasonal portion maximum temperature field 
exploratory analysis order get general understanding data performed simple exploratory analyses 
shows contour plot derived temporal means observation location 
note large scale spatial trend southwest northeast 
appears simple linear trend surface including intercept linear longitude linear latitude term reasonable large scale spatial structure model data case 
examination data suggest significant annual cycle temperature 
shows contour map estimates cosine coefficient annual harmonic site removal site specific mean shown 
annual harmonic site cos sin month index cosine sine coefficients respectively 
apparently large scale spatial structure cosine component including linear trend north south 
similarly shows contour plot sine coefficients annual harmonic 
detect large scale spatial linear trend 
removing site specific means site specific annual harmonic observations shows contour plot estimated site specific autoregressive order ar parameters 
plot suggests spatial structure ar parameters regions increased temporal predictability south central minnesota 
shows contour plot estimated standard deviation ar shocks site note spatial structure shocks linear trend southwest northeast associated variances exhibit 
temperature model model maximum temperature follows hierarchical framework outlined section 
subsections develop stage turn 
stage measurement process data spatial locations may may grid location 
consider model ffl theta vector observations theta state vector theta matrix maps temperature values grid locations observations ffl theta error vector representing sub grid scale processes measurement error 
case temperature data plot covariance function distance bottom panel suggests assume sub grid spatial structure white conditional true process observations degree degree box surrounding gaussian random variables mean variance oe ffl oe ffl 
matrix zeros ones th position indicating th grid location associated th observation location 
attempt distinguish sub grid scale variance measurement error example 
plausible model described simple 
recognize choice appropriate model stage research problem investigation model primary message 
second stage large small scale features consider model state process fl term theta vector means assumed spatial structure dependent seasonal term dynamical process accounts intra seasonal space time variability fl error term 
assume conditionally gaussian oe fl gau oe fl third stage spatial structures dynamics discussed section assume mutually independent conditional third stage parameters 
model conditionally specified gaussian mrf firstorder spatial dependence 
grid locations indices corresponding latitudes respectively jf gau ff gamma gamma gamma gamma fi gamma gamma gamma gamma specific mrf mean ff fi zonal east west north south mrf spatial dependence parameters respectively homogeneous mrf variance 
shown result factorization theorem cressie jf ff fi gau gamma gamma theta matrix diagonals ff fi cressie 
seasonal component modeled annual harmonic amplitudes phases vary spatially cos sin specified annual harmonic spatially varying cosine sine coefficients respectively 
model cosine sine coefficients annual harmonic simple spatial trends long lat long lat independent gaussian random variables gau oe gau oe gau oe gau oe gau oe gau oe parameters fixed specified table 
space time dynamic term modeled vector autoregressive var process gamma theta parameter matrix var noise term 
large spatial dimensions typical problems simple var model simplified practice 
consider nearest neighbor var model parameter matrix 
gamma gamma gamma gamma gamma gamma gamma form models described cressie 
note autoregressive parameter grid location consideration allowed vary spatially nearest neighbor parameters vary spatially 
anticipated estimates implications related dynamics system 
simplify model assume fj spatial white noise 
assumption may unrealistic assumes instantaneous spatial interaction hoped marginalization spatial dependence ag parameters lagged nearest neighbor structure provide suitable spatial dependence process 
addition large scale instantaneous spatial interaction captured terms 
assume jf gamma oe gau gamma oe diagonal matrix diagonals parameters main diagonal containing vector edge sites diagonals corresponding zeros 
diagonal var model equal zero considered spatially dependent nearest neighbor var model allowed vary spatially 
capture spatial structure field model described 
furthermore feel model sensitive initial conditions associated gibbs sampler difficulty converging 
fourth stage priors parameters indicated section partition fourth stage priors assume conditional independence 
represent mean mean mrf simple spatial trend long lat long lat longitude latitude th respectively regression coefficients specified independent gaussian random variables gau oe gau oe gau oe parameters fixed specified table 
spatial dependence parameters ff fi independent gaussian random variables constrain ensure positive definiteness marginal covariance matrices ff gau ff oe ff fi gau fi oe fi fixed specified parameters table 
represent spatially varying autoregressive parameters condition ally specified gaussian mrf order spatial dependence gau ff gamma gamma gamma gamma fi gamma gammaa gamma gamma mrf mean ff fi zonal mrf spatial dependence parameters homogeneous variance 
distributions parameters specified fifth stage 
assume nearest neighbor autoregressive parameters independent gaussian random variables gau oe gau oe gau oe gau oe fixed specified parameters table 
variances specified stages assume independence conjugate priors oe ffl ig ffl ffl oe fl ig fl fl oe ig ig ig refers inverse gamma distribution parameters fixed specified table 
fifth stage suggested exploratory analysis see assume mrf mean spatially varying autoregressive process large scale linear spatial trend decreasing northwest southeast 
assume simple spatial trend structure long lat independent gaussian random variables gau oe gau oe gau oe fixed specified parameters table 
furthermore spatial dependence parameters ff fi independent gaussian random variables constrain ensure positive definiteness marginal covariance matrices ff gau ff oe ff fi gau fi oe fi fixed specified parameters table 
assume variance parameter independent ff fi inverse gamma conjugate prior ig parameters fixed suitably specified table 
bayesian estimation gibbs sampler markov chain monte carlo mcmc methods stochastic simulation years metropolis hastings 
particular gibbs sampler approach mcmc extensively statistics literature pioneering geman geman 
general overview methods see gilks 

chosen gibbs sampler allow determine relevant posterior distributions hierarchical model temperature section 
chosen gaussian distributions conjugate priors derivation implementation full conditional distributions needed gibbs sampler exception quite straightforward 
see appendix derivations 
exception concerns full conditional distributions mrf spatial dependence parameters ff fi ff fi 
example full conditional distribution ff see appendix ff delta ff fi ff gamma gamma expf gamma gamma gamma gamma gamma ff gamma ff oe gamma def ff ff diagonals presence ff determinant term difficult conditional distribution sample 
order proceed employ metropolis hastings step gibbs sampler see gilks 
note relatively easy sample pseudo full conditional pseudolikelihood approach classical mrf estimation cressie pp 

ff delta pseudo ff fi ff def ff metropolis hastings step generating th sample full conditional distribution ff performed follows ffl choose starting value ff see section ffl sample ff ff ffl sample ffl min ff ff gamma ff gamma ff accept ff set ff ff gamma 
practice step relatively slow evaluation determinant 
utilizing sparse matrix technology implementation significant speed improvements realized 
assessing gibbs sampler theory implies markov chain guaranteed converge appropriate stationary distribution implementation issues arise practice 
choices related influence starting values long run chain convergence best monitor chain perform desired estimation 
issues focus ongoing research see gilks 
taken simple approach analysis 
initially ran pilot simulations iterations different starting values representative prior means widely dispersed parameter prior distribution 
addition visual assessment convergence examined gelman rubin convergence monitor close convergence model parameters listed table 
visual assessment pilot simulations suggested parameters converged iterations 
discarded iterations calculated gelman rubin monitor remaining iterates 
indicated table values parameters suggested convergence iterations burn monitor values cases 
ran single long iterations chain prior mean starting value set conservatively discarded iteration burn period 
posterior means quantities estimated corresponding sample means long run neglecting burn period 
due correlation mcmc samples estimated monte carlo standard errors batch means approach described roberts 
batch size determined examination lag autocorrelation plots parameters obtained pilot samples 
particular parameters autocorrelations dropped lag 
consequently batch sizes remaining gibbs iterations 
guaranteed batch means uncorrelated batch size believe conservative size parameters model 
monte carlo parameter estimates simulation associated monte carlo standard errors table 
modeling perspective results gibbs sampling rate convergence encouraging general 
note large scale spatial trend parameters ff show large difference prior mean posterior mean 
prior means variances estimated regression exploratory phase 
lack bayesian learning suggests trend terms estimated ad hoc exploratory analysis 
contrast note posterior means variance components oe fl oe extremely different prior counterparts 
may indicate bayesian learning recall earlier discussion regarding identifiability 
classical perspective variance components identifiable model 
prior specifications variance components permits bayesian analysis 
case prior means components exploratory data analysis confidence great suggested relatively narrow prior variances 
furthermore sensitivity analysis different priors suggest model tends put variance oe fl component remaining parameters greatly sensitive changes 
case try interpret parameters separately sum meaningful 
note identifiability issue handled methods deletion components variance reparameterization 
choose keep model form show flexibility available error modeling 
example meteorological examples natural model regimes constructing mixture model components variance 
results posterior parameter estimates examine issues 
instance mrf var parameters provide useful information 
lagged nearest neighbor parameters fb suggest upwind location influential table gibbs sampler results mcmc model prior prior posterior convergence parameter mean std 
dev 
mean std 
error monitor mean ff fi oe ffl oe fl oe mean ff fi location agreement prevailing west east propagation weather systems 
contrast locations equally important influential location zonal east west upwind component influential expected significant contributions north south locations suggesting monthly time scales propagating processes influential 
interesting extension model examine seasonal variation parameters 
mrf spatial dependence parameters interpreted perspective 
removal large scale spatial trend ff larger fi suggesting added importance zonal east west disturbances mean process 
ff fi parameter estimates posterior distributions similar see suggesting zonal influences spatial variability process important 
instructive examine predicted linear trend surfaces model 
shows trend surface derived relevant posterior means mean maximum temperature annual harmonic cosine sine terms site autoregressive parameters 
certainly interpret trend surface perspective 
northwest southeast trend interesting 
may indicative regional predictability differences northwest region persistence monthly temperature month temperature deviation climatology similar month monthly forecasts area skill 
possible explanation exploratory analysis suggests ar noise homogeneous model added spatial trend parameters compensate assumption homogeneous variance 
interesting examine annual harmonic amplitude amp phase phs arctan gammag shown 
annual cycle amplitude phase increase north northwest phase difference inconsequential maximum difference accounting phase difference days 
expected phase peak occurs july cos phs maximum corresponding maximum july estimated phs 
expect amplitude increase move northwest winters northwest corner grid southeast corner regional differences summer maximum temperature large 
ultimately interested prediction processes 
consider posterior samples gibbs iteration process locations observations locations benefit observations 
expected posterior densities wider locations data 
similar difference observation non observation locations evident samples process shown 
instructive examine time variation predicted processes selected sites 
shows time series plots sites directly influenced data lon lat 
model performance process difficult judge variance explained annual harmonic 
note marked difference series influenced observations influenced directly observations relate cold season variability 
non observation site time series fails capture increased variability winter season observation influenced series 
fact illustrates poor modeling assumption 
known maximum temperatures show variability winter summer especially central regions continents implying seasonal structure variance 
retrospect included cyclo stationary variance term model fl vary 
formulation easily handled hierarchical structure 
typically interested dynamic processes contained deviations average climate anomalies modeling process 
thing note time series process remarkable similarity time evolution sites 
shown similarity extends prediction domain 
believe time dynamic similarity physical monthly time scale weather features exhibit fair degree spatial homogeneity 
certainly case prediction process non observation location shows variance time series observation locations 
smaller variance predictor non observation sites explained follows 
little data posterior mean predictor shrunk prior mean lot data case variable sample mean tends dominate 
possible differences may attributable assumption spatial structure var variance 
shown coherent spatial structure variance 
demonstrate usefulness modeling exercise examining issues focus space time evolution process 
particular consider maps posterior means process june years summer season june july august 
years chosen region interest known experienced warm drought normal cool wet conditions summers respectively 
summer months chosen show space time dynamic evolution extreme hot years 
figures show smoothed posterior mean maps periods 
model correctly represented known weather extreme years captured space time dynamic evolution 
discussion hierarchical approach described offers flexible approach modeling large class environmental space time processes 
models general extensions modifications explored discussed previously 
particular scratched surface far space time dynamic process concerned 
additional parameterizations investigated 
instance allow time varying parameters process physically parameterizations 
approaches considered reported 
case model tailored problem hand 
instance goal increased understanding illustrated model discussed useful 
similarly interested predicting time approach useful 
trying predict process spatially locations observations lagged nearest neighbor implementation may need enhanced 
fortunately hierarchical bayesian framework exploration various complex space time models quite straightforward shows promise space time environmental problems 
acknowledgments support research provided geophysical statistics project sponsored national science foundation dms 
cressie research partially supported environmental protection agency operative agreement cr environmental protection agency iowa state university 
besag green higdon mengersen bayesian computation stochastic systems discussion statistical science 
berliner hierarchical bayesian time series models 
maximum entropy bayesian methods hanson silver eds kluwer academic publishers dordrecht 
brown le multivariate spatial interpolation exposure air 
canadian journal statistics 
cressie statistics spatial data revised edition wiley new york pp 
karl mason hughes bowman united states historical climatology network hcn serial temperature precipitation data revised 
ndp 
carbon dioxide information analysis center oak ridge national laboratory oak ridge tennessee 
gelfand smith sampling approaches calculating marginal densities 
journal american statistical association 
gelfand ghosh knight spatio temporal modeling residential sales data 
obtained spatial statistics preprint service hp niss rti org organization personnel 
gelman inference monitoring convergence 
markov chain monte carlo practice 
gilks richardson spiegelhalter eds chapman hall london pp 

gelman rubin inference iterative simulation multiple sequences 
statistical science 
geman geman stochastic relaxation gibbs distributions bayesian restoration images 
ieee transactions pattern analysis machine intelligence 
gilks full conditional distributions 
markov chain monte carlo practice 
gilks richardson spiegelhalter eds chapman hall london pp 
gilks richardson spiegelhalter eds markov chain monte carlo practice chapman hall london pp 
hainsworth mardia markov random field restoration image sequences 
markov random fields theory applications chellappa jain eds academic press london 
wallis approach statistical spatial temporal modeling meteorological fields discussion 
journal american statistical association 

hastings monte carlo sampling methods markov chains applications 
biometrika 
dynamic meteorology academic press san diego 
huang cressie spatio temporal prediction snow water equivalent kalman filter 
computational statistics data analysis 
hughes guttorp incorporating spatial dependence atmospheric data model precipitation 
journal applied meteorology 
metropolis rosenbluth rosenbluth teller teller equation state calculations fast computing machines 
journal chemical physics 
roberts markov chain concepts related sampling algorithms 
markov chain monte carlo practice 
gilks richardson spiegelhalter eds chapman hall london pp 

waller carlin xia gelfand hierarchical spatio temporal mapping disease rates 
journal american statistical association 
west harrison bayesian forecasting dynamic models 
springer verlag new york 
spatio temporal statistical models applications atmospheric processes 
ph dissertation iowa state university 
appendix derivation full conditional distributions section outlines derivation full conditional distributions gibbs sampler example discussed section 
general full conditional distributions determined writing joint distribution random quantities divided appropriate normalizing constant 
hierarchical models process typically simplified due various conditional independence assumptions 
particular components full joint distribution functionally depend quantity cancel numerator denominator full conditional distribution 
derivations simplifications considered 
note gaussian assumptions model implementation lead straightforward derivation full conditional distributions case see section 
ways approach derivations repeatedly completing squares approach 
example full conditional distribution parameter vector delta expf gamma gamma completing square gives delta gau gamma gamma generic notation delta delta represent conditional distribution random quantities 
delta recall section jk oe ffl gau oe ffl eqn 
oe fl gau oe fl delta jk oe ffl oe fl expf gamma oe ffl gamma gamma expf gamma oe fl gamma theta gamma expf gamma oe ffl oe fl gamma oe ffl oe fl delta gau oe ffl oe fl gamma oe ffl oe fl oe ffl oe fl gamma delta recall markovian assumption eqn 
eqn 

oe fl gau oe fl eqn 
yields gamma oe gau gamma oe gamma delta oe fl oe gamma oe expf gamma oe fl gamma gamma oe gamma gamma gamma gamma oe gamma gamma expf gamma oe fl oe oe gamma oe fl gamma gamma oe oe gamma need initial condition delta gau oe fl oe oe gamma oe fl gamma gamma oe oe gamma oe fl oe oe gamma similarly delta oe fl gamma oe leads delta gau oe fl oe gamma oe fl gamma gamma oe gamma oe fl oe gamma similarly sigma gau sigma full conditional distribution delta oe sigma expf gamma oe gamma gamma gamma sigma gamma gamma leads delta gau oe sigma gamma gamma oe sigma gamma oe sigma gamma gamma delta distributions eqns 
derive delta ff fi oe fl expf gamma gamma gamma gamma theta expf gamma oe fl gamma gamma gamma gamma gamma gamma expf gamma gamma oe fl gamma gamma oe fl gamma gamma delta gau gamma oe fl gamma gamma oe fl gamma gamma gamma oe fl gamma delta delta recall eqn 
long lat long lat longitude latitude th respectively regression coefficients specified independent gaussian random variables shown eqns 

defined model write long lat theta linear trend design matrix linear trend parameter vector 
independence eqns 
sigma gau sigma sigma theta diagonal matrix oe oe oe main diagonal 
recalling eqn 
delta ff fi sigma expf gamma gamma gamma gamma expf gamma gamma sigma gamma gamma expf gamma gamma sigma gamma gamma gamma sigma gamma delta gau gammac sigma gamma gamma gammac sigma gamma gammac sigma gamma gamma note derivation full conditional distribution analogous 
delta gj delta eqn 
definition linear design matrix eqn 
write eqns 
sigma gau sigma sigma diagonal matrix oe oe oe main diagonal 
delta sigma oe fl expf gamma gamma sigma gamma gamma expf gamma oe fl gamma cos pgl sin theta gamma cos pgl sin expf gamma sigma gamma oe fl cos fl gamma sigma gamma oe fl gamma pgl sin cos delta gau sigma gamma oe fl cos gamma sigma gamma oe fl gamma pgl sin cos sigma gamma oe fl cos gamma similarly gl delta gau sigma gamma oe fl sin gamma sigma gamma oe fl gamma cos sin sigma gamma oe fl sin gamma gl gl gl sigma gau gl sigma aj delta lagged nearest neighbor var structure eqn 
write decomposition gamma diag gamma gamma diag gamma gamma gamma gamma matrix main diagonal replaced zeros gamma diag gamma 
eqns 
delta gamma oe aj ff fi expf gamma oe gamma gamma gamma gamma gamma gamma gamma gamma theta expf gamma gamma gamma gamma expf gamma oe gamma gamma gamma gamma oe gamma gamma gamma gamma delta gau oe gamma gamma gamma gamma oe gamma gamma gamma gamma oe gamma gamma gamma gamma delta delta delta delta lagged nearest neighbor structure eqn 
write decomposition gamma gamma gamma matrix diagonal corresponding coefficient replaced zeros gamma gamma theta matrix ones diagonal corresponding coefficient zeros 
exact form matrix function chosen vectorization method handling edge effects 
eqns 
delta gamma oe bj oe expf gamma oe gamma gamma gamma gamma gamma gamma gamma gamma theta expf gamma oe gamma expf gamma oe gamma gamma oe gamma oe gamma gamma gamma oe delta gau oe gamma gamma oe gamma oe gamma gamma gamma oe oe gamma gamma oe gamma note analogous distributions obtained ff delta fi delta ff delta fi delta eqns 
independence assumptions hyperparameters ff delta ff fi ff ff oe ff gamma gamma expf gamma gamma gamma gamma theta expf gamma oe ff ff gamma ff ff diagonals presence ff determinant term difficult conditional distribution sample 
order proceed consider pseudo conditional distribution pseudolikelihood approach classical mrf estimation cressie pp 

ff delta pseudo ff fi ff ff oe ff expf gamma gamma gamma ff gamma gamma gamma gamma gamma fi gamma gamma gamma gamma theta expf gamma oe ff ff gamma ff expf gamma ff gamma gamma gamma gamma oe ff gamma ff ff oe ff gamma gamma gamma gamma theta gamma gamma fi gamma gamma gamma gamma ff pseudo delta gau gamma gamma gamma gamma oe ff gamma theta ff oe ff gamma gamma gamma gamma theta gamma gamma fi gamma gamma gamma gamma gamma gamma gamma gamma oe ff gamma samples ff pseudo delta obtain samples ff delta metropolis hastings sampling step gibbs sampler discussed section 
full conditional distribution fi delta analogous full conditional distri butions ff fi oe ffl delta discussion section eqn 
oe ffl delta jk oe ffl oe ffl ffl ffl oe ffl mt expf gamma oe ffl gamma gamma theta gamma ffl gamma ffl ffl oe ffl ffl expf gamma ffl oe ffl oe ffl mt ffl expf gamma oe ffl ffl gamma gamma oe ffl delta ig mt ffl ffl gamma gamma gamma oe fl delta eqns 
oe fl delta oe fl oe fl fl fl oe fl st fl expf gamma oe fl fl gamma gamma gamma theta gamma gamma gamma oe fl delta ig st fl fl gamma gamma gamma theta gamma gamma gamma gamma oe delta eqns 
oe delta jh gamma oe oe oe st expf gamma oe gamma gamma gamma gamma oe delta ig st gamma gamma gamma gamma gamma delta delta eqns 
obtain delta ff fi expf gamma gamma gamma gamma theta gamma gamma expf gamma expf gamma gamma gamma gamma delta ig gamma gamma gamma gamma analogously delta ig gamma gamma gamma gamma longitude deg prediction grid observation locations prediction grid observation locations longitude deg mean maximum temperature deg contour plot estimated means monthly maximum temperature observations sites contour interval deg longitude deg annual harmonic cosine coefficients contour plot estimated cosine component annual harmonic estimated deviations site specific temperature means contour interval longitude deg annual harmonic sine coefficients contour plot sine component annual harmonic estimated deviations site specific temperature means contour interval longitude deg ar parameter estimates contour plot autoregressive order parameters estimated deviations site specific temperature means annual harmonics contour interval longitude deg ar shocks standard deviation contour plot autoregressive order shock standard deviations estimated deviations site specific temperature means annual harmonics contour interval deg lag distance deg maximum monthly temperature covariance function lag distance lag distance deg covariance function lag distance degree box maximum monthly temperature covariance estimates function lag 
top panel estimates entire observational domain 
bottom panel estimates degree degree box surrounding observation locations 
histogram gibbs samples posterior distributions ff fi longitude deg posterior mean longitude deg latitude deg posterior mean longitude deg posterior mean annual harmonic cosine coeff 
longitude deg latitude deg posterior mean annual harmonic sine coeff 
linear spatial trend contour maps posterior means 
monthly temperature site specific mean mrf mean contour interval deg 
site lagged autoregressive parameter mrf mean contour interval 
annual harmonic cosine coefficients contour interval 
annual harmonic sine coefficients contour interval 
longitude deg posterior mean annual harmonic amplitude longitude deg posterior mean annual harmonic phase rad linear spatial trend contour maps annual harmonic amplitude phase contour intervals adn respectively 
observations grid box observations grid box histograms gibbs samples prediction grid locations observations grid box observations grid box 
posterior mean year obs obs posterior mean year obs obs posterior mean time series deg 
location observations observations latitude deg june latitude deg june longitude deg latitude deg june posterior mean spatial maps process june deg 
latitude deg june latitude deg july longitude deg latitude deg august posterior mean spatial maps process june july august deg 
