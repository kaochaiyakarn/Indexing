proceedings miccai pages novel approach registration portal ct images treatment setup verification radiotherapy ravi bansal lawrence staib chen anand rangarajan jonathan nath james duncan departments electrical engineering diagnostic radiology department therapeutic radiology yale university new haven ct 
framework simultaneously segment portal images register treatment planning ct data sets purpose radiotherapy setup verification 
due low resolution low contrast portal image taken high energy treatment photon beam registration ct data difficult problem 
structure segmented portal image help registration estimate registration parameters help improve portal image 
minimax entropy algorithm proposed evaluates appropriate entropies order segment portal image find registration parameters iteratively 
proposed algorithm general registering high resolution image low resolution image 
show proposed algorithm relation mutual information metric proposed literature multi modality image registration :10.1.1.18.4016
registration process maps pixels image called image pixels image called test image 
clinical diagnosis treatment planning delivery therapy images different modalities acquired provide complementary information disease give graphical verification delivered therapy 
radiotherapy cancer patients registration images different modalities computed tomography ct magnetic resonance imaging mri treatment planning delineate correct spatial extent tumor surrounding normal structures 
furthermore registration images modality routine verification radiation treatment 
case ray images taken reviews medical image registration classification multi modal images excellent review registration methods computer integrated surgery 
proceedings miccai pages different energies diagnostic energy kv called simulation image treatment setup initially simulated high energy mv treatment beam called portal images treatment course 
due high photon energy portal images intrinsically low contrast poor sharpness 
remained difficult task automate registration simulation portal images 
fact registration performed visual comparison radiotherapy centers 
treatment centers moving offering full conformal treatments initially planned treatment planning ct data sets 
registration image set portal images necessary fully quantify dimensional patient setup treatment 
related 
register portal image pre treatment image methods proposed literature semi automated require feature extraction portal image 
poor quality portal image difficult problem 
registration algorithms require feature extraction preprocessing step 
accuracy registration methods limited accuracy method segment features portal image 
methods called sparse field methods 
features registration methods directly gray scale pixel values images 
authors cross correlation pixel intensities match metric aligning portal simulation images 
woods measure mis registration images dispersion variance intensities histogram 
metric largely heuristic 
information theoretic match metric proposed multi modality image registration 
methods directly manipulate image intensities called dense field methods 
dense field methods compared sparse field methods robust noise methods require extraction features registered 
approach 
portal ct images properly aligned information high resolution ct segment portal image 
hand accurate segmentation portal image accurate registration obtained 
problem deciding try locate structure portal film registration purposes perform crude registration help look structure better registration 
propose clear answer registration segmentation carried simultaneously helping 
propose iterative framework segmentation registration images estimated stage algorithm different entropies termed minimax entropy 
entropy maximization step segmentation portal image estimated current estimates registration parameters 
entropy minimization step registration parameters estimated current estimates segmentation 
proceedings miccai pages algorithm start step appropriate initialization 
derive strategy starting em algorithm show relationship mutual information metric 
problem definition motivation patient setup verification performing radiotherapy portal ct image classical pose estimation problem computer vision 
pose estimation problem pose model determined set images model aligned images 
assume rigid transformation ct data set bring alignment portal image transformation parameters considered 
algorithm works directly pixel intensity values classify algorithm automated intrinsic global dense field algorithm classification 
subsection formulate pose estimation maximum likelihood estimation mle problem 
formulation requires knowledge joint density function portal drr pixel intensities denoted xi yi 
noted earlier want estimate segmentation portal image order help registration process 
problem segmenting portal image formulated labeling problem pixel labeled bone background 
incorporate segmentation information joint density function written mixture density form labels portal image pixels known 
segmentation labels treated missing information parameters determined pose parameters 
formulate problem maximum likelihood estimation mle problem section 
algorithm computing mle incomplete data called expectation maximization em algorithm 
thoughts select em algorithm compute estimates due proven monotonic convergence properties ease programming optimization techniques necessary compute hessians necessary worry setting step size 
em algorithm may estimate pose parameters segmentation labels 
problems em approach restrict problem 
explained subsection minimax entropy strategy addresses restrictions described section 
problem definition 
portal image 
similarly 
projected ct image transformation parameters 
ct image 
note index pixels images single index images images 
simplicity formulations proceedings miccai pages assumed portal projected ct dimensions 
need true 
projected ct image called digitally reconstructed drr 
pixel portal image classified belonging classes bone background 
formulate pose estimation problem maximum likelihood estimation problem arg max log arg max log arg max log log arg max log xi yi log yi ignore term ct data set independent transformation parameters equation assume image pixels independent 
logarithm likelihood function taken simplify mathematical formulation 
note notational simplicity shall write xi yi yi current transformation parameters drr obtained clear context explicit 
mixture model em 
letting set classes bone background non bone pixels defined background mixture density model write joint mixture density model equation portal image drr pixel xi yi mi pa xi yi pi pa xi yi mi random variable ith pixel values pa xi yi joint density function pixel intensities portal image pixel labeled classifying pixels portal image equivalent determination probability mass function mi 
classification matrix ith row ath column entry satisfying constraints 
note ith pixel portal image belongs class 
indicator variables 
indicator variables shall define expected value pi 
notation em algorithm mixture model written kth iteration step log pa xi yi log yi step arg max proceedings miccai pages 
pa xi pb xi limitations em approach alternative strategies purposes em algorithm key restrictions 
em algorithm mixture model formulated equation function defined component density functions pa xi yi specified 
component density functions need determined specific problem 
images prostate cancer radiotherapy joint density functions need determined projection model account physics interaction high energy rays matter 
joint density functions known usually simplified model assumed 
propose estimate unknown density functions data simplified models 
second observation comes neal hinton provide view general em algorithm coordinate descent algorithm coordinates axes joint density functions missing information parameters estimated :10.1.1.33.2557
similar view em algorithm parameter estimation mixture density models 
step em algorithm expected value calculated missing information known 
implies expected value equation taken respect density function 
neal hinton show iteration em algorithm density function estimated question remains relationship density functions :10.1.1.33.2557
approach described section max step minimax algorithm formalizes relation 
max step viewed step determining density function missing information 
principle maximum entropy principle maximal non states making inferences basis partial information probability distribution maximum entropy subject known 
unbiased assignment amount arbitrary assumption information hypothesis 
overcome restrictions em algorithm borrowing idea averaging estimated density function mutual information 
mutual information match metric proposed successfully applied multi modality image registration 
mutual information match metric formulation literature assumes pixels image assumption true general 
proposed minimax entropy algorithm described aims combining strengths em algorithm mutual information registration approach simultaneously segment register images 
proceedings miccai pages minimax entropy approach proposed minimax algorithm solving basic problem posed equation computational form similar em strategy described equations steps max step min step evaluated iteratively determine registration parameters probability density function pdf portal image segmentation 
details development proposed algorithm discussed 
notation section see steps mathematically follows max step arg max log dm log dm constraint dm random variable domain set possible segmentations portal image pixel labeled set labels assume pixel labels statistically independent mi pi 
formulated max step simply states maximum entropy estimate density simply log 
simple formulation estimated segmentation density function allows systematically put constraints density function show 
min step arg min arg min za ha za see development min step 
component density function class pa estimated weighted sum gaussian kernels parzen window method pa wi pi pi wi wi pi mi probability ith pixel portal image belongs class estimated max step equation covariance matrix assumed diagonal set pixels sampled portal image drr estimate conditional density functions 
ha pa log pa dx dy 
min step chosen mutual information mi metric currently popular proceedings miccai pages medical image analysis community 
robust interesting metrics correlation 
see relation metric show mi sensitive mis registration correlation 
mi assumes pixels general problem get mixture densities 
note authors register images mutual information match metric incorporating segmentation information images 
image pre hand segmented remains fixed registration 
proposed algorithm portal image segmentation estimated simultaneously transformation parameters 
annealing schedule imposed estimated portal image pixel segmentation distribution 
modified max step equation written max step arg max log dm log dm constraint dm temperature determines annealing schedule 
results fig 

volume rendered ct phantom simulated portal images calculated 
real portal image phantom obtained high energy ray phantom treatment room 
experiments carried simulated real portal images 
obtain simulated portal images ct data set rotated translated space known amount perspective projection computed 
simulated portal images rendered known parameters study accuracy algorithm 
note assume perspective parameters known 
proceedings miccai pages ct data set shown high resolution diagnostic energy data set obtained scanning phantom 
phantom real human bone enclosed glass density close soft tissue 
ct data set obtained diagnostic energy rays kev voxel values mapped high energy rays mev attenuation coefficient tables generate projection images close quality portal image 
diagnostic energy known attenuation coefficient tables estimate tissue type voxel 
tissue type known attenuation coefficient tissue high energy estimated tables 
attenuation coefficients map phantom voxel values high energy values 
ct data set rendered opacity value soft tissue set close zero 
shows portal image obtained imaging phantom rays treatment energy level mev 
portal image contrast enhanced histogram equalization 
experimentally histogram equalized portal images lead accurate results 
images shown simulated portal images obtained known transformation parameters validate proposed algorithm 
scattering high energy ray photons leads noise poor contrast portal image 
simulate photon scattering varying amounts independent identically distributed gaussian noise added pixels simulated portal image 
fig 

estimated segmentation results true portal image 
results proposed minimax entropy algorithm 
simple threshold 
clustering algorithm 
shows segmentation real portal image estimated different segmentation algorithms 
shows segmentation estimated proposed algorithm 
pixel labels estimated joint density distribution 
bright pixels labeled bone 
dark pixels labeled background 
gray pixels pixels labels decided joint probability density functions 
segmentation portal image simple manually selected threshold 
segmentation clustering algorithm 
clustering algorithm image segmented classes nearness gray values user specified values 
proceedings miccai pages shows result registering real portal image ct data set 
image drr rendered registration parameters estimated minimax entropy algorithm 
see goodness estimated parameters contours hand drawn portal image expert matching closely key features 
contours mapped drr estimated parameters determined proposed algorithm 
contours match closely feature points drr showing accuracy estimated transformation parameters mapping expert traced estimate bone boundaries 
estimated parameters tx ty tz deg deg deg fig 

portal image contours 
contours shown drawn portal image expert matching anatomical features interest study registration result 
contours mapped drr rendered parameters estimated proposed minimax entropy algorithm 
shows initial results obtained registration simulated portal images 
graph corresponds variation transformation parameter rendering simulated portal image 
graph labeled trans example ct data set translated axis voxels projection rendered varying noise 
register simulated portal image ct data set transformation parameters reset zeros 
results summarized follows 
minimax entropy algorithm quite robust noise plane translations axis axis 
performance method deteriorated gracefully rotations plane plane noise increased 
initial steps proposed algorithm labels equal probability belonging class algorithm increasing mutual information entire images 
iterations portal image pixels get classified belonging classes algorithm increasing mutual information classes separately 
simulated portal images true registration parameters known estimated parameters converged true parameters proceedings miccai pages iterations 
iterations algorithm led better segmentation simulated portal image turn helped registration lock minimum 
proposed algorithm implemented took minutes sgi indigo machine 
estimated parameters estimated parameters vs noise trans trans rot deg rot deg rot deg noise std 
fig 

digitally rendered simulated portal images ct data set 
ct data set rotated axis perspective projection 
varying amounts gaussian noise added 
maximum pixel value simulated portal image 
rendered portal image noise std 
std 
shows graph estimated parameters increasing noise added simulated portal image 
discussion information theoretic framework segmentation registration carried iteratively segmentation results helping registration vice versa 
registration methods proposed literature carry portal image segmentation pre processing step registration process 
approach simultaneously segmenting registering images unified framework leads novel robust algorithm 
need demonstrate accuracy algorithm comparison mutual information algorithm raw intensity information 
mutual information match metric overcomes assumption linear relationship pixel intensities images registered underlying assumption correlation match metric 
mutual information registration relationship pixel intensities estimated data register images different modalities 
estimated set transformation parameters joint density images registered estimated data 
mutual information metric assigns number estimated density estimated proceedings miccai pages different transformation parameters transformation parameters corresponding density having largest mutual information chosen estimated parameters algorithm 
em algorithm provides iterative framework estimate parameters distribution presence missing data 
em algorithm requires parametric form distribution known 
proposed minimax entropy algorithm overcomes restriction em algorithm borrowing idea mutual information method estimating joint distribution data emphasizes fact distribution segmentation labels maximum entropy distribution satisfying constraints 
fact allows invoke constraints distribution systematically impose annealing schedule 
proposed algorithm joint densities known assuming simplified parametric form estimate densities data 
information theoretic framework estimate transformation parameters 
note relationship algorithm mutual information match metric shown applied successfully multi modality image registration 
research includes algorithm speed validation accuracy robustness algorithm especially comparison mutual information registration ridge algorithm proposed 
experiments demonstrated estimated registration accurate plane rotations translations especially noise increased 
propose orthogonal views anterior posterior lateral views commonly taken treatment room accurate registration results 
extend algorithm portal images acquired views need orthogonal 

bansal staib novel approach registration portal ct images treatment setup verification radiotherapy 
technical report dept electrical engineering diagnostic radiology yale university jan 
med yale edu bansal regis ps gz 


maximum entropy solutions scientific problems 
prentice hall 


dimensional verification patient placement radiotherapy portal images 
med 
phys march april 

collignon maes automated multimodality image registration information theory 
info 
proc 
med 
imaging ipmi pages 

dempster laird rubin 
maximum likelihood incomplete data em algorithm 
royal statistical soc ser 



automated verification radiation treatment geometry 
phd thesis univ amsterdam radiotherapy dept netherlands 
proceedings miccai pages 
interactive dimensional inspection patient setup radiation therapy digital portal images computed tomography data 
int 
radiation 
biol 
phys 


interpretation em algorithm mixture distributions 
statistics probability letters north holland 

hubble 
photon cross sections attenuation coefficients energy absorption coefficients kev gev 
nat 
stand 
ref 
data 
ser nat 
bur 
stand 
august 

jaynes 
information theory statistical mechanics rosenkrantz editor jaynes papers probability statistics statistical physics volume pages 
reidel publishing boston 
usa 

kirkpatrick gelatt vecchi 
optimization simulated annealing 
science 


registration computer integrated surgery methodology state art 
russell taylor editors computer integrated surgery technology clinical applications pages 
mit press cambridge 

szeliski 
anatomy registration dimensional medical images range images ray projections dimensional models octree splines 
russell taylor editors computer integrated surgery technology clinical applications pages 
mit press cambridge massachusetts 

munro 
semiautomatic method registration portal images 
med 
phys april 

neal hinton 
view em algorithm justifies incremental sparse variants 
jordan editor learning graphical models 
kluwer academic press 
appear 
web address www cs toronto edu radford papers online html 

sensor systems multimodality radiological image processing unix workstations 
version 

incorporating connected region labelling automated image registration mutual information 
proc 
pages 

van den pol viergever 
medical image matching review classification 
ieee eng 
med 
biol 

viola wells 
alignment maximization mutual information 
fifth int 
conf 
computer vision pages 

registration pre operative ct images intra operative ray projections image guided surgery 
lemke editors comp 
assist 
rad 
surgery pages 


woods cherry mazziotta 
rapid automated algorithm aligning pet images 
comp 
assist 
tomography 
