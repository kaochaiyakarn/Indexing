performance evaluation quadrics interconnection network fabrizio wu chun feng richard graham ccs modeling algorithms informatics ccs advanced computing computer computational sciences division los alamos national laboratory fabrizio feng lanl gov initial performance evaluation quadrics interconnection network 
describe main hardware software features relevance system designer user 
actual benchmarks performed experimental linux cluster 
preliminary analysis indicates interconnect performs remarkably user level latency bandwidth mb efficient support collective communication patterns excellent contention resolution heavy traffic 
keywords interconnection networks performance evaluation user level communication operating system bypass 
system interconnection networks critical component computing technology great impact design architecture high performance computers 
sheer computational speed distinguishes high performance computers desktop systems efficient integration computing nodes tightly coupled multiprocessor systems 
network adapters switches device driver software increasingly performance critical components modern supercomputers 
cursory admittedly non comprehensive look state art networking technology high performance computers indicates number notable players 
list includes gigabit ethernet sci myrinet just name 
network solutions different terms programmability scalability topology performance 
low performance spectrum gigabit ethernet provides cost effective solution system area supported department energy los alamos national laboratory contract eng see public lanl gov radiant html networks 
myrinet sci add programmability performance communication processors network interface implementing types userlevel operating system bypass communication protocols 
evolving standard provides integrated approach high performance communication dealing aspects network architecture including elimination bottlenecks bus programming interface communication protocols faulttolerance salient aspects exist 
fact design provides innovative aspects 
include novel approach integrate local virtual memory distributed virtual shared memory presence programmable processor network interface allows implementation intelligent communication protocols integrated approach network fault detection fault tolerance 
interconnect adopted compaq high performance servers 
interconnection strategy great importance los alamos national laboratory asci architecture centered 
presents performance analysis qs net 
section gives comprehensive presentation hardware building blocks elan elite 
section discusses hierarchy communication libraries 
section give description benchmarking methodology experimental apparatus section presents experimental results performance analysis 
concluding remarks section 
building blocks programmable network interface called elan high bandwidth communication switch called elite www compaq com alphaserver news supercomputer html 
interconnected fat tree topology 
network layers communication libraries provide trade offs performance ease 
important features hardware support collective communication patterns fault tolerance 
elan elan network interface links high performance multi stage quadrics network processing node containing cpus 
addition generating accepting packets network elan provides substantial local processing power implement highlevel message passing protocols mpi 
internal functional structure elan shown centers primary processing engines microcode processor thread processor 
bit microcode processor supports separate threads execution thread independently issue pipelined memory requests memory system 
requests outstanding time 
scheduling microcode processor extraordinarily lightweight enabling thread wake schedule new memory access result previous memory access go back sleep system clock cycles 
microcode threads described thread handles input transactions network 
dma thread generates dma packets written network prioritizes outstanding dmas time slices large dmas small dmas adversely blocked 
processor scheduling thread prioritizes controls scheduling thread processor 
command processor thread handles operations requested host command processor user level 
thread processor bit risc processor aid implementation higher level messaging libraries explicit intervention main cpu 
order better support implementation high level messagepassing libraries explicit intervention main cpu thread processor instruction set augmented extra instructions construct network packets manipulate events efficiently schedule threads block save restore thread state scheduling 
mmu translates bit virtual addresses bit local sdram physical addresses bit pci physical addresses 
translate addresses mmu contains entry fully associative translation lookaside buffer tlb small data path state machine perform table walks fill tlb save trap information mmu faults 
elan contains routing tables translate virtual processor number sequence tags determine refers elan version elan 
elan elan interchangeably 
network route 
routing tables loaded order different routing strategies 
elan kb cache memory organized sets kb mb sdram memory 
cache line size bytes 
cache performs pipelined fills dram able issue number cache fills write backs different units able service accesses units hit cache 
interface sdram bits check bits added provide error code correction 
memory interface contains byte write buffer byte read buffer 
link logic transmits receives data network outputs bits clock signal half clock cycle 
link provides buffer space virtual channels entry bit fifo ram flow control 
elite building block elite switch 
elite provides features bidirectional links supporting virtual channels direction internal full crossbar switch nominal transmission bandwidth mb link direction flow latency ns packet error detection recovery routing data transactions crc protected priority levels combined aging mechanism ensure fair delivery packets priority level hardware support broadcasts adaptive routing 
elite switches interconnected quaternary topology belongs general class ary trees 
quaternary fat tree dimension composed processing nodes switches interconnected delta network recursively build connecting quaternary fat trees dimension 
quaternary fat trees dimension shown 
elite networks source routed 
route information attached packet header injecting packet network composed sequence elite link tags 
packet moves inside network elite removes route tag header forwards packet elite route final destination 
routing tag identify single output link group links 
transmission packet pipelined network wormhole flow control 
link level packet partitioned smaller units called flits flow control digits bits 
packet closed packet eop token normally sent receipt packet acknowledge token 
implies packet transmission creates virtual circuit source destination 
crossbar input ports input link accommodate virtual channels 
sdram thread code processor processor way set associative cache mmu tlb table walk engine link mux dma buffers pci interface 
elan functional units mhz clock statistics registers data bus 
ary trees dimension 
fifo fifo mhz mhz packets sent multiple destinations broadcast capability network 
broadcast packet successfully delivered positive received recipients broadcast group 
connected network capable receiving broadcast packet desired broadcast set limited subset physically contiguous 
programming libraries elan network interface programmed programming libraries outlined 
libraries trade speed machine independence programmability 
starting bottom elan lib lowest programming level available user space allows access low level features elan 
level processes parallel job communicate abstraction distributed virtual shared memory 
process parallel job allocated virtual process id map portion address space elan 
address spaces taken combination constitute distributed virtual shared memory 
remote memory memory processing node addressed combination virtual address 
elan mmu process select part address space visible network determine specific access rights write read select set potential communication partners 
higher level layer frees programmer revision dependent details elan extends elan lib point point tagged message passing primitives called tagged message ports 
standard communication libraries mpi cray implemented top 
elan lib elan lib library supports programming environment groups cooperating processes transfer data directly protecting process groups hardware 
communication takes place user level copy bypassing operating system 
information elan lib provided appendix machine independent library integrates main features elan lib 
provide basic mechanisms point point message passing 
senders label message tag sender identity size message 
known envelope 
receivers receive messages selectively filtering identity sender tag envelope 
layer handles communication shared memory processes node 
worth noting programming interface similar mpi 
experimental framework tested main features experimental cluster dual processor smps equipped mhz pentium iii 
smp uses motherboard chipset gb sdram 
motherboard provides bits mhz pci slots elan pci card qm 
interconnection network quaternary fat tree dimension shown external ports qm composed port elite switches integrated board 
operating system evaluation linux test 
preliminary results shown try expose basic performance interconnection network 
reason benchmarks written elan lib level 
shortly analyze overhead introduced implementation mpi port mpi ch 
list performed experiments follows 
unidirectional ping analyze latency bandwidth network sending messages increasing size source destination smp 
order identify different bottlenecks communication buffers placed main elan memory 
alternatives include main memory main memory elan memory elan memory elan memory main memory main memory elan memory 
buffers placed desired type memory allocation mechanisms provided elan lib described appendix unidirectional ping report graphs showing latency bandwidth 
latency measured elapsed time posting remote dma request notification successful completion destination steps 
unidirectional ping tests mpi implemented matching pairs blocking sends receives 
bidirectional ping unidirectional ping experiments considered peak performance network 
sending packets directions network path expose types bottlenecks 
example elan microcode interleaves activities dma engine command processor thread processor 
test evaluate dma engine elan lib system calls bidirectional traffic 
flow control requires transmission control information lead degradation unidirectional performance presence bidirectional traffic 
hotspot test network network interface hotspot 
hotspot traffic set communication partners try read write memory block 
localized communication pattern lead severe form congestion known tree saturation seriously degrade performance network 
experiments consider read write hotspots 
experimental results unidirectional ping compares performance unidirectional ping 
asymptotic bandwidth communication libraries buffer mappings lies narrow range mb mpi mb results show slight performance asymmetry read write performance pci bus 
fact elan lib read bandwidth mb write bandwidth peak bandwidth mb reached source destination buffers placed elan memory 
maximum amount data payload sent current elan implementation bytes partitioned low level write block transactions bytes 
message format overhead bytes message header routing info implies peak bandwidth delivered network approximately mb nominal bandwidth mb results show pci chipset efficient bottleneck type communication 
pci intel significantly slower resulting unidirectional bandwidths mb see support intel com support index htm user applications mpi elan kernel 
elan programming library hierarchy graphs logically organized groups relative elan lib source buffer elan memory elan lib source buffer main memory mpi 
group low latency small medium sized messages 
basic latency increased second group extra delay start remote dma pci bus 
mpi thread processor perform tag matching increases overhead 
shows latency range 
kb 
elan lib basic latency byte messages constant messages bytes messages packed single write block transaction 
note increase latency mpi level compared latency elan lib level approximately respectively 
elan lib level latency hardware system software needed run thread elan microprocessor order match message tags introduces extra overhead responsible higher latency value 
noise bytes shown due message transmission policy 
fact messages smaller bytes sent inline message envelope available immediately receiver posts request 
larger messages sent synchronously receiver posted matching request 
bidirectional ping benchmark results shown continue draw curves corresponding experiments described previous case 
see claimed bidirectionality network fully achievable 
maximum value obtained measured bidirectional traffic mb previous case mb gap bandwidth identifies bottlenecks network network interface opposed pci bus 
causes performance degradation interleaving dma engine sharing internal data bus elan interferences link level elite network 
counter intuitively value achieved source buffer main memory destination buffer elan memory buffers elan memory 
case elan memory bottleneck 
bidirectional bandwidth main memory main memory traffic mb libraries 
shows bidirectional traffic affects latency elan lib mpi 
hotspot experiment attempt read write memory location increasing number processors smp 
bandwidth plots depicted 
upper curves aggregate bandwidth processes 
curves remarkably flat reaching mb respectively read write hotspots 
lower curves show process bandwidth 
scalability type memory operation available number processors cluster 
hotspot operations read write common scientific computing scalability hotspot resolution important 
results performance tests targeting essential performance characteristics 
lowest level communication hierarchy unidirectional latency low bandwidth high mb performance numbers influenced mapping buffers various levels memory hierarchy 
network bandwidth measured placing communication buffers elan memory mb bidirectional measurements indicate degradation performance analyzed explained 
higher levels communication hierarchy exhibit excellent performance figures comparable ones elan lib level 
summary analysis shows components performance space analyzed network delivers adequate performance levels user 
includes scalability analysis larger configurations performance larger subset collective communication patterns performance analysis asci applications 
boden danny cohen robert alan charles seitz wen king su 
myrinet gigabit second local area network 
ieee micro january 
daniel 
architecture tutorial 
hot chips tutorial august 
william dally charles seitz 
deadlock free message routing multiprocessor interconnection networks 
ieee transactions computers may 
geist william gropp steve andrew lumsdaine ewing lusk william tony skjellum marc snir 
mpi extending message passing interface 
second international euro par conference volume number lncs pages lyon france august 
william gropp steven andrew lumsdaine ewing lusk bill nitzberg william marc snir 
mpi complete volume mpi extensions 
mit press 
hermann 
sci standard applications sci 
hermann alexander editors sci scalable coherent interface volume lecture notes computer science pages 
springer verlag 
charles leiserson 
fat trees universal networks hardware efficient supercomputing 
ieee transactions computers october 
fabrizio marco 
ary trees high performance networks massively parallel architectures 
proceedings th international parallel processing symposium ipps pages geneva switzerland april 
fabrizio marco 
performance analysis wormhole routed ary trees 
international journal foundations computer science june 
pfister norton 
hot spot contention combining multistage interconnection networks 
ieee transactions computers october 
quadrics supercomputers world elan programming manual january 
quadrics supercomputers world elan manual january 
quadrics supercomputers world elite manual november 
rich seifert 
gigabit ethernet technology applications high speed lans 
addison wesley may 
marc snir steve otto steven david walker jack dongarra 
mpi complete volume mpi core 
mit press 
dubois dubois feng 
changing guard gateway 
proceedings th international conference parallel interconnects pi october 
werner vogels david hsieh david david stern 
tree saturation control ac velocity cluster 
hot interconnects stanford university palo alto ca august 
elan lib main features elan lib event notification memory mapping allocation scheme remote dma transfers 
event notification events provide general purpose mechanism processes synchronize actions 
mechanism threads running elan processes running unidirectional ping latency unidirectional ping bandwidth mpi main main elan main main mpi elan elan main elan elan main main main elan elan elan elan main elan elan elan main elan main main latency bandwidth mb msg size bytes msg size bytes bidirectional ping latency bidirectional ping bandwidth mpi main main elan main main mpi elan elan main elan elan main main main elan elan elan elan main elan elan elan main elan main main latency bandwidth mb 
unidirectional bidirectional pings msg size bytes msg size bytes main processor 
events accessed locally remotely 
way processes synchronized network indicate communication operation completion remote ma 
events stored elan memory order guarantee atomic execution synchronization primitives processes wait event triggered blocking busy waiting polling 
addition event tagged block copy event 
block copy mechanism works follows 
block data elan memory initialized hold pre defined value 
equivalent sized block located main memory user virtual address space 
specified event set example dma transfer completed block copy takes place 
block elan memory copied block main memory 
user process polls block main memory check value example bringing copy corresponding memory block cache having poll information pci bus 
value initialized source block process knows specified event happened 
bandwidth mb memory mapping allocation mmu elan translate virtual addresses written format main processor example bit word big endian architecture alphaserver virtual addresses written elan format bit word little endian architecture 
processor bit architecture example intel pentium mapping required 
mapping bit processor shown 
bit addresses starting ff mapped elan bit addresses starting xc 
current pci bus implementations guarantee atomic execution possible store events main memory 
hotspot global read bandwidth global write bandwidth smp read bandwidth smp write bandwidth number smps 
read write hotspot means virtual addresses range ff accessed directly main processor elan access memory addresses range xc 
example user may allocate main memory malloc process heap may grow outside region directly accessible elan delimited 
order avoid problem main elan memory allocated consistent memory allocation mechanism 
shown mmu tables set map common region virtual memory called memory allocator heap 
allocator maps physical pages main memory elan virtual address range demand 
allocation functions provided elan library portions virtual memory allocated main elan memory main processor elan kept consistent 
reasons efficiency objects located elan example communication buffers dma descriptors elan process independently main processor 
remote dma elan supports remote dma direct memory access transfers network copying buffering operating system intervention 
process initiates dma fills dma descriptor typically allocated elan memory efficiency reasons 
dma descriptor contains source destination amount data source destination addresses event locations source destination process information enhance fault tolerance 
typical steps remote dma outlined 
ff mb main processor virtual address space heap bss data text stack allocator heap system main memory elan virtual address space heap bss data text stack allocator heap system elan sdram 
virtual address translation processor processor event source event destination elan sdram dma descriptor event elan sdram event mmu mmu command processor table walk engine command processor 
execution remote dma 
sending process initializes dma descriptor elan memory communicates address dma descriptor command processor 
command processor checks correctness dma descriptor adds dma queue 
dma engine performs remote dma transaction 
completion remote notifies dma engine sends ack source elan 
source destination events notified needed 
table walk engine dma engine dma engine mb 
