retinex bilateral filters michael elad computer science department technion israel institute technology haifa israel 
email elad cs technion ac il 
retinex theory deals removal unfavorable illumination effects images 
ill posed inverse problem typically regularized forcing spatial smoothness recoverable illumination 
field suggested exploiting knowledge illumination image bounds image fact reflectance expected smooth 
show model improved provide non iterative retinex algorithm handles better edges illumination suppresses noise dark areas 
algorithm uses specially tailored bilateral filters evaluates illumination computation reflectance 
result stands theoretic justification refinement proposed heuristic bilateral filter retinex durand dorsey 
line appealing way speeding bilateral filter show similar speedup methods apply algorithm 
retinex theory deals removal unfavorable illumination effects image 
commonly assumed model suggests image pixel wise multiplication images reflectance illumination look table log operation transfers multiplication addition resulting log log log clearly recovery ill posed inverse problem 
solving typically done introducing regularization forces spatial smoothness recoverable illumination 
early heuristic successful retinex methods homomorphic filtering algorithm proposed low pass filter algorithm amounts effect obtain rough estimate 
refrain reviewing literature limit approach topic building study 
describes improvements classical retinex models 
improvement refers passivity reflectance assumed satisfy 
direct consequence implying illumination image envelope image bounding 
due monotonicity log operation merging desire get spatially smooth may lead trivial meaningless result constant image max 
remedy proposed assume michael elad small implying upper envelope close 
modifications reconstruction illumination posed quadratic programming qp problem min dx dy 
operators dx dy represent horizontal vertical discrete derivatives forcing way spatial smoothness 
second ingredient introduced smoothness penalty forced reflectance image 
added gives min dx dy dx dy note enforced new term contradicts illumination smoothness jointly smooth 
effect gain smoothness expense losing 
justification desire lead nice looking natural images 
model efficient multi scale algorithm proposed estimate model propose simplified estimate solvers known implementation constraints 
simplified computation introducing spatial recursive smoothing filter 
model general covers correct forces solution retinex problem flaws commonly encountered artifact retinex algorithms existence 
direct consequence smoothness assumption discussed 
passing strongly illuminated region dark zone border shadowed area smoothness forces illumination remain high dark region near edge smoothly descend grasp illumination dark region 
removed dark regions near edges remain dark resulting effects 
effects obtained bright areas near illumination edges constraint practiced 
bright areas brighter 
noise dark regions image retinex algorithms expected yield contrast stretching similar effect caused standard gamma correction 
stretching causes magnification noise evident especially low quality images ones noticeable compression 
constraint implies noise migrates ingredients suppressed 
iterative solution model formulation leads naturally need iterative solver 
bypassed limitation price final outcome quality 
propose alternative model retinex numerical algorithm builds 
new model similar lecture notes computer science sense forces included 
new model enhanced solve mentioned shortcomings 
specifically smoothness illumination reflectance forced robust statistics method avoided 
smoothness terms spirit bilateral filter having wide stencil effect enables avoiding need iterative multi scale solver :10.1.1.126.2091
different smoothing formulation reflectance illumination handle differently absorb constraint natural way 
leads stage algorithm applies variations bilateral filter estimating illumination reflectance 
new model suppresses noise allowing deviate implying residual additive noise want discard 
new model accompanying algorithm stand theoretic justification refinement proposed heuristic bilateral filter retinex appeared 
line appealing way speeding bilateral filter show similar speedup methods bilateral filter variations 
organized follows section presents bilateral filter building 
section turn describe new model retinex algorithm emerges 
speedup methods discussed section 
section presents results section concludes 
denoising bilateral filter section bilateral filter designed removal additive noise images 
discuss origins described 
serve turn consider retinex problem 
consider image contaminated additive noise 
goal develop edge preserving smoothing algorithm effectively removes noise preserving image details 
maximum posteriori probability map formulation problem yields min cm cm 
operators cm shift operators moving image pixels horizontally pixels vertically 
matrices diagonal matrices weight large edge entries smooth edges image 
choice leads non robust option problem qp 
choosing weights inversely proportional cm ns leads ability handle edges image better 
note weighting parallels robust statistics relationship 
fact smoothness forced wide neighborhood implies simple iteration minimize functional effective 
established bilateral filter michael elad approximate solver programming task 
specifically shown bilateral filter amounts single jacobi iteration penalty term 
briefly show property meaning 
jacobi step constructed gradient diagonal hessian penalty function 
gradient hessian cm cm 
cm cm 
denoting main diagonal hessian matrix assuming initialization jacobi iteration minimize gives diag cm cm represents operator multiplies image operator applies weighted sum input pixels stencil pixels compute output weights dependent local differences center pixel neighbors 
spatially adaptive fir filter sort 
shown weight pixel chosen obtain filter tomasi manduchi proposed 
equivalence choose exp gaussian kernel 
consider robust functions weights give filter line spirit bilateral filter 
interestingly filter discrete version short time effective kernel beltrami flow discussed 
implies algorithm deep roots geometric understanding images manifolds 
analysis helpful understanding origins bilateral filter hard understand applied practice 
shown effective filter computes output pixel additional comes null factor gradient term 
lecture notes computer science exp 
term normalizes weights sum 
filter assigns neighbor weight inversely proportional euclidean distance inversely proportional distance gray value center pixel 
parameters governs behavior filters :10.1.1.126.2091
retinex bilateral filters section new model retinex problem uses bilateral smoothness term 
model develop bilateral filters compose novel retinex algorithm 
retinex result avoided allowing piece wise smooth 
easily accomplished replacing terms dx dy dx dy tv robust statistics penalty numerous options 
adopting local terms implies need iterations numerical solution 
consider bilateral smoothness 
brevity notations denote bw cm nx cm nx 
starting quadratic programming problem posed propose alternative model retinex bw pr min part handles smoothness illumination proximity bounding 
second part introduces smoothness reflectance requires close residual image 
noise discarded residual note notations hints fact consider different weights parameters smoothness terms formulation leads decomposition seeks unknown imply 
optimizing respect parallel option explored certainly addressed model posed adopt stage process estimating part evaluate starting quest attempt evaluate addresses term 
seek solution problem min bw 
michael elad clearly constraint equivalent problem posed bilateral filter excellent solver candidate 
natural question pose constraint accommodated way preserves convenience bilateral filter 
propose introduce special choice weights handle constraint implicitly 
new weights equation sided robust function exp 
alternative choice weights introduces simple modification bilateral filter neighbors pixel consider satisfy 
way local averaging done non negative normalized weights combining pixels higher gray values center pixel resulting final outcome satisfy 
new filter necessarily achieve satisfaction constraint virtue weights reducing newly defined penalty term considers smoothness desire 
refer filter envelope bilateral filter 
practice implies bilateral filter section slightly changed 
parallel envelope bilateral filter output pixel evaluated exp notation stands step function non negative zero 
term normalizes weights sum 
note description clear peak neighborhood filtering amounts case weights zero 
assuming stage completed estimate turn evaluate consider second term solving min pr 
image bilateral filter formulation 
application bilateral filter image lead desired due transform log domain noise discarded reflectance image resides regions lecture notes computer science low 
better direct bilateral filter inversely proportional reflect matter 
choice form effect definition implementation bilateral filter prevents having spatially adaptive parameter 
ensure hardly smoothed regions bright smoothed darker regions 
speeding retinex algorithm durand dorsey proposed wonderful speedup algorithm bilateral filter algorithm applied directly bilateral filter versions 
outline basic ideas speedup starting equation said applies just second bilateral filter 
referring equations constant re write equations exp exp exp 
expression convolution image exp gaussian blur 
apply sequence convolutions scanning values range log merging results choosing proper values output values 
note value similar expression exp exp 
recall shift avoid singularities 
michael elad computation done sequence similar convolutions 
durand dorsey proposed ways speed evaluation piece wise linear approximation ii multi scale implementation 
idea scan values range log jumps interpolate 
practically speaking equispaced jumps range log induce change outcome 
weights include step function discontinuity interpolation done sided operation preferring adopt larger avoid violation constraint 
causes interpolation loose accuracy experiments show lose mild unnoticeable 
multi scale option images convolved expressions wide range gaussian smoothers pre scale post scale yield substantial gain run time change outcome 
gain especially noticed wide supports 
top ideas note required convolutions required separable 
furthermore large effective convolving kernel square step function 
case speedup obtained computation integral image 
results interesting idea reported return illumination reflectance presenting final output image 
output image computed reflectance images typically unrealistic looking modest reduced effect illumination returned final image enjoys desired brightness natural appearance 
idea results 
illumination returned original image applying gamma correction multiplying back estimated reflectance 
figures pairs original images retinex results 
cases spatially varying little effect images high quality show 
presents results third image dark region noisy versions shown side side comparison parameters 
note processing color images apply retinex algorithm luminance layer hsv color representation leave chromatic layers unchanged 
cases setup parameters envelope bilateral filter parameters 
second bilateral filter pr adaptive method described earlier 
speedup algorithm scale factor grey value steps 
figures return example presenting accompanying results 
shows obtained reflectance illumination results gray images nasa retinex web page 
lecture notes computer science fig 

example original image left retinex result right 
fig 

example original image left retinex result right 
fig 

example original image left retinex results regular bilateral filter computing middle spatially adaptive right 
michael elad value images referring layer 
seen call reflectance far satisfactory describe image room return illumination 
indicates separation perfect leakage 
fact stand large scale intensity components small scale corrections respectively estimated preservation discontinuities 
final outcome satisfactory illumination return 
describes correspondence retinex algorithm showing retinex process generally resembles effect different effect varying gamma 
idea expanded showing image effective log log function location 
gives effective gamma correction applied pixel reproduce obtained result 
fig 

reflectance illumination images example 
fig 

example right input output mapping overlayed gamma correction corresponds left effective gamma correction value pixel 
improvement speed introduced speedup algorithm depends parameters mentioned implemen lecture notes computer science tation issues 
compared efficient implementations bilateral filter implemented matlab 
sweeps support filter applying operations complete images speedup algorithm mentioned 
parameters obtained factor shorter run time speedup algorithm 
presents comparison new algorithm reported severely degraded image comparison changed color space choose illumination return done match alternative algorithm 
results show strong previous method fully suppressed algorithm 
fig 

original image top new retinex algorithm bottom left reported bottom right 
new model retinex problem removal undesired illumination effects image 
new model enables better handling edges illumination causes effects enables eyal gordon cs department technion 
michael elad suppression noise dark areas 
algorithm model developed leading specially tailored bilateral filters evaluates illumination second computation reflectance 
stands theoretic justification refinement proposed heuristic bilateral filter retinex durand dorsey 
way speeding bilateral propose similar speedup methods filters 

faugeras 
digital image color processing framework human visual system ieee trans assp 

land 
advances retinex theory implications cortical computations color vision natural image proc 
nat 
acad 
sci 
usa 

blake 
boundary conditions lightness computation mondrian world computer vision graphics image processing 

terzopoulos 
image analysis multigrid relaxation methods ieee trans 
pami 

funt mccann 
retinex matlab journal electronic imaging 
terzopoulos 
image analysis multigrid relaxation methods ieee trans 
pami 

kimmel elad shaked keshet sobel 

variational framework retinex international journal computer vision 

elad kimmel shaked keshet 
reduced complexity retinex algorithm variational approach journal visual communication image representation 

shaked keshet 
robust recursive envelope operators fast retinex hewlett packard research laboratories technical report hpl 

tomasi manduchi 
bilateral filtering gray color images proc 
th int 
conf 
computer vision new delhi india 

elad 
bilateral filter ways improve ieee trans 
image processing 

durand dorsey 
fast bilateral filtering display range images siggraph 


fundamental relationship bilateral filtering adaptive smoothing nonlinear diffusion equation ieee trans 
pattern anal 
mach 
intell 

weickert 
robust estimation smoothing spatial tonal kernels 
geometric properties incomplete data 
kluwer dordrecht appear 

kimmel malladi 
geometrical framework low level vision ieee trans 
image processing 

kimmel bruckstein 
diffusions confusions signal image processing math 
imag 
vis 

chan osher shen 
digital tv filter nonlinear denoising ieee trans 
image processing 

viola jones 
rapid object detection boosted cascade simple features conference computer vision pattern recognition 
