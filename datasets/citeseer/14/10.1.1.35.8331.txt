tracking surveillance wide area spatial environments hidden markov model hung bui venkatesh geo west department computer science university technology perth wa australia geo cs edu au consider problem tracking object predicting object trajectory wide area environment complex spatial layout multiple sensors cameras 
solve problem need representing dynamic noisy data tracking tasks dealing di erent levels detail 
employ hidden markov models ahmm extension known hidden markov model hmm special type dynamic probabilistic network dpn underlying representation framework 
ahmm allows explicitly encode hierarchy connected spatial locations making scalable size environment modelled 
describe application tracking human movement oce spatial layout ahmm track predict evolution object trajectories di erent levels detail 
wide area spatial environments characterised complex spatial layouts large state space multiple cameras sensors 
dealing wide area spatial environment addition ability handle dynamics uncertainty environment ability process information environment various levels abstraction important 
bayesian network established framework dealing uncertainty 
applications need deal temporal dynamics environment dynamic probabilistic network dpn special bayesian network architecture representing evolution domain variables time 
special case dpn time slice single state variable observation node wellknown hidden markov model hmm 
bayesian models applied number researchers general problem recognising classifying individual group behaviours spatial domain :10.1.1.132.3753
applications domain usually locally restricted behaviour interest assumed take place single room local spatial region 
need dealing di erent levels abstraction arise 
modelling agent behaviour large spatial environment possibly long temporal interval poses new problems 
firstly state space model large due size environment considered 
secondly behaviours exhibited complex planned satisfy markov assumption state level 
propose probabilistic framework modelling large spatial environment speci cally addresses issues 
framework multi layer bayesian dynamic structure term hidden markov model ahmm known layered dynamic probabilistic network 
structurally ahmm extension basic hmm single hidden chain hmm replaced set multiple layered hidden chains 
structure special type generic dynamic probabilistic network 
speci cally thought coupled factorial hidden markov model chmm fhmm special type couplings hidden layers 
semantically layer ahmm corresponds path environment particular level detail 
couplings consecutive layers ahmm represent decomposition path higher layer re ned path lower layer 
multi layer model take direct advantage inherent structure large spatial environment making scalable larger spatial layouts 
structured follows 
section reviews various existing bayesian network architectures spatio temporal domain 
introduce ahmm describe tracking scenario ahmm answer queries tracked object di erent levels abstraction 
related background bayesian network known belief network probabilistic network established framework reasoning uncertainty 
ers graphical compact representation joint probability distribution jpd set variables number ecient algorithms computing various marginal conditional probabilities represented jpd 
bn achieves eciency utilising conditional probabilistic independence relations variables encoded directed acyclic graph dag structure 
set nodes graph corresponds set variables jpd 
links set parent nodes child node parameterised conditional probability corresponding child variable parent variables pr pa pa set parent nodes links causal interpretations attached case variable interpreted caused variables pa 
complete bn graphical structure parameters nodes represents factorisation jpd pr pr pa probabilistic reasoning bayesian networks termed inferencing problem calculating conditional probability variable values set variables evidence 
evidence marginal probabilities need computed 
algorithms developed doing fall main categories 
exact inference algorithms compute exact probability required network parameters algebraic analytical manipulation 
inexact inference algorithms compute estimate required probability form stochastic simulation network 
group algorithms trade accuracy probability estimates speed estimates obtained 
shown exact inference bn np hard network size inexact inference polynomial complexity network size np hard accuracy estimated probabilities 
light theoretical results inexact inference methods useful large networks certain degree error estimated probabilities tolerable 
dynamic probabilistic network dpn special bayesian network architecture developed modelling dynamic environment 
dpn number time slices time slice represents state environment current time 
time slice bayesian network 
dynamics environment encoded links parameters time slice termed evolution model 
time slice contains observation nodes values observed current time 
common assume current observation dependent current time slice current time slice independent happens past 
conditional probability observation nodes time slice constitutes observation model 
ect noisy sensors usually captured observation models 
dpn sequence observations want draw predictions state variables predicting unobserved variables past smoothing 
problem solved standard inference algorithms bayesian networks 
monitoring situations observations arrive time reapplying inference algorithm time observation sequence changes costly especially length observation sequence grows 
avoid problem common keep joint distribution variables current time slice observation sequence date 
probability distribution termed belief state plays important role inferencing dpn 
existing inference schemes dpn involve maintaining updating belief state approximation forms :10.1.1.119.6111:10.1.1.48.7248
new observation received current belief state rolled time slice ahead evolution model conditioned new observation obtain updated belief state 
obvious problem approach size belief state need maintain 
size intractably large necessary maintain approximation actual belief state form set weighted samples form approximate distribution represented compactly 
special case dpn time slice single state variable observation node known hidden markov model hmm 
extensions hmm multiple hidden chains coupled hidden markov models chmm factorial hidden markov models fhmm considered :10.1.1.50.8099:10.1.1.16.2929
models size belief state exponential number hidden chains 
inference parameter estimation problems intractable model consists hidden chains 
reason approximate techniques similar proposed 
hidden markov models viewed type coupled factorial hidden markov model network consists number interacting chains 
ahmm layer thought chain acting goal sequence layer goal realisation sequence layer 
chain ahmm interacts chains directly 
type interaction di erent types interaction considered :10.1.1.16.2929
addition nodes ahmm represent speci goal location environment links clear causal interpretation decomposition goal sequence subgoals leading goal 
contrast coupled hmm nodes links usually clear semantic causal interpretation 
number applications bayesian networks dealing noisy data spatio temporal domain including monitoring surveillance trac scenes tracking human movement group behaviours recognising classifying human gestures 
note applications domains usually locally restricted domain restricted single room single ground space region 
need dealing di erent level detail arise 
hidden markov model ahmm need structure dynamic model hidden markov model sucient modelling simple behaviours locally restricted region suited modelling complex behaviours especially take place large environment span long period time possibly number di erent stages 
main drawbacks having structure modelling situation 
behaviours evolve large environment non markov nonstationary ground level 

state space large hinders ecient computation 

structure unable handle queries di erent levels abstraction 
non markov non stationary problem clearer toy example illustrated fig 
thief plan entering room front door retrieve money middle room escape right door 
positions thief room plan carried represented sequence ground coordinates 
sequence shown satisfy markov assumption follows 
suppose time thief position depends entire history knowing history tell money retrieved prior time information turn tells time thief trying get money escape room drastically ect prediction position time 
history prediction history prediction thief example example illustrates general situation behaviours tracks planned advance evolve stages 
stage corresponds interval achieving intermediate goal reaching intermediate destination 
transition probabilities assumed stationary stage vary stage stage 
thief example intuitively view sequence positions concatenation stationary markov chains hmm noisy observations considered corresponding stages retrieving money escaping right door 
formal representation requires inclusion current stage equivalently current goal destination part chain state space 
words addition need introduce new variable represents current goal time new model viewed consisting interacting chains 
actual state space product set positions set possible intermediate destinations chain viewed realisation goal sequence goal sequence viewed abstraction chain 
similarly consider behaviours planned levels 
lead model consisting multiple chains organised chain realisation chain chain abstraction chain 
essence hmm model discussed rest section 
layer model rst consider simplest model consisting layers goal layer state layer 
model situation agent follows plan ordered sequence subgoals 
addition variable denote observation current state assume current state observed current goal 
observation model hmm set parameters encoding conditional probability observation obtained true state pr 
dynamics model described terms interaction chains representing states goals 
consider types interaction evolution type interaction represents current goal ects transition previous state current state 
graphically modelled evolution links current goal previous state current state numerically parameters links constitute evolution model em conditional probability current state previous state current goal pr persistence plan execution assume goal persists achieved state level 
persistence links represent current state uence achievement current goal 
binary variable representing current goal achieved 
persistence uence encoded links links parameterised persistence model pm encoding probability current goal achieved current state pr true true assume time instant current goal replaced goal succeeding plan current goal persists time goal achievement goal layer state layer observation layer time slice layer ahmm instant pr false pr succ true bayesian network layer model shown fig 

essence model follows 
agent starts rst goal plan initial state chosen initial state distribution process repeated current time current state current goal persistence model determines value achievement status current goal turns determines current goal persist time replaced goal succeeding plan new goal current state evolution model determines new state usual state observation model determines observation process viewed informally concatenation hmms corresponds interval achieving subgoal plan interval goal remains state transition probabilities stationary 
interval ends current goal achieved 
model layer model consider single goal layer state layer realisation goal layer 
describe full ahmm arbitrary number goal layers 
full ahmm designed model situation agent achieve top level goal top plan achieve level level re nement process creates series subgoals di erent levels abstraction bottom level state layer term hmm 
number intermediate subgoal levels 
notation denote subgoal level time denotes state time 
ahmm addition top level goal top contains chains represent evolution current subgoals state time 
full graphical model ahmm shown fig 

interaction chains similar types interaction layer model 
chain subgoals level receives types causal uence evolution uence chain directly persistence uence chain directly 
persistence uence determines current subgoal level achieved evolution uence determines subgoal level similar eq evolution model level ahmm pr true note current subgoal achieved false current subgoal persist time eq determine subgoal current subgoal achieved true 
equation state level assume true 
similar eq persistence model level pr true true note current subgoal level achieved false current subgoal level achieved 
eq determine observation layer time slice level goal level goal achieved state layer level goal achieved level goal level goal gk level goal achieved ak top level goal top level goal level goal achieved ahmm achievement status current subgoal level current subgoal level achieved true 
inference parameter re estimation monitoring situation asked prediction current goal position agent history observation current time 
ahmm di erent queries current goals various levels abstraction constructed 
types queries answered computing current belief state ahmm conditional joint probabilities current variables current observation history 
belief state computed prediction behaviour agent obtained simulating network 
ahmm type dynamic probabilistic network procedure maintaining belief state dpn applied directly 
main diculty doing belief state ahmm dimension intermediate goals top level goal state variable 
size belief state needs maintained grow exponentially ahmm layers necessary employ approximate inference schemes dpn 
adapted stochastic simulation inference scheme ahmm structure 
subsection illustrate ahmm inference method problem tracking surveillance wide area environment 
similar reasons number hidden layers exact algorithms hmm parameter re estimation inapplicable ahmm layers 
approximation methods factorial hmm needed 
special case training data contains values intermediate goals ahmm structure decomposed number separate models corresponding process achieving particular intermediate goal 
example layer ahmm decomposed separate hmm intermediate goals 
parameters models estimated independently standard hmm parameter re estimation methods 
procedure illustrated subsection 
modelling large spatial environment modelling large spatial environment simple representation ground plane coordinate suce 
suitable representation need take account locations special landmarks environment especially task involves tracking human movement 
landmarks doorways furniture windows places people tend visit act set possible destinations person follow 
facilitate working di erent levels detail important hierarchy set locations 
modelled assigning location number representing level detail location belongs 
example assign room doors level oor entrances exits level main building entrances exits level 
tracking room room need consider locations 
tracking oor oor need consider locations level numbers greater equal spatial environment corresponding hierarchy locations ahmm represent evolution path location di erent levels detail 
example path level goes set th level locations represented chain 
evolution model ahmm represents level path re ned level path starting top level destination ground level reached 
speci cally evolution parameter represents probability path evolve level location agent currently location having higher level destination 
note evolution probabilities need speci ed set destinations vicinity higher level destination 
example coordinate level specify evolution probabilities room assuming room door destination 
door door level evolution probabilities speci ed set doors oor assuming oor exit destinations 
partition environment hierarchy smaller regions helps reduce size evolution parameters ahmm model scalable larger environments 
addition assume goal achieved corresponding destination reached 
event reaching level destination achieves goal reaching level destination words persistence model ahmm 
example consider environment shown fig 
building consisting connected rooms 
room modelled set cells grid adjacent rooms connected door centre common edge 
entrances building labelled north west south east 
addition door centre building acts entrance building north wing south wing 
hierarchy spatial environment constructed follows 
state level level consists set connected cells rooms 
level consists set doors entrances 
level consists set building entrances wing entrance 
top level level consists entrances building 
evolution parameters state level specify transition probabilities cells single room room door agent heading 
level evolution parameters specify transition probabilities doors wing exits 
level evolution parameters specify transition probabilities wing entrances exits main exits 
sample evolution parameters fig 

experiments results section illustrate ahmm model simulated tracking problem complex spatial environment 
task involves tracking movement object environment shown fig 

environment back door parameters ahmm level final destination final destinations prior level level back door right right door right door state level level destination right door example environment typical room ahmm parameters acquisition tracking carried parameters ahmm needs speci ed 
note ahmm transition probabilities coordinate level observation model learned separately room standard method hmm parameter re estimation 
simplicity assume rooms identical perform parameter re estimation step real data room shown fig 

implement crude tracking module background subtraction returns current coordinate moving object human frame 
coordinate value calculated middle point object bounding box shown fig 
treated noisy observation true coordinate 
sequence returned coordinates observation sequence hmm 
destination room door sequences obtained letting di erent people walking target door 
object movement model camera observation noise model estimated data 
resulting movement observation model shown fig 

observation model contains probability cell occupied agent observed cells neighbourhood mask fig 

camera looking room bottom left corner notice errors tend spread south west northeast direction 
movement model contains probability destination front direction agent move front left right back cell stay cell fig 
note model gure oriented front direction pointing upward 
parameters ahmm higher level simply frequency object landmark move neighbouring landmarks higher level destination 
experiment simplicity specify probabilities manually easily recorded real scenario 
observation model movement model movement observation model rm rm rm rm rm rm rm rm synthetic track building tracking predicting ahmm simulate tracking task structure parameters ahmm generate random sequence cells bottom level hierarchy simulate observation agent path 
fig 
shows example generated path prior corrupted noise observation model entering building west entrance exiting building east entrance 
number shown position track represents time agent position 
set generated observation points input data run ahmm inference algorithm answer queries tracked object 
time slice look queries di erent levels abstraction main entrance object heading room object currently nearest door entrance agent currently heading 
scope rst query entire environment scope queries limited immediate surroundings current position tracked object 
answer rst query probability distribution set building exits obtained computing conditional probability top level goal node ahmm structure past sequence observations 
answer second query probability distribution set rooms obtained computing conditional distribution current coordinate level node ahmm 
answer third query probability distribution set doors entrances obtained conditional probability level goal node 
stochastic simulation inference algorithm provides estimates true probabilities run algorithm data times record averaged probability estimates standard deviation estimates returned di erent runs averaged computation time run 
number simulation samples set number increased obtain better accuracy probability estimates cost increasing computation time 
averaged probabilities obtained rst query plotted fig 

result shows predicted probabilities agent exit building exits time 
initially probabilities 
agent moves away room time pr starts decrease 
agent enters room time pr drops zero 
time pr greater pr 
agent enters room time pr dominant expected 
results obtained second third queries plotted fig 

note rooms doors plot probabilities room fig 
probabilities doors exiting room left right back fig 

fig 
shows time time object brie enters room time exit probabilities south east north result exit query room comes back room 
time object enters room room 
fig 
shows probabilities di erent doors object uses exit room 
time time object exits room back door time object exits room right door 
fig 
plots average error probability estimates indication uncertainty estimates returned run 
start run error arti cially small probability estimates initialised value runs 
grows stabilises starts decrease run target building exit certain 
average cpu time taken run plotted fig 

number samples xed time taken process new observation roughly seconds pentium machine 
note algorithm faster slower return accurate estimates varying sample population size 
issues trade accuracy eciency various means increase accuracy time ratio current inference algorithm scope subject current investigation 
time room probabilities rm rm rm probabilities agent room time door probabilities back door right door left door probabilities agent exiting room di erent doors results room door queries time standard deviation probability estimates std 
dev 
average error probability estimates time average processing cpu time cpu time average cpu time demonstrated ahmm tracking object movement wide area environment 
shown ahmm represent uncertain data spatial domain deal di erent levels detail 
dividing environment regions corresponding locations higher level transition probabilities need speci ed vicinity surrounding destination making size transition probability tables relatively constant ahmm model scalable wide area environments 
due decomposition parameters ahmm estimated separately region simplifying model acquisition step 
research directions investigated 
di erent methods approximate inferencing ahmm gibbs sampling variational approximation scheme tested compared current inference method terms eciency accuracy 
model enriched investigating coupled modelling group behaviours 
intermediate sub goals explicitly represented ahmm group behaviour speci ed coupling individual goals 
currently ahmm deployment wide area surveillance system multiple cameras di erent sites environment 
xavier boyen daphne koller 
tractable inference complex stochastic processes 
proceedings fourteenth annual conference uncertainty arti cial intelligence 
matthew brand 
coupled hidden markov models modeling interacting processes 
submitted neural computation 
matthew brand oliver alex pentland 
coupled hidden markov models complex action recognition 
ieee conference computer vision pattern recognition 
hung bui venkatesh geo west 
layered dynamic bayesian networks spatio temporal modelling 
intelligent data analysis 
hilary buxton gong 
advanced visual surveillance bayesian networks 
proceedings ieee international conference computer vision 
cooper 
computational complexity probabilistic inference baysian belief networks 
arti cial intelligence 
dagum luby 
approximating probabilistic inference bayesian belief networks np hard 
arti cial intelligence 
paul dagum adam eric horvitz 
dynamic network models forecasting 
proceedings eighth annual conference uncertainty arti cial intelligence pages 
ambrosio 
incremental probabilistic inference 
proceedings ninth annual conference uncertainty arti cial intelligence pages 
thomas dean kanazawa 
model reasoning persistence causation 
computational intelligence 
maybank 
vehicle trajectory approximation classi cation 
british machine vision conference 
fung chang 
weighting integrating evidence stochastic simulation bayesian networks 
proceedings fifth conference uncertainty arti cial intelligence 
zoubin ghahramani michael jordan 
factorial hidden markov models 
machine learning 
henrion 
propagating uncertainty bayesian networks probabilistic logic sampling 
lemmer kanal editors uncertainty arti cial intelligence amsterdam 
north holland 
huang koller malik rao russell weber 
automatic symbolic trac scene analysis belief networks 
proceedings national conference arti cial intelligence aaai 
jensen 
bayesian networks 
springer 
jensen lauritzen olesen 
bayesian updating recursive graphical models local computations 
computational statistics quarterly 
jordan ghahramani saul 
hidden markov decision trees 
mozer jordan petsche editors advances neural information processing systems cambridge ma 
mit press 
kanazawa daphne koller stuart russell 
stochastic simulation algorithms dynamic probabilistic networks 
proceedings eleventh annual conference uncertainty arti cial intelligence pages 
computational scheme reasoning dynamic probabilistic networks 
proceedings eighth annual conference uncertainty arti cial intelligence pages 
kj computational system dynamic time sliced bayesian networks 
international journal forecasting 
lauritzen spiegelhalter 
local computations probabilities graphical structures application expert systems 
journal royal statistical society 
nicholson brady 
data association problem monitoring robot vehicles dynamic belief networks 
proceedings tenth european conference arti cial intelligence pages 
oliver barbara rosario alex pentland 
bayesian computer vision system modeling human interactions 
proceedings 
pearl 
reasoning intelligent systems networks plausible inference 
morgan kaufmann san mateo ca 
judea pearl 
evidential reasoning stochastic simulation causal models 
arti cial intelligence 
lawrence rabiner 
tutorial hidden markov models selected applications speech recognition 
proceedings ieee 
shachter peot 
simulation approaches general probabilistic inference belief networks 
proceedings fifth conference uncertainty arti cial intelligence 
jeremy york 
gibbs sampler expert systems 
arti cial intelligence 

