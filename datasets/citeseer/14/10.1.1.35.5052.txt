signal processing generalized gradient vector flow external forces active contours xu jerry prince image analysis communications laboratory department electrical computer engineering johns hopkins university baltimore md usa active contours snakes extensively computer vision image processing applications particularly locate object boundaries 
new type external force active contours called gradient vector flow gvf introduced address problems associated initialization poor convergence boundary concavities 
gvf computed diffusion gradient vectors gray level binary edge map derived image 
generalize gvf formulation include spatially varying weighting functions 
improves active contour convergence long thin boundary indentations maintaining desirable properties gvf extended capture range 
original gvf special case new generalized gvf ggvf model 
error analysis active contour results simulated test images 
elsevier science rights reserved 
oder werden und anwendungen um zu 
ein typ kr fte fu gradient ector flow gvf wurde hrt um probleme die mit und zu 
gvf wird als eine diffusion des einer oder binary edge die aus dem werden 
diesem wir die gvf da zwei ra werden 
dies die zu du nnen hrend andere wu des gvf wie 
das gvf ist ein dieses gvf ggvf 
von mit wird pra 
elsevier science rights reserved 
sum les contours ou snakes sont utilis en vision par ordinateur pour les applications de traitement images pour les contours objects 
un type de force pour les corresponding author 
tel fax mail prince jhu edu 
preliminary version appeared proceedings johns hopkins university conference information sciences systems 
research supported nsf mip 
see front matter elsevier science rights reserved 
pii xu prince signal processing contours appel flux de gradients fvg te pour les mes associ initialisation la convergence vers des dans les contours 
le fvg est calcul comme une diffusion des gradients une carte des contours une image en de gris ou 
dans cet article nous ne la formulation du fvg pour deux fonctions de variation 
am la convergence des contours vers les indentations de contours fines tout en les autres propri te int des fvg comme la de capture 
les fvg sont un cas des mod les de fvg ge ne une analyse de des de contours sur des images de test synth est aussi pr sent elsevier science rights reserved 
keywords edge detection image segmentation shape representation recovery deformable models active contour models gradient vector flow 
active contours snakes curves defined image domain move influence internal forces curve external forces derived image data 
internal external forces defined snake conform object boundary desired features image 
snakes widely applications including edge detection shape modeling segmentation motion tracking 
key difficulties design implementation active contour models 
initial contour general close true boundary converge wrong result 
second active contours difficulty progressing boundary concavities 
xu prince developed new external force called gradient vector flow gvf largely solves problems :10.1.1.35.1779
gvf computed diffusion gradient vectors gray level binary edge map derived image 
resultant field large capture range means active contour initialized far away desired boundary 
gvf field tends force active contours boundary concavities traditional snakes poor convergence 
difficulties forcing snake long thin boundary indentations 
generalize gvf formulation include spatially varying weighting functions 
weighting functions define tradeoff smoothness resulting gvf field conformity gradient underlying edge map 
external force fields derived new generalized ggvf improve active contour convergence long thin boundary indentations maintaining desirable properties gvf extended capture range 
original gvf special case ggvf 
error analysis active contour results simulated test images 

background 
traditional snakes traditional snake curve moves spatial domain image minimize energy functional ds weighting parameters control snake tension rigidity respectively andx denote second derivatives 
external energy function derived image takes smaller values features interest boundaries 
examples typical external energy functions lines step edges gray level image dimensional gaussian function standard deviation gradient operator 
snake minimizes satisfy euler equation 
find solution eq 
snake dynamic treating function time 
partial derivative respect set equal left hand side eq 
follows 
solution stabilizes term vanishes achieve solution eq 


gvf snakes eq :10.1.1.35.1779
starting point define new snake called snake 
proposed replace external force term eq 
gvf field defined equilibrium solution system partial differential equations denotes partial derivative respect laplacian operator applied spatial component separately 
edge map derived image having property larger near image edges 
edge map gray level binary valued 
computed conventional image edge detector cf 


generalized gvf gvf desirable properties external force snakes :10.1.1.35.1779:10.1.1.35.1779
difficulties forcing snake long thin boundary indentations 
hypothesized difficulty caused excessive smoothing field near boundaries governed coefficient eq 

reasoned introducing spatially xu prince signal processing varying weighting function constant decreasing smoothing effect near strong gradients solve problem 
formulation termed generalized ggvf replace eq 
general weighting functions 
alternative generalization follows variational formulation appendix define ggvf equilibrium solution vector partial differential equation 
term right referred smoothing term term produce smoothly varying vector field 
second term referred data term encourages vector field close computed data 
weighting functions apply smoothing data terms respectively 
weighting functions dependent gradient edge map spatially varying weights spatially varying general 
want vector field slowly varying smooth locations far edges conform near edges monotonically non increasing non decreasing functions respectively 
equation reduces gvf 
constant smoothing occurs grows larger near strong edges dominate boundaries 
gvf provide edge localization 
effect smoothing apparent edges close proximity long thin indentation boundary 
situation gvf tends smooth opposite edges losing forces necessary drive active contour region 
address problem weighting functions selected gets smaller larger 
proximity large gradients little smoothing effective vector field nearly equal xu prince signal processing gradient edge map 
ways specify pairs weighting functions 
weighting functions ggvf 
ggvf field computed pair weighting functions conform edge map gradient strong edges vary smoothly away boundaries 
specification determines extent degree tradeoff field smoothness gradient conformity 
gvf partial differential equation specifying ggvf implemented explicit finite difference scheme stable time step spatial sample intervals satisfy maximum value range gradients encountered edge map image 
implicit scheme numerical implementations eq 
unconditionally stable need condition explicit scheme faster 
faster methods example multigrid method possible 

experimental results experiments edge maps gvf computations normalized range order remove dependency absolute image intensity value 
snakes dynamically reparameterized maintain contour point separation pixels cf 

gvf ggvf snake parameters case 
comparison performance gvf snake ggvf snake shown fig 

edge map obtained original image shown fig 
gvf field ggvf field computed shown zoomed fig 
respectively 
note experiment gvf field ggvf field normalized respect magnitudes external forces 
snake initialized position shown fig 
allowed converge external force fields 
gvf result shown fig 
stops short convergence long thin boundary indentation 
hand ggvf result shown fig 
able converge completely region 
noted gvf ggvf wide capture ranges evident initial snake fairly far away object preserve subjective contours meaning cross short boundary gaps 
turns result similar ggvf fig 
achieved gvf 
small homogeneous regions near edges convergence gvf slow takes order magnitude longer ggvf gvf 
gvf iterations terminated early result undesirably small capture range 
result shows ggvf thought faster gvf preserves boundary detail large capture range 
ggvf gvf results exactly smoothing parameter ggvf goes zero edges impossibility gvf 
compared accuracy different active contour formulations simple harmonic curves 
curves generated equation cos setting suitable values varying curves corresponding digitized grid give images fig 

order eliminate problem capture range traditional active contours comparisons initialized active contours true curves deform different external forces 
convergence computed maximum distance radial direction true boundary active contour 
compute maximum radial error mre final active fig 

square long thin indentation broken boundary original gvf field zoomed proposed ggvf field zoomed initial snake position gvf snake ggvf snake final result gvf snake final result ggvf snake 
contours linearly interpolated maintain pre specified small point separation 
maximum radial errors measured terms pixels 
experimental results accuracy shown fig 

curves shown resulted traditional active contour external forces gaussian standard deviations pixel xu prince signal processing fig 

harmonic curves cos 
pixels pixels 
fourth curve resulted distance potential forces cohen cohen 
resulted gvf ggvf 
cases test intensity images edge maps 
see traditional potential forces small yield small errors 
capture range type force small larger xu prince signal processing shown forces yield high accuracy especially larger distance potential forces gvf forces ggvf forces yield high accuracy consistently 
distance potential forces shown poor performance boundary concavities 
note fluctuations error curves increasing arise due discretization curves image grid underlying performance variations active contours 
active contour algorithms extremely sensitive noise 
test noise sensitivity gvf ggvf added impulse noise harmonic image fig 

resulting image shown fig 
initial active contour plotted circle 
active contour allowed converge driven external force fields calculated noisy image 
results traditional snakes shown fig 
respectively 
problem fig 
snake simply captured local impulsive spikes dominant 
fig 
large blurs fig 

maximum radial error mre 
boundary snake latch detail 
contour resulting distance potential forces shown fig 

external force uses binary edge map attracted nearest detected edge points belong dominant 
results gvf ggvf shown fig 
respectively 
results barely distinguishable demonstrate remarkable ability captured long distance converge extremely dominant shape 
natural ask smoothing strategy improve results distance potential forces 
example may possible improve edge map prefiltering image creating edge map applying nonlinear filter edge map 
tried approaches lines difficult eliminate extraneous boundary points simultaneously preserving boundary 
approach filter distance potential order fig 

impulse noise corrupted image initial snake snake results traditional external forces xy snake result distance potential force gvf snake result ggvf snake result 
edge map gvf ggvf snake respectively 
snake results computed 
smooth energy valleys caused extraneous edge points 
approach flattens valley true edge located eliminate extraneous valleys converged active contour poor fidelity truth 
gvf ggvf improve distance potential forces applying narrow filter edge map followed vector diffusion allows dominant edge map effects extraneous edge points scattered image 
noted gvf run small parameter smooth extraneous edges 
highlights important advantage ggvf gvf ggvf support convergence thin xu prince signal processing boundary concavities simultaneously eliminating extraneous edge points 
compared qualitative performance gvf ggvf active contours magnetic resonance image left ventricle human heart 
original image shown fig 
gray level edge map shown fig 

goal experiment extract boundary description inner wall left ventricle 
initial positions gvf ggvf active contours shown circles gray overlaid real images fig 

final contours shown white 
details border captured gvf ggvf muscle xu prince signal processing fig 

pixel magnetic resonance image left human heart edge map result gvf snake result ggvf snake 
parameters snakes 
cavity clock position represented best ggvf 
cases ggvf gvf perform similarly 
experiments revealed certain differences may important practice 
ggvf generally show better convergence thin boundary concavities 
parameter sufficiently small gvf may achieve similar convergence properties 
case gvf require significantly longer computation time noise edge map may cause erroneous convergence 
short ggvf thought computationally faster version gvf better boundary localization especially respect concave boundaries better noise immunity 

new class external force models active contours 
generalization gvf formulation includes spatially varying weighting functions 
showed ggvf improves active contour convergence long thin boundary indentations maintains desirable properties gvf extended capture range 
showed ggvf excellent performance noisy real medical images 
investigations nature uses ggvf warranted 
making connections ggvf applications image processing computer vision provide new insights new solutions existing problems 
appendix variational framework generalizing gvf gvf generalized starting variational formulation proposed 
spatially varying weighting functions leading new variational formulation dx dy vector norm second order tensor 
calculus variations obtain euler equation 
solution vector equation obtained computing steady state generalized diffusion equation written explicitly 
result different ggvf 
understand nature difference note get ggvf 
condition data dependent satisfied homogeneous regions generally nonzero near edges 
implemented generalized gvf similar properties ggvf usually yields similar result 
version computationally demanding 
despite aesthetically pleasing property satisfies minimum principle xu prince signal processing advocate ggvf generalization gvf desired 
marques class constrained clustering algorithms object boundary extraction ieee trans 
image process november 
terzopoulos harris registration segmentation reconstruction images neuronal tissue sections ieee trans 
med 
imaging june 
cohen active contour models balloons cvgip image understanding march 
cohen cohen finite element methods active contour models balloons images ieee trans 
pattern anal 
machine intell 
november 
davatzikos prince active contour model mapping cortex ieee trans 
med 
imaging march 
yamashita dynamic contour texture approach contour operations visual comput 

frames snakes super quadrics geometry bottom ieee trans 
pattern anal 
machine intell 
august 
jain fundamentals digital image processing prentice hall cliffs nj 
kass witkin terzopoulos snakes models internat 
comput 
vision 

leymarie levine tracking deformable objects plane active contour model ieee trans 
pattern anal 
machine intell 

viergever discrete dynamic contour model ieee trans 
medical imaging march 
mcinerney terzopoulos dynamic finite element surface model segmentation tracking medical images application cardiac image analysis comput 
med 
imaging graph 

terzopoulos fleischer deformable models visual comput 

terzopoulos szeliski tracking kalman snakes blake yuille eds artificial intelligence mit press cambridge ma pp 

xu prince gradient vector flow new external force snakes ieee proc 
conf 
comput 
vis 
patt 
recog 
cvpr pp 

xu prince snakes shapes gradient vector flow ieee trans 
image process 
march 
