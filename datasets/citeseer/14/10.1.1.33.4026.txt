clustering methods collaborative filtering lyle ungar dean foster cis dept dept statistics university pennsylvania philadelphia pa grouping people clusters items purchased allows accurate recommendations new items purchase liked movies probably enjoy movies 
recommending items similarity interest collaborative ltering attractive domains books cds movies 
data sparse person seen small fraction movies accurate predictions grouping people clusters similar movies grouping movies clusters tend liked people 
finding optimal clusters tricky movie groups help determine people groups visa versa 
formal statistical model collaborative ltering compare di erent algorithms estimating model parameters including variations means clustering gibbs sampling 
formal model easily extended handle clustering objects multiple attributes 
keywords collaborative ltering clustering em gibbs sampling email address contact author ungar cis upenn edu phone number contact author collaborative filtering 
line shopping centers keep record purchased 
records predict shoppers want buy 
predictions limited purchases records movies cds online documents people enjoyed past predict ones enjoy 
consider example list people movies liked 
real list tens thousands people equal numbers movies obvious reasons smaller set illustration 
lyle andre star wars ellen andre star wars fred star wars dean star wars jason know karen likes andre 
ars certainly may useful item recommend likes 
short french lm en recommendation ellen likes andre 
want recommend level indirection jason likes liked ellen likes andre 
goal formal statistical models data methods estimating parameters data 
recommendations movies books cds overlap interests called collaborative ltering selection items done method similar individuals collaborating recommendations friends 
collaborative ltering methods applied applications research goldberg sheth maes maes shardanand konstan industry see www sims berkeley edu resources collab 
analysis purchase preference data allows ect detailed market segmentation 
consumers grouped level groups individuals tastes modeled targeted marketing customized sales pitches 
mass suggesting buy cd annoying spam su ciently targeted announcements new releases information service pay 
real problems complex suggested simple listing movie preferences 
people movies attributes 
people age sex country origin 
movies directors actors objects right attribute lists 
wish provide method allow range information collaborative ltering 
current methods collaborative ltering tend view records movies tables form andre star wars lyle ellen fred dean jason karen 
nearest neighbors nn methods means clustering people objects purchased 
methods poorly partly data highly sparse movies rated people partly people tastes put multiple categories may read science fiction nineteenth century naval history computer science books 
standard clustering methods ad hoc improvements obscure easily take advantage available knowledge 
symmetry people movies table suggests new approach group movies watches movie groups help group people 
speaks meaningful movies appealing people action movies appeal 
friend mine refers girl movies ones action 
discover natural groupings movies easier accurately recommend movies people 
statistical model collaborative filtering propose model collaborative ltering people movies classes 
example movies action foreign classic real data hundreds classes 
people classes intellectual fun 
classes unknown derived part model estimation process 
eventually range information derive classes initially ask far get just links indicating liked 
see form classes concretely rearrange person movie table saw andre star wars lyle ellen jason fred dean appears group people lyle ellen jason certain movies andre 
group fred dean movies 
likes third group movies consisting just star wars 
person movie class pair probability table action foreign classic intellectual fun insight formal generative model collaborative ltering 
useful think rst data generated best estimate parameters model 
generative model assures clean speci ed model 
assume model randomly assign person class randomly assign movie class person movie pair assign link probability model contains sets parameters pk probability random person class pl probability random movie class probability class linked movie class rst just base rates classes fraction people class 
numbers estimated table 
model estimation estimate model observed data need estimate class base rates pk pl link probabilities assignments individual people movies classes 
estimating model parameters easy knew class assignments 
unfortunately know 
obvious way estimation em algorithm modern generalizations dempster mclachlan krishnan neal hinton 
em approach problem class assignments hidden parameters 
alternate estimating class assignments estimating model parameters 
gives steps expectation assignment find expected class person movie 
maximization model estimation find pk pl 
just count people movies class fraction likes subclass pair 
surprisingly em formulated problem 
understand rst review em standard problem estimating gaussian mixtures 
show constraints complicate problem formulation nally show constraints implicit collaborative ltering problem 
model gaussian mixtures simple 
consider classes generated normal distribution mean gk 
variance 
observed data th model parameters class labels unknown 
em iterates steps step step estimate class assignments pik xi xi estimate model parameters ik converges remarkably rapidly 
see model break add constraint problem clusters constrained equal numbers 
changing observation potentially changes assignment 
move point xa cluster cluster moving point xb back cluster cluster 
constraint destroys separability tractability em 
case handled dropping constraint clusters tend close size method move right answer 
situation collaborative ltering 
collaborative ltering observed event person movie pair 
constraints person class movie class 
dropping constraints destroys problem loses connection individual people movies 
lyle likes andre lyle likes star wars know lyles class 
methods repeated clustering method addressing problem cluster people movies separately means clustering variants eld massart kaufman 
means clustering closely approximates em mixture model described 
cluster people movies watched cluster movies people watched 
people re clustered number movies movie cluster watched 
movies similarly re clustered number people person cluster watched 
results soft clustering analog kmeans clustering assign person class degree membership proportional similarity person mean class 
means clustering results sets class membership movie person entirely class highest degree membership 
rst pass people clustered movies movies people 
second subsequent passes people clustered movie clusters movies people clusters 
results repeat clustering times 
unfortunately immediately obvious repeated clustering help hurt 
clustering clusters provides generalization individual movies groups help sparse data data may generalize 
gibbs sampling wish update person movie time avoid constraint violation updating person em changes 
described possible person just person movie event lead constraint violation 
person needs simultaneously ed events occur 
person movie em prohibitively expensive simple su cient statistics exist 
gibbs sampling ers way dilemma sampling distri butions nding single model 
gibbs sampling easy change class person movie change simultaneously events occur 
gibbs sampling bayesian equivalent em em alternates steps assignment pick person movie random assign class proportionally probability class generating model estimation pick pk pl probability proportional likelihood generating data order describe steps precisely need nomenclature 
yij observed data yij person likes movie 
ci class person cj class movie 
recall model parameters base rates people movies pk pl probabilities person class liking movie class 
probability person class ci model parameters class assignments proportional cj yij cj yij pk kl sums movies assigned class probability ci proportional base rate class times product movie classes likelihood movie seen seen 
assignment phase gibbs sampling person movie picked random assigned class probability proportional expression corresponding movies 
estimation phase gibbs sampling model parameters class membership link probabilities drawn beta distributions follows link probabilities taken beta distribution parameters number people movies classes 
kl kl number movies class liked people class number movies class liked people class note je ries prior expression adding counts 
generally biased prior re ect sparsity links 
class membership probabilities pk pl taken drawn multivariate beta distribution parameters equal number people movies class 
similarly added counts re ect je ries prior 
actual implementation useful fact generate observation multivariate beta distribution generating samples gamma distributions nding pk number people class similar equation applies movies 
gibbs sampling guaranteed converge true distribution need quickly 
results synthetic data relative strengths di erent methods depend nature data easily seen synthetic data correct answer known 
show results synthetic data sets 
rst small data set clusters people movies people movies link matrix form typical data set small problem rows people columns movies indicates person liked movie 
note clusters obvious 
data sets large problem large reproduce highly sparse 
clusters visually obvious 
versions problem run class probabilities equal chance class people movies class 
sets data generated case 
larger data set typical real data tested 
real data typically clusters people fall small number clusters 
larger problem clusters people movies people movies tridiagonal link matrix probabilities diagonal diagonals 
subcases run equal class sizes class sizes drawn uniform distribution 
truth means repeated gibbs clustering small model class sizes error likelihood small model division error likelihood large model class sizes error likelihood large model random class sizes error likelihood means repeated clustering gibbs sampling methods give comparable error rates classes equal numbers members 
class sizes uniform statistical model estimated gibbs sampling gives superior performance smaller problem larger 
likelihood models generated highest gibbs sampling higher likelihood true model indicating tting occuring roughly equal means repeated clustering 
runs means better repeated clustering runs worse 
interestingly general performance patterns small larger data sets highly similar spite vastly di erent structures 
results suggest formal generative model yields accuracies roughly comparable produced simpler means clustering generative model give superior results class sizes vary widely 
sense kmeans clustering explicit means modeling di erences class size 
estimating class sizes give signi cant extreme gain modeling accuracy accounting structure data 
results neglect important bene advanced models ability incorporate information attributes people movies 
section examines context real data 
results real data purchase data cdnow world largest online vendor compact disks examined better understand clustering items attributes collaborative ltering 
sample customers purchased cds developed models predict purchases 
actual models built optimized various ways maximize rate response email advertising new releases encourage purchases customers browsing cdnow web site herz 
clustering people cds works relatively poorly 
data simply sparse people bought cd 
methods described cluster cds clustering people cds precisely cd clusters purchased 
case clustering necessary information available cds gives excellent clustering 
cds grouped clusters music cluster single artist 
clustering people cd clusters works extremely 
quantitative results approved release results example tests shown table 
table shows recommendations resulting person purchased cds miles davis charlie parker 
recommended cds genre jazz 
collaborative ltering software course labeled jazz 
table shows similar results country western artists 
table shows particularly poor input cds somewhat di erent genres gives reasonable results 
recommendation system tested cdnow customers sending email recommendations new artists 
automated system cluster model resulted doubling rate purchase solicitation previous manual selections cdnow 
input miles davis charlie parker output 
chet baker new york 
count april paris 
duke newport 
bill evans believe spring 
maynard ferguson american music hall 
pat secret story 
charles ah um 
monk brilliant corners 
rollins 
john zorn naked city table sample recommendations jazz input input cline lynn hank williams jr output 
johnny cash 
cash song demo 
road 
alan jackson greatest hits 
george jones best 
reba starting 
willie nelson greatest hits 
bonnie road tested 
blue 
travis greatest hits table sample recommendations country western input input ii men king output 
day 
ry music 
robert cray strong persuader 
franklin greatest hits 
buddy guy got blues 
john lee hooker ultimate collection 
albert king ultimate collection 
phantom blues 
ray live austria 
waiting soundtrack table sample recommendations combination contemporary blues extensions statistical method proposing advantages 
easily extended handle missing data 
easily extended case multiple clusters people movies directors actors 
particularly important clustering data relational databases 
consider database containing people movies person age movie movie director male female lead lead unfold extend table include attributes movies ine cient 
di erent objects di erent elds extended table may large numbers empty elds 
extended table neglects correlation structure objects know instance star wars directed george lucas stars harrison ford 
alternate approach cluster sub objects rst cdnow 
works relatively simple problems ective complex domains people clusters people read kinds books object attributes lead clean clusters actor 
cases simultaneous statistical model superior 
generative model easily constructed 
simple model form randomly assign person movie actor class assign link person movie pair probability movie actor pair probability plm 
alternatively assign link person movie actor triple probability model harder estimate 
complex models easily built 
example frequently case may person buying cds movies account 
husband wife di erent tastes may purchase cds account name 
case model extended account random mixture people biased small numbers people account 
gibbs sampling trivially extended estimate new models 
summary believe collaborative ltering described probabilistic model people items view buy divided unknown clusters link probabilities clusters 
em obvious method estimating models ciently constructed recognize constraint movie liked di erent people movie class time 
means clustering fast ad hoc 
repeated clustering kmeans clustering soft clustering version means may useful usually improve accuracy 
clustering movies people relevant attributes help help case cd purchase data 
gibbs sampling works virtue easily extended complex models computationally expensive 
currently developing cient gibbs sampling methods collaborative ltering problems extending repeated clustering gibbs sampling code incorporate multiple attributes applying real data sets 
acknowledgments cdnow providing cd purchase data discussing analysis 
eld cluster analysis sage publications 
casella george explaining gibbs sampler american statistician 
dempster laird rubin maximum likelihood incomplete data em algorithm discussion royal stat 
soc series 
goldberg nichols oki terry collaborative filtering weave information tapestry communications acm 
herz ungar collaborative filtering system analysis consumer data unpublished 
konstan miller maltz grouplens applying collaborative ltering usenet news commun acm 
maes shardanand social information filtering algorithms automating word mouth chi conference proceedings denver may 
mclachlan krishnan em algorithm extensions wiley 
massart kaufman interpretation analytical chemical data cluster analysis john wiley sons 
neal hinton view em algorithm justi es incremental sparse variants unpublished 
sheth maes evolving agents personalized information filtering proceedings ninth ieee conference arti cial intelligence applications 

