motion segmentation tracking edge information multiple frames paul smith tom drummond roberto cipolla department engineering university cambridge cambridge cb pz uk fpas eng cam ac uk www svr eng cam ac uk pas 
presents new bayesian framework layered motion segmentation dividing frames image sequence foreground background layers tracking edges 
rst frame sequence segmented regions image edges tracked estimate ane motions 
probability edges tting motion calculated st order statistics edge 
region labelling resolved probabilities markov random field prior 
part process motions identi ed foreground motion 
results obtained frames segmentation 
demonstrated multiple frames probabilities may accumulated provide accurate robust segmentation 
nal region labelling motion models produce segmentation extended sequence 
video segmentation rst stage areas video analysis 
example growing interest video indexing image sequences indexed retrieved content semantic analysis image sequence requires moving objects distinguished background 
emerging mpeg standard represents sequences objects series layers objects layers identi ed encode video sequence 
trend motion segmentation layers :10.1.1.30.656
avoids traditional multiple motion estimation problems assuming motion layer consistent layer boundaries mark motion discontinuities 
motions layers may estimated recursive dominant motion approach tting layers simultaneously 
motion estimation poor regions low texture structure image play part 
smooth regions expected move coherently changes motion occur edges image 
common approach local image intensity prior assigning pixels layers 
normalized cuts method shi malik combine motion intensity information pixels weighted graph best partition 
alternatively image structure may considered motion estimation stage performing initial static segmentation frame pixel colour intensity 
reduces problem identifying correct motion labelling region 
bergen meyer success merging regions similar motion elds 
concentrates edges image 
edges valuable features consider motion estimation segmentation 
object tracking commonly performed edge information form snakes image segmentation techniques naturally structure cues edges 
image motion sequence segmented regions similar colour intensity edges clear large proportion motion information come edges interior regions 
shows edge information sucient estimate track motions label image regions 
papers motion segmentation avoid question occlusion ordering layers 
occluded pixels commonly treated outliers algorithm able tolerate reasoned analysis modelling outliers retrieve layer ordering identify occluded regions 
edge method proposed problem occluded pixels greatly reduced occluding boundary region tracked 
furthermore relationship edges regions inherently depends layer ordering extracted integral part algorithm 
describes novel ecient framework segmenting frames sequence layers edge motions 
theory linking motions edges regions outlined bayesian probabilistic framework developed enable solution region labelling inferred edge motions 
extends approach rst proposed developing powerful probabilistic models demonstrating evidence may accumulated sequence provide accurate robust segmentation 
theoretical probabilistic framework analysing edge motions sect 

current implementation theory outlined sect 
experimental results sect 

theoretical framework edges image important features desired segmentation divides image occluding edges foreground object objects image 
edges features consider motion estimation reliably corners long extent means number measurements may taken length leading accurate estimation motion 
segmentation ultimately involves regions task labelling image pixels motions 
assumed image segmented regions edges natural link regions edges 
section relationship motion regions edges outlined probabilistic framework developed enable region labelling estimated edge data 
image motion region edges edges image due texture objects boundaries scene 
edges due shadows specular re ections considered stage 
assumed object moves edges associated object move edges frame may compared partitioned di erent real world motions 
assumes motion sequence layered motion takes place completely front 
typically layer farthest camera referred background foreground layers front 
assumed occluding boundary edge foreground object visible image 
regions image de ned edges implies region obeys motion edge occluding boundary motion occluding region 
enables general rule stated labelling edges regions labelling rule layer edge belongs nearer regions bounds 
probabilistic formulation large number parameters solved give complete motion segmentation 
section bayesian framework developed enable value parameters estimated 
complete model segmentation consists elements rg parameters layer motion models depth ordering motion layers motion label layer region 
region edge labels part model completely de ned labelling rule sect 

image data prior information assumed world task nd model maximum probability data priors max jd max rf rf jd max represent argmax frequently maximum value parameters giving required 
decomposed motion estimation component region labelling max rf rf jd max rf jd rf stage simpli cation assumed maximum value model parameters give independent motion motion parameters maximised independently 
expression maximised max jd max rf rf value term maximises term 
components evaluated turn rst 
estimating motions 
rst term estimates motions frames may estimated tracking features 
outlined sect 
edges robust features track provide natural link regions labelled 
order estimate motion models edges necessary know edges belong motion known priori 
order resolve random variable introduced labelling edge motion edge obeys 
motion estimation expressed terms expectation maximisation problem ej nd stage max ej stage 
starting initial guess motions expected edge labelling estimated 
edge labelling maximise estimate motions process iterates convergence 
estimating labellings having obtained motions remaining parameters model maximised 
edge labels intermediate step 
motion estimation allows edge probabilities estimated sect 
relationship edges regions known 
term augmented edge labelling marginalised giving max rf rf max rf rf je ej conditionally independent entirely de ned 
second term edge probabilities extracted directly motion estimation stage 
rst term dicult estimate easier recast bayes rule giving rf je rf maximisation constant 
assumed priors independent foreground motion equally constant 
term prior probability particular region labelling constant leaves expression evaluated max rf ej term useful 
intermediate variable entirely de ned region labelling foreground motion probability takes binary value edge labelling implied 
sum removed nal term replaced function gives correct edge labels max rf variable takes discrete set values case layers motion foreground 
equation maximised stages xed value expression maximised process repeated values global maximum taken 
maximisation performed complete region labelling testing evidence calculating probability edge labelling regions motions prior calculating likelihood particular labelling con guration 
exhaustive search impractical implementation region labellings hypothesised simulated annealing 
implementation section outlines implementation framework sect 
layers foreground background motions modelled ane motion 
basic implementation divided sections see fig 

find edges regions rst frame 
estimate motions edge probabilities 
label regions foreground motion second stages continued subsequent frames edge probabilities accumulated 
initial static segmentation edges labelled motion motion foreground regions fig 

foreman segmentation frames 
foreman moves head slightly left frames accurately estimate motions calculate edge probabilities 
foreground motion identi ed regions labelled produce segmentation head 
finding edges regions implement framework outlined sect 
regions edges rst located image 
implementation uses scheme developed sinclair edge schemes morphological segmentation suitable 
sinclair scheme colour edges image seed points region growing locations furthest edges 
regions grown pixel colour image edges acting hard barriers 
result series connected closed region edges generated original fragmented edges see fig 

edges referred region boundaries boundary distinct regions edge 
estimating motions described sect 
problem labelling segmented regions divided stages rst estimating motions motion region labelling 
order estimate motions features tracked frame obvious features region edges 
motion parameterised ane transformation gives approximation small inter frame motions 
multiple motion estimation circular problem 
known edges belonged motion directly estimate motions 
edge motion labelling performed knowing motions 
order resolve expectation maximisation em implementing formulation outlined described 
edge tracking 
stages em process group constrained snake technology 
edge tracking nodes assigned regular fig 

edge tracking example 
edge initial frame 
frame image edge moved 
tracking nodes initialised model edge search normal edge nd new location 
best motion minimises squared distance error tracking nodes edge 
intervals edge see fig 

motion nodes considered representative edge motion tracking nodes typical frame 
tracking nodes rst frame mapped current best guess motion 
dimensional search edge normal pixels direction nd matching edge pixel colour image gradients 
image distance original node location match image measured see fig 

tracking node expected image motion due ane motion calculated 
best solution minimises residual min edges tracking nodes measurement component image motion normal edge image location 
expression may minimised squares practice estimator see example provide robustness outliers 
maximisation estimating motions 
previous estimate motions tracking nodes mapped frame motions 
possible locations normal search performed described best match match reported threshold 
distances combined estimate ane motion parameters proportion current edge probabilities 
expectation calculating edge probabilities 
simplicity assumed tracking nodes edge independent tracker errors modelled normal distribution 
experiments shown gaussian statistics independence assumption valid see sec 
performs satisfactorily em stage 
assuming independence edge probability motion product tracking node probabilities 
tracking node tries nd match motions yielding error distance nding match threshold denoted 
distinct cases matching motions match motions motion motion 
probability distributions case modelled data considering ideal solution 
match motions 
errors motions modelled normal distributions priori equally 
probability tracker belonging motion normalised probability motion jd exp data 
probability belonging motion course motion jd 
match motion 
gaussian experimental data motion jd 
equation holds single match motion 
match motion 
case information available uniform prior motion jd initialisation convergence 
em initialised guess motions 
rst frame initial guesses zero motion camera stationary tracking foreground object mean motion estimated initial errors edges 
subsequent frames velocity estimate see sec 

rst iteration em tracker search path set pixels compensate possible poor initialisation 
convergence gauged considering maximum posteriori labelling edge motion motion depending 
edge changes labelling iterations convergence assumed 
maximum number iterations set takes seconds mhz pentium ii 
labelling regions nding layer order having estimated motions second term maximised 
nds region labelling identi es motion foreground 
performed possible region foreground motion labellings calculating probabilities selecting probable 
current tracker error correct motion current tracker error incorrect motion fig 

markov chain transition probabilities 
calculate probability observing particular sequence tracking node errors edge 
residual corresponds match tracker motion 
region probabilities edge data 
hypothesised region labelling layer ordering edges labelled motion motion labelling rule sect 

probability region labelling data term probability edges having labels 
edge probabilities em sec 
assumption tracking node errors independent 
acceptable em assumption edge probabilities con dent result incorrect region labelling solution 
result suitable edge probability model developed 
correlations tracking nodes edge decoupled markov chains encode st order probabilistic relationships 
example maccormick blake contour matching robust occlusion 
higher order statistics em valid near convergence 
ensure em solution maximises markov chain edge probabilities em switches markov chain model near convergence 
markov chain models relationship tracking node edge giving probability tracking node having certain residual residual previous tracking node 
transition probabilities estimated data cases edge matched correct motion incorrect motion modelled probabilities seen fig 

correct motion low residual distance residuals largely independent match case highly tracking node nd match 
incorrect motion residual distances highly correlated high probability match 
models edge tracking node sequence formation motion correct motion incorrect vice versa 
considered equally priori 
chain probability calculated product transition probabilities assumed probabilities correct incorrect motions independent multiplied give hypothesis probability 
hypothesis probabilities normalised sum give posterior edge probability 
region probability data probability edges obey correct motions 
assumed edges independent evaluated multiplying region edge probabilities edge labelling implied region prior term encodes priori region labelling 
implemented markov random field mrf prior probability region labelling depends immediate neighbours 
neighbours considered term fractional boundary length region boundary foreground regions region foreground 
prior model estimated examples correct region segmentations 
asymmetric sigmoid data foreground sea background inlet foreground percentage foreground boundary region exp solution simulated annealing 
order minimise possible region labellings simulated annealing sa 
begins initial guess repeatedly tries ipping individual region labels see change ects probability 
simple process single region label change causes local changes 
annealing process initialised guess edge probabilities 
sec 
foreground regions entirely surrounded foreground edges 
region labelling rule works better slightly diluted allow outliers 
initial region labelling labels foreground region edges having high foreground probability 
region turn considered foreground background probability hypothesis calculated 
case prior calculated current labels neighbours evidence calculated edge probabilities edge motions implied neighbouring region labels layer ordering 
pass data labels region order shu ed time avoid systematic errors 
rst pass region assigned monte carlo approach randomly probabilities 
cycle repeated iterations progress probabilities forced saturate iterations regions assigned motion 
annealing process continues changes observed complete pass data takes iterations 
random element sa enables local minima avoided 
local minima problem reasonable cooling timetable situations optimal solution third time 
solved repeating annealing process number times performed gives probability nding optimal solution 
entire maximisation takes seconds mhz pentium ii 
determining depth ordering optimal segmentation moving region edge labels annealing process requires layer ordering known 
identi es occluding edges regions di erent layer ordering result di erent segmentation 
ordering segmentation consistent edge probabilities highest probability 
annealing process performed twice possible value rst motion foreground motion foreground 
segmentation greater posterior probability identi es foreground motion segmentation 
multiple frames maximisation outlined sects performed frames results see example fig 

multiple frames evidence accumulated give robust estimate 
segmentation frame maximised comparing frame frame frames compared 
initialisation estimated motions edge probabilities frames initialise em stage frame 
motion estimate previous frame incremented velocity previous frames 
edge labelling initialised implied region labelling previous frame em begins stage 
combining statistics probability edge obeys motion frames probability obeyed motion frames 
calculated product probabilities edge frames assumed edge probabilities independent frames 
perform region foreground labelling cumulative statistics method described sec 
followed cumulative edge statistics just frame 
occlusion frames problem occlusion ignored little ect outcome 
tracking multiple frames signi cant problem 
foreground background labelling edges allows problem overcome 
edge labelled background previous frame region labelling tracking nodes locations current image background motion projected back frame foreground motion 
fall regions currently labelled foreground marked occluded contribute tracking edge 
trackers tested see project outside frame current motion ignored 
segmenting sequence segmentation entire sequence may approximated projecting foreground regions frames sequence foreground motion frame 
regions may template cut object subsequent frames see figs 
results shows segmentation standard foreman sequence neighbouring frames 
frames head moves pixels left 
rst frame statically segmented fig 
em run frame extract motion estimates 
shows edge labels motion convergence 
seen em process picks edges correctly motion small 
edges shoulders poorly labelled due shoulders motion smaller head 
correct motion selected foreground high con dence posterior probability nal segmentation fig 
despite poor edge labels 
case mrf region prior great help producing plausible segmentation 
mhz pentium ii takes seconds produce motion segmentation initial static region segmentation 
ect multiple frames seen fig 

accumulating edge probabilities frames allows random errors removed edge probabilities reinforced 
larger motions widely separated frames removes ambiguity 
seen time consensus edges shoulders foreground motion 
accumulated edge probabilities positive ect region segmentation settles frames accurate solution 
fig 

evolution foreman segmentation showing edge probabilities segmentations frames evidence accumulated 
edge probabilities certain small errors removed resulting improved region segmentation 
fig 

multiple frame segmentation tennis sequence 
camera zooms arm slowly descends 
shown original frame foreground segmentation part sequence showing th frame 
nal region labelling segment frames second pass data 
segmentation continued large number frames errors assuming ane motion signi cant particularly foreman tilts head back opens mouth segmentation break 
dealing non ane motions signi cant element planned 
figures show frames extended sequences segmented method 
tennis sequence fig 
arm obey ane motion particularly upper arm torso hardly obey tracked segmented short sequence frames 
car sequence fig 
atypical large background motion pixels frame hole foreground object dominant motion foreground 
segmented cleanly including window correct motion identi ed foreground 
case layer ordering unsure frames frames edge labellings reinforced nal decision clearly favour correct labelling 
ane motion ts side car large number frames 
fig 

multiple frame segmentation car sequence 
camera pans left track car 
shown original frame foreground segmentation part sequence showing th frame 
nal region labelling segment frames second pass data 
develops demonstrates novel bayesian framework segmenting video sequence foreground background regions tracking edges initial region segmentation frames 
demonstrated edges reliably tracked labelled frames sequence sucient label regions motion ordering 
em algorithm simultaneously estimate motions edge probabilities robustly estimated markov chain edge 
correct foreground motion region labelling identi ed testing maximise probability model edge data mrf prior 
algorithm runs quickly results frames 
multiple frames edge probabilities accumulated resulting accurate robust region segmentation 
current implementation considers layers ane motions 
concentrate extended multi frame sequences longer sequence edge motions modelled ane motion model 
edges appear incorporated model 
problems may solved tracked edges assist frames sequence behave new key frames segmentation process described 
allow system adapt non rigid non ane motions longer term 
research funded united kingdom epsrc studentship case award laboratories cambridge uk 
go david sinclair image segmentation code ken wood useful discussions 
ayer big un 
segmentation moving objects robust motion parameter estimation multiple frames 
proc 
rd european con ference computer vision volume ii pages stockholm sweden may 
bergen meyer 
motion segmentation depth ordering morphological segmentation 
proc 
th european conference computer vision volume ii pages freiburg germany june 
black fleet 
probabilistic detection tracking motion discontinuities 
proc 
th international conference computer vision volume pages kerkyra greece september 
blake isard 
active contours 
springer verlag 
dempster laird rubin 
maximum likelihood incomplete data em algorithm 
journal royal statistical society series 
drummond cipolla 
visual tracking control lie algebras 
proc 
ieee conference computer vision pattern recognition volume pages fort collins june 
hsu anandan peleg 
accurate computation optical ow layered motion representations 
proc 
th international conference pattern recognition pages jerusalem israel october 
maccormick blake 
spatial dependence observation visual contours 
proc 
th european conference computer vision volume ii pages freiburg germany june 

region merging robust statistical testing 
proc 
spie visual communications image processing orlando florida usa march 
bouthemy 
separation moving regions background image sequence acquired mobile camera 
video data compression multimedia computing pages 
kluwer academic publisher 
sawhney ayer 
compact representations videos dominant multiple motion estimation 
ieee transactions pattern analysis machine intelligence august 
shi malik 
motion segmentation tracking normalized cuts 
proc 
th international conference computer vision pages bombay india january 
sinclair 
voronoi seeded colour image segmentation 
technical report laboratories cambridge 
smith drummond cipolla 
edge tracking motion segmentation depth ordering 
proc 
th british machine vision conference volume pages nottingham september 
torr szeliski anandan 
integrated bayesian approach layer extraction image sequences 
proc 
th international conference computer vision volume ii pages kerkyra greece september 
wang 
adelson 
layered representation motion analysis 
proc 
ieee conference computer vision pattern recognition pages new york ny june 
weiss adelson 
uni ed mixture framework motion segmentation incorporating spatial coherence estimating number models 
proc 
ieee conference computer vision pattern recognition pages san francisco ca june 
