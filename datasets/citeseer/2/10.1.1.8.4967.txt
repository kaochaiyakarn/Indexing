heterogeneous multi scale methods bjorn engquist april heterogeneous multi scale method hmm general methodology ecient numerical computation problems multi scales multi grids 
variational dynamic problems considered 
method relies ecient coupling macroscopic microscopic models 
case macroscopic model explicitly available invalid microscopic solver supply necessary data macroscopic model 
scale separation exploited considerably reduce complexity microscopic solver 
unifying existing multiscale methods ab initio molecular dynamics quasi continuum methods projective methods systems hmm provides methodology designing new methods large variety multiscale problems 
framework analysis stability accuracy hmm 
applications discussed problems homogenization molecular dynamics kinetic models dynamics 
department mathematics princeton university school mathematics university department mathematics princeton university department mathematics university california los angeles contents macroscopic microscopic models compression reconstruction operators 
variational problems 
dynamic problems 
structure hmm macroscopic scheme 
estimation macroscopic data 
examples 
estimating macroscale data compressed microscopic solvers 
variational problems 
dynamic problems 
simpli cations 
traditional approach explicit macroscopic models 
semi empirical methods 
type problems 
galerkin formulation 
variational problems 
dynamic problems 
examples simple illustrative examples 
applications 
stability accuracy variational problems 
dynamic problems type 
subtleties flux formulation 
limitations hmm 
variations improvements basic hmm problems nature involve multiple active scales 
example chemical reactions may take seconds hours vibration chemical bonds occurs time scale 
time scales internal motion proteins nucleic acids typically span seconds seconds 
structures atmosphere may range meters thousands kilometers 
want understand reasonable detail dynamics result plastic deformation material face task studying structure cores scale collective dynamics entangled loops scale size material 
exceptions traditional approach problems obtain analytically empirically explicit equations scale interest eliminating scales problem 
equations basis computer simulations 
impressive array techniques developed accomplish task including averaging methods classical mechanics homogenization theory equilibrium statistical mechanics methods nonequilibrium thermodynamics kinetic theory transition state theory turbulence models approach successful fact far dominated science engineering necessary restricted computational capabilities 
typical example approach navier stokes equation uid mechanics microscopic processes represented equation state linear constitutive equations 
quite impressive general macroscopic conservation laws combined empirical linear constitutive relations describe dynamics simple liquids situations 
despite success approach forces introduce empirical closures systems justi ed understood 
result success phenomenological equations spectacular large class complex systems 
typical examples situation complex uids plasticity fracture dynamics important regimes turbulent ows 
new approach rst principle approach emerged years quickly attracted great deal attention 
aim approach model theoretical input coarse grained model detailed microscopic model bypassing necessity empirical modeling 
examples approach include ab initio molecular dynamics empirical potentials molecular dynamics replaced electronic structure calculations quasi continuum method stored energy functional nonlinear elasticity theory replaced molecular potentials coupled kinetic hydrodynamic models complex uids constitutive relations replaced kinetic models conformation macromolecules 
coupled multi scale multi physics approach discussed papers central theme 
follows concentrate types multi scale problems macroscopic description known cease valid localized region space time microscopic description 
macroscopic model may explicitly known expensive obtain known exist exist set macroscopic variables obeying closed macroscopic model 
problems type include defects crystals atomistic descriptions near defects continuum theories valid away defects contact line dynamics turbulent ame fronts chemical systems localized chemical reactions quantum mechanics chemically active regions classical mechanics 
problems type transport inhomogeneous media porous medium ows ective properties composite materials complex uids plasticity 
principle class problems say type combines characteristics types macroscopic model explicitly known cease valid near defects 
type problems dealt combining techniques problems types general framework designing analyzing numerical methods deal problems type type main motivation framework ecient usage macroscopic microscopic formulations cases macroscopic equations models explicitly known 
goal introduce framework analysis cover existing methods derive new techniques general formulation 
basic set 
microscopic process molecular dynamics quantum mechanics describes microscopic state variable de ned microscopic domain macroscopic process describes macroscopic state variable de ned macroscopic domain processes state variables related compression reconstruction operators denoted respectively qu ru property qr identity operator 
example microscopic process described kinetic theory macroscopic process described hydrodynamics compression operator maps particle phase space distribution function conserved mass momentum energy densities 
reconstruction operator opposite general unique 
interest resolve macroscale behavior 
doing direct models 
done eciently precisely issue address 
aim accurately approximate macroscopic state system 
working macroscopic grid resolves large scale problem 
main components procedure 
rst select conventional macroscale scheme 
second estimate necessary data macroscale scheme model 
selection macroscale scheme depends know macroscale model variational problem conservative 
macroscopic model fully known explicitly provide general ecient procedure supplementing missing data microscopic models 
example macroscopic problem variational standard nite element method task reduces approximating ective sti ness matrix macroscopic problem 
done solving microscopic problem locally reduced computational domain 
dynamic problems missing data macroscopic forces part forces eddy viscosity terms turbulence models 
estimate generalization classical godunov scheme gas dynamics macroscopic time step rst reconstruct microscopic state system known macroscopic state 
evolve microscopic process microscopic time scale desired macroscopic forces reach quasi steady value 
estimated value update macroscopic state macroscopic time step 
way guarantee numerical results comparable accuracy full microscopic model 
procedure sets approximation macroscopic model explicitly 
problems type simplify algorithm replacing procedure standard macroscopic solver regions explicit macroscopic model known known valid 
call methods heterogeneous multi scale methods abbreviated hmm emphasize fact di erent physical models numerical techniques di erent scales di erent grids 
contrast standard multi grid techniques homogeneous sense employ physical model di erent scales aimed eciently resolving microscopic details 
key eciency approach possibility reducing temporal state space complexity microscopic model exploiting scale separation 
ideas literature example sti odes kinetic schemes gas dynamics 
current draws inspiration workers 
closely related ideas 
written pedagogical style 
section discuss relations macroscopic microscopic models compression reconstruction operators linking models give examples 
section discuss scheme hmm contains main ingredients macroscale scheme estimation missing macroscale data models 
section discuss microscopic models eciently supplement missing data macroscopic models 
examples section illustrate scheme 
stability accuracy issues discussed section 
algorithmic improvements discussed section 
final section 
emphasis framework new numerical techniques numerical results analytical proofs 

grateful inspiring discussions yannis outlined program macroscale analysis solvers 
grateful eric vanden stimulating discussions 
supported part onr 
macroscopic microscopic models compression reconstruction operators convenient think macroscopic microscopic models de ned di erent domains di erent state spaces linked compression reconstruction operators discuss 
fug set macroscopic state variables interested de ned macroscopic computational domain mcd denote fug set microscopic state variables de ned microscopic computational domain mcd convenient think ber bundle denote ber note precise notion ber bundle extended obvious way order accommodate generality framework 
examples bers 
denote appropriate function spaces macroscopic microscopic states respectively 
macroscopic microscopic state variables related compression reconstruction operators denoted respectively qu ru course satisfy may nonlinear operators exposition treat linear 
general unique way de ning part concentrate discussions problems type problems de ned macroscopic model may known explicitly 
discuss macroscopic models related microscopic models 
variational problems consider microscopic minimization problem min 
appropriately chosen compression operator 
min min min qu de ne min qu macroscopic variational problem corresponding min consider examples 
consider variational problem min dx smooth periodic period smooth 
ways look problem 
rst numerical 
consider regular nite element triangulation denoted 
mesh size 
resolves variations slow variables 


standard piecewise linear nite element space 

de ne qu 
ru dx ru dx 

easy see uniquely de nes 
min qu dx reduced problem 
min 
fu dx second way think problem homogenization theory 
wellknown solution converges solution problem min dx fu dx ki lj dy xed solution cell problem 
periodic boundary condition 
view macroscopic problem state space 
macroscopic domain connection microscopic problem microscopic state space microscopic domain important note macroscopic variational problems may result types microscopic models ensembles averages statistical physics du du important line research pursue 
dynamic problems assume macroscopic model gives rise de ned evolutionary process characterized solution operators fs form semigroup index set interval continuous processes 
tz discrete processes 
set integers 
semigroup generated di erential equation general nonlinear operator discrete evolutionary equation 
set transition rules prob kinetic monte carlo scheme 
likewise microscopic model assumed give rise semigroup solution operators denoted fs generated di erential equation general nonlinear operator discrete evolutionary equation set transition rules prob emphasize microscopic model assumed explicitly known 
basic time scales interest macroscopic time scale relaxation time scale microscopic process assuming basic idea approximate qs ru suitable reconstructions knowing may nd ective macroscopic model 

suitably chosen 

give examples illustrate concepts 

sti odes 
consider system small 
case macroscopic slow variable macroscopic equation explicitly known case 
general case slow fast variables explicitly separated slow manifold state space 
case macroscopic equation may explicitly known 

kinetic equations 
classical boltzmann equation example illustration 
ideas apply equally kinetic models 
consider boltzmann equation 
phase space particle distribution functions knudsen number proportional mean free path collisions 
collision operator right hand side describes binary collisions particles 
detailed form important 
crucial properties satis ed dv jvj log dv consequently admits parameter family equilibrium states exp jv uj density mean velocity temperature system dv jv uj dv hydrodynamic limit obtains compressible euler equation conserved densities 

rp 
juj example macroscopic variables interested microscopic state variable 
qf 
macroscopic domain physical domain denoted microscopic domain fxg momentum space 

di usion random walks 
consider ensemble independent random walkers domain ensemble averaged density random walkers fu position random walkers initial position random walkers probability space ensembles 
qu dp 
problem 
langevin equations kinetic monte carlo method 
consider system stochastic di erential equations dx dt xn potential energy associated system independent gaussian white noise 
small system spends time near local minima rare sudden transitions di erent local minima 
situation ectively approximate dynamics full system markov process state space set local minima transition rates di erent local minima obtained microscopic process transition state theory 
ecient numerical method implementing discussed 
example microscopic process set odes macroscopic process discrete markov process 
qx domain attraction local minimum 
molecular dynamics uids solids 
consider system identical particles interacting short ranged potential dynamics described newton law dt dt ru 
corresponding hamiltonian model simulate wide range problems protein folding pathways crystal growth defect dynamics solids complex uids discuss situation molecular dynamics model macroscopic behavior system 
rst discuss example uid ow 
continuum theory state uid described density velocity temperature elds denoted respectively 
situations neglecting dissipative ects obey compressible euler equation pressure internal energy density total energy density 
microscopic macroscopic state variables related way 
microscopic state system fq 
de ne empirical distributions 
empirical density momentum total energy elds microscopic model 
obey equations 


current densities 
ru ensemble local time averages empirical conserved densities currents give macroscopic elds compressible euler equation 
problem mi ei de ned denotes ensemble spatial temporal averaging 
bers probability space local spatial temporal domains averaging taken 
solids customary lagrangian coordinates 
deformed position material point undeformed position stress tensor density material deformation heat ux 
macroscopic state variables displacement eld total energy density yj internal energy density 
macroscopic equations take form 


simplicity notations dimensional situation 
generalization higher dimensions straightforward 
take arbitrary interval macroscopic size dt ru denote initial position th particle 
notice cancellations expression equal ru de ne empirical stress ru dt fashion dt ru je je je ru position particle initial position nearest write je je ru equation de nes discrete analog heat ux 
de ne empirical distributions dx dx tt 

je je microscopic currents de ned 
macroscopic conserved densities related microscopic densities currents ensemble spatial temporal averaging 
ei 

dynamics 
simplicity concentrate ginzburg landau equation 

think reaction di usion equation fast reaction 
solutions closely approximated constant equilibrium values region thickness transition equilibrium values takes place 
small scale problem corresponds internal structure region 
large scale corresponds shape interface 
fast process problem reaction term vanishes points 
points de ne slow manifold function slow component level set values 
particular interest level set fu 
de ne qu dynamics macroscopic component reduces dynamics level set fu denoted 
equations 
example equation simple kinetic model 
example variations limitations hmm illustrate importance di erent scales 
initial values assumed oscillatory smooth periodic exists understood homogenization theory problem 
dy dy formulations represent problem 
oscillations function scale explicit represented local distribution new independent variable compare discussion bers 
lim natural macroscale variables weak limits full solutions de ned follows 
dy lim lim dz dy lim lim dz compactly supported dx see section reconstruction contain information oscillations hmm ective 
relation macroscopic microscopic models illustrated 
gure macroscopic model de ned space 
de ned space bers 
discussed bers momentum space kinetic model periodic cell homogenization problems probability space ensembles 
illustration macroscopic microscopic computational domains 
spaces bers representing 
structure hmm main components heterogeneous multiscale method macroscopic scheme estimating missing macroscopic data microscopic model 
macroscopic scheme right macroscopic scheme depends nature problem typically choice 
variational problems standard nite element method 
fact examples section standard piecewise linear nite element method 
dynamic problems conservative may methods developed nonlinear conservation laws see 
examples include godunov scheme lax scheme discontinuous galerkin method 
dynamic problems non conservative simply standard ode solver forward euler runge kutta method coupled force estimator discuss 
estimation macroscopic data selecting macroscopic scheme face diculty data macro scheme available underlying macro model explicitly known 
component hmm estimate missing data microscopic model 
done solving micro model locally subject constraint qu approximation current macro state 
example variational homogenization problem missing data sti ness matrix macro model 
explain section data estimated solving original microscopic variational homogenization problem unit cell element triangulation subject constraint qu dynamic problems data estimated godunov procedure rst reconstruct micro state evolve micro state subject constraint qu estimate missing data missing data forces part forces eddy viscosity term turbulence model 
option carrying number microscopic calculations di erent reconstruction di erent realization randomness extract accurate estimate collection microscopic calculations 
examples illustrate selection macroscale scheme estimation missing macroscale data models discuss examples detail 

variational problems 
examples include 
min dx multiscale nature problem contained tensor form smooth periodic period classical homogenization problem discussed earlier 
random stationary model random medium 
smooth 
dependence problem nonlinear 
dependence periodic random stationary 
macroscale problem type min ru dx 
atomistic models crystalline solids min fx subject loading conditions pairwise atomistic potential position th atom deformation displacement th atom 
macroscale problem type considered nonlinear elasticity min ru macroscale displacement eld 
problems choose macroscale scheme standard nite element method macroscale triangulation 
macroscale data need estimate ru dx ru dx 
nite element space 
approximated steps 

element 
approximate ru dx ru dx quadrature formula 

quadrature nodes 
approximate ru ru minimizing original problem micro cell 
subject constraint 
dx 
dx 
ru dx 
ru dx appropriate changes atomistic problem 
periodic homogenization crystalline solids problems 
chosen unit cell replace constraint periodic boundary condition cauchy born rule explain section 
stochastic homogenization problem 
larger correlation length 
case may advantageous perform ensemble averages realizations 
dynamic problems conservative type 
examples include 

ru fa discussed 


periodic stochastic stationary 
kinetic models boltzmann bgk equations 

molecular dynamics type discussed section 
spin exchange models kawasaki dynamics 
examples may include models phase segregation mixtures binary uids elastic ects macroscale models type 
general vectorial macroscale variable may depend ru macroscale scheme nite volume method godunov scheme nite element method discontinuous galerkin method 
discuss nite volume method 
hmm discontinuous galerkin method considered 
missing macroscale data nite volume method macroscale ux cell boundaries denoted fj estimated procedure 
select 
cell boundary 
fu reconstruct microstates ug 
consistent fu sense qu approximation restricted 

evolve microstate model inside 
initial state ug subject constraint qu 
evaluate macroscale ux fj fu constraint qu requires additional comment 
take example molecular dynamics 
capture macroscale behavior level euler equations constraint simply average mass momentum energy prescribed macroscale values fu capture viscous higher order ects need constrain system average density momentum energy gradients macroscale values 
convenient implement particularly higher order gradients required 
discontinuous galerkin formulation proposed avoids diculty 
rules selecting 
variational problems 
usual periodic homogenization crystalline solids problems 
chosen unit cell 

dynamic problems type 
examples include 
fa discussed 

spin ip models leads ginzburg landau type equations 
case write macroscale model nonlinear operator acting macroscale scheme choose ode solver grid forward euler runge kutta need estimate macro grid 
macro grid point select 
principle selecting 

fu construct piecewise polynomial th order 
denoted 
rest steps conservative systems 
note constraint qu interpreted 
dx 
macroscale markov chains 
macroscale process markov chain natural kinetic monte carlo method macroscale scheme 
missing data transition rates macro states 
estimating data non trivial task 
discussed 
dynamic problems concentrate simplest case macroscopic scheme godunov scheme missing data macroscopic forces 
extension general situations studied 
estimating macroscale data section discuss detail estimation missing macroscale data solving local problems 
main issues 
consistency accuracy problems reformulated correctly adding constraints qu boundary conditions 
eciency exploit possible reduction complexity problems 
done reducing size computational domains problem compression semi empirical method explain section 
compressed microscopic solvers key idea eciency proposed method compression achieve reduction computational complexity microscopic problem reduction size microscopic computational domain mcd exploring separation macroscopic microscopic scales 
compression techniques 
variational problems best illustrate main ideas examples 
rst discuss classical homogenization problem discussed 
dx de ne compression operator min qu 
explicitly known 
needed evaluating sti ness matrix macroscale nite element method 
problem approximate macroscopic solver reduces approximate evaluation sti ness matrix associated 
consider case period periodic obtain approximation consider triangle 
solution cell problem 
ru 


interior point 
subject condition 
periodic 



dx 
denotes volume 
de ne approximation needed assemble sti ness matrix macroscopic problem 
general case form 
de ned 
min 
ij dx subject condition 
appropriately chosen subdomain 


approximation example situation random stationary case size approximate cell problems larger local correlation length method strategy solving directly macroscopic problems approximate macroscopic sti ness matrices solving micro cell problems 
computational complexity method increase decreased 
furthermore show extends easily nonlinear time dependent problems 
contrast method proposed idea replacing nite element basis functions functions having correct 
disadvantage basis functions expensive compute 
particularly dicult extend methods nonlinear problems problems microstructure evolves time 
extends method high dimensions 
related see 
quasi continuum method formulated way 
problem simulate nonlinear elastic behavior crystalline solids stored energy functional base simulation molecular potential xn fx positions atoms 
start macroscopic triangulation sample denote 
standard vectorial piecewise linear nite element space 
microscopic state variable positions atoms fx xn say qu 
average strain atoms triangle 
equal average strain 

reduced macroscopic energy functional min qu total potential energy associated con guration method approximates cauchy born rule 
triangle 

potential energy unit cell subject constant strain ru 



number unit cells 
quasi continuum approximation 
quasi continuum method developed additional important twist allowing deal problems type case quasi continuum method provides option returning full atom computation near defects local strain varies atomic scale 
summary basic strategy compressing state space complexity model reduce computation macroscale cell basic microscopic unit 
microscopic units single period periodic homogenization problem unit cell crystalline materials block size comparable correlation length medium porous medium ows 
dynamic problems concreteness assume macroscopic model takes form di erential equation 
estimate microscopic model say 
basic assumption local relaxation time microscopic process shorter typical time scales macroscopic process starting point generalization gas kinetic scheme approximation see 
estimated steps step 
reconstruction reconstruct microscopic state ru step 
microscopic evolution evolve microscopic process reduced computational domain appropriate time 

step 
force estimation obtaining approximation compression microscopic forces 
microscopic process form di erential equation write qff 
tg space time compression operator 
step 
macroscopic evolution having estimation compute standard ode solvers 
called estimator 
practice step proceed simultaneously step 
value determined estimator reaches nearly stationary value 
macroscopic process kinetic monte carlo type markov process force estimation replaced estimating transition probabilities macroscopic states 
estimator discussed 
remains discuss speci details algorithm 
reconstruction 

compression reduction computational complexity microscopic solver reducing size computational domain 

force estimation 
data microscopic solver processed order provide accurate estimation macroscopic forcing term 
issues related 
center discussion compression 
discuss aspects compression compression space compression time 
basic principle compression space variational problems reducing computation macroscopic cell microscopic unit 
homogenization problems 
ru 
leads algorithms approximating local averages macroscopic grid step 
reconstruction 
fu construct piecewise polynomial 
order polynomial depends problem solve 
piecewise quadratic piecewise linear 
return issue section discuss accuracy method 
step 
macroscopic cell 
solve 
subject boundary condition periodic period step 
average 
right hand side 
step 
compute fu standard ode solvers estimator ff quasi continuum method natural extension fashion dynamic problems 
easiest setting doing nite element method 
solve elastic wave equation 
functional de ned molecular potentials cauchy born rule exactly way done quasi continuum method 
turn compression time 
resorting microscopic model order simulate macroscopic dynamics forced resolve microscopic times scales interest 
particularly expensive case explore time scale separation reduce computational cost temporal domain 
express estimator form weights satisfy computed microscopic state microscopic time step helpful distinguish di erent scenarios relaxation local equilibrium takes place 
problems parabolic homogenization problem boltzmann equation strong convergence equilibrium 
temporal ensemble averaging necessary convergence physical observables 
problems advection homogenization problem molecular dynamics convergence equilibrium sense distributions physical observables converge local equilibrium values time ensemble averaging 
selection weights estimator crucially depends nature convergence 
particular note special choices 
rst suitable strong convergence equilibrium 
second choice suited case weak convergence local equilibrium 
accurate choices weights discussed 
time interval microscopic model solved depends fast transient introduced reconstruction step dies 
best illustrated examples 
consider parabolic homogenization problem 
ru dirichlet boundary condition 
approximate macroscopic behavior macroscopic grid size 


qu moving cell averages cell size 
piecewise linear reconstruction 
dimension ru 



reconstruction proceed microscopic solver 
asymptotic analysis suggests relaxation time problem 
plot typical behavior microscopic ux ru cell boundary time interval 
function micro time steps 
quite clear quickly settles micro time steps quasi stationary value rapid transient 
obtain ecient numerical scheme select value macroscopic ux evolve larger time step 

computed ux ru function micro time step typical macro time step parabolic homogenization sin bottom gure detailed view top gure small time steps 
notice quickly settles micro time steps quasi stationary value rapid transient 
example advection homogenization problem 
dimension 
assume 
proceed take piecewise constant reconstruction 
contrast previous example temporal oscillations solutions die 
re ected plot microscopic ux time interval 
function time steps 
remains oscillatory time interval 
plot time average cos shown see settles quasi stationary value time scale 

top gure computed ux fraction micro time step macro time step convection homogenization problem 
bottom gure time averaged ux function micro time step 
fact microscopic process evolved time scales comparable leads possibilities state space compression neglecting part state space contribute signi cantly estimator 
truncation mcd introduces arti cial numerical boundaries boundary conditions imposed 
suggest periodic free boundary conditions subject constraint qu ideally apply absorbing boundary conditions aim eliminating spurious ect arti cial boundary 
boundary conditions proposed context wave equations molecular dynamics 
extending general situations simple task take 
summary express estimator time 
ff 
rug solution compressed microscopic model possibly truncated computational domain initial data ru 
numerical approximation compression operator 
typically 
form 
denote compression operators probability spatial temporal spaces respectively 
having macroscopic state variables updated standard ode solvers 
simplest example forward euler scheme gives 
tf simpli cations situations simplify compression techniques replacing compressed solver explicit macroscale models 
parameters macroscale models analytically computed numerically tted model 
technique particularly useful type problems characterized fact techniques applicable computational domain 
traditional approach explicit macroscopic models explicit macroscopic model known known valid compressed microscopic solver discussed replaced traditional approach explicit macroscopic models 
particularly useful problems type cases adaptive model selection needed 
see example 
semi empirical methods method compromise explicit macroscopic models compressed microscopic models 
assume macroscopic model takes speci form coecients involved unknown change environment estimate coecients data obtained microscopic models 
ideas extensively pre processing step calibrate input data simulation parameters macroscopic models 
propose incorporate ideas hmm 
example discuss parabolic homogenization problem considered earlier 
macroscale equation qu dicult obtain explicitly take form 
ru task nd tensor 
plot simple dimensional problem sin computed macroscopic ux approximation ru compressed microscopic model function ru see clean straight line slope gives estimate 
actual computation unknown entry cell boundary compressed microscopic solver twice macroscopic cell boundary give estimate entry 
empirically computed macroscopic ux function macroscopic gradient showing 
line exact homogenized ux parabolic homogenization problem 
gure illustrates semi empirical method 
knowing form macroscopic equation unknown coecients empirically estimated small cost 
examples similar spirit include dynamic subgrid models large eddy simulation turbulent ows vanden numerical solutions multiscale stochastic di erential equations model reduction techniques control theory 
type problems additional twist type problems adaptive procedure decides macroscopic computational element known explicit macroscopic model 
postpone general discussions adaptive procedure publication 
may happen near defects singularities comparable case may longer advantageous compression techniques discussed earlier 
consequently compression reconstruction operators unnecessary microscopic state kept macroscopic time step 
case example method proposed couples kinetic monte carlo continuum models growth 
galerkin formulation problems applications convenient galerkin formulation 
section discuss extension hmm galerkin formulation 
simplicity assume bers satisfy independent variational problems bilinear form appropriate function space microscopic domain satisfying standard requirements continuity ellipticity 
consider problem form find continuous functional version hmm discuss splitting problem pieces 
macroscopic state 
denote solution problem find qu satisfying constraint qv 

xed reconstruction operator de ne macroscopic bilinear form rv macroscopic problem rv easy see solution solution rv rv rv follows convenient take example homogenization problem ij dx 
case emphasize methodology applies general situations 
kd nite element triangulations respectively 
standard galerkin methods microscopic formulation proceed directly nite element space kd denoted 
contrast hmm proceeds steps 

standard piecewise linear nite element space kd de ne qu 

kd 
denote solution problem find 
qu 
satisfying qv 
second step solve 
key eciency hmm comes possibility approximate eciently 
idea completely analogous variational problems 

kd 
interior point 


dx 

solution problem 

fv dx 
satisfying constraint periodic period 
required satisfy boundary condition 
periodic period de ne 


dx approximate 
macroscale problem 
method closely related analytic tool scale convergence homogenization theory 
idea oscillatory test functions form order probe macroscopic behavior oscillations unknowns 
split steps probe oscillations rst step compute 
second step nd approximation macroscopic behavior 
dynamic problems set similar variational problem 
consider dynamic problem form dt corresponding macroscopic model dt time discretized version 
dt 
evaluate microscopic models proceed steps 

reconstruction ru 
element 
solve restricted small subset 
appropriate boundary conditions 
homogenization problem take subset 
periodic boundary condition 
construct approximation similar way constructed subsection 
denote approximation 
microscopic solver time average reaches quasi stationary value 


ta 
situations simply 
constructed earlier 
examples simple illustrative examples interesting special cases hmm literature 
immediate rst example godunov scheme gas dynamics 
classical godunov scheme corresponds case reconstruction operator just identity operator 
non trivial high order reconstruction operators extensions godunov scheme ppm eno schemes see example 
interesting example literature solving sti odes 
particular projective methods time scale separation combining micro macro time steps order achieve large time steps 
details see 
signi cant example published literature closely resembles spirit algorithm described problems type kinetic scheme gas dynamics 
form kinetic scheme bgk model 
eq eq local equilibrium state small relaxation time 
numerical approximation local conserved quantities time kinetic scheme proceeds steps compute local conserved quantities time 
approximate local equilibrium states eq local gas distribution functions constructed neighborhood cell boundaries 

bgk equation solved cell boundaries 

numerical conserved quantities evaluated distribution functions local conserved quantities updated 
procedure euler equation gas dynamics 
bgk equation 
connection hmm de ne compression operator qf respectively density momentum total energy densities associated designing reconstruction operator involved step computes corrections local form taylor expansions order achieve second order accuracy see details 
applications 
interface dynamics interfaces occur problems 
dynamics may modeled variety approaches including 
explicit boundary conditions curvature ows 

phase eld models 
examples include phase eld equations cation landau lifshitz equation domain walls domain walls modeled allen cahn equations 

molecular dynamics 
examples include phase boundaries boundaries grain boundaries 

kinetic monte carlo models 
examples include steps surfaces grain boundaries domain walls ising type models 
current methods treating interfaces divided classes 
sharp interface methods explicit boundary conditions direct simulation full model resolves detailed microscopic structure interface 
variety powerful techniques developed rst class methods including front tracking methods level set methods immersed boundary methods 
algorithmic development second class methods far centered adaptive mesh re nement region 
methods tend expensive problems explicit boundary conditions available far choice 
hmm ers third choice resolving macroscopic dynamics interface ciently microscopic model 
consists main components 

macroscopic grid resolves elds temperature elastic deformation away interface 
interface immersed macroscopic grid 

piece interface environment compute normal velocity compressed microscopic solver 
obviously crucial expression normal velocity interface terms microscopic model 
discuss simple example ginzburg landau equation 
complicated examples discussed separate 
assume grid size 

resolves dynamics shape level set fu 
order nd velocity level set integrate cell intersects level set obtain 

ru ds dv outward normal normal velocity level set 
preliminary versions ideas study dynamics defects interfaces crystalline solids 
particular applications dynamics dry friction fracture dynamics considered 

kinetic equations rare ed gases knudsen number small euler equation gas dynamics inaccurate 
case hmm provides way approximating macroscopic behavior system directly kinetic equations 
longer small compared gain eciency compressing microscopic solvers lost 
case standard conserved quantities density momentum energy selected macroscopic variables 
interesting possibility exists expanded set macroscopic variables decrease expectation embodied approaches grad moment closures entropy closure schemes 
case procedure described section nd expanded set 
hmm set eciency gained result decreasing possibility exists er improvement existing approaches simple gases rare ed regimes 
expanding set macroscopic variables uses set hydrodynamic variables hmm macroscopic model empirically truncated equations navier stokes burnett equations 
stability accuracy numerical solution computed heterogeneous multiscale method exact solution microscopic problem compression operator 
aim approximate qu 
section estimate error qu 
variational problems take classical homogenization problem example 
principle analysis applies general problems 
consider problem min ij dx fu dx smooth function ij smooth periodic period see section notations 
assume triangulation quasi regular triangles comparable size angles bounded uniformly away 
analyze hmm approximated de ned 
stability comes fact quadratic form dealing uniformly elliptic accuracy estimated rst strang lemma approximation sti ness matrix nite element methods problem simpler proceed directly 
lemma assume uniformly elliptic sense jruj dx 
dx 
proof min qu min qu jruj dx dx lemma condition lemma dx 
proof observe 
ij 

dx min 
ij dx minimum taken functions periodic 

ij 

dx minc 
jruj dx 
dx 
gives desired result 
solution min 
fa easy see ku qu 
solution min 
estimate ku di erence due fact quadratic form approximated sup 
ja kv order estimate helpful introduce bilinear form min ij ij dx minimization functions uj dx dx 

clearly 
di erence minimization carried independently triangle 
longer require 

minimizer element 
lemma 
satis es 
solution min ij dx subject constraint 
rv dx 
dx dx fa ij coecient homogenized problem solution 
xed 
periodic boundary condition jr ru 
ij 

dx ij dx 

ij ij 
constant independent 

proof rst part lemma simple consequence results chapter 
speci ed statement lemma satis es 


ij 

dx ij 
jr 
estimate di erence observe exact solution min ij ij 
dx subject constraint rv dx dx dx 
ja ij ij 


obtain jr ru 
rest lemma follows easily 
lemma estimates error due non conformity lemma ja 

proof element 

ij dx ij 

continuous edges triangles discontinuities edges size 
consider modi cation qu construct satisfying jruj 
element 
ij dx 
ij 

dx 




step estimate just observe 
lemma 
ij 

dx ij 
dx 
true ij 
min 
ij 
dx minimization subject constraint periodic 
plus lemma gives lemma 
far estimated quadratic form 
estimate bilinear form goes exactly lines obtain theorem assume nite element triangulation quasi regular qu 

theorem suggests result general nature error hmm variational problems comes sources standard local truncation error rst term error due compression second term 
proof theorem complicated fact comparing qu needed estimate simpler estimate solution homogenized equation 
purpose just estimate ij dx direct consequence lemma 
theorem solution min fu uk 
dynamic problems type concreteness discuss case macroscopic model di erential equation form hmm takes form 
estimate error fu suitably chosen numerical scheme macroscopic model 
write numerical scheme form 


chosen stable minimizes purpose de ne generalized godunov scheme obtained replacing microscopic solver hmm exact macroscopic solver 
precise de nition important 
just identify particular macroscopic scheme stable close hmm 
examples 
nonlinear problems careful notion stability 
problems smooth numerical solutions divided di erences suitable orders uniformly bounded strang showed stability linearized equation sucient getting full accuracy nonlinear problem 
multiscale problems interested macroscopic variables typically averaged quantities small scale uctuations exist small amplitudes specify carefully class numerical solutions allowed de ne stability 
fix macroscopic time class discrete functions de ned numerical grid 
example strang theorem ffu kd 

tg integer depending spatial dimension independent 


divided di erence operator order problem usually chosen consist discrete functions bounded divided di erences order close exact solution macroscopic model 
de nition said stable 
constant 
fu fv fu fv ku 
constant depends theorem assume 
stable 
fu 
max 



exist 






max 
proof assume 


stability ke ke 
kf ke tc max 
kf show assumption violated 


assume 

stability get ke ke tc max 
kf third assumption statement theorem exist 





right hand side inequality ke induction proves ke 




completes proof theorem 
theorem guarantee fu closely approximates true macroscopic behavior system 
happen important assume consistent 
consider illustrative example solving parabolic homogenization problem 
proposed method consists steps 

fu ru piecewise linear reconstruction ru 

solve initial data ru boundary condition ru periodic 

average 
ru 


tf corresponding replace microscopic model steps homogenized equation 
algorithm converge true macroscopic behavior described homogenized equation consistent homogenized equation 
fact easy check produces 
consistency reconstruction piecewise quadratic 
corollary assume conditions theorem hold ku qu 
qu 
max 
error contributions rst term standard local truncation error macroscopic scheme second term error due compression 
compression error contributions error due compression time error due compression space 
study error due compression time 
situations macroscopic model takes form qf microscopic local equilibrium state associated recall form 
ff 
rug 
simplicity assume microscopic solver exact 
observe replace ff qf qf qf qf 
ff 
rug consider special cases estimating reduces estimating ffu 
rug clearly depends rate relaxation local equilibrium 
relatively easy calibrate term strong relaxation takes place 
lemma solution problem initial data ru assume strong relaxation takes place sense ju ce qf ce ff 
ru 
jf ce 
typically holds spectral gap 
relaxation time goes zero goes zero 
case weak relaxation subtle non trivial time averaging necessary order guarantee convergence 
postpone discussion general theory 
follows concentrate linear problems type 
notion standard linear stability suces 
case natural nite volume method underlying macroscopic scheme 
estimating forces estimate macroscopic cell boundaries 
compare solutions hmm expressed form 

numerical ux computed hmm cell boundary associated macroscopic scheme 




lemma assume stable 
je max 
situations quantity smoothly varying divided di erence comparable magnitude 
task reduced estimating max 
jh discuss concrete examples 
rst example advection equation 
dimension assumed smooth strictly positive 
consider simpli ed situation microscopic solver exact computed averages small interval size 


dt exact solution reconstruction particular problem macroscopic equation simply 
au dy upwind scheme au stability condition 


compute de ned solves equation initial data equation easily solved method characteristics 
solution dx dt inverse function xed 


dt 

dt 

dy 
dt dy 

dy dt dy 



easy see 
dy 
dy 


jj 

lemma ju 

turn gives ju qu 


estimate optimal due 
second example take 
ru dimension boundary condition 
simplicity neglect possible technical diculty boundary 
assured choosing form integer 
argument applies general case slight modi cation 
satis es homogenized equation 
ru dy satis es xed consider family operators de ned periodic boundary condition 
xed zero eigenvalue eigenvalues positive 
smallest positive eigenvalue 
solutions general averages respect determined slow equations obtained higher order terms hierarchy see 
take averages 
ju ce ju ce ce min constant depends 
takes form 
depends smoothness reconstruction 
dimension expressed 


going back hmm assume microscopic solver exact ux estimator 




obtained exact solution homogenized equation reconstruction hmm nally obtain estimate type 

depends regularity reconstruction 
analysis extended high dimension ceases valid high dimension 
fact hmm ux form may converge high dimension 
discussed section 
third example consider case ensemble independent random walkers line 
example serves purpose illustrating ect di erent reconstructions rate relaxation 
macroscopic equation average density walkers simply heat equation 
macroscopic grid hmm formulated 

computed ensemble averaging independent copies empirical ux boundary obtained placing particles reconstructed distributions 
empirical ux computed 


denotes number particles crossing cell boundary right left respectively time 
simplicity replace random walks continuous counterpart brownian paths 
denote initial position brownian particles 
time positions brownian particles consider di erent cases 
case 
fw 
independent brownian paths 
case 
fw 
independent brownian paths 
number particles starting cross time fmin denotes indicator function set denotes random path 
re ection principle prob min prob fw equality de nes 
en nf denote total number particles cross right time consider rst case fy distributed 
kx corresponds piecewise constant reconstruction 

kx 
kx 
dy 


erf dx 
similarly total number particles cross left 
ensemble averaged ux square root behavior linear 
expected rate crossing slows time increases 
compute variance rst consider case 
notice en en var var case assume brownian paths independent 
observe similarly 
var var 
expected larger variance case 
calculation piecewise constant reconstruction 
consider case piecewise linear reconstruction 
de ned equation kx 
satisfy relation dx dy 

way 
dx 
dy 




yf dy 
tg 

erf 


ye time averaged ux behaves 

calculation clearly shows superiority piecewise linear reconstruction case averaged ux rate quickly saturates stationary value 
summary error due compression time depends nature rate relaxation local equilibrium compression operators extract estimators reconstruction operator 
subtleties flux formulation turn error due compression space ect see importance consider example parabolic homogenization problem 
macroscale scheme pick nite di erence method 
take macroscale ux ru homogenization theory know form satis es homogenized equation 
ru homogenized coecient tensor de ned earlier solution cell problem 
know jr 
ru 
ru 
dimension generally true ru ru satis es 

speci example 
ux form hmm able compute accurately 
notice 




discrete divergence operator macroscopic grid 
evaluation su er large errors coming poor approximation 

problem occur approximate directly force 
ru oscillatory component contribute force virtue 
additional error due oscillatory nature microscopic macroscopic extracted 
similar nature case weak relaxation local equilibrium error due compression time considered 
solution problem simple 
pointwise values ux cell boundaries take appropriate spatial averages smooth spatial oscillations 
give example 
observe dy holds dimension 
consider situation smooth periodic function period 
easy computation get solutions cell problem dy dy dy 
leading order ux dy dy limitations hmm appreciate limitations hmm go back example equations discussed earlier section 
homogenized form equations see essential knowledge oscillations kept compression 
nonlinear terms imply local distribution values oscillation uence weak limit terms dy dy evolution distributions decay characteristics term local computation linear homogenization problems discussed earlier followed compression approximate weak limit 
homogenized form equation basis hmm replacing direct discretization original problem 
discretization ber needed computational complexity algorithm increase decreasing 
case possible construct hmm complexity coarse grid calculation space 
choosing appropriate coarse grid discretization coarse grid sampling 
details 
original compression uniform sampling 
rational 
initial values fu fa qa fv fb qb variations improvements basic hmm hmm described requires de nition macro scale variable examples choice coarse scale variable quite natural 
may case possible determine automatically part computational process 
mention techniques 
rst class model reduction methods particular connection control 
dimension state space reduced reduced model derived 
numerical techniques involved may example singular value decomposition krylov subspace methods 
reduced state space case typically correspond macro scale 
technique wavelet compression 
compression common signal image processing applied di erential equations 
engquist describe wavelet method numerical homogenization 
di erential equation representing macro micro scale processes rst discretized micro scale standard techniques 
resulting numerical operator projected coarse wavelet space 
corresponding compression reduces numerical state space examples classical homogenization compressed dependent variable corresponds standard macro scale 
numerical methods coarse grid mainly low order 
advantageous presentation principles practical computation better apply higher order methods 
ts general framework 
higher order elements replace variational problems higher order di erencing reconstruction possible godunov setting 
order apply higher order methods higher order forces micro scale simulation required 
achieved appropriate choice estimators 
assume force computed simulation computational cell mcd diameter represent spatial temporal variables 
assume form macroscale forcing approximate 
estimate dx de ned dx jpj smooth chosen 
contains subdomain transient supported outside case contains oscillations smooth function compactly supported speci highly oscillatory smooth mean function write jb dx jjj dx dx dx nal step high order numerical estimator replacing integral high order accurate quadrature formula 
concentrated case missing macroscale data depend local behavior macroscale quantities 
true practical problems 
incompressible limit uid ows example 
missing macroscale data pressure depends velocity eld nonlocal way 
possible modify hmm procedure accommodate situations 
postpone detailed discussion extension publication 
knowledge macroscopic model necessary order guarantee consistency macroscopic problem 
example important know macroscopic model nonlocal local helpful know order di erential equations 
information probed pre processing step adaptively computation microscopic model 
considered detail publication 
type problems happens near defects singularities longer small compared cases important modify hmm locally microscopic states retained near defects singularities converted macrostates macro time step 
done algorithms involving multi levels physical models coupled locally 
heterogeneous multi scale method hmm general methodology allows eciently move macroscopic microscopic models best exploit scale separation problem improving eciency 
case fast algorithms multigrid fast multipole method wavelet multi resolution methods eciency achieved minimizing redundancy computations 
hmm done compressing complexity microscopic solvers explicit macroscopic models valid available available computational data 
demonstrated examples approach ers considerable exibility 
main components hmm 
rst formulate microscopic problem smallest possible computational domain altering basic local averaged properties 
includes prescribing right constraints processing data extract macroscopic information eciently accurately 
second component information passing macroscopic level linking correctly di erent microscopic problems order model macroscopic behavior 
done hmm macroscale scheme 
versions implemented 
order overwhelmed generality hmm summarize examples new algorithms emerge applications speci problems 

homogenization problem 
static dynamic homogenization problems method proceeds standard nite element method usual basis functions 
new component comes computation sti ness matrix obtained solving small cell problem element 
additional savings obtained semi empirical methods see 
exibility hmm means readily applied complicated problems nonlinear problems microstructure changes time 
contrast methods proposed modify basis functions building 
means microstructure problem solved element 
limits applicability method problems 

coupling molecular dynamics 
low temperatures exist satisfactory algorithms couple molecular dynamics continuum elasticity 
static quasi static problems quasi continuum method popular tool 
dynamic problems dynamic atomistic continuum method proposed works quite 
methods ideal studying crystalline solids isolated defects 
natural step deal ect nite temperature heat conduction 
hmm readily purpose 
away defects interfaces uses continuum theory material parameters obtained molecular dynamics 
near defects local deformation large uses compressed microscopic model evaluate forces macroscopic equations 
details microscopic expression section 
fashion hmm provides way coupling molecular dynamics continuum theory uid ow 

structure dynamics complex interfaces 
complex interfaces turbulent ames boundaries grain boundaries equations explicitly known hmm provides ecient way evolving interfaces microscopic models time couple macroscopic behavior away interfaces 

coupled hydrodynamic kinetic models complex uids 
molecular conformation non trivial contribution macroscopic stress hmm provides ecient way exploiting separation hydrodynamic time scales 
numerous possible areas applications enumerate 
theoretical point view associate underlying macroscopic scheme generalized godunov scheme hmm 
stability properties hmm read 
error hmm comes main sources standard truncation error additional error due compression 
compression error comes sources compression time compression space 
error due compression time depends nature rate relaxation local equilibrium compression operators extract estimators 
similarly error due compression space depends compression operators estimators boundary constraining conditions imposed truncating microscopic computational domains 
abraham bernstein spanning continuum quantum length scales dynamic simulation brittle fracture europhys 
lett 
abraham bernstein concurrent coupling length scales methodology application phys 
rev 
homogenization scale convergence 
siam math 
anal 

arnold mathematical methods classical mechanics springer verlag 
fourth order chebychev methods recurrence relations siam sci 
comput 
appear 
homogenization applications hubbard ed 
pp 

lions asymptotic analysis periodic structures north holland 
bird armstrong dynamics liquids vol 
kinetic theory john wiley new york 
boley krylov space methods state space control methods circ 
syst 
signal proc 
brandt multiscale scienti computation review 
lecture notes computational science engineering barth eds springer 
car uni ed approach molecular dynamics density functional theory physical review letters 
cai de yip minimizing boundary re ections simulations phys 
rev lett 
ciarlet finite element methods elliptic problems amsterdam new york north holland pub 

clayton engquist absorbing boundary conditions acoustic elastic wave equations bull 

soc 
amer 
dynamic non homogeneously coarse grained system press phys rev lett 
de groot mazur non equilibrium thermodynamics dover publications new york 
spreading liquids solid surfaces static dynamic contact lines ann 
rev fluid mech vol 

homogenization linear nonlinear transport equations comm 
pure appl vol 

engquist preparation 
engquist shu preparation 
huang matching conditions atomistic continuum modeling materials phys 
rev lett 
huang dynamic atomistic continuum method simulation crystalline materials submitted comput 
phys 
ren vanden preparation 
engquist computation oscillatory solutions hyperbolic di erential equations springer lecture notes mathematics 
engquist wavelet numerical homogenization applications lecture notes computational science engineering barth eds springer 
engquist radiation boundary conditions acoustic elastic wave calculations comm 
pure appl 
math 
fan molecular models ow calculations ii 
simulation steady planar ow acta mech 
sinica vol 

gear projective methods sti di erential equations problems gaps eigenvalue spectrum submitted siam sci 
comp 
gear coarse integration bifurcation analysis simulators micro galerkin methods submitted comp 
chem 
eng 
lebowitz deterministic stochastic hydrodynamic equations arising simple microscopic model systems stochastic partial di erential equations perspectives edited american mathematical society 
mcbryan sharp front tracking applied rayleigh taylor instability 
siam sci 
statist 
comput 

godunov mat 
sb pp 

domaine de associ aux int num equations di pas es pas li es 
ler congr 
assoc 
fran 
calcul grenoble pp 
sept 
convergence multigrid iterations applied di erence equations 
math 
comp 

wanner solving ordinary di erential equations ii sti di problems springer verlag 
reaction rate theory fty years rev modern phys 

harrison brenner atomic scale simulation related phenomena handbook micro nano edited crc press 
lax van siam review 
hou wu multiscale nite element method elliptic problems composite materials porous media comput 
phys 
hughes multiscale phenomena green functions dirichlet neumann formulation subgrid scale models bubbles origin methods comput 
methods appl 
mech 
engrg 
landau lifshitz statistical physics part rd edition 
calculation ow molecular models approach non newtonian fluid mech vol 

explicit methods second order solution sti systems ordinary di erential equations zh 

mat 
mat vol 
pp 

gaussian moment closure gas dynamics 
siam appl 
math 
electronic 
leveque numerical methods conservation laws birkh auser 
gross origin crack tip instabilities mech 
phys 
solids 
coarse stability bifurcation analysis stochastic simulators kinetic monte carlo examples submitted chem 
phys 
miller phillips simulation fracture atomic scale model simul 

sc 
numerical issues large eddy simulation complex turbulent ows application 
advanced turbulent ow computations udine courses lectures springer vienna 
general convergence result functional related theory homogenization 
siam math 
anal 

osher sethian front propagation curvature dependent speed algorithms hamilton jacobi formulations comput 
phys 
peskin mcqueen computational bio uid dynamics 
fluid dynamics biology seattle wa contemp 
math amer 
math 
soc providence ri 
peters turbulent combustion cambridge university press cambridge 
phillips crystals defects cambridge university press 
robbins user computer simulations friction wear modern handbook edited crc press 
coarse grained molecular dynamics atomic limit nite elements phys 
rev 
atomistic simulation mems resonators coupling length scales modeling simulation microsystems 
ective bifurcation analysis approach submitted nonlinearity 
schulze coupling kinetic monte carlo continuum models applications growth preprint 
schwab 
fem homogenization problems lecture notes computational science engineering barth eds springer 
shenoy miller models structure deformation phys 
rev lett 
shenoy miller rodney phillips ortiz adaptive nite element approach atomic scale mechanics method mech 
phys 
solids 
smith multiscale simulation loading electrical resistance silicon phys 
rev lett 

spohn large scale dynamics interacting particles springer verlag 
strang accurate partial di erential methods ii nonlinear problems numer 
math vol 

ortiz phillips analysis defects crystals phil 
mag 
solutions des de 
meyer schwartz seminar exp 
xii pp cole palaiseau 

qian coarse stability bifurcation analysis time reaction di usion example pnas 

engquist interface tracking phase ows multi eld problems state art springer verlag 
random heterogeneous materials microstructure macroscopic properties springer verlag 
vanden preparation 
xu numerical navier stokes solutions gas kinetic theory comput 
phys 
suen armstrong molecular orientation ects annual review fluid mechanics 
yau asymptotic solutions dynamics body systems classical continuum equations current development mathematics international press 

