weakly secret bit commitment applications lotteries fair exchange paul syverson center high assurance computer systems naval research laboratory washington dc usa syverson itd nrl navy mil presents applications weak protection secrets weakness just acceptable desirable 
application versions lottery scheme result lottery determined ticket numbers purchased control outcome determine lottery closes 
outcome kept secret way breakable predictable amount time computation 
application variant fair exchange protocols requires trusted third party 

secure computing communication distributed environments typically assumed foundation strong cryptography 
known fallacy security rests entirely strength cryptographic algorithms 
weak cryptography tolerated practice number problems associated stronger stu availability cost monetary computational legal policy restrictions 
may surprising weak cryptography tolerated embraced useful 
explore applications weak cryptography 
speci cally look applications desired goals attained cryptographic components practically breakable predictable cost government subject copyright 
published proceedings ieee computer security foundations workshop massachusetts june 
time computation 
applications type bit commitment con dentiality bit commitment breakable way 
weakly secret bit commitment wsbc 
consider applications 
rst means hold form lottery winner determined entirely set public inputs determination inputs publicly identi ed 
lottery organizer manipulate wins 
second application variant fair exchange 
combines features fair exchange features contract signing protocols 
main contributions relatively efcient contract signing requires trusted third party fair exchange 
accomplishes short sequence messages combine diminishing increasing ability complete exchange help evidence cheating occurred 
functions preventing cheating structuring incentives self interested parties prefer complete protocol cheat 
reason call rational exchange 
remainder organized follows section basic properties concepts involved wsbc 
section background information structure lotteries 
section general properties assumptions lotteries 
section lottery scheme collected wsbc 
section describe lottery scheme shifts trust veri cation cost associated basic scheme placing wsbc individual tickets preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
collection tickets 
lottery tickets properly constructed result quickly publicly determined 
lottery schemes earlier require wants con rm result repeat long costly calculation result 
section describe verify calculation somewhat quickly multiple processors available 
section explore entirely di erent application wsbc variants fair exchange protocols 
section discuss related conclude 

weakly secret bit commitment section set basic concept wsbc give examples 
rst brie sketch basic concept secret bit commitment 
bit commitment requiring principal commit value revealing value 
simple example taken 
alice generates random bit strings 
commits message creating sending bob 
wants reveal bob sends properties hash functions bob determine rst message alice sent 
properties hash functions alice nd 
note example illustrates bit commitment slight misnomer 
technique commit single bit obviously commit 
example single bit committed making need obvious 
clear needed relatively small predictable set candidates 
idea wsbc similar bit commitment 
di erence want secrecy bit commitment breakable acceptable bound time computation 
general properties wsbc function 
nd preimage resistance computationally infeasible nd 
weak preimage resistance value moderately hard compute rst standard desired property hash functions taken properties discussion 
second variant preimage resistance computationally infeasible replaced moderately hard 
term borrowed 
mean imply upper lower bounds ease computation 
say 
depending application may wish require properties 

collision resistance computationally infeasible nd 
stronger nd preimage resistance 

near preimage resistance hard nd di er small number bits 
directly similar hash function properties probably related non correlation property 

temporarily secret bit commitment applications envision important easy compute 
nice quickly verify fact argument 
related generally desirable property hash functions easy compute 
fact ease computation implies property 
careful pursue 
example suppose wish show commitment toa random xed length binary value relatively small space 
natural suggestions hash concatenation xed binary string length xed time nd brute force search upper lower bounds required preimage resistance 
related approach appropriate applications goal simply computational load involved breaking bit commitment 
example pricing functions designed complicate sending junk email appear property 
approach advantage quick veri ability may suited applications 
problem easy break search space 
accuracy may bounds computation time assumed indicate realtime bounds processors run computation faster nd predict average time nd way guarantee similar hashes described ironically strengthening weakening secrecy :10.1.1.35.6328
preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
earlier 
suggest restricted class wsbc breaking bit commitment accurately related time 
suggest important features calculated inherently sequential computation predictable length :10.1.1.110.5709
inherently sequential mean sequential computation results preceding computations needed calculate value 
way temporarily secret bit commitment 
function replace requirement preimage resistance precise requirement 

temporary preimage resistance prespeci ed value nd require inherently sequential computation length prespeci ed bounds 
relatively easy construct means commit value known advance 
example commit result performing hashes value 
case example collected lottery section designed way 
function means quickly veri ed commit known value needed 
fortunately functions drawbacks 
example time lock puzzles :10.1.1.110.5709

time lock puzzles brief summary technique set rivest shamir wagner :10.1.1.110.5709
roughly take secret encrypt strong key perform repeated squares value wrt composite modulus large prime factors known individual 
ectively encrypt result 
knowing factor modulus allows individual get result repeated squaring ciently 
choice perform 
appear parallelizable way 
advantage gained doing faster processor range available processor speeds readily determined 
assuming speed processor predictable computation time 
performed key revealed uncovered 
note straightforward generalization technique quickly veri able gene tsudik rst pointing similar observations :10.1.1.110.5709
message encrypt strong key take function commit forming 
general guarantee quicker form derive 
function chosen especially nice allows quick calculation person possesses factors modulus :10.1.1.110.5709
quickly veri able quickly calculated rst place 
applications describe rest require wsbc general 
typically general wsbc describing applications 
turn look lotteries 

lotteries general background lotteries getting structure lotteries designed 
lotteries avariety structures 
options concerning determination prizes means entering determination winners 
simplest form lottery names entrants placed pool winner selected random pool 
example names participants written slips placed hat 
mixed ensure randomness drawn blindly 
course names replaced pseudonyms time tokens numbers 
physical selection winning entry replace means identifying entry policy numbers game 
tokens numbers happen pool possible tokens selection superset entered lottery 
variants easily vulnerable cheating part determining winners particularly done public view 
solution problem include having determination trusted party making determination publicly visible leaving determination public unpredictable events 
trusted parties limited trust placed party 
remains widely form lottery publishers clearinghouse 
trust necessary diminished watch assigning parties evaluate fairness drawing making generally publicly visible 
example case policy remains structure preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
state lottery drawings 
potential abuse 
mechanism randomizing choice tampered assorted variants weighting dice determination properly conducted public uses devices exclusive control determining winner 
careful public inspection trusted parties approach determination event control lottery organizers preferably widely visible 
example traditional numbers games values signi cant digits result adding winnings paid previously announced set races race track digits announced digit columns total volume stock traded exchange important event unpredictable control organizers connected lottery 
issue nature winnings 
winnings may predetermined independent entrants lottery 
case may monetary prizes 
winnings may determined amount bet players betting 
may questions prizes guaranteed awarded 
noted possible pool entry tokens numbers proper subset pool winners drawn 
drawing considered complete winner chosen winner chosen means winner drawn pool possible prizes guaranteed awarded 
suitable metric available winners may determined closeness token number drawn 
prizes awarded longer considered possible winnings 
alternatively added available prizes instance lottery 
example game run state lotteries roll rst prize running lottery wins run 
way prizes ultimately awarded prizes awarded running lottery 

general properties lotteries sections discuss di erent lottery schemes 
share certain properties 
section rst de ne properties share 
describe detail assumptions features common 

committed lottery outcome entirely determined ticket numbers purchased tickets 

simple total value winnings run lottery total purchase cost tickets 
means winnings money bet lottery 
simple means prizes awarded state games 

weakly secret outcome lottery determined lower time bound determined upper time bound 
lower time bound clearly termination ticket sales 

random fair random ticket number outcome random ticket predictably win 

ver able determined 
total ticket sales numbers sold tickets criteria assessing outcome distributing winnings publically veri ably determined clearly lower bound determining outcome 

tickets discussing tickets set assumptions environment sale tickets takes place 
assume methods independently available authentication integrity ticket sales 
rightful purchaser ticket identi ed 
leave aside questions anonymous purchase 
way link winnings claimant ticket purchaser purchased tickets bearer instruments 
assume means protect ticket theft transferred vendor customer presumably encryption 
assume tampering ticket purchase detectable 
meant denial service 
means attempts alter ticket attacking communication customer vendor detected unaltered tickets entered lottery 
important assumptions workable implementation lottery means satisfying 
various known mechanisms authentication preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
integrity protection employed independent basic lottery design 
just assume 
likewise assume weak fair exchange tickets ticket sale takes place vendor gets money customer gets ticket prove received sent 
possible advantages integrating mechanisms fair exchange authentication integrity lottery design 
leave topic 
tickets abstraction 
may ticket se 
ticket refers means reliably associating number ticket number individual typically purchaser token associates bearer ticket number 
tickets assumed unforgeable 
valid tickets issued ticket vendor 
leave aside discussion tickets authenticated central design 
note vendor free issue tickets friends charging 
example possible tickets belong vendor 
see winnings properly structured vendor gains advantage doing ticket purchaser 
publicly announced open lottery time customers contact ticket vendor purchase tickets 
publicly announce close lottery time new tickets purchased 
announced advance actual running lottery 
tickets purchased ticket numbers placed vendor ticket list 
list publicly available possible tell list posted vendor 
may periodically occasionally updated sale tickets 
nal ticket list clearly labeled di erentiate lists may include tickets entered close lottery 
tickets unique 
simplicity assume accomplished requiring tickets numbers unique 
course vendor allowed choose ticket numbers individuals values precomputed lottery outcome 
compute predict control total number tickets sold 
important distinction 
individuals allowed choose numbers preferably random manner predictable vendor 
vendor attempt control ticket numbers extent rejecting numbers customers submit 
determination winners fairly tickets sold unpredictable lottery closed payo described gain advantage doing choose accept reject single ticket number equivalent letting choose ticket numbers 

determining winner lottery outputs single result determines winning ticket 
example simple way determine winner ticket matches lottery output places 
simplicity rest assume primary winners 
easy establish secondary tertiary winners ticket numbers match lottery output speci ed degrees primary winners 
approach seen generalization usual approach primary winners match lottery output exactly secondary winners match output prespeci ed degree 
ticket numbers lottery output represented binary numbers size ticket numbers randomly chosen winners easily determined means 
naturally winners ticket numbers di er output number bits hamming distance output 
see ticket numbers chosen tend clustered space possible ticket numbers may way determine winner 
return presently consider alternatives 
lottery output entirely ticket numbers purchased tickets committed 
able assume publicly veri able means producing lottery output unpredictable purchases tickets awards prizes design simpler require algorithm delays determination output lottery closed 
noted means computing lottery output traditional numbers games assumed means 
assume means available acceptable case 
lottery output fair sense ticket just win 
course may possible prove algorithm computing output truly fair 
noted lottery winners determined output 
strict avalanche criterion bit input preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
ticket list yields chance change bit lottery output 
time compute lottery output acceptably bounded 
speci cally time compute lottery output su ciently long nal ticket list publicly posted compute lottery output 
truly secure regard time compute output ticket issued open lottery time sent customer lottery output determined su ciently long close lottery vendor possibly ect outcome issuing tickets 
time compute lottery output long cause unreasonable delay determining winning tickets distributing winnings 
assume clock skew communication delays strictly dominated bounds time compute lottery 
assume time compute lottery orders magnitude longer clock skew communication delay 
assume possible vendor mount attack type getting caught 
vendor sells 
breaks connections customers bought tickets 
picks sets ticket numbers calculates lottery outcome sold ticket numbers sets 
chosen su ciently sets odds outcome tickets winner 
builds nal ticket list sold tickets chosen set resumes communication 
claims tickets sold close lottery keeps money 
number ways prevented 
vendor required maintain copy ticket list timestamp trusted time server 
generally vendor demonstrate acceptable means ticket list yielded lottery output publicly available close lottery time adequately minimum time calculate outcome open lottery time lottery cancelled customers issued full refund tickets purchased 

payoff winnings simple scheme 
winnings assumed monetary value proportional xed percentage total number tickets list 
percentage assumed publicly posted lottery 
simplicity assuming primary winners 
winnings simply equally split 
payo simple possible expected value tickets rise increase payo dominated amount rolled exogenously added 
simplest case vendor simply run lottery tickets collaborators 
guaranteed collect prize money 
case lottery simple mechanism available prevent attack vendor 
payo simple xed percentage number tickets issued expected value ticket xed regardless number tickets issued 
vendor gain expected advantage issuing tickets covertly friends 
doing decrease probability win proportionally increase payo receive win 
vendor issue tickets charging 
point remains expected value ticket remains constant 
cheating vendor shift extent expected value due probability winning vs value payo appearances deceptive 
way vendor gain advantage issuing tickets 

spatial distribution ticket numbers claim expected value true ticket numbers uniformly distributed space possible ticket numbers 
case winner determined hamming distance vendor mount attack lowers expected value sold tickets increasing expected earnings lottery 
simple example suppose lottery run 
tickets cost basic expected value ticket cents 
suppose possible ticket numbers 
ticket purchased ticket number vendor issues false tickets numbers expected value sold ticket just cents 
vendor attack pro table tickets purchased value 
attack defeated simply requiring ticket numbers unique large number di erent people buy tickets 
long distribution tickets skewed away preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
vendor issue tickets numbers closer ticket number space numbers sold tickets able run version attack 
important question complexity attack 
choosing ticket numbers bend lottery vendor advantage order complexity calculating lottery outcome may threat 
exact outcome lottery generic distribution calculations may run advance especially typical ticket distributions somewhat predictable 
building vendor able construct meta attack need executed time lottery run 
vendor may tics point particularly glaring skews ticket numbers sold tickets 
may employ attack employ 
section consider lottery vendor heuristics rendering complexity questions meta attack moot 
see way prevent vendor running heuristic checks lottery runs progress prevent assessing typical distribution tickets runs lottery advantage pattern sees tailoring space possible ticket numbers facilitate attack increase advantage 
customers choose numbers dates example vendor may able choose space set numbers relatively easy approximately bound date subspace rest ticket number space 
vendor may able encourage clustering purchased tickets 
lottery vending machines today provide random ticket numbers want pick 
indirect covertly involved publication books lottery playing strategies 
course space possible ticket numbers sets ticket numbers chosen previous runs public information 
take advantage 
sense attack 
savvy gradually occupy ticket number space having certain advantage savvy counterparts games chance poker way go 
intellectually egalitarian game 
way require people random numbers 
disadvantages inconvenient best enforce require people trust maintain number generators 
choose favorite numbers salt random desirable case 
possibility set winner minimum hamming distance hamming distance boundary 
boundary wins 
state lottery games hamming distance rst place 
remove advantage attempt draw boundaries parts space 
clustering small parts space ticket numbers may advantageous scatter tickets rest space depending amount clustering size boundary 
note may winner approach 
means calculating winner violate assumption total amount awarded xed ratio total purchase assumption lottery simple 
alternatively winner determined means hamming distance lottery output 
example output taken modulo total sold considered order entered ticket list lottery close 
secondary tertiary winners determined closeness winning number 
hamming distance ticket list order appear adequate measures closeness purposes examined carefully 
outcome unpredictable mod remove bias randomness ticket numbers played space potential ticket numbers 
am assuming lottery output potentially larger 
suggestion 
mechanism chooses winners true lottery fashion picking randomly bias entered ticket numbers substituted 
need judgement type game played picks fairly domain ticket numbers vs picks fairly played ticket numbers 
fair need clearly explained potential players advance 

lottery collected wsbc rst lottery design need additional assumptions 
speci cally assume produce list ticket numbers preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
nd preimage resistant function hash value range wsbc function 
note conceivable simply identity 
properties exists moderately hard nd 
output lottery 
straightforward way build lottery employing wsbc 
way determining lottery outcome similar section 
discuss di erences 
obvious di erence lottery employs delaying function called place wsbc 
inverting wsbc delaying functions meant moderately hard compute 
meant entropy preserving information theoretic sense 
obviously similar collision resistance nd preimage resistance wsbc 
delaying functions may simply inverses class wsbc precisely inverses 
speculation leave exact relation topic 
important di erence lottery requires authentication ticket minimum number di erent obtain tickets critical phase lottery 
basically period sale tickets close sale 
designed guarantee lottery organizer lottery buying tickets handful 
insuring minimum number distinct buy period assuming probability collusion number low sure probability su ciently low 
course lotteries free corner lottery way 
means need registration authentication complications 
bother 
answer allows lotteries simple 
may outside prizes may 
payo lotteries gets high may attract disproportionate numbers customers purchases customer 
advantages vendor 
expected dollar value ticket goes circumstances potential prize large may playing advantageous customers 
mistake measure expected utility playing linearly related expected monetary value tickets 
true point playing lottery 
advantages disadvantages requiring authentication 
lottery 
possible lottery boundary method calculating winners described section violating constraints running lottery 
noted presence clustering vendor may theoretically able take advantage distribution attack lottery method calculate winner 
may exacerbated lottery 
set hamming distance boundary winning properly done things encourage clustering able create fairly high play spread ticket numbers guarantee high probability winning time dropping threshold critical purchase phase 
fact plays spread high sure larger average number players 
analysis scope necessary determine building attack really worth risk trouble 
case methods determining winner modulo method 

lottery individual wsbc basic collected wsbc lottery require trust vendor concerning fairness lottery 
trust lies solely algorithms transform lottery input lottery output implementations 
element trust vs convenience take place 
speci cally wishes con rm outcome lottery reproduce presumably time consuming expensive calculation trusted platform wait results 
step way algorithm operate entire conglomerate list ticket entries ticket number individually 
advantage twofold 
ticket holder way know result applying algorithm ticket number ahead time 
importantly algorithm inverting wsbc perform perform wsbc easier 
call input chooses private ticket number output public ticket number 
nal calculation lottery output preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
fast calculation hash function private ticket numbers 
obtained breaking secret bit commitments constitute public ticket numbers 
private ticket numbers taken input calculation xed order presumably public ticket numbers ticket list ordering 
important advantage splitting wsbc allows individuals precompute commitment value 
advantages paramount secret individual possesses 
means lottery result quickly easily veri ed 
means lottery result potentially determined quickly threat fairness 

quick verification lottery results quickly veri able technique section commit private ticket number 
encryption 
precisely function commit 
calculated tickets keys published 
quickly verify lottery result performing encryptions computing lottery output 
lottery output may quickly veri ed necessary wait result breaking secret bit commitments lottery outcome determined 
depending cooperation lottery participants accelerated 
lottery publically determined closed individual ticket holders reveal private ticket numbers keys encrypt 
lottery outcome determined presumably quickly breaking bit commitments include temporal safety margin 
guarantee cooperate 
know won lost done 
interest participants cooperate 
calculation similar respect rational exchange discussed 
allowing irrational ticket holders system errors may occur probably interest individual ticket holders reveal secrets 
vendor probably processors devote breaking bit commitments 
people send secrets faster outcome determined 
may imply solution case classic coordination problem requires cooperation lots people rational think fail part 
worth doing part 
doing part helps don better bet cooperate 
may lead higher number lottery runs send secrets 

malformed tickets discussion assumes tickets valid 
tickets produced encryption appropriate key correct algorithm determined provided redundancy determine message encrypted key including hash message encryption 
ticket declared invalid 
alternatively technique extracting key yield unique key key encrypt private ticket number private ticket number declared decryption key public ticket number private ticket number clearly chosen committed way 
choice advantage avoiding customer relations problems accompanying rst choice 
choice existence improperly formed tickets ect destroying quick con rmation lottery outcome 
lottery outcome quickly determined ignoring malformed tickets determination tickets malformed quickly veri ed 
malformed tickets relatively rare 
conceivable lottery runs contain 
customers submit malformed tickets cost money 
recall assume integrity protection ticket purchase ticket chosen customer assumed ticket entered ticket list 
necessary ticket purchase authenticated means reveal submits malformed ticket 
individual sanctioned excluding lottery runs 
assuming customer generated malformed tickets rarely occur vendor choose invalid ticket numbers lottery appealing public vendor 
possible malformed tickets occur remove advantage quick veri cation 
preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 

parallel veri cation computations noted slow veri cation limitation collected lottery potentially limitation individual lottery 
speed veri cation parallelizing 
somewhat surprising computations designed resist parallelization 
intrinsically sequential computation intermediate results 
sequential computation requiring steps broken arbitrarily smaller pieces 
example nk ci th intermediate result veri cation computation cs broken pieces form hci ci ki 
veri cation piece con rm computations ci yields ci veri cation time calculating cs reduced factor assuming processors working parallel 
method possible split veri cation collected lottery outcome split veri cation malformed ticket malformed 
individual ticket processors disposal allow mutually trusting customers split duties 
splitting things way itis possible verify computations probabilistically 
ameliorate limitation easy veri cation 
error equally come segment checking number segments random reduce probability computation incorrect proportionately 
case probability error higher 
sense check segments check backwards increasingly checking initial segment approached 

fair exchange name implies fair exchange protocols designed provide guarantee participant cheated agrees exchange goods takes sends send agreed goods 
cf 
reserve fair exchange protocols guarantee participant eventual delivery agreed goods 
may called strong fair exchange 
weak fair exchange guarantees participant receive agreed goods evidence principal access goods sent 
somewhat related fair exchange protocols nonrepudiation protocols 
provide nonrepudiation origin proof sender message nonrepudiation receipt proof received message 
protocols provide form fair exchange form nonrepudiation 
protocol describe protocol 
protocols general provide weak fair exchange 
title misnomer 
protocols result form exchange appears similar fair exchange 
provide incentives principals operating self interest reason proceed protocol point abort 
reason call rational exchange protocols 
sends message supposed provide value goods xed amount time computation sends shown 
protocol provides feature weak fair exchange 
time wishing prove proceeded point protocol show counterpart proceeded immediately prior point 
degree nonrepudiation evidence provided 
bottlenecks fair exchange nonrepudiation protocols trusted third party ttp typically necessary guarantee protocol desired properties 
done cited papers reduce bottleneck 
improvements include moving ttp ine need contacted principals fails cooperate 
protocols describe require ttp 
explain 
related fair exchange phenomenon fair contract signing 
cf 
high level description 
lottery fair exchange non repudiation protocols discussed fair contract signing typically trusted third party 
roughly parties exchange bits larger parts signatures contract alternating fashion 
assuming roughly equal computing power party points roughly chance committing party contract amount ort 
ben fair contract signing protocol limitations assumptions basic contract signing protocols describe 
requires limited ttp 
main problem contract signing maintain parity small amounts information conveyed message 
preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
protocols tend highly ine cient 
goals slightly di erent able cient 

rational exchange wsbc simple example vendor selling goods customer 
follow somewhat usual conventions digital signature principal private key fxgk encryption key 
main mechanism employ encrypt value strong key commit words quickly computable technique section 
message description goods message payment message message message protocol 
vendor selling relatively low value items worth customer break encryption recover item 
may literally true terms cost computation may value inconvenience delay 
cost computation factor general wsbc 
alternatively vendor may item timely diminishing value short term investment advice regularly changing lists bargain items sale 
commitment structured goods greatly diminished value time recovered 
structured properly vendor take unknown customers way refuse service repeat customers fail pay 
protocol step earlier signed request goods sent customer 
rst message customer turn wants evidence vendor sent wrong thing 
customer sends payment rst message 
vendor show sent goods weakly encrypted form shows received payment 
third message received david goldschlag suggested similar version protocol delaying functions improvement earlier version 
customer prove sent payment proving vendor sent information quickly get goods 
information just key included message show key reveals goods 
vendor send third message long time 
way counter possibility add timestamps protocol 
defeat point ttp 
applications envision primary deterrent vendor delaying sending message vendor gains doing bad reputation ruin business 
case prevent customer getting goods albeit slightly longer wait greater ort really sent rst message 
case provided evidence customer sent evidence show judge ful lled part protocol 
penalty form cheating greatly exceeds value goods vendor interest cheat 
add fourth message customer acknowledges timely receipt message customers generally incentive send message 
account system vendor er incentive customers turn certain number acknowledgments 
vendor trusted keep track number acknowledgments sent need message 
generic fair exchange wsbc generic protocol fair exchange principals 
alice exchange goods bob 
protocol uses wsbc commitment previous example 
commitment quickly easily breakable successive message 
protocol party encryption party goods accessible quickly 
message message descrip 
exch 
parameters fg gk descrip 
exch 
parameters fg gk message preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
message message message message exchange parameters include things length computation message nd encryption key 
may take account things assumed asymmetry processor speed trust customer vendor asymmetry goods distributed money investment advice 
include minimum time principals held responsible maintaining evidence messages sent protocol 
cost nding preimage bit commitment compared value goods may possible general wsbc 
case generally important bit commitment function quickly computable cited section :10.1.1.110.5709
take impractically long principals prepare messages 
protocol structure similar contract signing typically cient 
need proceed tiny increments 
example suppose simplicity alice bob exchanging items useful days useless 
protocol structured rst message contain encryption goods take days bob break 
second message breakable alice day 
third message breakable bob hours 
fourth message breakable alice minutes 
fth message breakable bob minute 
sixth message reveal completely 
messages sent way 
stage game parties easier time cheating get worth proceed 
importantly providing party evidence agreed protocol received previous messages 
bob send fourth message alice show judge messages judge rule bob comply exchange respond message timely manner eventually show received message 
alice break encryption second message day 
get part value bob goods presumably responsible having failed complete protocol 
sending completely random garbage 
provable short amount time 
rst message shown 
purchase protocol penalties compensation form cheating exceed value exchanged making worthwhile people go computation demonstrate making worthwhile cheat way 

related basic idea wsbc related number ideas arisen lately puzzles pricing functions delaying functions :10.1.1.110.5709
noted text pricing functions appear related general wsbc time lock puzzles delaying functions related speci cally 
values repeated hashing section measure elapsed time 
previous cryptographic treatments lotteries 
generally forms payment mechanisms run actual lotteries cf 
closely related general approach lotteries 
fact basic ideas arose joint discussion authors 
development basic ideas done independently important di erences 
discussed section 
rational exchange protocols discussed similar jakobsson 
main idea allow cryptographic equivalent bill say bill half giving half vendor vendor provides goods 
second half 
similar approach part idea force compliance protocol remove incentives cheat 
introduced concept weakly secret bit commitment shown applications 
construct lotteries entirely determined tickets purchased determination lottery closed lottery result takes long calculate 
individual lottery shown quickly verify results provided malformed tickets 
collected lottery individual lottery presence malformed tickets showed speed veri cation lottery results parallelization 
preprint syverson 
weakly secret bit commitment applications lotteries fair exchange 
published proceedings ieee computer security foundations workshop csfw massachusetts june 
allows perform veri cation probabilistic assurances faster perform 
introduced idea rational exchange showed wsbc exchange protocols cient require ttp 
recall assumed weak fair exchange purchase lottery tickets 
lottery tickets small purchase value possible wsbc integrating rational ticket purchase lottery design 

observe examples shown weak protection secrets achieve things strong protection 
basic ideas collected lottery scheme developed conversations david goldschlag stewart stubblebine fc bwi february 
greatly conversations 
am thankful cathy meadows helpful conversations writing 
gene tsudik anonymous referees helpful comments 
supported onr 
mart abadi mark lomas roger needham :10.1.1.35.6328
strengthening passwords src technical note sept minor revisions dec 
asokan waidner 
optimistic protocols fair exchange proceedings th acm conference computer communications security ccs acm press pp 
april 
ben goldreich micali rivest 
fair protocol signing contracts ieee transactions information theory vol 
pp 
jan 
cynthia dwork moni naor 
pricing processing junk mail weizmann institute tech 
report cs 
preliminary version crypto 
matthew franklin malkhi 
metering lightweight security financial cryptography fc proceedings ed springer verlag lncs vol 
pp 

matthew franklin michael reiter 
fair exchange semi trusted third party proceedings th acm conference computer communications security ccs acm press pp 
april 
david goldschlag stuart stubblebine 
publically veri able lotteries applications delaying functions extended financial cryptography fc bwi february 
final proceedings forthcoming springer verlag 
markus jakobsson 
coins fair exchange advances cryptology eurocrypt springer verlag lncs pp 

menezes van oorschot vanstone 
handbook applied cryptography crc press 
ronald rivest adi shamir david wagner :10.1.1.110.5709
time lock puzzles timed release crypto unpublished march 
ronald rivest 
electronic lottery tickets financial cryptography fc proceedings ed springer verlag lncs vol 
pp 

schneier 
applied cryptography second edition protocols algorithms source code john wiley sons 
webster 
design boxes advances cryptology crypto springer verlag lncs pp 

david wheeler 
transactions bets security protocols th international workshop lomas ed springer verlag lncs vol 
pp 

zhou dieter gollmann 
fair nonrepudiation protocol proceedings ieee symposium security privacy ieee cs press pp 

zhou dieter gollmann 
cient non repudiation protocol proceedings ieee computer security foundations workshop csfw ieee cs press pp 

preprint 
