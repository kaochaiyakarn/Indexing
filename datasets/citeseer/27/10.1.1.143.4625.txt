quadrics network high performance clustering technology quadrics network extends native operating system processing nodes network operating system specialized hardware support network interface 
doing integrates individual node address spaces single global virtual address space provides network fault tolerance 
fabrizio wu chun feng salvador coll eitan los alamos national laboratory interconnection network associated software libraries critical components high performance cluster computers supercomputers web server farms network attached storage 
components greatly impact design architecture systems 
key solutions high speed interconnects include gigabit ethernet scalable coherent interface sci myrinet gigabyte system network 
interconnects differ architecture programmability scalability performance ability integrate large scale systems 
gigabit ethernet resides low performance spectrum provides low cost solution 
sci myrinet gigabyte system network provide programmability performance adding communication processors network interface cards implementing different types user level communication protocols 
quadrics network surpasses interconnects functionality approach integrates node local virtual memory globally shared virtual memory space provides programmable processor network interface allows implementation intelligent communication protocols delivers integrated network fault detection fault tolerance 
consequently possesses salient aspects evolving standard gives integrated approach highperformance communication 
consists hardware building blocks programmable network interface called elan high bandwidth communication switch called elite 
elite switches interconnected topology 
respect software provides layers communication libraries trade performance ease 
combines hardware software components implement efficient protected access global virtual memory remote direct memory access dma operations 
enhances network fault tolerance link level ieee mhz link multiplexer fifo queue fifo queue sdram interface thread processor microcode processor direct memory access engine data bus mhz way set associative cache memory management unit translation look aside buffer table walk engine clock statistics registers pci interface mhz 
elan functional units 
protocols detect faults automatically retransmit packets 
elan network interface elan network interface refer elan version elan article connects quadrics network processing node containing cpus 
addition generating accepting packets network elan provides substantial local processing power implement high level message passing protocols message passing interface mpi 
internal functional structure elan shown centers primary processing engines microcode processor thread processor 
bit microcode processor supports hardware threads 
thread independently issue pipelined memory requests memory system 
requests outstanding time 
scheduling microcode processor permits thread wake schedule new memory access result previous memory access go back january february clustering technology ieee micro sleep system clock cycles 
microcode threads handles input transactions network dma engine generates dma packets write network prioritizes outstanding dmas time slices large dmas prevent adverse blocking small dmas processor scheduling prioritizes controls thread processor scheduling command processing handles requested operations commands host processor user level 
thread processor bit risc processor helps implement higher level messaging libraries explicit intervention main cpu 
better support implementation high level messagepassing libraries main cpu explicit intervention augments instruction set extra instructions 
extra instructions help construct network packets manipulate events efficiently schedule threads block save restore thread state scheduling 
memory management unit mmu translates bit virtual addresses bit local sdram physical addresses bit peripheral component interconnect pci physical addresses 
translate addresses mmu contains entry fully associative translation look aside buffer small data path state machine perform table walks fill translation look aside buffer save trap information mmu experiences fault 
elan contains routing tables translate virtual processor number sequence tags determine network route 
system software load routing tables provide different routing strategies 
elan kbyte memory cache organized sets kbytes mbyte sdram 
cache line size bytes 
cache performs pipelined fills sdram issue multiple cache fills write backs different units servicing accesses units hit cache 
sdram interface bits length check bits added provide errorcorrecting code 
memory interface contains byte write read buffers 
link logic transmits receives data network generates bits clock signal half clock cycle 
link provides buffer space virtual channels entry bit fifo ram flow control 
elite switch elite provides bidirectional links supporting virtual channels direction internal full crossbar switch crossbar input ports input link accommodate virtual channels nominal transmission bandwidth mbytes link direction flow latency ns packet error detection recovery cyclic redundancy check protected routing data transactions priority levels combined aging mechanism ensure fair delivery packets priority level hardware support broadcasts adaptive routing 
connects elite switches quaternary fat tree topology belongs general class ary trees 
quaternary fat tree dimension composed processing nodes switches interconnected delta network recursively built connecting quaternary fat trees dimension 
shows quaternary fat trees dimensions 
packet routing 
elite networks source routed 
elan network interface resides network node attaches route information packet header injecting packet network 
route information sequence elite link tags 
packet moves inside network elite switch removes route tag header forwards packet elite switch route final destination 
routing tag identify single output link group links 
elan interface pipelines packet transmission network wormhole flow control 
link level elan interface partitions packet smaller bit units called flow control digits flits 
packet closes packet token source elan normally sends token receipt packet acknowledgment token 
process implies packet transmission creates virtual circuit source destination 
network nodes send packets multiple destinations network broadcast capability 
successful broadcast packet delivery source node receive positive acknowledgment broadcast group recipients 
elan interfaces connected network receive broadcast packet desired sender limit broadcast set subset physically contiguous 
global virtual memory elan transfer information directly address spaces groups cooperating processes maintaining hardware protection process groups 
capability called virtual operation sophisticated extension conventional virtual memory mechanism concepts elan virtual memory elan context 
elan virtual memory 
elan contains mmu translate virtual memory addresses issued various chip functional units thread processor dma engine physical addresses 
physical memory addresses refer elan local memory sdram node main memory 
support main memory accesses configuration tables elan mmu synchronized main processor mmu tables elan access virtual address space 
system software responsible mmu table synchronization invisible programmers 
elan mmu translate virtual addresses main processor format example bit word big endian architecture alphaserver virtual addresses written elan format bit word little endian architecture 

quaternary trees dimensions 
processor bit architecture example intel pentium requires toone mapping 
page shows bit processor mapping 
bit addresses starting ff mapped elan bit addresses starting xc 
means main processor directly access virtual addresses range ff elan access memory addresses xc january february clustering technology ff mbytes main processor virtual address space heap bss block started symbol data text stack heap system ieee micro main memory elan sdram elan virtual address space heap bss block started symbol data text stack heap system range 
example user allocate main memory malloc process heap grow outside region directly accessible elan delimited 
avoid problem main elan memory allocated consistent memory allocation mechanism 
shown mmu tables map common region virtual memory called memory allocator heap 
allocator maps demand physical pages main elan memory virtual address range 
allocation functions provided elan library user allocate portions virtual memory main elan memory main processor elan kept consistent 
mbytes 
virtual address translation 
dotted lines signify segment memory address space maps equally sized segment memory address space 
efficiency programmers locate objects example communication buffers dma descriptors elan memory 
way elan process independently main processor 
elan context 
conventional virtual memory system user process assigned process identification number selects mmu table set physical address spaces accessible user process 
extends concept user address spaces parallel program intersect 
elan replaces process identification number value context value 
user processes directly access exported segment remote memory context value virtual address 
furthermore context value determines remote processes access address space elan network processes reside 
user process multithreaded threads share context just share main memory address space 
node multiple physical cpus different cpus execute individual threads 
threads share context 
network fault detection fault tolerance implements network fault detection tolerance hardware 
important note fault detection tolerance occurs communicating 
normal operation source elan transmits packet route information source routing followed transactions 
receiver destination elan receives transaction ack flag means transaction user applications message passing interface mpi tagged message port user space elan lib kernel space system calls elan kernel communications 
elan programming libraries 
packet 
destination elan sends packet acknowledgment token back source elan 
source elan receives packet acknowledgment token send packet token indicate packet transfer completion 
fundamental rule elan network operation packet sent link elan interface returns single packet acknowledgment token 
network reuse link destination elan sends token 
elan detects error packet transmission immediately sends error message waiting token 
elite detects error automatically transmits error message back source destination 
process source destination isolate faulty link switch hop fault detection source receives notification faulty component retry packet transmission default number times 
unsuccessful source appropriately reconfigure routing tables avoid faulty component 
programming libraries shows different programming libraries elan network interface 
libraries trade speed machine independence programmability 
elan lib provides lowest level user space programming interface elan 
level processes parallel job communicate abstraction distributed virtual shared memory 
process parallel job allocated virtual process identification number map portion address space elan 
address spaces taken combination constitute distributed virtual shared memory 
combination virtual address provide address remote memory memory processing node belonging process 
system software elan hardware locate elan context perform remote communication 
elan mmu process select part address space visible network determine specific access rights example write read select set potential communication partners 
higher level interface releases programmer revision dependent details elan extends elan lib pointto point tagged message passing primitives called tagged message ports 
standard communication libraries mpi standard cray implemented top 
elan lib elan lib library supports programming environment groups cooperating processes transfer data directly protecting process groups hardware 
communication takes place user level copy bypassing january february clustering technology ieee micro operating system 
main features elan lib memory mapping allocation scheme described previously event notification remote dma transfers 
events provide general purpose mechanism processes synchronize actions 
threads running elan processes running main processor mechanism 
processes threads packets access events locally remotely 
way synchronization processes possible events indicate communication operation completion remote dma 
stores events elan memory guarantee atomic execution synchronization primitives 
current pci bus implementations guarantee atomic execution possible store events main memory 
processes wait event triggered blocking busy waiting polling 
addition processes tag event block copy 
block copy mechanism works follows process initialize block data elan memory hold predefined value 
equivalent sized block located main memory blocks user virtual address space 
specified event set example dma transfer completed block copy takes place 
hardware elan dma engine copies block elan memory block main memory 
user process polls block main memory check value example bringing copy corresponding memory block level cache polling information pci bus 
value initialized source block process knows specified event occurred 
elan supports remote dma transfers network copying buffering operating system intervention 
process initiates dma fills dma descriptor typically allocated elan memory efficiency 
dma descriptor contains source destination process amount data source destination addresses event locations source destination process information enhances fault tolerance 
outlines typical steps remote dma 
command processor referred elan microcode thread processes user commands specific microprocessor 
machine independent library integrates main features elan lib 
provide basic mechanisms point point message passing 
senders label message tag sender identity message size 
information known envelope 
receivers receive messages selectively filtering sender identity tag envelope 
layer handles communication shared memory processes node 
programming interface similar mpi 
implement message sends receives distinct function calls nonblocking send posts performs message communication blocking send waits matching start send completed allowing implementation different flavors higher level communication primitives 
deliver messages synchronously asynchronously 
transfer synchronous messages sender receiver intermediate system buffering message leave sender receiver requests 
copies asynchronous messages directly receiver buffers receiver requested 
receiver requested copies asynchronous messages system buffer destination 
experiments tested main features experimental cluster dual processor symmetric multiprocessors smps equipped mhz pentium 
smp uses motherboard chipset gbyte sdram bit mhz pci slots elan pci card qm 
interconnection network quaternary fat tree dimension composed port elite switches integrated board 
linux test operating system evaluation 
expose basic performance wrote benchmarks elan lib level 
briefly analyzed overhead user process elan sdram dma descriptor direct memory access engine event command processor event source memory management unit table walk engine user process elan sdram direct memory access engine event command processor destination event memory management unit table walk engine 
execution remote dma 
sending process initializes dma descriptor elan memory communicates address dma descriptor command processor 
command processor checks correctness dma descriptor adds dma queue 
dma engine performs remote dma transaction 
transaction completion remote notifies dma engine sends acknowledgment source elan 
hardware elan notify source destination events needed 
introduced implementation mpi port mpi ch 
identify different bottlenecks placed communication buffers unidirectional bidirectional ping tests main january february clustering technology bandwidth mbytes latency mpi elan elan main elan elan main main main elan elan elan elan main elan elan elan main elan main main mpi main main elan main main ieee micro unidirectional ping bandwidth message size bytes unidirectional ping latency message size bytes 
unidirectional pings bandwidth latency 
elan memory 
communication alternatives memories include main main elan elan elan main main elan 
unidirectional ping shows results unidirectional ping 
asymptotic bandwidth communication libraries buffer mappings lies narrow range mbytes mpi mbytes elan lib 
results show small performance asymmetry read write performance pci bus 
elan lib read write bandwidths mbytes system reaches peak bandwidth mbytes place source destination buffers elan memory 
logically organize graphs groups relative elan lib source buffer elan memory elan lib source buffer main memory mpi 
group latency low small messages 
basic latency increases second group extra delay cross source pci bus 
mpi thread processor perform tag matching increases overhead 
shows latency messages range kbytes 
elan lib latency byte messages constant messages bytes elan interface pack messages single write block transaction 
latency mpi levels increases 
elan lib level latency hardware level system software runs thread elan match message tags 
introduces extra overhead responsible higher latency value 
noise bytes shown due message transmission policy 
elan inlines messages smaller bytes message envelope immediately available receiver requests 
sends larger messages synchronously receiver posted matching request 
bidirectional ping shows full network bidirectionality achieved practice 
maximum unidirectional value obtained half measured bidirectional traffic approximately mbytes unidirectional case mbytes gap bandwidth exposes bottlenecks network network interface 
dma engine interleaving sharing elan internal data bus interference elite network cause performance degradation 
mbytes value occurs source buffer main memory destination buffer elan memory buffers elan memory 
case elan memory bottleneck 
bidirectional bandwidth main memory main memory traffic mbytes libraries 
shows bidirectional traffic affects latency elan lib mpi 
bandwidth mbytes latency hotspot hotspot single memory location processors access repeatedly 
measure vulnerability hotspots read write memory location increasing number processors mpi elan elan main elan elan main main main elan elan elan elan main elan elan elan main elan main main bidirectional ping bandwidth mpi main main elan main main message size bytes bidirectional ping latency message size bytes 
bidirectional pings bandwidth latency 
smp 
page plots bandwidth increasing numbers smps 
upper curve shows aggregate global bandwidth processes 
curves remarkably flat reaching mbytes read write hotspots 
lower curves show smp band january february clustering technology bandwidth mbytes global read global write smp read smp write number symmetric multiprocessors 
bandwidth variation read write hotspots 
width 
scalability type memory operation available number processors cluster 
analysis shows components performance space analyzed network libraries deliver excellent performance users 
includes scalability analysis larger configurations performance testing larger subset collective communication patterns performance analysis scientific applications 
micro acknowledgments quadrics team david addison jon robin crook david duncan john taylor generous support 
supported department energy los alamos national laboratory contract eng 

seifert gigabit ethernet technology applications high speed lans addison wesley reading mass 

vogels tree saturation control ac velocity cluster hot interconnects aug www cs cornell edu vogels clusters ac files frame htm current dec 

sci standard applications sci sci scalable coherent interface lecture notes computer science vol 
eds springer verlag heidelberg germany pp 


boden myrinet gigabit second local area network ieee micro vol 
jan pp 


changing guard gateway proc 
th int conf 
parallel interconnects pi ieee cs press los alamitos calif pp 


architecture tutorial hot chips aug www cs cf ac uk 
pdf current dec 

elan programming manual quadrics supercomputers world bristol england uk jan www docs html 
html 

leiserson fat trees universal networks hardware efficient supercomputing ieee trans 
computers vol 
oct pp 

ieee micro 
performance analysis wormhole routed ary trees int foundations computer science vol 
june pp 


dally seitz deadlock free message routing multiprocessor interconnection networks ieee trans 
computers vol 
may pp 


hardware software collective communication quadrics network proc 
ieee int symp 
network computing applications nca ieee press piscataway pp 


gropp mpi complete volume mpi extensions mit press cambridge mass 
staff scientist leader modeling algorithms informatics group computer computational sciences division los alamos national laboratory 
research interests include performance analysis modeling distributed computing parallel computer architectures 
member ieee 
salvador coll faculty member electronic engineering technical university valencia spain 
research interests include multicomputer systems interconnection networks special interest routing algorithms collective communications 
coll bs electronic engineering ms computer science technical university valencia 
member spanish academy engineering 
fabrizio member modeling algorithms informatics group ccs los alamos national laboratory 
research interests include high performance interconnection networks network interfaces job scheduling algorithms simulation parallel architectures operating systems 
received phd computer science university pisa italy 
recipient european community marie curie research fellowship 
member ieee computer society 
eitan research assistant los alamos national laboratory graduate student hebrew university jerusalem israel 
research interests include operating systems networks data compression 
ms computer science mathematics hebrew university jerusalem 
member ieee 
wu chun feng technical staff member team leader research development advanced network technology radiant los alamos national laboratory 
research interests include high performance networking network protocols architecture 
feng bs computer engineering music ms computer engineering penn state university phd computer science university illinois urbana champaign 
member ieee acm 
direct questions comments article fabrizio computer computational sciences division modeling algorithms informatics ccs ms los alamos national laboratory los alamos nm fabrizio lanl gov additional information related publications quadrics network please visit www lanl gov fabrizio quadrics html 
information computing topic visit digital library computer org publications dlib 
january february 
