recovering intrinsic images single image marshall william freeman edward adelson mit artificial intelligence laboratory cambridge ma ai mit edu ai mit edu adelson ai mit edu algorithm uses multiple cues recover shading reflectance intrinsic images single image 
color information classifier trained recognize gray scale patterns image derivative classified caused shading change surface reflectance 
generalized belief propagation propagate information areas correct classification clear areas ambiguous 
show results real images 
image product characteristics scene 
important characteristics scene shading reflectance 
shading scene interaction surfaces scene illumination 
reflectance scene describes point reflects light 
ability find reflectance point scene shaded important interpreting image requires ability decide factors affect image 
example geometry object scene recovered able isolate shading point 
likewise segmentation simpler reflectance point scene 
system finds shading reflectance point scene decomposing input image images containing shading point scene image containing reflectance point 
images types representation known intrinsic images image contains intrinsic characteristic scene 
prior algorithms finding shading reflectance images broadly classified generative discriminative approaches 
generative approaches create possible surfaces reflectance patterns explain image model choose surface 
previous generative approaches include modeling worlds painted polyhedra constructing surfaces patches taken training set :10.1.1.116.8559
contrast discriminative approaches attempt differentiate changes image caused shading caused reflectance change 
early algorithms retinex simple assumptions assumption gradients reflectance changes larger magnitudes caused shading 
assumption hold real images algorithms complex statistics separate shading reflectance 
bell freeman trained classifier local image information classify steerable pyramid coefficients due shading reflectance 
steerable pyramid coefficients allowed algorithm clas edges multiple orientations scales 
steerable pyramid decomposition low frequency residual component classified 
classifying low frequency residual band pass filtered copies shading reflectance images recovered 
addition low frequency coefficients may natural classification 
different direction weiss proposed multiple images reflectance constant illumination changes 
approach able create full frequency images required multiple input images fixed scene 
system uses multiple cues recover full frequency shading reflectance intrinsic images single image 
approach discriminative classifier color information image classifier trained recognize local image patterns distinguish derivatives caused reflectance changes derivatives caused shading 
address problem ambiguous local evidence markov random field propagate classifications areas evidence clear ambiguous areas image 
separating shading reflectance algorithm decomposes image shading reflectance images classifying image derivative caused shading reflectance change 
assume input image expressed product shading image reflectance image 
considering images log domain derivatives input image sum derivatives shading reflectance images 
significant shading boundaries reflectance edges occur point simplifying assumption image derivative caused shading reflectance 
reduces problem specifying shading reflectance derivatives binary classification image derivatives 
labelling derivative produces estimates derivatives shading reflectance images 
derivative represents set linear constraints image derivative images results constrained system 
recover intrinsic image derivatives method introduced weiss find pseudo inverse constrained system derivatives 
fx fy filters compute derivatives fx fy estimated derivatives shading image shading image fx fx fy fy convolution reversed copy solution fx fx fy fx reflectance image fashion 
nice property technique computation done fft making computationally efficient 
classifying derivatives architecture recovering intrinsic images step create classifiers separate underlying processes image 
system uses classifiers uses color information separate shading reflectance derivatives second classifier uses local image patterns classify derivative 
original image shape image reflectance image example computed color information classify derivatives 
facilitate printing intrinsic images computed gray scale version image 
color information solely classifying derivatives gray scale copy image 
color information system takes advantage property changes color pixels indicate reflectance change 
surfaces diffuse changes color image due shading affect color channels proportionally 
assume adjacent pixels image values rgb triplets 
change pixels caused shading intensity color changes scalar 
chromaticity colors changed color change caused reflectance change 
chromaticity change image indicates reflectance changed point 
find chromaticity changes treat rgb triplet vector normalize create 
angle find reflectance changes 
change caused shading equals 
threshold derivative associated colors classified reflectance derivative 
color information approach similar 
primary difference system classifies vertical horizontal derivatives independently 
shows example results produced algorithm 
classifier marked reflectance areas correctly text cleanly removed bottle 
example demonstrates high quality reconstructions obtained classifying derivatives 
gray scale information color information useful sufficient properly decompose images 
change color intensity caused shading reflectance change 
local color information color intensity changes classified properly 
fortunately shading patterns unique appearance discriminated common reflectance patterns 
allows local gray scale image pattern surrounding derivative classify 
basic feature gray scale classifier absolute value response linear filter 
refer feature computed manner non linear filter 
output non linear input patch ip ip convolution linear filter 
filter size image patch consider response center ip 
feature function patch image data scalar response 
feature viewed absolute value dot product ip responses linear example images training set 
examples reflectance changes examples shading original image shading image reflectance image results obtained gray scale classifier 
filters basis feature part successfully characterizing synthesizing images textured surfaces 
non linear filters classify derivatives classifier similar viola 
classifier uses adaboost algorithm combine set weak classifiers single strong classifier :10.1.1.32.8918
weak classifier threshold test output non linear filter 
iteration adaboost algorithm new weak classifier chosen choosing non linear filter threshold 
filter threshold chosen greedily finding combination performs best re weighted training set 
linear filter non linear filter chosen set oriented second derivative gaussian filters 
training set consists mix images rendered fractal surfaces images shaded ellipses placed randomly image 
examples reflectance changes created images random lines images random ellipse painted image 
samples training set shown 
training set illumination coming right side image 
evaluating test images classifier assume test image lit right 
shows results system gray scale classifier 
results evaluated thinking shading image scene appear entirely gray plastic 
reflectance image appear flat dimensional depth cues placed shading image 
system performs image shown 
shading image uniform appearance effects reflectance changes placed reflectance image 
examples shown computed log input image processing 
input images uncalibrated ordinary photographic similar log transformation 
errors log input image example propagation needed 
smile pillow image enlarged 
figures contain example shading reflectance change respectively 
locally center mouth similar shading example example reflectance change 
original image shading image reflectance image pillow 
combining local evidence color gray scale classifiers generalized belief propagation propagate local evidence 
cause intrinsic image modulate local brightness 
occur results 
propagating evidence classifier works areas image local information ambiguous 
example shown 
compared example shading reflectance change center mouth equally classified label 
corners mouth classified caused reflectance change little ambiguity 
derivatives corner mouth center lie image contour classification 
mechanism needed propagate information corners mouth classification clear areas local evidence ambiguous 
allow areas classification clear disambiguate areas 
order propagate evidence treat derivative node markov random field possible states indicating derivative caused shading caused reflectance change 
setting compatibility functions nodes correctly force nodes contour classification 
model potential functions node mrf corresponds classification derivative 
constrain compatibility functions neighboring nodes xi xj form xi xj 
term controls nodes influence 
derivatives image contour classification close neighboring derivatives contour contour 
depends image point express image information point 
ensure modelled logistic function large response image contours 
learning potential functions function local image features magnitude image difference orientation gradient orientation graph edge 
features reflect heuristic derivatives image contour classification 
difference orientation horizontal graph edge image contour orientation image gradient 
assuming angle horizontal edge image gradient 
vertical edges 
find values maximize probability set training examples parameters 
examples taken set train gray scale classifiers 
probability training samples xi xj indices neighboring nodes mrf normalization constant 
note function 
function relating image features chosen linear function maximizing equation set training images similar train local classifier 
order simplify training process approximate true probability equation assuming constant 
doing leads value magnitude image gradient normalized 
measures break areas weak gradient set regions image gradient magnitude 
combined values learned effectively limits range 
larger values correspond belief derivatives connected edge value negative values signify derivatives original image shading image reflectance image example generated combining color gray scale information propagation 
different value 
values equation correspond expected results derivatives constrained value edge image similar orientation edge mrf connecting nodes 
inferring correct labelling compatibility functions learned label derivative inferred 
local evidence node mrf obtained results color classifier gray scale classifier assuming statistically independent 
necessary color information propagation help areas gray scale classifier misses edge altogether 
cheek patches pillow pink color image missed gray scale classifier caught color classifier 
results shown results adaboost classifier classify gray scale images method suggested friedman obtain probability labels :10.1.1.30.3515
generalized belief propagation algorithm infer best label node mrf ordinary belief propagation performed poorly areas weak local evidence strong compatibility constraints 
results color grayscale information propagation seen 
ripples pillow correctly identified caused shading face correctly identified having painted 
second example shown algorithm correctly identifies change reflectance jersey correctly identifies folds clothing caused shading 
small shading artifacts reflectance image especially presumably caused particular shapes training set 
examples computed non linear filters input adaboost gray scale classifier 
discussion system able multiple cues produce shading reflectance intrinsic images single image 
method able produce satisfying results real images 
computationally intense steps recovering shading reflectance images computing local evidence takes minutes mhz pentium image running generalized belief propagation algorithm 
belief propagation derivative images took minutes run iterations image 
pseudo inverse process took seconds 
primary limitation method lies classifiers 
type surface classifiers incorporate knowledge structure surface appears illuminated 
classifiers operate single spatial scale mrf framework allows integration information multiple scales 
acknowledgments portions completed senior research scientist summer intern mitsubishi electric research labs 
supported fellowship nih ey ntt contract research 
barrow tenenbaum 
recovering intrinsic scene characteristics images 
computer vision systems pages 
academic press 
bell freeman 
learning local evidence shading reflection 
proceedings international conference computer vision 
freeman pasztor :10.1.1.116.8559
learning low level vision 
international journal computer vision 
freund schapire :10.1.1.32.8918
decision theoretic generalization line learning application boosting 
journal computer system sciences 
friedman hastie :10.1.1.30.3515
additive logistic regression statistical view boosting 
annals statistics 
funt drew 
recovering shading color images 
sandini editor eccv second european conference computer vision pages 
springer verlag may 
heeger bergen 
pyramid texture analysis synthesis 
computer graphics proceeding siggraph pages august 
land mccann 
lightness retinex theory 
journal optical society america 
leung malik 
recognizing surfaces dimensional textons 
ieee international conference computer vision 
rubin richards 
color vision image intensities changes material 
biological cybernetics 
sinha adelson 
recovering reflectance world painted polyhedra 
fourth international conference computer vision pages 
ieee 
viola 
boosting image retrieval 
proceedings ieee computer vision pattern recognition volume pages 
weiss 
deriving intrinsic images image sequences 
proceedings international conference computer vision vancouver canada 
ieee 
yedidia freeman weiss 
generalized belief propagation 
advances neural information processing systems pages 
