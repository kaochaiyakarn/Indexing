boxtree hierarchical representation surfaces gill barequet dept computer science tel aviv university tel aviv israel bernard chazelle dept computer science princeton university princeton nj leonidas guibas dept computer science stanford university ca joseph mitchell dept applied mathematics suny stony brook ny tal dept applied mathematics weizmann institute science israel introduce boxtree versatile data structure representing triangulated meshed surfaces 
boxtree hierarchical structure nested boxes supports efficient ray tracing collision detection 
simple robust requires minimal space 
situations storage premium boxtrees effective alternatives octrees bsp trees 
flexible efficient trees nearly simple implement 
keywords collision detection hierarchical data structures ray shooting 

ballard simple data structure representing digitized curves means nested strips 
attempt generalize strip tree structure case surfaces 
known curves quite tame compared surfaces 
example collision detection orders magnitude difficult 
generalizing strip tree boxtree raises number thorny issues 
thing ways go dismissed hand 
guide experimental search plethora candidate heuristics kept additional motivation mind 
explain dobkin kirkpatrick hierarchy compact representation convex polytope supports logarithmic time collision detection 
main limitation method requires convexity 
commonly objects say medical imaging appear convex distance close examination reveals locally structure invalidates dk hierarchy 
initial motivation remedy shortcoming way redesigning dk hierarchy break absence convexity degrade gracefully objects convex 
problem dk hierarchy tries overcome lack robustness convex polyhedron vertices hierarchy inevitably generate extremely thin trouble prone tetrahedra boxtree answer problems 
binary tree leaves bijection facets triangulated meshed surface 
consider piecewise linear surfaces modulo cost representing surface patches boxes say applies general case 
leaf associate box encloses corresponding facet 
similar manner internal node associated box encloses boxes children 
boxtree ray shooting collision detection straightforward starting root tree determine box collides ray obstacle question 
explore children recurse 
search procedure octrees bsp trees trees 
course hierarchical boxing strategy various design factors taken account ffl shape boxes chosen 
consider kinds axis parallel boxes ii arbitrarily oriented rectangular boxes iii triangular cylinders pie slices 
ffl merge rule followed sibling pairs selected 
consider various alternatives depending geometric criteria 
intuitively sibling preference pairs boxes small incident skewed 
ffl pair sibling boxes form enclosing parent box 
consider optimization criteria involving volumes areas angles aspect ratios 
provide empirical data shed light design choices 
take closer look ray shooting 
internal node children determined ray hits box child boxes box box examined 
hit ray trigger recursive call 
follows immediately number nodes traversed coincides precisely number boxes hit ray 
maximum number rays called stabbing number boxtree 
asymptotically worst case cost ray shooting 
obviously keep number low chief goal design strategy 
finely triangulated low curvature surface looks locally planar subdivision important understand case terrains flat surfaces 
subject section 
case rectangular meshed surface particularly interesting lends nice mathematical analysis 
byproduct leads strikingly simple optimal point location structure rectilinear subdivisions 
see section bears direct relevance design boxtrees axis parallel boxes 
section describes detail various heuristics tried converge best possible boxtree design 
section report experimental results provide evidence back choice promising design 
section provides theoretical lower bounds performance boxtrees 
related 
motivated need efficient ray shooting collision detection polyhedral objects dimensions 
dobkin kirkpatrick hierarchy supports logarithmic intersection queries point line plane single preprocessed convex polytope 
general polyhedral surfaces collections triangles theoretical results allow obtain log query time roughly space sublinear query time space 
boxtree closely related spatial access data structures popularly practice necessarily theoretical performance bounds 
strip tree data structure commonly representing polygonal curves hierarchically arranging tree approximated smallest enclosing rectangle 
closely related data structure tree variants include packed tree tree tree optimized trees prism trees cone trees 
tree organization geometric objects tree node associated subset objects keep minimal amount geometric information stored node simply store axis aligned bounding box subset objects 
leaf node contains small constant number primitive objects triangular facets 
root node corresponds full set objects 
children internal node represent partitioning objects associated various heuristics determining goodness partition minimizing total volume coverage total amount overlap total surface areas resulting bounding boxes children 
trees constructed maintained dynamically simple insertion deletion routines 
big advantage boxtree tree opposed spatial partitioning methods bsp trees octrees storage space linear hierarchy partitioning set objects 
fact held compared methods doing collision detection flying object set obstacles method variant trees uses significantly space methods tetrahedral decomposition simple grid hashing trees method having fastest query processing 
boxtrees allow general classes bounding boxes trees 
related prism trees truncated tetrahedra bound objects bounding convex polyhedra small fixed set normal directions utilized generalized bounding box methods 
construction boxtrees contrasted insertion methods top methods 
proceed bottom fashion starting leaves combining pairs neighboring boxes 
packed trees built bottom grouping boxes nearest neighbor criterion 
zachmann term boxtree 
data structure substantially different partitioning object bounding box manner similar trees 
mention related interference detection 
hubbard uses sphere trees arrange bounding spheres hierarchical fashion 
lin system collide incrementally maintaining closest distances pairs convex polyhedra pruning number pairs need checked 

hierarchical boxing plane suppose collection axis parallel rectangles partition unit square 
design boxtree linear size logarithmic stabbing number 
case boxes understood rectangles 
answer question affirmative 
process provide simple linear preprocessing data structure logarithmic time point location rectilinear planar subdivision 
advantage method kirkpatrick point location method utilizes horizontal vertical lines greatly facilitates computations 
denote union rectangle boundaries 
graph nodes maximal horizontal vertical line segments contained edge joining node node endpoint segment say corresponding lies segment corresponding node corresponding edges intersect 
assume endpoint maximal segment lies junction disallow cross junctions perturbing input slightly modifying definition maximal consider segments maximal length contain cross junction 
easy check jv 
graph planar node degree 
bipartite nodes corresponding horizontal segments colored red remaining nodes colored blue 
jej jv gamma shows average node degree 
slightly careful analysis gives result lemma consider bipartite planar graph node degree 
exists independent set blue nodes having degree total number nodes graph 
proof assume blue nodes nr red nodes 
loss generality assume nr 
denote sum degrees blue nodes 
graph planar bipartite gamma edges 
edge incident exactly blue node know equal number edges gamma 
claim blue nodes degree 
assume contrary fewer blue nodes degree blue nodes degree 
consequently node degree total blue degree greater contradicting fact gamma 
follows blue nodes degree 
nodes degree 
theorem rectangular partition contain pairs adjacent rectangles region denotes bounding box covered rectangles furthermore rectangles side collinear side proof bipartite planar graph nodes degree 
previous lemma contain nodes degree color say corresponding vertical sides 
claim node gives rise desired pair rectangles 
clearly node degree get rectangles share common edge 
similarly node degree gives rise situation depicted paired whichever horizontal extent 
node degree corresponding maximal segment ab get cases depicted depending horizontal segments incident ab internal points extend side ab case extend opposite sides ab case 
cases easy check pair claimed property 
example case pair whichever rk horizontal extent 
case rectangle right ab horizontal extent paired left ab horizontal extent 
course pairs rectangles guaranteed theorem need independent sense pairs may involve rectangle 
single rectangle involved pairs case case node degree node degree configuration corresponding node degree corresponding opposite sides know pick subset half pairs pairs share common rectangle 
assured pairs 
note elementary find pairs linear time assuming standard plane graph representation 
build boxtree bottom follows initially associate rectangle distinct leaf tree 
pick maximal set disjoint rectangle pairs provided lemma 
pair create parent node corresponding leaves box associated new node smallest enclosing axis parallel rectangle enclosing pair question 
replace chosen pairs enclosing boxes iterate process recursively finish construction boxtree 
problem scheme boxes overlap technically lemma longer applies 
minor difficulty overlapping occurs nicely controlled fashion overlapped box needs shortened direction horizontal vertical order nonoverlapping 
apply shortening needed order produce new rectangular partition point able apply pairing process 
pairing done respect shortened boxes replace pair enclosing box original shortened boxes 
forms inductive invariant recursion 
fixed fraction root nodes paired iteration produces boxtree logarithmic height 
level prior shortening rectangles overlap point stabbing number twice height 
case note stabbing number defined maximum number nodes corresponding box encloses point 
entire construction takes linear time leads simple optimal point location structure rectilinear subdivisions 
possible prove stronger statement regarding existence mergeable rectangles proof omitted 
theorem collection rectangles contains pair adjacent rectangles set empty meaning edge exactly coincides edge covered single rectangle sharing part sides side bounding box interesting mention point allow arbitrarily oriented subdivisions nice schemes collapse 
prove lower bound section 
theorem exists planar subdivision admits boxtree sublinear stabbing number 

boxtrees mentioned earlier main considerations guide choice heuristic box shape ii merge rule iii design parent box 
describe discuss implementation issues 
recall basic principle underlying construction boxtree 
triangulated meshed surface associate facet leaf non necessarily balanced binary tree internal node children build node box box box box 
discuss various box shapes design implications 

axis parallel boxes choice axis parallel boxes advantage simplicity 
bottom version tree 
test collision detection particularly simple 
similarly merging boxes straightforward 
obvious parent box rule box smallest box encloses box box 
computation requires coordinate comparisons 
initially facet triangulated surface covered minimum area rectangle 
fine case meshed surfaces produce excessive overlap triangulated case 
octree decomposition surface applied preprocessing produce behaved boxes leaves boxtree 
involves refining surface small patches disjoint rectangular projections 
note significantly increase complexity surface violate linear storage feature boxtrees 
increase size tolerable 
shown section arbitrarily bad examples hand crafted 
finding proper merge rule obvious 
clearly pairs adjacent overlapping boxes selected ones 
previous section suggests answer 
surface terrain graph piecewise linear bivariate function vertical projection plane graph 
furthermore boxes enclosing facets project rectangles form configuration similar section 
apply pairing rule devised case 
choice pairings ordering leads naturally boxtree lift node box axis fitting smallest horizontal strip encloses child boxes 
main result previous section implies consider vertical rays stabbing number boxtree logarithmic 
practice surface flat rays tangential 
worst case conceivable ray hits linear number boxes 
necessarily bad 
prove linear lower bound section 
exhibit polyhedral surface boxtree linear stabbing number 
course worst case lower bound 
hope exploiting flexible box shapes reduce stabbing number practice 

arbitrarily oriented boxes keep box shapes free rotate please 
smallest enclosing rectangles turned boxes zero thickness cover facet triangulated surface 
rectangles easily computed constant time 
choose best merged pairs boxes considered surface areas volumes slopes 
words checked combinations minimum area volume enclosing box minimum slope difference children 
area volume criteria important factors 
attempt theoretical justification 
pair boxes vertices treated population covariance matrix computed diagonalized 
recall points translated center mass origin covariance matrix canonical matrix derived quadratic form statistical principal components describe population matrix 
example direction variance population largest corresponds largest eigenvalue 
investigated methods determining enclosing box vertices pair child boxes 
principal component box principal components eigenvectors directions newly built box 
box centered center mass points 

max principal component box principal component corresponds largest eigenvalue direction 
project population vertices input boxes plane normal 
find minimum area enclosing box dimensions 
box determines directions resulting dimensional box 

min principal component box shortest principal component corresponding smallest eigenvalue direction newly built box 
proceed previous method 
plate illustrates construction min principal component box hierarchy 
shows merge pairs boxes parent boxes 
depicts lowest levels hierarchy 

pie slices box associated node triangular pyramid affinely translated minkowski sum triangle segment normal 
call pie slice 
vertices pair pie slices child boxes investigated methods determining enclosing pie slice 
max principal component pie slice principal component direction pie slice 
project population vertices plane perpendicular direction 
find enclosing isosceles triangle minimum area 
minkowski sum triangle principal component determines newly built pie slice 
rook banana sphere combs cad model models correspond data figures 
min principal component pie slice shortest principal component direction pie slice 
proceed 
plate illustrates construction min principle component pie slice hierarchy 
shows merge pairs slices parent slices 
shown lowest levels hierarchy 

experimental results investigated hierarchy methods compared performance axis aligned box box max principal component box min principal component box max principal component pie slice min principal component pie slice 
theoretically area considerations relevant measure correlating query processing time choice heuristic 
due observation thickness enclosing boxes pie slices increase slowly level level 
means overwhelming majority node boxes roughly thickness 
empirically volume considerations relevant 
collision detection applications plane ray boxes cuts happens surface area plays major role assessing effectiveness heuristic 
suppose define random plane cuts randomly uniformly large box omega enclosing entire input surface 
probability measure unique plane density 
invariant motions 
cauchy integral geometry theorem probability random plane cuts convex region proportional surface area 
sv surface area box pie slice bv node boxtree simplicity choose omega br root boxtree 
expected number nodes visited query determined random plane equal prob cuts bv sr sv average complexity query minimized simply choosing boxes minimize total surface area occupy 
figures illustrate average volume surface area level enclosing objects boxes pie slices hierarchy methods investigated 
graphs correspond input models shown 
rook contains vertices facets 
banana contains vertices facets 
sphere contains facets connecting vertices randomly distributed unit sphere 
comb contains vertices facets 
cad model contains vertices facets 
pie slices consistently smaller areas volumes boxes 
axis parallel box method worst lower levels hierarchy upper levels best 
axis parallel boxes tend smaller higher levels hierarchy chose implement hybrid methods 
lower levels implemented methods mentioned higher levels hierarchy implemented axis aligned strategy cases 
graphs plot lowest levels hierarchies 

goal minimize number hierarchy objects collisions attempt detect 
area volume measures indicate number 
counting number collision tests hierarchy elements experimentations show minimum principal component pie slice box pie slice average volume level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice volume surface area rook box pie slice average volume level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice volume surface area banana average volume surface area enclosing objects heuristic method choice 
far better methods 
second best method minimum principal component box heuristic 
methods behave quite similarly 
glance surprising methods rely maximum principal component advantage axis aligned boxing strategy 
close examination reveals reason maximum principal component direction maximum variance distribution vertices 
direction contributes longest possible edge enclosing object 
example consider convex objects vertices facets 
volume directed hierarchies axis aligned box strategy performed collision tests principal component box strategy tests maximum principal component box strategy minimum box strategy maximum principal component pie slice strategy minimum principal component pie slice tests 
table compares number collision tests performed methods best methods component pie slice box axis aligned box 
table shows collision checks interleaved combs shown 
results collision tests pairs concentric table 
pair consists spheres surfaces close 
construction picked order enforce collision tests hierarchy objects 
model resp 
second third pair contains resp 
vertices resp 
facets 
expected input models grow size minimum principal component strategies exhibit superiority axis aligned box strategy 
box pie slice average volume level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice volume surface area sphere box pie slice average volume level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice volume surface area comb box pie slice average volume level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice level hierarchy axis parallel box maximum principal component box minimum principal component box principal components box maximum principal component pie slice minimum principal component pie slice volume surface area cad model average volume surface area enclosing objects cont 
objects facets axis aligned box min 
prin 
comp 
box min 
prin 
comp 
pie slice combs spheres spheres spheres table number collision tests 
lower bounds exhibit surfaces doom idea boxtree 
particular describe convex polytope boundary boxtree linear stabbing number 
disappointing view fact dk hierarchy works wonders convex polytopes 
shall see lower bound construction highly pathological 
empirical evidence confirm bad cases turn practice 
lower bound compared linear lower bound proven stabbing number triangulation polytope argument completely different expected convex polytope logarithmic triangulation stabbing numbers achievable 
trivial linear lower bound stabbing number axis parallel boxtrees 
take boundary cone apex joined vertices regular gamma polygon 
simple exercise show point belong omega gamma leaf level boxes linear lower bound stabbing number 
note apex qualify point case just dk hierarchy stabbing number defined maximum number ray hits respect interior node boxes 
interesting scenario allow convex box shape defining boxtree 
previous lower bound collapses immediately involved argument needed 
construction begins collection segments plane 
second stage lift segments axis take convex hull resulting set 
details construction pk qk ng pk point qk gamma gamma theta gamma 
note segment pk qk tangent parabola easily verify convex hull segments pk qk contains origin 
observe convex hull question triangle pkq qk line passing segment pk qk equation theta gamma origin lies right segment pk qk suffices show lies line pk equivalent showing pk gamma pk replacing appropriate coordinates find gamma theta true 
completing construction full fledged triangulation whichever way complete proof theorem 
lift segments boundary convex solid segment edge convex hull 
omit details 
obviously gamma node boxes contain distinct pairs distinct segments 
box hit vertical line origin proves desired lower bound 
theorem exists convex polytope boundary admits boxtree sublinear stabbing number 
acknowledgments barequet supported israeli ministry science 
chazelle supported part nsf ccr 
mitchell supported part hughes research laboratories boeing computer services nsf ccr ccr 
tal supported israeli ministry science 

ballard strip trees hierarchical representation curves comm 
acm pp 


dobkin kirkpatrick fast detection polyhedral intersection theoret 
comput 
sci pp 


samet spatial data structures quadtrees octrees hierarchical methods addison wesley mass 

fuchs kedem naylor visible surface generation priori tree structures proc 
siggraph computer graphics pp 


guttman trees dynamic index structure spatial searching proc 
acm sigact sigmod conf 
principles database systems pp 


kay kajiya ray tracing complex scenes proc 
siggraph computer graphics pp 


goldsmith salmon automatic creation object hierarchies ray tracing ieee computer graphics applications pp 


glassner ray tracing academic press london 

de berg efficient algorithms ray shooting hidden surface removal ph thesis dept computer science utrecht univ utrecht netherlands 

de berg halperin overmars snoeyink van kreveld efficient ray shooting hidden surface removal proc 
th ann 
acm symp 
computational geometry pp 


pellegrini stabbing ray shooting dimensional space proc 
th ann 
acm symp 
computational geometry pp 


roussopoulos direct spatial search pictorial databases packed trees proc 
acm sigact sigmod conf 
principles database systems pp 


sellis roussopoulos faloutsos tree dynamic index multidimensional objects proc 
th vldb conf pp 


beckmann 
kriegel schneider seeger tree efficient robust access method points rectangles acm sigmod int 
conf 
manag 
data pp 


theodoridis sellis optimization issues tree construction technical report national technical university athens athens greece 

ponce faugeras object centered hierarchical representation objects prism tree computer vision graphics image processing pp 


chen hierarchical probe model technical report dept mathematical sciences purdue univ 


held klosowski mitchell evaluation collision detection methods virtual reality fly throughs proc 
th canadian conf 
computational geometry pp 


held klosowski mitchell speed comparison generalized bounding box hierarchies technical report applied math suny stony brook 

zachmann boxtree enabling real time exact collision detection arbitrary polyhedra proc 
sive pp 


hubbard collision detection interactive graphics applications ieee trans 
visualization computer graphics pp 


cohen lin manocha ponamgi collide interactive exact collision detection system large scaled environments proc 
acm int 
graphics conference pp 


lin efficient collision detection animation robotics ph thesis university california berkeley 

kirkpatrick optimal search planar subdivisions siam computing pp 


van de light scattering small particles dover publications ny 

agarwal aronov suri stabbing triangulations lines proc 
th ann 
acm symp 
computational geometry pp 

