constrained means clustering background knowledge cs cornell edu claire cardie cardie cs cornell edu department computer science cornell university ithaca ny usa seth rogers rogers daimlerchrysler com stefan daimlerchrysler com daimlerchrysler research technology center page mill road palo alto ca usa clustering traditionally viewed unsupervised method data analysis 
cases information problem domain available addition data instances 
demonstrate popular means clustering algorithm pro modi ed information 
experiments arti cial constraints data sets observe improvements clustering accuracy 
apply method real world problem automatically detecting road lanes gps data observe dramatic increases performance 

clustering algorithms generally unsupervised fashion 
set data instances grouped notion similarity 
algorithm access set features describing object information labels instances placed partition 
real application domains case experimenter possesses background knowledge domain data set useful clustering data 
traditional clustering algorithms way take advantage information exist 
interested ways integrate background information clustering algorithms 
previously success modi ed version cobweb fisher uses background information pairs instances constrain cluster placement cardie 
means popular clustering algorithm variety application domains image segmentation girosi information retrieval el 
due widespread believe developing modi ed version background knowledge signi cant clustering community 
major contributions current twofold 
developed means variant incorporate background knowledge form instance level constraints demonstrating approach limited single clustering algorithm 
particular modi cations means algorithm demonstrate performance data sets 
second previous cobweb restricted testing random constraints demonstrate power method applied signi cant real world problem see section 
section provide background means algorithm 
section examines detail constraints propose presents modi ed means algorithm 
describe evaluation methods section 
experimental results sections 
section compares related research section summarizes contributions 

means clustering means clustering macqueen method commonly automatically partition data set groups 
proceeds selecting initial cluster centers iteratively re ning follows 
instance assigned closest cluster center 

cluster center updated mean constituent instances 
algorithm converges change assignment instances clusters 
initialize clusters instances chosen random data set 
data sets composed solely numeric features symbolic features 
numeric features euclidean distance metric symbolic features compute hamming distance 
nal issue choose data sets optimal value known uci data sets realworld problem nding lanes gps data wrapper search locate best value details section 
constrained means clustering proceed discussion modi cations means algorithm 
focus background knowledge expressed set instance level constraints clustering process 
discussion kind constraints describe constrained means clustering algorithm 
constraints context partitioning algorithms constraints useful way express priori knowledge instances grouped 
consequently consider types pairwise constraints link constraints specify instances cluster 
link constraints specify instances placed cluster 
link constraints de ne transitive binary relation instances 
consequently making set constraints kinds take transitive closure constraints 
full set derived constraints clustering algorithm 
general constraints may derived partially labeled data cf 
section link constraints transitive closure performed kinds link link dk know link dk table 
constrained means algorithm cop kmeans data set link constraints con link constraints con 
ck initial cluster centers 

point assign closest cluster violate constraints con con false 
cluster exists fail return fg 

cluster update center averaging points assigned 

iterate convergence 

return fc 
violate constraints data point cluster constraints con link constraints con 
con return true 

con return true 

return false 
background domain data set cf 
section 
constrained algorithm table contains modi ed means algorithm cop kmeans changes bold 
algorithm takes data set set link constraints con set link constraints con 
returns partition instances satis es speci ed constraints 
major modi cation updating cluster assignments ensure speci ed constraints violated 
attempt assign point closest cluster succeed constraint violated 
point assigned cluster cluster point grouped placed continue sorted list clusters nd legally host constraints broken legal cluster empty partition fg returned 
interactive demo algorithm www cs cornell edu home cop kmeans 

evaluation method data sets evaluation include correct answer label data instance 
labels post processing step evaluating performance 
calculate agreement results correct labels rand index rand 
allows measure agreement partitions data set partition viewed collection pairwise decisions size pair points assigns cluster di erent clusters 
number decisions cluster number decisions instances placed di erent clusters partitions 
total agreement calculated rand measure calculate accuracy experiments 
interested testing hypothesis constraint information boost performance unconstrained instances 
consequently sets numbers accuracy entire data set accuracy held test set subset data set composed instances directly transitively ected constraints 
achieved fold crossvalidation generate constraints folds evaluate performance tenth 
enables true measurement improvements learning improvements held test set indicate algorithm able generalize constraint information unconstrained instances 

experimental results arti cial constraints section report experiments known data sets conjunction arti constraints 
graph demonstrates change accuracy constraints available algorithm 
true value known data sets provided input algorithm 
constraints generated follows constraint randomly picked instances data set checked labels available evaluation purposes visible clustering algorithm 
label generated link constraint 
generated link constraint 
conducted trials data set trial fold cross validation run averaged results 
previous cop cobweb constrained partitioning variant cobweb uci data sets soybean mushroom tic tac toe real world data set involved part speech data cardie 
replicated cop cobweb experiments purpose comparison cop kmeans 
cobweb incremental algorithm means batch algorithm 
despite signi cant algorithmic di erences algorithms improved identically supplied amount background information 
number constraints accuracy held test set 
cop kmeans results soybean rst data set interest soybean instances attributes 
classes represented data 
constraints means algorithm achieves accuracy see 
accuracy steadily increases incorporation constraints reaching random constraints 
applied rand index set constraints vs true partition 
rand index views partition set pairwise decisions allowed calculate decisions known set constraints 
data set random constraints achieve average accuracy 
see combining power clustering background information achieves better performance isolation 
clarity numbers appear gure 
held accuracy improves achieving constraints 
represents held improvement baseline constraints 
similarly cop cobweb starts accuracy constraints reaching held accuracy random constraints 
number constraints accuracy held test set 
cop kmeans results mushroom turn mushroom data set instances attributes 
contains classes 
absence constraints means algorithm achieves accuracy 
incorporating random constraints accuracy improves 
case random constraints achieve accuracy clustering occurs 
held accuracy climbs yielding improvement baseline 
cop cobweb starts accuracy constraints held accuracy reaching constraints 
third data set consideration part ofspeech data set cardie 
subset full data set contains instances described attributes 
classes data set 
constraints means algorithm achieves accuracy omitted graph data set cop kmeans cop cobweb similar performance just shown previous gures 
incorporating random constraints accuracy improves 
random constraints attain accuracy 
held accuracy climbs yielding improvement baseline 
likewise cop cop cobweb results reproduced graph form full detail cardie 
subset full mushroom data set match cop cobweb experiments 
cobweb starts accuracy constraints reaching held accuracy constraints 
number constraints accuracy held test set 
cop kmeans results tic tac toe focus tic tac toe data set 
instances data set described attributes 
classes data set 
constraints means algorithm achieves accuracy 
incorporating random constraints accuracy 
set constraints achieves accuracy isolation 
held accuracy reaches achieving increase accuracy 
cop cobweb behaves somewhat worse data set held performance staying roughly mark 
believe data set particularly challenging classi cation board win loss player requires extracting relational information attributes information contained instance level constraints 
contrast cop cobweb experiments data sets symbolic categorical attributes experimented uci data sets numeric continuous attributes 
iris data set instances attributes classes incorporating random constraints yielded increase held accuracy 
accuracy climbed set constraints achieved accuracy 
behavior wine data set instances attributes classes similar toe data set marginal held improvement accuracy usual increased data set larger experimented constraints 
dramatically 
constraint set achieved isolation 
conclude section randomly generated constraints improve clustering accuracy 
expect improvement obtained depends data set consideration 
constraints generalizable full data set improvements observed unconstrained instances 

experimental results gps lane finding experiments constraints experimented randomly generated true data labels 
demonstrate utility constrained clustering real domain knowledge applied cop kmeans problem lane nding gps data 
section report results experiments 
details 
focuses speci cally problem map re nement lane nding 
show unconstrained means algorithm performs compared cop kmeans access additional domain knowledge problem 
section describes transformed domain knowledge useful set instance level constraints 
lane finding explained digital road maps currently exist enable applications generating personalized driving directions 
maps contain coarse information location road 
re ning maps lane level enable host sophisticated applications alerting driver drifts current lane 
approach problem observation drivers tend drive lane boundaries 
time lanes correspond densely traveled regions contrast lane boundaries sparsely traveled 
consequently hypothesized possible collect data location cars drive road cluster data automatically determine individual lanes located 
collected data approximately second drivers gps receivers top vehicle driven 
data point represented features distance road segment perpendicular set road centerline 
evaluation purposes asked drivers indicate lane occupied lane changes 
allowed label data point correct lane 
background knowledge constraints problem automatic lane detection focused domain speci heuristics generating constraints trace contiguity maximum separation 
represent knowledge domain encoded instance level constraints 
trace contiguity means absence lane changes points generated vehicle single pass road segment lane 
maximum separation refers limit far apart points perpendicular centerline lane 
points separated meters generate constraint prevent points placed cluster 
better analyze performance domain modi ed cluster center representation 
usual way compute center cluster average constituent points 
signi cant drawbacks representation 
center lane point halfway extent commonly means points inside lane far ends road appear extremely far cluster center 
second applications clustering results need single point de ne lane 
consequently represented lane cluster line segment parallel centerline 
accurately models conceptualize center lane provides better basis measuring distance point lane cluster center provides useful output applications 
basic means algorithm cop kmeans lane representation problem 
experiment comparison means table presents accuracy results algorithms road segments 
number data points road segment indicated 
data sets centerline parallels road necessarily located middle road 
results represent accuracy held accuracy determining right set constraints part problem arti cially generated true labels 
table 
lane finding performance rand index segment means cop constraints size kmeans average larger uci data sets providing chance test algorithms scaling abilities 
experiments algorithms required select best value number clusters second measure trades cluster cohesiveness simplicity number clusters 
note measure di ers objective function means cop kmeans clustering 
language jain dubes relative criterion internal criterion 
lane nding domain problem selecting particularly challenging due large amount noise gps data 
algorithm performed randomly initialized trials value 
cop kmeans selected correct value road segment means chose correct value method selecting 
shown table cop kmeans consistently outperformed unconstrained means algorithm attaining accuracy data sets precisely calculates average squared distance point assigned cluster center penalizes complexity solution dist cluster goal minimize value 
averaging 
unconstrained version performed worse averaging accuracy 
clusters algorithm produces span multiple lanes cover entire road segment 
lane clusters speci shape greatly elongated usually oriented horizontally respect road centerline 
cluster center line point means seeks compact usually spherical clusters 
consequently poor job locating true lanes data 
example shows output regular means algorithm data set 
horizontal axis distance road meters vertical axis centerline set 
true lanes 
points clusters means represented di erent symbols 
clearly lanes correspond true lanes 
traces lane lane lane lane 
means output data set nal column table measure known generating constraints doing clustering 
shows average accuracy achieved background information 
demonstrates general similarity information means clustering domain speci information constraints perform combining sources information ectively cop kmeans produce excellent results 
analysis errors cop kmeans lane nding data sets showed mistake arose di erent reason 
data set algorithm incorrectly included part trace lane lane 
appears caused noise gps points question signi cantly correct value speci ed 
algorithm selects 
closer lane lane 
data set chose wrong value decided lanes 
road segment contains traces possibly contributed diculty 
cop kmeans errors data set possible provide general characterization causes 
argued means simply poor choice algorithm problem 
marked improvements observed suggest advantage method algorithm choice may importance access constraints domain knowledge 
task poorly performing algorithm boost performance extremely high levels 
essence appears domain knowledge performance sensitive algorithm chosen 
experiment comparison rogers 
previously experimented clustering approach viewed lane nding onedimensional problem 
algorithm centerline set point 
hierarchical agglomerative clustering algorithm terminated closest clusters distance apart represented maximum width lane 
approach quite ective lane merges splits segment lane continues horizontally left right interruptions 
data sets listed table algorithm obtains average accuracy 
data sets taken freeway number lanes constant entirety road segment 
cases lane merges splits dimensional approach inadequate represent extent lane road segment 
currently process obtaining data larger variety roads including segments lane merges splits expect illustrate di erence clearly 

related lot certain varieties constrained clustering done statistical literature gordon 
general focuses exclusively ag maximum merging distance meters speci ed 
clustering algorithms contiguity constraints similar trace contiguity constraint particular accommodation provided constraints dictate separation items 
addition contiguity relation assumed cover data items 
contrasts approach easily handle partial constraint relations cover subset instances 
machine learning literature thompson langley performed experiments providing initial priming concept hierarchy incremental unsupervised clustering systems 
algorithms free modify hierarchy appropriate 
contrast soft constraints approach focuses hard instance level constraints 
additionally incorporated domain knowledge agglomerative algorithm isaac 
dicult classify isaac constraints uniformly hard soft 
nal output partition level hierarchy algorithm decides level hierarchy constraint satis ed 
consequently constraint may may satis ed output 
possible means algorithm evolve empty clusters course iterations 
undesirable produce result fewer clusters 
bradley 
developed method ensure happen imposing minimum size cluster 
ectively act cluster level constraints 
instance level constraints incorporate domain knowledge problem 
example know road lanes separated minimum distance 
incorporated type constraint input clustering algorithm simply discard solutions contain lanes deemed close 
interested exploring constraints integrating closely clustering algorithm 

directions developed general method incorporating background knowledge form constraints means clustering algorithm 
experiments random constraints data sets shown signi cant improvements accuracy 
interestingly results obtained similar obtained cop cobweb 
addition demonstrated background information utilized real domain gps lane nding reported impressive gains accuracy 
see avenues improvements 
constraints clustering means regular means algorithm assignment instances clusters order sensitive 
poor decision early algorithm may encounter instance possible valid cluster link constraint item clusters 
occasionally occurred experiments random data orderings 
ideally algorithm able backtrack rearranging instances validly assigned cluster 
additionally interested extending constrained clustering approach include hierarchical algorithms 
cop kmeans cop cobweb generate partition data take advantage hard instance level constraints 
di erent constraint formulation required hierarchical algorithms 
explore alternative hard constraints 
domain knowledge heuristic exact possible better expressed soft constraint 
pat langley assistance suggestions access gps data sets 
especially weimer advice suggestions progressed 
marie desjardins insightful comments 
el 

clustering method information retrieval technical report ir 
laboratoire informatique avignon france 
bradley bennett demiriz 

constrained means clustering technical report msr tr 
microsoft research redmond wa 
cardie 

case approach knowledge acquisition domain speci sentence analysis 
proceedings eleventh national conference arti cial intelligence pp 

washington dc aaai press mit press 


types clustering relational constraints 
psychometrika 
fisher 

knowledge acquisition incremental conceptual clustering 
machine learning 
gordon 

classi cation presence constraints 
biometrics 
jain dubes 

algorithms clustering data 
prentice hall 


conditional clustering 
biometrics 
macqueen 

methods classi cation analysis multivariate observations 
proceedings fifth symposium math statistics probability pp 

berkeley ca university california press 
girosi 

extensions means algorithm image segmentation pattern memo 
massachusetts institute technology cambridge ma 
rand 

objective criteria evaluation clustering methods 
journal american statistical association 
rogers langley wilson 

mining gps data augment road models 
proceedings fifth international conference knowledge discovery data mining pp 

san diego ca acm press 
rogers langley wilson 

mining gps traces map re nement 
preparation 


integrating declarative knowledge hierarchical clustering tasks 
proceedings international symposium intelligent data analysis pp 

amsterdam netherlands springer verlag 
thompson langley 

concept formation structured domains 
fisher pazzani langley eds concept formation knowledge experience unsupervised learning 
san mateo ca morgan kaufmann 
cardie 

clustering instance level constraints 
proceedings seventeenth international conference machine learning pp 

palo alto ca morgan kaufmann 
