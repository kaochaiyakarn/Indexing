approximate classification earthmover metrics aaron archer chris robert metric space natural distance measure probability distributions earthmover metric 
randomized rounding earthmover metrics devise new approximation algorithms known classification problems metric labeling extension 
result extension problem 
show terminal metric decomposable parameter planar metrics decomposable earthmover linear program extension rounded factor 
second result log approximation metric labeling probabilistic tree embeddings way different log approximation kleinberg tardos 
number nodes number labels 
key element rounding earthmover linear program metric labeling increasing solution cost input graph tree 
rounding method provides alternate proof result stated chekuri earthmover linear program integral input graph tree 
simple constructive rounding techniques contribute understanding earthmover metrics may independent interest 
operations research department cornell university ithaca ny 
email cs cornell edu 
supported fannie john hertz foundation nsf ccr 
university thailand 
partially done author graduate student uc berkeley 
email ku ac th uc berkeley 
supported part fellowship nsf ccr 
email cs berkeley edu ibm almaden research center harry road san jose ca usa 
part done author international computer science institute computer science division berkeley 
email almaden ibm com uc berkeley 
partially done author microsoft research 
email cs berkeley edu computer science department cornell university ithaca ny 
research supported part nsf ccr 
email eva cs cornell edu talwar va tardos metric labeling problem proposed kleinberg tardos kt model classification problems domains ranging categorizing web documents machine vision including image recovery stereo matching problem 
metric labeling models situations wish label nodes graph prior information true labels information pair nodes similar labels 
see kt motivation perspective markov random fields 
formally input node graph nonnegative edge weights set labels assignment costs metric set labels 
goal find labeling minimizes total sum kinds costs 
node incur assignment cost penalizes assigning label prior un likelihood having label 
edge uv incur separation cost penalizes assigning dissimilar labels adjacent nodes 
extension problem special case metric labeling nodes designated terminals labels fixed advance assignment costs zero 
addition metric labels uniform problem reduces multiway cut problem np hard apx hard just terminals 
extension metric labeling np hard 
earthmover metric 
consider linear program lp problems family metrics called earthmover metrics 
metric earthmover metric respect natural extension probability distributions consider earth sitting points suppose moving amount earth point point takes 
denotes set 

probability distributions define dem minimum amount necessary move configuration configuration 
important properties earthmover metric 
metric dem reader guessed name 
second denotes probability distribution mass concentrated point xi xl dem dem extension distance dem solving transportation problem 
optimal value linear program lp flow variable zij represents amount earth moved label label going configuration configuration minimize subject zij zij xi zij yj zij note special case metric uniform earthmover distance dem proportional distance distributions 
original motivations better understand relationship metrics earthmover metrics 
earthmover relaxation 
classification problems mentioned require map node label natural relaxation allow nodes mapped earthmover metric corresponds label metric 
relaxation expressed lp 
write lp terms dem shall think 
configuration assigned node denoted xv represents vector xvi components actual variables lp 
suppresses flow variables necessary representing dem edge definition 
earthmover lp earthmover linear program metric labeling follows 
min 
xvi xvi uv xvi xu xv adding integrality constraints variables yields exact formulation 
extension problem identify labels terminals fixing xii assignment costs zero term objective function zero 
lp relaxation sense extension 
preliminaries related definition 
decomposable metric metric space called decomposable randomized algorithm partitions clusters subsets xl 
xl diameter 

probability fall different clusters say graph family graphs decomposable shortest path metric graph decomposable 
example easy see line metric decomposable 
wellknown see ap lr ls graph vertices log decomposable graphs expanders bound best possible 
klein plotkin rao kpr showed planar graphs decomposable generally graphs excluding fixed minor size decomposable 
talwar ft improved bound 
charikar ccg showed metrics max decomposable bound tight 
extension problem posed kar gave lp relaxation call semi metric lp relaxation 
showed linear program integral terminal metric tree larger class bipartite graphs contains trees tree metric contain steiner nodes 
karloff rabani ckr gave log approximation extension lp relaxation 
special case input graphs planar gave approximation algorithm 
fact algorithm extends decomposable input graphs giving approximation 
improved general result log log log 
hand semi metric relaxation known log integrality gap ckr 
note lee stronger definition decomposability padded decomposition requires distance vertex cluster boundary distributed 
results require condition 
naor ln independently obtained extension result similar relaxation 
semi metric lp relaxation allows nodes mapped arbitrary metric containing terminal metric 
earthmover metric specific metric type containing terminal metric earthmover lp relaxation integrality gap larger semi metric relaxation 
furthermore approximation algorithms 
unknown worst case integrality gaps relaxations different 
interestingly known integrality gap earthmover lp relaxation constant metric labeling 
metric labeling problem studied time computer vision community 
polynomial time algorithm line metrics constant factor approximation uniform metrics boykov 
gupta tardos gt gave constant factor approximation truncated line metrics 
kleinberg tardos kt gave approximation algorithm case uniform metric labels combined bartal probabilistic tree embeddings bar obtain log log log approximation general metrics 
frt improved bartal result leading improved bound log :10.1.1.11.2667
earthmover lp proposed independently charikar cha chekuri 
successful lp give matching improved algorithms certain classes distance functions convex truncated linear previously addressed flow techniques local search gt ig 
worth noting lp relaxation directly models general metric labeling problem 
previously lp relaxations known various simple classes metrics 
interestingly history multiway cut problem parallels extension ways 
dahlhaus introduced problem showed apx hard gave approximation combinatorial isolation heuristic 
known simple randomized algorithm semi metric lp relaxation matches factor integrality gap lp 
ckr strengthened lp nodes may mapped point containing metric induced distances mapped nodes form semi metric name 
relaxation property 
embedding nodes obtain approximation 
karger kks improved results bound approaching 
lp algorithms exactly earthmover lp metric labels uniform 
plausible earthmover lp similarly improve approximation bound general case extension metric labeling problems 
believe results progress direction 
contributions 
devise approximation algorithms rounding earthmover lp 
techniques improve understanding earthmover metrics may independent interest 
extension show section terminal metric decomposable simple rounding algorithm earthmover lp approximates lp solution integral solution factor 
previously approximation ratio known hold stringent requirement input graph decomposable 
technically give randomized rounding procedure expected separation cost vertices times larger earthmover distance simply contribution lp objective 
case significant improvement previous known approximations 
suppose large number terminals lie low dimensional normed space 
cases know depends dimension euclidean space 
rounding algorithm give approximation depends dimension depend number terminals size 
metric labeling give section algorithm achieves log approximation 
cases expect number objects labeled far exceed number labels approximation guarantee worse log currently known 
applications instance recognizing position human body image see fh objects handful rigid moving parts part needs labeled tuple representing position rotation scale 
new algorithm metric labeling uses earthmover lp follows 
lp solution defines model fh uses different distance function edge identical model 
earthmover metric probabilistically approximate tree round 
crux rounding method incurs loss tree 
tree approximations contrasts kt approximates label metric tree uses specialized lp trees 
rounding method proves earthmover lp integrality gap input graph tree 
phenomenon previously mentioned chekuri proof appears upcoming journal version proof different 
interestingly implies extension tree graphs distinction integrality ratio earthmover lp semi metric relaxations 
integral special case result integrality ratio star leaves terminals 
extension algorithm decomposable terminal metrics section show metric labels terminals decomposable solution extension earthmover lp relaxation rounded randomized algorithm integral solution expected cost times lp cost 
remarked point metric log decomposable get log approximation extension problem general 
better decomposable metrics course approximation ratio better 
set terminals metric vertex xu xu xu 
distribution terminals associated solution earthmover lp dem induced earthmover metric 
vertex au mini dem xu distance closest terminal 
high level rounding algorithm consists steps bringing closer integral solution 

break groups vs au containing vertices approximately value au 
round group separately 

truncate distribution xu concentrated terminals close 
decompose terminal metric clusters diameter choose representative terminal cluster 
fact slightly better see discussion section 

project distribution xu representatives mass concentrated representative terminals close 
round vertex vs representative terminals rounding algorithm kleinberg tardos kt metric labeling uniform metrics 
intuitively step works vertices vs metric representatives looks approximately uniform 
formal rounding algorithm 
assume loss generality smallest distance terminals denote largest distance 
decomp decomposition algorithm implied definition 


log pick rs uniformly random 
grouping vs rs au rs 
truncation pick uniformly random 
zero dem xu rescale remaining sum 
resulting vector 
tl clusters output decomp 
pick arbitrary terminal il cluster tl cluster representative 
projection vs project distributions xu clusters representatives tl ui ui il rounding apply vs rounding algorithm kt metric labeling uniform metric 
analysis 
final assignment output algorithm vertex assigned terminal 
edge uv refer dem dem xu xv cost uv associated distribution vectors implicit context 
terminals dem convenient notation 
analysis edge edge 
show edge uv expected value times dem xu xv 
notice initial step grouping breaks problem subproblems solve separately 
consequently edge edge endpoints group vs intergroup edge goes different groups 
looking edges show subsequent step algorithm increase expected cost edge 
intergroup edges easier handled 
truncation 
truncation step pick uniformly random truncate concentrated terminals distance rescale restore sum 
show need rescale 
lemma 
vertex terminal ui 
proof 
terminal closest consider iteration vs grouping phase ensures dem rs 
definition dem dem 
dem dem 
triangle inequality dem dem dem 
thirds probability mass xu concentrated terminals distance truncation removes third probability mass scaling requires multiplication factor larger 
show transformation increase cost edge uv 
lemma 
edge uv dem dem xu xv 
proof 
recall dem xu xv ij zij flow variables transform distribution xu xv 
show modify zij slightly valid flow transform expected cost new flow large 
clearly earthmover distance dem cost best flow larger 
attempts optimize constants 
define new flow ij need set terminology 
tu tv sets terminals distance respectively 
pu tu qu pu define pv qv similarly 
loss generality assume pu pv 
original flow variables naturally fall categories fpp example flow goes tu tv 
notice new flow ij transforms nonzero flow going tu tv 
create new flow scale kind flow fpp factor pu 
set flows zero 
scale flows pu re route greedily terminals tv 
easy verify total flow leaving tu total flow leaving tu total flow entering tv conservation flow total flow entering tv 
furthermore total flow leaving tu ui pu pv step done total flow entering tv get feasible flow 
vi notice lemma pu pv scaling increases cost small factor 
flows rerouted terminals away 
flows contribute increase cost cost needs bounded 
show isn flow 
consider flow variable zij 
flow note assume pu pv case exactly events dem dem happen 
words fall dem dem 
probability happening clearly dem dem 
triangle inequality dem dem dem dem 
flow zij falls bad categories probability min dem dem 
hand flow rerouted goes tu tv distributed 
distance traveled flow dem dem dem dem dem 
expected cost rerouted flow ignoring scaling zij pr zij rerouted cost rerouting zij min dem dem dem zij dem zij dem dem dem dem dem dem second step fact exactly dem xu xv 
scaling factor larger lemma follows 
clustering projection 
intuitively clustering projection steps convert metric host space approximately uniform metric 
metric earthmover distance metric proceed kleinberg tardos rounding 
show clustering terminals projection just 
precisely relate distance earthmover distance dem 
lemma 
vs dem proof 
flow values ij dem ij values 
terminals separated clustering step 
em earthmover distance 
em ij ij dem 
equality holds uniform metric earthmover metric 
inequality holds necessarily opti mal way route flow take flow induced ij flow cluster representa tive equals total flow ij routed nodes cluster nodes second cluster case flow originating ij associated cost 
inequality due requirements definition 
note clusters diameter distribution xu terminal concentrated terminals distance kleinberg tardos rounding 
go rounding algorithm kleinberg tardos kt rounding linear program metric labeling terminal metric uniform 
set terminals 
set vertices distribution vectors algorithm assigns vertex terminal 
algorithm follows 
unassigned vertex pick terminal uniformly random pick value uniformly random 
assign ui difficult show algorithm terminates expected polynomial time 
kleinberg tardos show algorithm nice properties 
repeat proof completeness 
lemma 
algorithm kt properties vertex probability gets assigned exactly ui pair vertices probability get assigned different terminals 
proof 
iteration conditioned unassigned probability gets assigned ex property follows 
ui follows vertex probability assigned terminal iteration 
look pair vertices probability exactly assigned terminal particular iteration exactly ui vi 
probability assigned different terminals upper bounded pr exactly assigned iteration pr assigned iteration plugging values probabilities second property follows 
summary 
kleinberg tardos algorithm assigns vertex terminal nonzero ui truncation step ensures vertex assigned terminal distance vertices assigned different terminals distance bounded dem dem dem dem dem 
lemma probability assigned different terminals 
lemmas expected value dem min dem dem dem 
shown 
lemma 
vs dem xu xv 
intergroup edges 
argue intergroup edges 
lemma 
edge uv contribution expected cost uv due intergroup cutting dem xu xv 
proof 
argued vertex vs assigned terminal closer uv edge goes vs vs dem dem dem 
dem dem follows dem note uv intergroup edge au rs av happens probability min av au min dem 
expected contribution length edge uv due intergroup cutting dem 
note proof lemma property earthmover distance grouping applied semi metric relaxation 
leads simpler proof ckr result decomposable graphs 
omit details 
combining lemmas get theorem 
algorithm described gives approximation algorithm extension problem terminal metric decomposable 
note random steps algorithm easily derandomized standard techniques leading deterministic algorithm performance guarantee 
omit details extended 
discussion 
recall case log algorithm log worstcase bound 
clustering projection steps fact done scale larger analysis edges goes 
terminal metric better decomposition large scale edges expectation 
bound distance vertex assigned terminal goes increasing expected cost intergroup edges 
take advantage pick random log log decomposition scale 
expectation shown worst case log log log decomposition intergroup edges fine expectation 
improve result general graphs log log log log matching result 
shown techniques ckr imply approximation problem terminal metric satisfies 
set points radius metric 
metric decomposition results follow 
metrics larger dimensional euclidean spaces decompositions results stronger implied previous techniques 
metric labeling tree rounding section earthmover lp obtain log approximation metric labeling problem 
basic idea algorithm lp define embedding nodes earthmover metric space defined label metric 
approximate metric space dem tree round coordinated way tree 
crux method round tree preserving separation costs tree edges assignment costs 
start showing 
coordinated rounding 
distributions labels show randomly round labels way obeys specified distributions coordinated expected distance resulting labels dem 
define breakpoint bi xi 
identify label interval ii bi bi 
generate uniform random variable ux round label interval ux falls 
flow variables zij determine round subdivide ii intervals iij bij bi bij bi zij 
ux lands subinterval iij round ux iij ii generate random variable uy function ux propagating partition rounding 
break intervals subintervals ij zij flow values analogously ux iij set uy ij ux bij 
uy defined lands spot interval ij ux interval iij 
process leads easily proposition 
proposition 
rounding scheme rounded labels probabilities matching distributions expected distance labels dem 
uy distributed uniformly 
rounding technique easily extends trees node assigned distribution labels 
fix arbitrary root node generate uniform random variable ur 
round ur procedure described propagate rounding children generating associated random rounding variable uc child way propagate rounding way tree 
corollary 
input graph tree earthmover lp integrality gap 
note metric labeling problem polynomial time solvable trees dynamic programming 
corollary provides alternative approach 
importantly rounding technique leads new approach general metric labeling problem 
algorithm 
probabilistic tree approximation metric distortion probability distribution collection trees dt cd dt 
general trees may contain steiner points original metric space 
algorithm uses results 
theorem 
frt point metric probabilistic tree approximation distortion log sample polynomial time 
theorem 
gupta gup tree set required vertices exists tree dt dt dt 
algorithm 
solve earthmover lp 

define metric dlp dlp dem xu xv 
theorems generate random tree spanning just probabilistically approximates dlp dilation log 

compute earthmover distances edge obtain flow variables 
select node arbitrarily root randomly round propagate results rest tree 
denote assignment separation costs solution alp slp denote corresponding costs optimal lp solution 
theorem 
algorithm achieves alp log slp provides log approximation metric labeling 
proof 
lp solution provides lower bound cost op proposition nodes tree rounded labels distribution specified lp assignment cost preserved expectation 
separation cost preserved expectation tree edge triangle inequality dt expectation randomized rounding 
dt log dem xu xv summing edges yields desired bound 
note algorithm easily derandomized 
omit details 
acknowledgment eran halperin satish rao helpful discussions 
ap awerbuch peleg 
sparse partitions 
st annual ieee symposium foundations computer science pages 
bar bartal 
approximating arbitrary metrics tree metrics 
th annual acm symposium theory computing pages 
acm 
boykov veksler zabih 
markov random fields efficient approximations 
th ieee international conference computer vision pages 
boykov veksler zabih 
fast approximate energy minimization graph cuts 
ieee transactions pattern analysis machine intelligence nov 
ccg charikar chekuri goel guha plotkin 
approximating finite metric small number tree metrics 
th annual symposium foundations computer science pages 
cha charikar 
personal communication january 
chekuri khanna naor 
approximation algorithms metric labeling problem new linear programming formulation 
th annual acm siam symposium discrete algorithms pages 
ckr karloff rabani 
improved approximation algorithm multiway cut 
jcss 
ckr karloff rabani 
approximation algorithms extension problem 
th annual acm siam symposium discrete algorithms 
dahlhaus johnson papadimitriou seymour yannakakis 
complexity multiterminal cuts 
siam comput 
fh felzenszwalb huttenlocher 
efficient matching pictorial structures 
ieee computer vision pattern recognition conference pages 
rao talwar 
improved approximation algorithm extension problem 
th annual acm siam symposium discrete algorithms pages 
frt rao talwar 
tight bound approximating arbitrary metrics tree metrics 
th annual acm symposium theory computing pages 
ft talwar 
improved decompositions graphs forbidden minors 
th international workshop approximation algorithms combinatorial optimization pages 
gt gupta 
tardos 
constant factor ap proximation algorithm class classification algorithms 
nd annual acm symposium theory computing pages 
gup gupta 
steiner points tree metrics don really help 
th annual acm discrete algorithms pages 
ig ishikawa geiger 
segmentation grouping junctions 
ieee conference computer vision pattern recognition 
kar 
minimum extensions graph metrics 
european journal combinatorics 
kks karger klein stein thorup young 
rounding algorithms geometric embedding minimum multiway cut 
st annual acm symposium theory computing pages 
kpr klein plotkin rao 
excluded minors network decomposition multicommodity flow 
th annual acm symposium theory computing pages may 
kt kleinberg 
tardos 
approximation algorithms classification problems pairwise relationships metric labeling markov random fields 
journal association computing machinery 
ln lee naor 
metric decomposition smooth measures clustering 
submitted 
lr leighton rao 
multicommodity maxflow min cut theorems designing approximation algorithms 
jacm 
ls linial saks 
low diameter graph decompositions 
combinatorica 
vazirani 
approximation algorithms 
springer verlag new york 
