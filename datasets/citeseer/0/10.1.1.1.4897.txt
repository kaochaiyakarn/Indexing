fusing heterogeneous alert stream scenarios oliver massachusetts institute technology lincoln laboratory th september robert cunningham massachusetts institute technology lincoln laboratory algorithm fusing alerts produced multiple heterogeneous intrusion detection systems 
algorithm runs realtime combining alerts scenarios composed sequence alerts produced single actor organization 
software capable discovering scenarios stealthy attack methods forged ip addresses long attack latencies employed 
algorithm generates scenarios estimating probability new alert belongs scenario 
alerts added candidate scenario 
alternative probability estimation techniques compared algorithm builds scenarios set rules 
probability estimate approaches training data learn appropriate probability measures 
algorithm determine scenario membership new alert time proportional number candidate scenarios 
keywords security fusion scenarios correlation intrusion detection security conscious organizations protect networks multiple intrusion detection systems idss 
improve attack detection rates increases load intrusion detection analysts components monitored false alarm rates tend rise 
fusion systems attempt alleviate problems collecting alerts produced systems network 
collected alerts managed single location 
propose realtime algorithm combine alerts produced multiple intrusion detection systems scenarios 
scenario intended indicate sequence actions performed single actor organization 
important realize scenario constructed algorithm necessarily indicate malicious behavior 
purpose scenarios simply group alerts share common cause 
resulting scenarios give network defenders complete picture traffic network 
additionally assign false alarm probabilities scenarios individual alerts decrease false positive rates increasing sensitivity underlying sensors 
time new alert produced algorithm compare scenarios constructed 
existing scenario probability new alert belongs scenario calculated 
compare techniques producing required probability estimates 
approaches training data learn appropriate probability measures 
techniques compared na algorithm builds scenarios set hand coded rules 
algorithm runs time proportional number existing scenarios capable finding scenarios intruder stealthy attack methods forged source ip addresses long latencies attack components 
sponsored department defense air force contract 
opinions interpretations recommendations authors necessarily endorsed united states air force 
edward points little research done correlation fusion 
area focused collecting alerts multiple detectors single location displayed queried correlated 
grids system developed university california davis uses rule sets combine alerts network data graph structure capable discovering large scale coordinated attacks 
clifton data mining techniques discover common sequences alerts 
alert sequences discretion human operators filtered longer displayed analyst 
discovered sequences intended scenarios simply sequences appear frequently 
valdes skinner studied correlation scenario building probabilistic detectors emerald system 
alert meta alert scenario system represented vector attributes 
similarity measure applied vectors exceed threshold joined scenario 
approach similar proposed valdes skinner different scenario construction algorithm optimize probability estimates system forms scenarios human expert 
furthermore tested system output commercial proprietary intrusion detection systems 
fusion approach fusion system develops scenarios alerts received component intrusion detection systems 
task instant determine scenario membership new alert alerts seen 
flexible way consider possible ways combining alerts scenarios time new alert generated 
unfortunately quickly computationally intractable 
see consider simpler problem deciding existing alerts belong scenario new alert 
shows possible scenario assignments new alert existing alerts 
note possibilities 
shows possible scenario assignments new alert existing alerts 
note add alert scenarios enumerated 
additionally grouped scenarios removed 
addition alert doubles number possible scenario constructions new alert may grouped existing alerts ways 
task simply construct scenario place single new alert construct scenarios alerts complexity problem super exponential 
clearly possible consider arrangements realtime 
solution atom model 
time receive new alert sensor compare scenarios constructed far 
existing scenario calculate probability new alert belongs scenario 
new alert assigned scenario produced highest probability score 
scores threshold new alert joined scenario starts new scenario 
alert joined scenario consider changing assignment 
scenario divisible atom may absorb alerts grow split 
may cause errors assembled scenarios simplification reduces computational complexity number alerts linear number candidate scenarios 
despite simplification system performs see section 
informal testing indicates system able construct scenarios alerts seconds 
architecture fusion system consists distinct components idss produce alerts database alerts stored fusion software 
idss currently fusion system internet security system realsecure network sensor mit lincoln laboratory battlefield intrusion detection system bids host system capable finding known novel attacks 
alerts produced idss converted standard form written sql database 
fusion system reads database determines scenario membership new alerts saves results back database 
research possible scenario assignments new alert existing alerts 
possible scenario assignments new alert existing alerts far focused sensors mentioned algorithm sensor send output database 
communication component idss database currently relies custom bridging software 
vendors support internet engineering task force intrusion detection working group emerging intrusion detection message exchange format consider supporting communication mechanism 
definitions decimal binary address address mask table value calculation addresses realsecure version capable identifying different attack types 
attackers multiple techniques accomplish result alerts assigned categories discovery scan escalation denial service dos stealth 
alerts discovery category indicative network discovery activity ip sweeps dns zone transfers 
alerts scan category indicate port scanning activity 
escalation category consists privilege escalation type attacks password guessing buffer overflows 
dos bucket consists attacks prevent access services syn floods smurf attacks 
stealth bucket contains alerts indicate attempts conceal identity forged ip addresses 
attacker may able launch attacks different legitimate ip addresses attacker may access machines single subnet may running dhcp useful able quantify proximity ip addresses 
defined quantity denote 
maximum number bits ipv subnet mask account addresses 
ip addresses identical way addresses subnet see table 
due prevalence classless inter domain routing cidr allow addresses different class subnets value greater long high order bits 
example class addresses differ second octet class network 
organization owned networks treat large subnet cidr 
give addresses value bits addresses 
probability assignment far specified scenarios formed measure probability event belongs scenario 
sections describe different approaches probability estimation problem 
section describes na approach section describes heuristic method section describes application traditional data mining techniques problem 
heuristic data mining approaches training data optimize probability estimates 
process data collected prepared described section 
data sources set network alerts corresponding scenarios data train free parameters probability estimate algorithms reproduce scenarios data set 
unfortunately authors know dataset contains realistic network traffic attack scenarios ground truth known dataset contain scenarios parameter estimation 
fusion system match performance human expert valuable contribution 
find scenarios real network traffic hand data optimization 
year def con conference participants play capture flag 
types participants game run servers try break 
group gets points running services host vulnerable group gets points server compromise 
rules stipulate host considered compromised attacker put file containing name root file system 
additional points awarded style 
excellent data source contains large amount attacks scenarios 
unusual data source 
volume frequency attacks far greater experienced operational networks 
additionally hosts participating game subnet 
ordinarily large volume attacks small time window emanating single subnet indicative coordinated attack single organization 
case type activity similar see cyber terrorism attack 
example israeli web sites target coordinated attacks palestinian groups 
type traffic experienced sites may similar traffic data set 
believe different tactical situations produce different alert stream characteristics 
example cyber war produce different alert profile normal traffic 
fusion approach flexible environments 
case optimal parameters change tactical situation easily swapped configuration file 
far analyzed data def con hacker conference capture flag game 
investigating data sources contain typical traffic patterns 
results data sources help determine robust approach different tactical situations 
half hours tcpdump data def con conference replayed network lincoln laboratory tool 
traffic iss realsecure network sensor box configuration 
produced alerts 
alerts mapped author scenario alert occurrences selected scenarios time seconds alert occurrence times def con data 
axis time seconds data collection began 
horizontal line depicts single scenario 
endpoints line indicate scenario began ended 
black circles indicate alert occurred 
depicted scenarios containing largest number alerts 
scenarios 
largest scenario contained alerts 
scenarios contained single alert 
average number alerts scenario 
scenarios contained alerts source address 
remaining scenarios contained alerts single source ip address 
length time covered alerts scenario varied widely see 
consecutive alerts scenario separated hundreds alerts belonging scenarios making scenario reconstruction difficult 
hand tagging scenarios idiosyncrasies iss realsecure version discovered 
particular noticed source destination addresses reported realsecure reverse expected 
expect attacker address listed source victim address listed destination 
majority realsecure alerts follow pattern 
classification features designed account idiosyncrasies discussed section 
tagging scenarios provides examples data cause probability estimate algorithms produce join scenario decision high probability alert belongs scenario 
optimization requires negative don join scenario decision training examples positive ones 
order produce negative training examples program written reproduces decisions computer need set data 
program takes file contains alerts order appears realsecure version reports windows access error dns length overflow alerts backwards dns udp port scan alerts reported backward 
dns udp port scan alerts appear reported backward echo effect 
reported source destination address backward shortly alert reported correctly 
occurrence alerts followed source destination reversed 
produced 
alert tagged number indicating scenario membership 
program loops file writes line output decision fusion system 
output contains correct decision statistics decision time difference alerts value ip addresses question 
pseudo code algorithm included alerts file read alert file scenario memory id current scenario matches id new alert positive training example negative training example generate write features add new alert correct scenario running algorithm alerts dataset produced training examples 
training data generated separated training validation test data sets 
validation test data sets ensure learning function generalize data see discussion overfitting 
order ensure accurate results proportion join don join examples equal train test validation data files 
script written randomly split data files training evaluation testing preserving prior probabilities 
na technique obvious way group alerts source ip address 
na approach assumes attacks belonging single scenario share common source address 
scenarios formed comparing new alert alert scenario 
new alert added scenario source ip addresses identical technique tried due tendency realsecure reverse source destination ip addresses perform 
compensate applied simple heuristics correct alerts source destination address reversed 
deal alerts source destination addresses reversed simply replaced source address destination address comparing alerts 
alerts reversed 
usually occurs echo effect alert reported twice source destination correct source destination exactly reversed 
handled alerts producing join decision new alert alert scenario type source destination addresses exactly opposite 
results approach section 
heuristic technique technique discussed section extends described earlier 
attempts model intuitions form scenarios 
believe attacks follow logical progression 
certain sequences alerts types common 
time alerts predictor scenario membership 
alert latencies vary alert type 
range source ip addresses group alerts predictor scenario membership 
range addresses see dependent alert type attacks lend ip spoofing 
approximate intuitions bigram model 
scenario new alert probability assigned considering alert scenario new alert 
scenario contains alerts get new alert compare 
probability alerts buckets respectively belong scenario product quantities accounts strength link alerts accounts time lag alerts accounts source ip addresses alerts 
quantities product see 
decision surface single transition type 
height curve probability alerts time span value belong scenario 
black plane threshold new alert join scenario start new scenario 
quantity probability alert bucket followed alert bucket 
example probability scan followed escalation higher probability escalation followed dos attacker needs scan system prior gaining access attacker gained unauthorized access system deny services network 
second quantity accounts time alerts 
sigmoid function defined shape function determined values different transition type transition type defined buckets containing alerts 
sigmoid representing time dos attacks fall quickly expect alerts occur rapid succession sigmoid representing time network discovery privilege escalation fall slowly attacker launch attack immediately gathering information 
final quantity accounts ip address range alerts 
maximum number bits ipv subnet mask account ip addresses defined section 
function 
exact function depends buckets 
transition type values picked 
value values determined linear interpolation 
example source addresses spoofed dos attack expect high value values dos 
relatively compensate idiosyncrasies realsecure heuristics na approach applied calculated 
calculated modified value 
algorithm calculate new new alert alert reversed new reversed calc new destination source reversed reversed new calc new source destination reversed new reversed source new destination destination new source calc new source source transition type model parameters described 
bucket types transition types 
total parameters 
optimize parameters converted fusion code training file discussed section compiled shared library 
call fusion code passing matrix parameters 
fusion code reads line training file parameters passed produces probability example read file produce join decision 
training file encodes right answer calculate squared error example correct probability example produced don join decision 
examples training file scored sum squared errors returned 
constrained optimization routine matlab find parameter values minimize sum squared errors 
iteration evaluation data set scored sum squared errors data set tracked 
allow training early overfitting issue 
data mining techniques assigned probabilities data mining techniques 
data prepared described section passed standard machine learning algorithm 
machine learning algorithms allowed additional features may provide better predictive power 
heuristic technique features indicate bucket membership new alert bucket membership alert scenario time new alert alert scenario value new alert compared alert scenario 
addition features expand model simple bi gram model features indicate bucket membership alerts scenario 
attackers tools attack types times features included indicate previous alerts scenario exact type current alert alert scenario exact type new alert 
attackers focus efforts single host include feature indicates destination address new alert target alerts scenario 
attack scenario may contain components spoofed source ip addresses components attack may attackers real source ip 
feature value maximum value source ip new alert compared source ip addresses alerts scenario included 
machine compromised source attacks 
feature value maximum value source ip new alert compared destination ips alerts scenario included 
realsecure reports source destination ip addresses reversed features account included 
indicates new alert backward 
indicates alert scenario backward 
features vary indicates alert type reported backward realsecure indicates alert type reported backward 
realsecure alerts suffer echo effect alert sent twice source destination ip addresses alerts exactly switched included feature indicates source ip new alert matches destination ip alert scenario destination ip new alert matches source ip alert scenario 
experimental results experiments conducted def con data described section 
test data set containing patterns train heuristic data mining algorithms 
evaluation data set containing patterns monitor fitting choose algorithm parameters 
test data set containing patterns purpose final algorithm evaluation 
results reflect performance data set 
na technique target predicted don join join totals don join join totals target predicted don join join totals don join join table confusion matrices na approach test data set patterns produced join decision incorrectly produced don join decision patterns produced don join decision incorrectly produced join decision 
performance na approach table 
simple approach remarkably data set making errors patterns 
performance adequate 
think important improve performance reasons 
data set contains attempts stealth 
capture flag game rewards speed points awarded stealth 
expect realistic data sets amenable simple technique 
second percent attackers missed simple technique precisely individuals need worry 
attacker discovered na algorithm attacker probably damage anyway 
simple technique help group script attacks results significant data reduction prefer approach discover sophisticated attacks 
heuristic technique parameters heuristic approach optimized data described section 
monitoring performance evaluation data set revealed overfitting problem probably target predicted don join join totals don join join totals target predicted don join join totals don join join table confusion matrices heuristic approach test data set 
algorithm tries match human decision 
example test examples produced join decision 
algorithm correctly produced join decision times time 
complex classifier 
optimizing parameters needed heuristic approach scored test data set contained patterns 
results depicted table 
error rates algorithm slightly higher error rates na approach features na algorithm classifier 
problem constrained possible set decision surfaces classifier produce decision surface equivalent na approach possible 
additional features different set possible decision surfaces need considered classifier order improve performance useful 
immediately clear features useful features combined considering replace technique powerful data mining algorithms discussed section 
target predicted don join join totals don join join totals target predicted don join join totals don join join table confusion matrices decision tree test data set 
decision tree tries match human decision 
example examples produced don join decision 
rbf network produced correct decision time 
data mining techniques radial basis function networks multi layer perceptrons decision trees applied training data features described section 
data mining package experiments 
decision tree non terminal nodes produced best performance 
confusion matrices classifier appear table 
tree trained cart algorithm errors produced training set 
nodes ordered effect error rate training data pruned removing nodes affect error rate 
validation data set choose optimal number nodes 
error rate decision tree extremely low 
performs significantly better approaches considered catching percent attack scenario missed na approach 
percent attackers probably ones concerned performance increase significant 
suspect improved performance largely result additional features available algorithm 
features tree splitting criteria non terminal nodes indicate features useful 
listed features indicate bucket type new alerts scenario splitting criteria 
features indicated new alert scan new alert belonged stealth bucket alert scenario belonged stealth bucket second alert escalation alert 
measure proved useful 
recall section number indicates similarity ip addresses 
compare new alert alert scenario produce values ways 
compare source new alert source alert destination new alert source alert source new alert destination alert destinations alerts may compared 
features decision tree 
additionally feature value maximum value source address new alert compared source address alert scenario 
feature indicates destination new alert destination previous alerts 
time new alert alert scenario splitting criteria 
feature indicates alert type new alert feature indicates alert scenario type new alert 
feature indicates new alert source destination addresses switched 
feature varies indicates type alert reported reversed indicates alert addresses reversed half time 
system benefits system described provides great benefits security analyst 
value system clear began examine def con data 
looking alerts data set initially overwhelming 
extremely difficult happening network alerts represented activity concern somebody trying protect network 
took author fifteen hours hand tag data scenarios 
done scenarios consider 
scenarios conveyed information original alert stream 
quick look scenarios sufficient infer attackers intentions tools 
example scenarios consisted scans port followed long string specific exploits 
individuals clearly running scripts tried exploit knew 
exploits attempted host identical 
network administrator determined hosts vulnerable exploits quickly determine entire scenario containing alerts security risk 
allow preemptively check security web servers scenario seen 
benefits type analysis clear feasible administrators spend fifteen hours analyzing half hours network data 
necessary automate analysis 
atom model possible reproduce decisions real time 
system binary tree discussed section able accurately reproduce author data seconds 
system valuable able assess security risk scenario update risk assessment scenario changed 
begun declarative language administrators specify risk assignment rules 
language subject publication 
discussion summary scenario building approach ids fusion 
believe scenarios produced software convey information analyst individual alerts 
scenario building process requires able produce estimate alert belongs scenario 
examined approaches problem 
analysis indicates data mining approach superior considered 
data set analysis fairly simple 
allowed na approach perform better expect realistic data 
relatively simplistic data improvement offered machine learning techniques significant 
process obtaining large amount data operational military network assess technique realistic traffic 
intend improve system integrating security risk assessment language adding graphical user interface viewing constructed scenarios 
furthermore intend create graphical tools ease burden hand tagging scenarios produce training data 
def con conference 
las vegas nv 
www org 

intrusion detection 
intrusion net books new jersey 
breiman friedman olshen stone 
classification regression trees 
wadsworth belmont california 
clifton 
developing custom intrusion detection filters data mining 
military communications international symposium los angeles ca october 
coleman branch grace 
optimization toolbox matlab 
mathworks 
cunningham lippmann webster 
host bottleneck verification efficiently detects novel computer attacks 
ieee military communications conference proceedings atlantic city nj 
cunningham 
building scenarios heterogeneous alert stream 
proceedings ieee smc information assurance workshop west point ny june 
feinstein matthews 
intrusion detection exchange protocol august 
www ietf org 
ford rekhter 
braun 
improving routing addressing ip 
ieee network may 
haines lippmann 
extending evaluation 
discex proceedings june 
internet security systems 
realsecure console user guide 
atlanta ga 
www iss net 
lippman neural network machine learning statistical software pattern classification 
lincoln laboratory journal 
mitchell 
machine learning 
mcgraw hill 
schwartz 
hacker pro israel web site mideast conflict expands cyberspace 
new york times november 
staniford chen cheung crawford frank levitt wee yip 
grids graph intrusion detection system large networks 
th national information systems security conference proceedings pages october 
valdes skinner 
approach sensor correlation 
advances intrusion detection raid toulouse france october 

automated intrusion detection environment aide 
joint aerospace weapon systems support sensors simulation proceedings june 
www org events brochure proceed htm 
wood duggan 
red advanced information assurance concepts 
discex hilton head south carolina january 

