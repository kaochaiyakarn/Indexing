geographic properties internet routing analysis implications lakshminarayanan subramanian university california berkeley venkata padmanabhan microsoft research randy katz university california berkeley september technical report msr tr microsoft research microsoft microsoft way redmond wa usa geographic properties internet routing analysis implications lakshminarayanan subramanian venkata padmanabhan randy katz university california berkeley microsoft research university california berkeley cs berkeley edu microsoft com randy cs berkeley edu study geographic properties internet routing 
distinguished previous studies internet routing consider geographic path traversed packets just network path 
examine geographic properties including circuitous internet routes tend multiple isps endto path share burden routing packets sharing paths geographic level 
evaluate properties extensive network measurements 
examine spatial temporal variations properties 
discuss implications geographic properties conclude geography interesting tool analyzing internet properties 
keywords network measurement internet topology routing geography study geographic properties internet routing 
number studies internet routing 
key distinguishing feature consider geographic path traversed packets just network path 
geographic path obtained geographic locations nodes routers network path hosts 
instance geographic path host berkeley harvard may looks follows berkeley san francisco new york boston cambridge 
level detail geographic path depend precisely able determine locations routers appearing network path 
geography interesting networking context 
show geographic information provide new insights structure functioning internet 
provides novel way quantifying various network properties 
specific issues study include circuitous routing internet routes necessarily optimal 
fact highly circuitous 
instance observed route host st louis indiana km away traverses total distance km section iv 
tracing geographic path able automatically flag anomalous routes difficult purely network centric information delay 
compute linearized distance hosts sum geographic lengths individual links path 
compute ratio linearized distance path geographic distance source destination hosts 
large ratio indicative circuitous possibly anomalous route 
hot potato versus cold potato routing today internet packet typically traverses multiple isp networks way source destination 
isp typically employs hot potato routing hands packets isp soon possible routing carries packet network far possible handing isp 
policy minimizes burden isps network policy gives isp greater control quality service experienced packets 
geographic information quantify degree isp routing policy resembles routing cold potato routing 
shared network infrastructure number efforts aimed discovering topological structure internet typically traceroute tool discover ip addresses intermediate routers path 
topology information may incomplete seemingly independent routers may sharing networking infrastructure may vulnerable correlated failures 
instance multiple routers may correspond separate interfaces single router set routers may located data center belonging isp may share resources long haul links locations routers may located city isp network may vulnerable correlated failures natural disaster earthquake strike city 
threat simultaneous failure greatest case case 
case may useful network fault tolerance viewpoint know routers located may share net resources 
geographic information serve useful complement pure network topology information 
study issues extensive traceroute data gathered hosts distributed europe historic data gathered paxson 
examine circuitousness toend paths internet section iv properties paths traverse multiple isp networks section extent sharing paths geographic level section vi 
clarify network performance focus 
investigating performance issues ongoing indicated section vii 
instance claim non circuitous route optimal terms performance circuitous 
geography interesting tool studying network properties 
ii 
related discovering analyzing internet structure subject studies 
focused studying topology purely network level regard geography 
tools developed map ip addresses corresponding geographic locations 
internet mapping projects tools incorporate notion geographic location maps 
aware previous study uses geographic information analyze internet routing 
mercator project focusses heuristics internet map discovery 
basic approach traceroute ttl limited probe packets coupled source routing discover routers key component mercator heuristics resolving aliases multiple ip addresses corresponding possibly different interfaces single router 
basic idea send udp packet non existent port router wait icmp port unreachable response elicits 
general destination ip address udp packet source ip address icmp response may match indicating addresses correspond different interfaces router 
geographic information identify points sharing network 
view complementary network level heuristics ones employed mercator 
internet mapping project bell labs uses traceroute approach map internet single source 
colored octets ip address portions corresponding isp tend colored similarly 
map laid geography 
router interfaces discovered routers 
efforts produced topological maps reflect geography internet 
examples include skitter project commercial matrix net service 
number tools developed determining geographic location corresponding ip address 
tools variety approaches map ip address location inferring location whois records extracting location information traceroute data geotrack determining location coordinates delay measurements geotrack tool describe detail section iii 
internet topology discovery mapping network path information obtained traceroute study dynamics network routing 
instance paxson studied temporal stability internet routing extensive set traceroute data 
contrast study different set static properties internet routing traceroute data coupled geographic information 
iii 
experimental methodology section discuss experimental methodology 
details measurement testbed data sets gathered 
description geotrack tool determine geographic paths internet 
overview goal study geographic properties internet routing measurement focused gathering network path data traceroute tool 
interested studying dynamic properties internet routing routes change time record single snapshot network path pair hosts 
traceroute determine network path traceroute sources thousands geographically distributed destination hosts 
gathered traceroute data geotrack tool determine location nodes network path possible 
geotrack reports location granularity city 
online latitude longitude server compute geographic distance source destination traceroute pair adjacent routers path 
enabled compute linearized distance define sum geographic distances successive pairs routers path 
path passes linearized distance path sum geographic distances discuss section iii typically able determine location routers 
simply skip routers location unable determine 
example location unknown compute linearized distance path computed sum geographic distances clearly skipping results estimate linearized distance smaller true value 
noted section iii skipped nodes vicinity source destination error introduced linearized distance computation small 
fig 

locations traceroute sources note hosts seattle berkeley 
measurement testbed geographically distributed hosts sources traceroutes 
hosts located 
located europe stockholm sweden bologna italy budapest hungary 
geographical diversity enables study variations topological routing properties seen different vantage points 
logistical reasons convenient locate traceroute sources university campuses 
traceroute sources fell category 
furthermore university locations considered connected internet backbone 
add diversity source berkeley ca connected home cable modem network addition university california berkeley seattle wa connected microsoft research network addition university washington seattle 
sources note linearized distance computed nodes routers visible ip level 
way discovering underlying physical links may atm technologies consider computation 
allow study albeit limited extent impact nature source connectivity 
set comprising hosts destination set traceroutes 
destinations hosts fell categories 
univhosts web servers hosts located university campuses hosts distributed states 
web servers public libraries distributed states 
tvhosts client hosts connected online tv program guide 
majority clients located non academic networks america online aol 

web servers distributed countries europe 
ease exposition refer univhosts tvhosts hosts european hosts 
diverse set destination hosts enables investigate properties internet routing context large set isps 
traced approximately paths traceroute sources destination hosts october december 
dataset study temporal variations internet properties traceroute data set collected paxson 
data set includes traceroutes conducted pairs hosts drawn set hosts distributed mainly academic sites europe south korea australia 
gathered data europe considered subset data set corresponded europe 
despite fact data set contains far fewer paths data set provides interesting data point comparison 
data set gathered late months demise nsfnet backbone provide connectivity academic sites early life commercial internet 
geotrack gathered traceroute data geotrack tool developed previously translate network path pair hosts corresponding geographic path 
geotrack tries infer location router dns name 
network operators diverse set public traceroute servers overcome limitation 
large volume traceroutes looking run source precluded 
assign geographically meaningful names routers presumably administrative convenience 
example name sanfrancisco cw net corresponds router located san francisco 
router names recognizable router names may contain indication location 
brief outline geotrack works please refer detailed description 
dns name router parsed determine contains location codes 
geotrack uses database approximately location codes cities europe 
isp tends naming convention may multiple codes city chi chicago chicago il 
geotrack incorporates isp specific parsing rules specify subset valid codes position may appear router names 
coverage geotrack router names traceroute data set recognizable approximately 
compiled list major isps nationwide backbones international coverage cable wireless sprintlink uunet router names isps recognizable 
individual cases uunet recognizability excess 
router names tend concentrated regional campus networks 
example cmu psc net node pittsburgh supercomputing center pittsburgh pa contain valid city airport code geotrack unable recognize location 
nodes typically located vicinity source destination paths traced resulting error linearized distance minimal 
case data set geotrack able recognize router names approximately 
computing distances compute geographic distance locations consulted online atlas server obtain corresponding latitude longitude values 
simple compute distance locations basically length great precise dns names associated router interfaces routers 
ease exposition term router 
course possible include psc cmu codes 
refrain doing want include codes geotrack inherently indicate location 
doing lead path exhaustive tabulation undesirable 
circle arc connecting points 
having discussed experimental testbed methodology turn analysis data gathered 
findings discuss significance 
iv 
circuitousness internet paths section examine circuitous internet paths 
standard measure circuitousness define metric distance ratio ratio linearized distance path geographic distance source destination path 
distance ratio reflects degree network path nodes deviates geographic path nodes 
ratio indicate perfect match absolutely direct route large ratio indicate circuitous path 
different analyses view studying impact spatial factors location source destination traceroutes temporal factors versus 
specifically distribution distance ratio paths single location different sets destinations univhosts tvhosts paths hosts location entirely different networks paths geographically distributed hosts paths lie entirely versus paths lie entirely europe paths drawn paxson data set ones drawn data set 
paths single source consider paths traceroute source uc berkeley univhosts tvhosts 
hosts univhosts traceroute source uc berkeley connect internet high speed backbone local 
wide area path uc berkeley host host univhosts traverses internet backbone 
hand tvhosts diverse set includes hosts located various commercial networks aol msn home university campuses 
wide area paths uc berkeley host hosts tvhosts typically traverse commercial isp backbones 
difference groups destination hosts reflected cumulative distribution function cdf distance ratio cases 
shows distance ratio close destinations 
ratio corresponding linearized distance exceeds geographic distance destinations univhosts tvhosts 
finding consistent rich internet connectivity san francisco clearly ratio smaller network links pass earth 
distance ratio uc berkeley univhosts vs tvhosts univhosts tvhosts fig 

cdf distance ratio paths uc berkeley univhosts tvhosts 
bay area uc berkeley located 
area includes public internet exchanges mae west private peering points 
path uc berkeley host destination host able transition isp sf bay area 
little need take detour city just transition destination isp 
far pronounced difference univhosts tvhosts cases look tail distribution 
instance th percentile mark distance ratio case univhosts case tvhosts words overhead due detour times large tvhosts destinations univhosts versus 
paths hosts tvhosts tend circuitous traverses multiple commercial isps sub optimal peering relationship 
trends qualitatively traceroute source locations uc berkeley 
paths multiple sources location consider paths pairs hosts location entirely different networks destinations univhosts set 
consider pairs traceroute sources machine berkeley campus berkeley home cable modem network machine university washington uw campus seattle microsoft research network km away 
shows cdf distance ratio sources 
sources located berkeley find university campus significantly smaller distance ratio especially tail distribution 
instance th percentile distance ratio uc berkeley source cable distance ratio cumulative distribution univhosts comparison universities cable corporate sites uc berkeley berkeley cable modem uw microsoft research redmond fig 

cdf distance ratio paths pairs colocated sources univhosts 
modem source 
destination set univhosts uc berkeley source tends direct routes internet cable modem client home commercial isps called 
observe similar trend uw microsoft pair 
uw source direct routes university hosts microsoft source 
instance path microsoft university chicago follows highly circuitous route network 
path goes way west coast los angeles carlton tx back indianapolis chicago 
linearized distance path km geographic distance seattle chicago km 
contrast path uw internet far direct passes denver kansas city indianapolis chicago total linearized distance km 
results indicate nature source destination network connectivity significant impact direct circuitous network paths 
paths multiple sources different locations consider paths sources geographically distributed locations stanford washington university st louis wustl university north carolina unc 
destination set larger diverse set univhosts set considered section iv 
shown distance ratio tends smallest paths originating stanford largest originating wustl 
stanford berkeley located san francisco bay area served large isps nationwide backbones 
contrast wustl connected 
paths wustl enter network distance ratio different sources unc stanford wustl fig 

cdf distance ratio paths multiple sources 
st louis take detour chicago north dallas south 
cities path transitions major isp cable wireless proceeds destination 
detour particularly expensive terms distance ratio central location st louis means geographic distance various destinations relatively small 
general paths wustl traverse significant distances backbones large isps tend circuitous paths stanford traverse distance backbone single isp regardless isp 
example highly circuitous path involved large isps path originates wustl st louis terminates host indiana university km away 
geographic path goes st louis new york chicago network 
new york transitions network path back chicago st louis heading indiana 
linearized distance km times geographic distance 
examine impact multiple isps greater detail section findings section suggest distribution distance ratio indicative richness connectivity source 
versus europe analyze distance ratios paths europe compare distance ratios paths consider paths sources destinations set paths european sources destinations set 
paths contained entirely entirely europe 
consider paths sources european destinations vice versa distance ratio paths tends dominated long links tends push ratio 
distance ratio cumulative distribution vs europe europe uc berkeley stockholm sweden bologna italy fig 

cdf distance ratio paths europe 
show distribution distance ratio sources berkeley stockholm sweden bologna italy europe 
observe distance ratio tends larger european sources compared berkeley especially tail distribution 
attribute causes 
paths europe tend traverse multiple regional national isps 
complex peering relationships isps results convoluted paths 
instance path bologna host salzburg austria traverses isps italian academic research network leading pan european isp netherlands passes milan italy geneva switzerland paris france amsterdam netherlands frankfurt germany vienna austria 
linearized distance path km geographic distance bologna salzburg km 
second cases path european source european destination passes nodes 
instance path stockholm sweden croatia passes node new york city belonging large international isp 
heard anecdotal evidence concrete data similar detours paths countries east southeast asia 
large fraction internet communication locations tends 
instance web content located better connectivity remote locations 
versus compare distribution distance ratio computed data set computed paxson data set 
paths data set correspond traceroutes conducted nodes mainly academic locations part testbed 
considered paths subset nodes located keep nature measurement points similar data set consider paths source hosts located universities hosts univhosts set 
distance ratio vs fig 

cdf distance ratio paths paxson data set data set 
plots cdf distance ratio data sets 
note distance ratios tend smaller data set 
improvement surprising internet richly connected today years ago 
exist direct pointto point links locations previously connected indirect path 
summary summary analysis section shown distance ratio useful metric quantifying quality connectivity source path 
large value distance ratio enables automatically flag paths highly circuitous possibly routing anomalies 
impact multiple isps analysis section iv focused characteristics path source destination 
path typically traverses multiple autonomous systems ases 
ases stub networks university corporate networks source destination nodes may located isp networks 
relationships networks complex 
customer provider relationships university network isp regional isp nationwide isp peering relationships nationwide isps 
stub network may multi homed connected multiple providers 
nationwide isps may peer multiple locations san francisco new york 
complex interconnections individual networks impact routing 
section show geography tool analyze complex interconnections 
specifically investigate questions internet paths individual isp networks circuitous paths impact presence multiple isps circuitousness path distribution path length individual isp networks geography shed light issue hot potato versus cold potato routing 
circuitousness paths versus intra isp paths take closer look circuitousness endto internet paths quantified distance ratio 
compare distance ratio paths sections path lie individual isp networks 
consider paths sources data set 
distance ratio cumulative distribution path vs isp path path isps avg alter net internet fig 

cdf distance ratio paths versus sections path lie individual isp networks 
shown distance ratio paths tend significantly larger intra isp paths 
words paths tend circuitous intra isp paths 
furthermore distribution ratio tends vary isp internet doing better average alter net part uunet doing worse 
believe reason paths tend circuitous sub optimal peering large isps 
inter domain routing internet largely uses bgp protocol 
bgp path vector protocol operates level ases 
offers little visibility internal structure network isp network 
actual cost hop terms latency distance largely hidden bgp level 
issue isps employ complex policies controls traffic enters network ingress points 
example mentioned section iv packets need travel way st louis new york enter network 
reasons surprising paths tend circuitous 
contrast routing isp network controlled 
typically link state routing protocol ospf intra domain routing 
internal topology isp network typically known routers routing isp network tends close optimal 
section path lies isp network tends circuitous 
referring example section iv st louis chicago new york path network new york chicago st louis path network circuitous path 
mean intra isp paths circuitous 
noted section iv circuitous path microsoft research seattle university chicago linearized distance km geographic distance km 
imply path necessary sub optimal 
fact circuitous path may best viewpoint network load congestion 
point geography provides useful insights non optimality network paths presents part picture 
impact multiple isps circuitousness section hypothesized presence multiple isps sub optimal peering path contributes circuitousness path 
examine issue carefully 
classify paths categories non circuitous distance ratio circuitous distance ratio 
path category identify top isps account linearized distance 
compute fraction linearized distance accounted top isps denote fractions max max 
ex choice thresholds arbitrary capture intuitive notion circuitous non circuitous routes 
note may paths fall category 
ample path linearized distance km traverses km network km uunet network smaller distances networks max max 
note possible max max entire path traverses just isp network fraction path isp cumulative distribution circuitous vs routes circuitous max circuitous max max max fig 

cdf fraction path lies top isps case circuitous paths non circuitous paths 
shows cdf max max circuitous non circuitous paths 
difference characteristics categories paths striking 
max max curves closer case circuitous paths case paths 
words case circuitous paths path traverses substantial distances top isps isps 
contrast non circuitous paths tend dominated single isp 
instance median values max max case circuitous paths approximately respectively 
words top isps account respectively path median case 
fractions non circuitous paths approximately respectively skewed favor top isp 
findings reinforce hypothesis correlation circuitousness path quantified distance ratio presence absence multiple isps account substantial portions path 
distribution isp path lengths section examine distribution linearized distance accounted just clarify isp network means single usually wide area network traverses long distance 
local networks confined city university network contribute nil linearized distance ignored 
individual isps 
wish understand effort carrying traffic wide area path different isps 
reason consider set large isps nationwide coverage isps considered alter net sprintlink cable wireless internet level exodus uunet vbns global crossing 
ease exposition term major isps 
major isp consider set paths traverse nodes isp network 
path compute fraction path lies isp network 
fraction path isp path distribution isps internet sprintlink att cable modem fig 

cdf fraction path lies individual isp networks 
plots cdf fraction different isps 
purposes exposition case internet sprintlink consider paths geographically distributed university source hosts data set 
university sources ucsd jhu ut dallas duke 
case consider paths originating home cable modem host berkeley 
observe distributions look different 
instance median fraction path lies sprintlink corresponding fraction internet 
internet high speed backbone network connects university campuses path traverses internet typically originates terminates university campuses 
internet backbone accounts overwhelming fraction path 
similarly large fraction case attributed fact considered paths originating cable modem host home network 
home owned part surprising backbone accounts substantial fraction path 
smaller fraction case sprintlink harder explain definitively 
result specific peering relationships sprintlink major isps 
discuss hot potato routing offer possible explanation 
stress position definitive determination 
hot potato versus cold potato routing investigate geographic information helpful assessing isp routing policies internet conform hot potato routing cold potato routing 
hot potato routing isp hands traffic downstream isp quickly 
routing opposite hot potato routing isp carries traffic far possible network handing downstream isp 
policies reflect different priorities isp 
hot potato case goal get rid traffic soon possible minimize amount isp network needs 
cold potato case goal carry traffic isp network extent possible maximize control isp quality service 
fraction path isp cumulative distribution isp vs second isp isp isp sprintlink isp isp fig 

cdf fraction path lies second isp networks sequence 
consider set paths sources tvhosts 
path traverses major isps compute fraction path lies isp isp second isp isp sequence 
fractions measures amount isps conveying packets 
distributions fractions plotted 
observe fraction path lies isp tends significantly smaller second isp 
instance median isp second isp 
consistent hot potato potato routing behavior isp tends hand traffic quickly second isp carries greater distance 
plots distributions path lengths case isp sprintlink 
find difference isp isp curves greater case 
consistent routing behavior part sprintlink 
note indirect inferences data 
establish certainty sprintlink isp fact employ hot potato routing 
summary section geographic information study various aspects wide area internet paths traverse multiple isps 
internet paths tend circuitous intra isp paths presumably sub optimal peering isp networks 
furthermore paths traverse substantial distances isps tend circuitous paths largely traverse single isp 
findings geography analysis consistent hypothesis isps generally employ hot potato routing 
presence hot potato routing may explain major isps account relatively small fraction path 
vi 
path sharing section geographic information study characteristics sharing network paths 
outlined section investigation motivated network fault tolerance considerations 
failure shared section paths potential adversely impacting paths 
consider paths pair hosts traceroute sources common destination 
define notions sharing 
basic term shared ip refers sharing ip level 
path paths portion lies common router paths determined matching ip addresses destination 
corresponds notion sharing networking studies 
noted section shared ip necessarily capture true notion sharing paths 
seemingly separate routers may sharing network resources 
routers may correspond different interfaces router 
may located data center city 
routers network paths traverse may vulnerable correlated failures 
hard determine resources shared nodes detailed knowledge actual network deployment 
define additional notions sharing geographic information approximations ideal 
termed refers sharing isp geographic levels 
routers deemed shared isp network located city 
intuition routers located data center share resources long haul links 
second termed shared geo refers sharing purely geographic level 
routers deemed shared located city isp network 
city struck disaster earthquake cyclone routers vulnerable coordinated failures 
analysis shared paths consider different pairs sources uc berkeley stanford 
uc berkeley stanford share common connection internet backbone regional network 
expect significant amount sharing paths originating uc berkeley stanford similarity network connectivities physical proximity 
hand uiuc ucsd located far apart 
different network connectivities 
uiuc direct connectivity internet ucsd connectivity 
traceroutes ucsd connects internet indirectly los angeles ca 
fraction shared path cumulative distribution shared path characteristics berkeley stanford shared ip berkeley stanford shared geo ucsd uiuc shared ip ucsd uiuc shared geo fig 

shared path characteristics berkeley stanford vs ucsd uiuc pairs sources consider paths common destinations drawn data set 
destination compute linearized distance shared ip path shared path path 
express fraction endto linearized distance path 
essentially destination compute fractions source 
shows cumulative distribution length shared path expressed fraction shared ip shared geo cases corresponding berkeley stanford uiuc ucsd pairs 
note approximately destinations paths berkeley stanford shared geo path extends path source 
destinations paths shared ip path extends path source 
indicates greater sharing paths geographic level ip level 
characteristics shared path similar shared geo path pairs sources 
note sharing paths originating ucsd uiuc small 
destinations shared ip negligible terms linearized distance 
shared geo path characteristics indicate sharing poor geographic terms ucsd uiuc 
vii 
geography tool analyzing various aspects internet routing 
geotrack tool determine geographic path pair nodes 
distance ratio metric quantify circuitousness geographic path underlying network path 
extensive traceroute data gathered source nodes distributed europe analysis 
find degree circuitousness paths varies depending connectivity source destination nodes 
paths originating connected hosts uc berkeley stanford campuses tend far circuitous routes hosts connected wustl campus 
region europe tends circuitous routes routes measured year circuitous measured 
believe positive change result internet richly connected 
paths traverse substantial distances multiple isp networks tend circuitous presumably suboptimal peering isps 
fraction path lies isp network varies widely isp 
furthermore consider paths travers major isps find path generally traverses significantly shorter distance isp network second 
finding consistent hot potato routing policy 
geographic information analyze sharing paths various granularities 
find sharing geographic level far greater sharing ip level 
addition specific analyses performed believe significant contribution introduce idea geography tool analyzing network properties 
internet richly connected expect geography network analysis techniques useful 
instance distance ratio automatically flag routes anomalous 
ongoing studying correlation network performance geographic location 
particular investigating effectiveness geography schemes wide area replica selection 
vern paxson data set available 
arvind arasu badrinath mary baker paul barford john byers chlamtac mike dahlin kevin jeffay craig labovitz paul mahesh vijay parthasarathy jerry prince amin vahdat srinivasan geoff voelker marcel waldvogel david wood helped obtain access geographically distributed set measurement hosts 

cheswick burch mapping visualizing internet usenix technical conference june 
govindan tangmunarunkit heuristics internet map discovery ieee infocom march 
stahl nickname whois rfc ietf october 
jacobson traceroute software ftp ftp ee lbl gov traceroute tar gz moore world caida org 
inet june 
padmanabhan subramanian 
investigation geographic mapping techniques internet hosts 
acm sigcomm august 
paxson 
routing behavior internet 
ieee acm transactions networking vol pp 
october 
john stewart bgp inter domain routing internet 
addison wesley publishers 
geography com internet 
www internet org internet traffic archive 
ita ee lbl gov list public libraries sunsite berkeley edu list public traceroute servers www traceroute org list web servers europe pauli 
de world europe html matrix net www matrix net npd routes data set internet traffic archive ita ee lbl gov html contrib npd routes html skitter project caida www caida org tools measurement skitter www com 
