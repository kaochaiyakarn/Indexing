siggraph chicago computer graphics july dynamic simulation non penetrating flexible bodies david baraff andrew witkin program computer graphics school computer science cornell university carnegie mellon university ithaca ny pittsburgh pa model dynamic simulation flexible bodies subject non penetration constraints 
flexible bodies described terms global deformations rest shape 
dynamical behavior bodies closely matches behavior ideal continuum bodies derived subsumes results earlier lagrangian dynamics models 
dynamics derived flexible body model allows unification previous flexible body simulation previous non penetrating rigid body simulation 
non penetration constraints system bodies contact multiple points maintained analytically calculated contact forces 
implementation second order polynomially deformable bodies described 
simulation second order higher deformations currently involves polyhedral boundary approximation collision detection purposes 

new formulation dynamics flexible bodies covers collisions continuous contact free motion 
model draws flexible body model proposed witkin welch analytical contact force model rigid bodies baraff centers idea flexible body simulation greatly simplified suitable geometric approximation :10.1.1.163.5683
restricting body changes shape represented global parametric deformation solve problems plague conventional local formulations dimensionality simulation reduced second severe numerical problems local interactions give rise eliminated 
restricted geometric approximation flexible body behavior generally exhibits error compared behavior ideal continuum body conditions 
approximation error acceptable depends factors materials forces modeled purpose simulation 
case approximation adopted clearly desirable minimize resulting error 
formulation derived criterion minimal approximation error 
brief discussion local models problems introduce review global model witkin welch show formulation free body motion fact minimal error solution 
consider problem collision response flexible bodies 
collisions electronic reprint 
permission granted copy part noncommercial provided title copyright notice appear 
electronic reprint cmu 
original printed acm 
author address may david baraff school computer science carnegie mellon university pa usa 
email baraff cs cmu edu aw cs cmu edu rigid bodies generally modeled instantaneous events impulses 
case flexible bodies inappropriate interested seeing compress rebound 
minimal error criterion leads phase model initial impulse prevents inter penetration followed non impulsive phase continuous contact body compresses due momentum due buildup internal strain energy 
extend baraff analytic contact force model flexible bodies discuss implementation issues polynomial deformations simulation results 
local models problem stiffness traditional models flexible bodies including finite difference finite element mass spring lattice models approximate deviation continuum body rest shape terms displacements finite number points called nodal points 
sufficient density nodal points formulations represent essentially deformation 
spectrum continuum bodies deformations considered small neglected approximated rigid bodies free translate rotate 
obviously rigid body formulation applied bodies deformation want neglect 
unfortunate nodal formulations tend give rise stiff differential equations difficult solve numerically 
basic problem nodal formulations model global phenomena example acceleration body due point force local interactions adjacent nodes 
compression waves translate local interactions large scale effects involve deformations generally far small fast play significant role computer animation mechanical stiffness flexible body increased 
ordinary numerical methods high speed effects phenomena primary interest dictate size time steps potentially disastrous effects performance 
applies rigid body approximation sweeps problems away eliminating local interactions altogether degrees freedom rigid body global ones govern position orientation 
modeling flexible body collisions contact raises additional problems nodal formulation 
particular collisions difficult handle usually involve extremely large transient forces accelerations operate strictly local interactions 
usual stiffness problem exacerbated 
things worse penalty methods local model enforce non penetration constraints introduce stiffness problems :10.1.1.163.5683
siggraph chicago computer graphics july global models witkin welch flexible body model represents compromise extremes nodal rigid formulations 
changes body shape approximated nodal displacements rigid body transformations global deformations apply parametric space warp points body 
global formulation constrains range deformations body undergo represented chosen deformation function 
shape parameters global effect stiffness problems due local interactions eliminated rigid case 
different flexible body formulation pentland williams achieve goal linearizing dynamic model modal analysis eliminate high frequency vibrations 
prefer formulation witkin welch primarily see section minimizes error due geometric approximation consequences approximations pentland williams difficult assess 
collision contact baraff presents analytical method computing contact forces configurations rigid bodies 
contact forces computed solving simultaneous equations reflect forces acting bodies 
external force acting body immediate effect contacting bodies 
formulation contact forces global problem eliminates stiffness problems encountered penalty method contact forces 
complete global formulation adapt method deal flexible bodies 

global deformations section define basic global formulation flexible bodies 
stated describe shape deformed body terms number nodal points body shape described terms global deformation function dq vector parameters controls deformation 
function dq maps dq describes deformed shape body mapping point body rest shape point dq pa dynamics global deformations goal deriving dynamical behavior flexible body model relate forces acting body acceleration control parameters generalization familiar equation ma 
control parameters derivative want express terms forces acting body 
want motion prescribed minimum possible deviation motion ideal continuum body 
expression derived minimizes deviation matches expression derived earlier witkin welch lagrangian dynamics show lagrangian dynamics formulation satisfies minimal approximation error criterion 
model derived section minimum error criterion 
derivations bodies parameterized coordinate body space ranges fixed volume 
density body point body space denoted pa ta describe state body function time time dq ta specifies body mapped body space world space 
specifically time deformed body density pa world space point dq ta pa ideal continuum body acceleration point standard equation ma 
ideal continuum body completely unconstrained motion deformed arbitrary shape appropriate forces 
contrast global deformations represent constraint limiting allowable deformations motion body 
constraint acceleration point mass response force general satisfy am 
best minimize deviation actual acceleration ideal acceleration am 
measure total acceleration deviation entire body integrate acceleration deviation point entire volume body 
net force world space acting body described vector valued function pa body 
force function includes external forces gravity internal forces due deformation forces due contact 
pa denote acceleration point body pa ideal satisfied pa paa pa equivalently pa paa pa 
measure net acceleration error ideal acceleration entire body writing pa pa paa pa dv ranges volume body world space 
deviation mass weighted error contributed acceleration deviation region body grow linearly density region 
relate acceleration control parameters net force function requiring chosen minimize error defined equation quantity named gauss constraint system 
gauss formulated principle called principle constraint asserts motion system subject constraints minimizes constraint equation 
principle constraint yields result constrained motion lagrange equation motion notion motion satisfying minimal error criterion equivalent treating bodies mechanical systems defining motion terms known lagrangian dynamics 
linear deformations previous section describes dynamics deformation function dq ta arbitrary 
remainder limit deformations dq ta pa depend linearly may vary non linearly respect describe state terms vector ta switch notation define state matrix ta correspondingly dr ta denotes deformation function specified ta 
fact deformation dr ta linear respect ta means dr ta form dr ta pa taz pa pa vector valued function depend restriction greatly simplifies dynamics equations allowing latitude choice deformation function note pa need linear function deformation quadratic undeformed coordinates specified pa yy pxy ta matrix 
clearly polynomial deformations order expressed terms deformations linear respect state 
second order polynomial deformations particular fairly liberal terms allowable deformations body 
section discuss details implementing second order polynomial deformation functions 
siggraph chicago computer graphics july previous section know lagrangian dynamics relate ta ta ta force pa minimal error 
witkin welch derive relation ta tam constant square matrix ta matrix generalized net force acting body 
matrix defined paz paz pa dv yields square matrix size dimension column vector pa additionally symmetric positive definite 
matrix ta dimension 
generalized force related force follows force acting point dr ta pa world space yields matrix generalized force pa note pa column vectors outer product pa yields matrix 
bodies complicated rest shape integral equation difficult calculate analytically 
constant calculated line simulation process numerical techniques currently monte carlo integration precompute required simulate motion flexible bodies solution equation 
done converting equation coupled order ordinary differential equation dt ta ta ta tam remaining task evaluate generalized force ta subsumes external forces internal forces contact forces acting body 
external forces definition forces known time gravity viscous damping 
section show internal forces due deformation may calculated 
section discusses computation contact forces included ta 
potential energy functions linear deformations internal forces act restore flexible body rest shape specified terms derivative potential energy function 
physical bodies potential energy functions described terms metric tensor body 
internal damping forces calculated similarly terms metric tensor time derivative 
affine deformations metric tensor time derivative instant time constant volume body evaluating integrals metric tensor body volume trivial 
non affine deformations metric tensor vary volume body body shape complex integrals needed compute difficult evaluate 
choices calculate integrals analytically numerical approximation 
polynomial deformations integrals involving metric tensor expressed linear combination integrals independent ta 
integrals weighted functions ta summed compute 
internal damping forces computed similarly linear combination precomputed integrals weighted functions ta ta 
second order polynomial deformations implemented necessary expansion precalculated integrals quite large 
alternate technique simply approximate integrals evaluating integrand finite number points scattered body 
virtue trivial implement may general dealing complex energy functions allow non penetration enforced preventing contacting vertices moving plane 
entire lower rim cylinder prevented moving plane 
plasticity fracture 
second order polynomial deformations small number sample points order yields adequate results 

non penetration constraints derivation contact forces flexible bodies prevent inter penetration closely parallels derivation contact forces rigid bodies baraff 
notable difference arises considering collisions bodies detailed section 
contact geometry restrictions considering contact bodies assumption contact bodies described terms finitely contact points 
restrict configurations inter penetration prevented globally enforcing finite number local constraints 
example consider 
bodies involved rigid inter penetration prevented globally cube plane enforcing local constraints vertex cube contact plane remain plane 
prevent cylinder plane inter penetrating allowing tip arbitrarily constrain infinitely boundary points lower cylinder remain plane 
allow configurations 
bodies deformations affine functions material coordinates rigid bodies polyhedral contact regions allowed 
deformations configurations allowed 
deformation caused contact face cube curve result inter penetration vertices face prevented inter penetrating plane 
section describes geometric polyhedral boundary discretization permits simulation configurations dimensional polygonal contact regions arbitrary deformation functions allowed 
approximation somewhat unsatisfactory non discretized method dealing situations preferable 
colliding contact having described geometry contact consider dynamics contact 
bodies initially come contact point pc say collision occurred 
order maintain siggraph chicago computer graphics july rest shape linear deformation non linear deformation affine deformations allow polyhedral contact regions inter penetration prevented finitely local constraints 
non linear deformations preventing vertices moving plane necessarily prevent inter penetration 
non penetration constraint bodies contact surfaces undergo velocity discontinuity contact point 
amount inter penetration occur vicinity contact point 
rigid bodies deform case collision rigid bodies point rigid body experiences velocity discontinuity 
implies abrupt change momentum accomplished impulse 
collisions quantified terms energy lost collision completely elastic meaning energy lost completely inelastic meaning kinetic energy bodies completely dissipated measured respect center mass coordinate system 
rigid body collisions energy loss instantaneous 
immediately collision bodies bounce apart velocity depends elasticity collision 
contrast collision process flexible bodies takes non zero amount time 
time colliding bodies remain contact 
derive collision response model flexible bodies variational principle 
motivate derivation consider case onedimensional rod colliding fixed obstacle 
rod discretized mass points 
example dimensional mass point may undergo displacement left right 
mass points numbered left right 
mass point collides fixed obstacle velocity discontinuously change zero prevent interpenetration 
velocity mass points rod unchanged 
particular second mass point continues original velocity distance second mass point decreases 
distance decreases internal force acts repel mass points 
effect second mass point means distance second third mass point decreases clearly effect propagates entire rod 
happening fixed obstacle exerting non impulsive contact force mass point prevent repulsive internal force accelerating mass point leftwards 
finite period contact internal forces cause rod bounce away obstacle 
damping energy lost due dissipation kinetic energy mass point 
limit goes infinity mass point initial kinetic energy go zero 
velocity discontinuity occurs left bar actual change momentum zero energy lost 
wish model collisions amount impose damping forces body dissipate energy collision 
collision response model constrained flexible bodies impulse contact force contact force 
discretized rod collides obstacle 
mass velocity changes instantaneously zero impacting obstacle 
mass approaches mass internal force acts pushing mass leftwards 
contact force acts rightwards mass prevent inter penetration 
analysis 
rigid body case need apply impulse contact point prevent immediate interpenetration 
means kinetic energy lost attain perfectly elastic collision 
consequence limiting allowable deformations body 
impulse applied bodies longer colliding non impulsive force described section act contact point prevent inter penetration 
section error measure compare collision response flexible body model ideal continuum body 
measure net generalize equation obtain new error measure pa pa dv pa change velocity response impulse 
ideal continuum body pa zero point collision zero 
flexible body model measures deviation actual change velocity pa ideal change velocity zero 
correct instantaneous change ta state velocity ta minimizes subject kinematic constraints collision 
description collision intuitive correct course action apply impulse colliding bodies point contact just come rest relative contact point 
absence friction impulse act normal contact surfaces 
standard constrained minimization principle applied equation shows change velocity ta impulse fact exactly ta minimizes subject kinematic constraints collision 
actual computation impulse trivial 
simplicity consider collision flexible body obstacle defined surface normal general energy loss decreased altering deformation function allows body degrees freedom 
limiting case represent deformation limiting case discretized bar goes infinity 
obviously case simulated infinite amount computation 
siggraph chicago computer graphics july impact flexible body body contact point pc 
vector denotes outwards pointing unit surface normal contact point pc 
generalization case ordinary rigid deformable body straightforward 
case generalized forces impulse acting body point dr ta pa produces generalized impulse pa flexible body state velocity ta changes discontinuously ta qm subject generalized impulse calculate required impulse pc dr ta pa know impulse occurs pc direction frictionless impact 
express impulse unknown scalar 
velocity contact point moving body collision pc dt dr ta pa taz pax collision velocity contact point ta qm az pa body fixed velocity contact point direction collision zero require ta qm az pa substituting pa constraint yields ta nz pa az pa taz pa nz taz pa pa pa unit length 
positive definite denominator equation non zero positive 
taz pa initial approach speed normal direction negative positive expect 
collisions involving contact point collisions contact point considered sequence collisions slightly staggered time 
collisions involving multiple contact points modeled occurring simultaneously approach taken baraff 
resting contact derivation resting contact forces flexible bodies derivation resting contact forces rigid bodies 
non penetration constraints rigid bodies described baraff restricted handle situations finitely contact points described section 
restricted situations inter penetration prevented considering finitely contact points index contact points contact point bodies write constraint form ta measure separation normal direction time ta spatial measure ta measures relative normal acceleration particular bodies accelerating inter penetrate ith contact point 
conversely bodies accelerating apart contact broken ith contact point immediately time 
contact broken ith contact point 
prevent inter penetration enforce equation 
relation ta maintained contact point time varying contact force acting normal contact surface 
case colliding contact need calculate magnitudes contact forces 
measures acceleration depends linearly forces acting bodies contact force contact point required repulsive conservative add energy system bodies 
normal force contact may affect acceleration bodies contact satisfying ta contact points involves satisfying system simultaneous linear inequalities 
constraint contact forces act conservatively expressed terms quadratic constraint contact forces 
contact forces satisfying constraints computed quadratic programming 
exactly formulation prevent inter penetration flexible bodies 
expression derived baraff requires spatial temporal derivatives functions describing contact surfaces 
suppose express undeformed rest shape contact surface body space terms real valued function pa point pb body space undeformed surface pba 
deformed contact surface time consists points world space py ta paa ta deriving expressions various derivatives py ta necessary symbolically evaluate exercise applying chain rule calculus 
deformation function dr ta pa taz pa linear function depends linearly contact forces 
contact forces extended include friction described baraff 

implementing polynomial deformations implemented flexible bodies cases second order polynomial deformations 
difficulty performing simulations involve bodies mix differing deformation functions 
simulations mix rigid deformable bodies 
section discuss number implementation details 
collision detection currently bodies limited unions convex primitives primitive polyhedron convex closed curved surface 
deformations limited order deformations convexity conserved deformation 
collision detection method described baraff alteration 
additionally flexible bodies determined contact point pc world space necessary compute pc body space bodies pca computed ta body 
trivial order deformations dr ta simply affine transformation inverse easily computed 
siggraph chicago computer graphics july polygons body space mapped polygons world space dimensional contact regions allowed described section 
matters complicated second order higher deformations 
computing pca severe problem 
coarse ta mesh control points known body space coordinates transformed world space body 
point pc world space body space coordinates control points closest pc world space interpolated provide rough estimate pca 
starting estimate pca ta ta computed numerically iterative techniques 
initial determination contact points world space difficult problem 
suitable collision detection algorithm simulations severely restricted contact geometry restrictions section 
hope eventually deal problems describe approximation method removes contact geometry restriction lets previously developed collision detection algorithms 
polyhedral approximation approximation method consists discretizing contact surfaces triangular mesh 
undeformed contact surface body decomposed number triangular patches completely cover surface 
body space triangular patch described triple vertices 
time triangle transformed world space triangle dr ta ay dr ta ay dr ta aa 
performing collision detection enforcing non penetration constraints contact surface considered collection transformed triangles 
coherence culling step results collision detection algorithm nearly linear number polygons 
non penetration constraints written terms deformed triangles 
triangle treated plane solving contact forces 
plane equation triangle written terms vertices derivatives needed section computed terms derivatives dr ta dr ta dr ta 
contact surfaces remain planar contact geometry restriction finitely contact points issue 
order case non penetration constraint formulated terms finitely constraints dimensional contact regions result 
results simulation displayed actual deformed shape body polyhedral approximation dynamics computations visual anomalies occur 
discretization polyhedral mesh low compared curvature body bodies may appear inter penetrate somewhat 
fairly coarse mesh produces quite reasonable results second order deformations 
presumably higher order deformations require finer meshes avoid visual artifacts 
shows deformed rectangular block display purposes block meshed sufficiently appear smooth curved surface 
simulation purposes deformed block subdivided cubic mesh exterior square face split triangles total triangles 
sufficient remove suggestion inter penetration entire simulation 

demonstrated new technique simulating flexible bodies subject non penetration constraints 
implemented second order polynomial deformable bodies 
second order deformations requires polyhedral approximation collision detection purposes 
model unifies previous deformable bodies non penetration constraints friction 
research cornell university supported part bell laboratories phd fellowship nsf 
research carnegie mellon university supported part apple computer simulations performed equipment generously donated hewlett packard digital equipment 
gene baraff helpful conversations concerning variational principles 
baraff 
analytical methods dynamic simulation rigid bodies 
computer graphics proc 
sig graph volume pages 
acm july 
baraff 
curved surfaces coherence non penetrating rigid body simulation 
computer graphics proc 
sig graph volume pages 
acm august 
baraff 
dynamic simulation non penetrating rigid bodies 
phd thesis cornell university may 
dennis jr schnabel 
numerical methods unconstrained optimization nonlinear equations 
prentice hall 
lanczos 
variational principles mechanics 
dover publications 
pentland williams 
vibrations modal dynamics graphics animation 
computer graphics proc 
siggraph volume pages 
acm july 
press flannery teukolsky vetterling 
numerical recipes 
cambridge university press 
terzopoulos fleischer 
modeling inelastic deformation plasticity fracture 
computer graphics proc 
siggraph volume pages 
acm august 
witkin welch 
fast animation control nonrigid structures 
computer graphics proc 
siggraph volume pages 
acm august 
quadratically deformable block falling stairs 
