network working group ramakrishnan request comments networks updates floyd aciri category standards track black emc september addition explicit congestion notification ecn ip status memo document specifies internet standards track protocol internet community requests discussion suggestions improvements 
please refer current edition internet official protocol standards std standardization state status protocol 
distribution memo unlimited 
copyright notice copyright internet society 
rights reserved 
memo specifies incorporation ecn explicit congestion notification tcp ip including ecn bits ip header 
table contents 


conventions acronyms 

assumptions general principles 

active queue management aqm 

explicit congestion notification ip 

ecn indication persistent congestion 

dropped corrupted packets 

fragmentation 

support transport protocol 

tcp 
tcp initialization 

issues 

robust tcp initialization echoed reserved field 

tcp sender 

tcp receiver 

congestion ack path 

retransmitted tcp packets 
ramakrishnan standards track page rfc addition ecn ip september 
tcp window probes 

non compliance nodes 

non compliance network 

complications introduced split paths 

encapsulated packets 

ip packets encapsulated ip 

limited functionality full functionality options 

changes ecn field ip tunnel 

ipsec tunnels 

negotiation tunnel endpoints 

ecn tunnel security association database field 

ecn tunnel security association attribute 

changes ipsec tunnel header processing 

changes ecn field ipsec tunnel 

comments ipsec support 

ip packets encapsulated non ip packet headers 

issues raised monitoring policing devices 

evaluations ecn 

related evaluating ecn 

discussion ecn nonce 

incremental deployment ect routers 

summary changes required ip tcp 







security considerations 

ipv header checksum recalculation 

possible changes ecn field network 

possible changes ip header 

erasing congestion indication 

falsely reporting congestion 

disabling ecn capability 

falsely indicating ecn capability 

information carried transport header 

split paths 

implications subverting congestion control 

implications network competing flows 

implications subverted flow 

non ecn methods subverting congestion control 

motivation ect 

motivation ect codepoint 

motivation ect 

bits ip header 

historical definitions ipv tos octet 

iana considerations 

ipv tos byte ipv traffic class octet 

tcp header flags 
ramakrishnan standards track page rfc addition ecn ip september 
ipsec security association attributes 

authors addresses 

full copyright statement 

describing tcp packet drops indication congestion 
explain addition active queue management red internet infrastructure routers detect congestion queue overflows routers longer limited packet drops indication congestion 
routers set congestion experienced ce codepoint ip header packets ecn capable transports 
describe ce codepoint set routers describe modifications needed tcp ecn capable 
modifications transport protocols unreliable unicast multicast reliable multicast reliable unicast transport protocols considered protocols developed advance standards process 
describe document issues involving ecn ip tunnels ipsec tunnels particular 
guiding principles document extent possible mechanisms specified incrementally deployable 
challenge principle incremental deployment prior existence ip tunnels compatible ecn 
ecn deployed ip tunnels upgraded conform document 
document rfc proposal add explicit congestion notification ecn ip defined ecn experimental protocol internet community 
document updates rfc definition differentiated services field ds field ipv ipv headers defining ecn field ip header rfc security architecture internet protocol change handling ipv tos byte ipv traffic class octet tunnel mode header construction compatible ecn rfc transmission control protocol defining new flags tcp header 
tcp congestion control avoidance algorithms notion network black box jacobson jacobson 
network state congestion determined endsystems probing network state gradually increasing load network increasing window packets outstanding network network congested packet lost 
treating network black box treating ramakrishnan standards track page rfc addition ecn ip september loss indication congestion network appropriate pure best effort data carried tcp little sensitivity delay loss individual packets 
addition tcp congestion management algorithms techniques built fast retransmit fast recovery minimize impact losses throughput perspective 
mechanisms intended help applications fact sensitive delay loss individual packets 
interactive traffic telnet web browsing transfer audio video data sensitive packet losses especially unreliable data delivery transport udp increased latency packet caused need retransmit packet loss reliable data delivery semantics provided tcp 
tcp determines appropriate congestion window gradually increasing window size experiences dropped packet causes queues bottleneck router build 
packet drop policies router sensitive load placed individual flow tail drop queue overflow means packets latency sensitive flows may dropped 
addition drop policies lead synchronization loss multiple flows 
active queue management mechanisms detect congestion queue overflows provide indication congestion nodes 
active queue management reduce unnecessary queuing delay traffic sharing queue 
advantages active queue management discussed rfc rfc 
active queue management avoids bad properties dropping queue overflow including undesirable synchronization loss multiple flows 
importantly active queue management means transport protocols mechanisms congestion control tcp rely buffer overflow indication congestion 
active queue management mechanisms may methods indicating congestion nodes 
packet drops currently done 
active queue management allows router separate policies queuing dropping packets policies indicating congestion 
active queue management allows routers congestion experienced ce codepoint packet header indication congestion relying solely packet drops 
potential reducing impact loss latency sensitive flows 
ramakrishnan standards track page rfc addition ecn ip september exist middleboxes firewalls load intrusion detection systems internet drop tcp syn packet configured negotiate ecn respond rst 
document specifies procedures tcp implementations may provide robust connectivity presence equipment 

conventions acronyms keywords required shall shall recommended may optional appear document interpreted described rfc 

assumptions general principles section describe important design principles assumptions guided design choices proposal 
ecn adopted gradually accommodating migration essential 
routers may drop packets indicate congestion systems may 
viable strategy accommodates incremental deployment having resort islands ecn capable non ecn capable environments 
new mechanisms congestion control avoidance need coexist cooperate existing mechanisms congestion control 
particular new mechanisms exist tcp current methods adapting congestion routers current practice dropping packets periods congestion 
congestion may persist different time scales 
time scales concerned congestion events may longer round trip time 
number packets individual flow tcp connection exchange udp may range small number packets quite large number 
interested managing congestion caused flows send packets active network feedback reaches 
asymmetric routing normal occurrence internet 
path sequence links routers followed data packets may different path followed acknowledgment packets reverse direction 
ramakrishnan standards track page rfc addition ecn ip september routers process regular headers ip packets efficiently process header information ip options 
suggests keeping congestion experienced information regular headers ip packet 
recognized systems cooperate mechanisms congestion control 
new mechanisms shouldn easier tcp applications disable tcp congestion control 
benefit lying participating new mechanisms ecn capability small 

active queue management aqm random early detection red mechanism active queue management aqm proposed detect incipient congestion fj currently deployed internet rfc 
aqm meant general mechanism alternatives congestion indication absence ecn aqm restricted packet drops mechanism congestion indication 
aqm drops packets average queue length exceeding threshold queue overflows 
aqm may drop packets queue overflows aqm forced memory limitations discard packet 
aqm set congestion experienced ce codepoint packet header dropping packet field provided ip header understood transport protocol 
ce codepoint ecn allows receiver receive packet avoiding potential excessive delays due retransmissions packet losses 
term ce packet denote packet ce codepoint set 

explicit congestion notification ip document specifies internet provide congestion indication incipient congestion red earlier rj notification marking packets dropping 
uses ecn field ip header bits making ecn 
ecn capable transport ect set data sender indicate points transport protocol ecn capable call ect ect respectively 
phrase ect codepoint documents refers ect 
routers treat ect ect equivalent 
senders free ect ect codepoint indicate ect packet packet basis 
ramakrishnan standards track page rfc addition ecn ip september ect ect ect motivated primarily desire allow mechanisms data sender verify network elements erasing ce codepoint data receivers properly reporting sender receipt packets ce codepoint set required transport protocol 
guidelines senders receivers differentiate ect ect addressed separate documents transport protocol 
particular document address mechanisms tcp differentiate ect ect 
protocols senders require single ect codepoint ect 
ect codepoint indicates packet ecn 
ce codepoint set router indicate congestion nodes 
routers packet arriving full queue drop packet just absence ecn 
ecn field ect ce obsolete rfc names ecn bits 
ect ect ect ce ecn field ip 
ect essentially gives bit ecn nonce packet headers routers necessarily erase nonce set ce codepoint 
example routers erased ce codepoint face additional difficulty reconstructing original nonce repeated erasure ce codepoint detected nodes 
ecn nonce address problem misbehaving transport receivers lying transport sender ce codepoint set packet 
motivations ect discussed detail section discussion alternate possibilities fourth ect codepoint codepoint 
backwards compatibility earlier ecn implementations understand ect codepoint discussed section 
rfc rfc ecn field divided ecn capable transport ect bit ce bit 
ecn field ecn capable transport ect bit set rfc corresponds ect codepoint document ecn field ramakrishnan standards track page rfc addition ecn ip september ect ce bit rfc corresponds ce codepoint document 
codepoint left undefined rfc reason recommending ect single ect codepoint needed 
ds field ecn field differentiated services codepoint ecn explicit congestion notification differentiated services ecn fields ip 
bits ipv tos octet designated ecn field 
ipv tos octet corresponds traffic class octet ipv ecn field defined identically cases 
definitions ipv tos octet rfc ipv traffic class octet superseded bit ds differentiated services field rfc rfc 
bits listed rfc currently unused specified rfc approved experimental ecn 
section gives brief history tos octet 
unstable history tos octet ecn field specified document guaranteed backwards compatible past uses bits pre date ecn 
potential dangers lack backwards compatibility discussed section 
receipt ecn capable transport single ce packet congestion control algorithms followed systems essentially congestion control response single dropped packet 
example ecn capable tcp source tcp required halve congestion window window data containing packet drop ecn indication 
reason requiring congestion control response ce packet essentially response dropped packet accommodate incremental deployment ecn endsystems routers 
routers may drop ecn capable packets aqm policies congestion detection routers set ce codepoint equivalent levels congestion 
similarly router drop non ecn capable packet set ce codepoint ecn capable packet equivalent ramakrishnan standards track page rfc addition ecn ip september levels congestion 
different congestion control responses ce codepoint packet drop result unfair treatment different flows 
additional goal systems react congestion window data round trip time avoid reacting multiple times multiple indications congestion round trip time 
router ce codepoint ecn capable packet set router dropped packet indication congestion nodes 
router buffer full router prepared drop packet inform nodes incipient congestion router check see ect codepoint set packet ip header 
dropping packet router may set ce codepoint ip header 
environment nodes ecn capable allow new criteria developed setting ce codepoint new congestion control mechanisms node reaction ce packets 
research issue addressed document 
ce packet packet ce codepoint set received router ce codepoint left unchanged packet transmitted usual 
severe congestion occurred router queue full router choice drop packet new packet arrives 
anticipate packet losses relatively infrequent majority systems ecn capable participate tcp compatible congestion control mechanisms 
ecn capable environment adequately provisioned packet losses occur primarily transients presence sources 
discussion ce may set dropping packet applies default differentiated services hop behaviors rfc 
specifications may provide specifics compliant implementation choose setting ce dropping packet required 
router set ce dropping packet drop occur caused reasons congestion desire indicate incipient congestion nodes diffserv edge node may configured unconditionally drop certain classes traffic prevent entering diffserv domain 
ramakrishnan standards track page rfc addition ecn ip september expect routers set ce codepoint response incipient congestion indicated average queue size red algorithms suggested fj rfc 
best knowledge proposal currently discussion ietf routers drop packets proactively buffer overflows 
document attempt specify particular mechanism active queue management leaving endeavor needed areas ietf 
ecn inextricably tied need reasonable active queue management mechanism router reverse hold active queue management mechanisms developed deployed independent ecn packet drops indications congestion absence ecn ip architecture 

ecn indication persistent congestion emphasize single packet ce codepoint set ip packet causes transport layer respond terms congestion control packet drop 
instantaneous queue size see considerable variations router experience persistent congestion 
important transient congestion router reflected instantaneous queue size reaching threshold smaller capacity queue trigger reaction transport layer 
ce codepoint set router instantaneous queue size 
example atm frame relay mechanisms congestion indication typically defined associated notion average queue size basis determining intermediate node congested believe provide noisy signal 
tcp sender reaction specified document ecn appropriate reaction noisy signal congestion notification 
routers interface atm network way maintaining average queue interface come reliable determination atm subnet congested may ecn notification defined 
continue encourage experiments techniques layer atm switches frame relay switches take advantage ecn 
example scheme red packet marking average queue length exceeding threshold layer devices provide reasonably reliable indication congestion 
layer devices path set layer congestion experienced codepoint bit atm bit frame relay reliable manner interface router layer network copy state layer ramakrishnan standards track page rfc addition ecn ip september congestion experienced codepoint ce codepoint ip header 
recognize current practice current standards 
encouraging experimentation manner may provide information needed enable evolution existing layer mechanisms provide reliable means congestion indication single bit indicating congestion 

dropped corrupted packets proposed ecn document transport protocol tcp dropped data packet indication congestion nodes detect dropped data packets congestion response nodes dropped data packet strong congestion response received ce packet 
ensure reliable delivery congestion indication ce codepoint ect codepoint set packet loss packet network detected nodes interpreted indication congestion 
transport protocols tcp necessarily detect packet drops drop pure ack packet example tcp reduce arrival rate subsequent ack packets response earlier dropped ack packet 
proposal extending packets address issues case ack packet marked ce codepoint dropped network 
believe aspect subject research document specifies time pure ack packets indicate ecn capability 
similarly ce packet dropped network due corruption bit errors nodes invoke congestion control just tcp today response dropped data packet 
issue corrupted ce packets considered proposal network distinguish packets dropped due corruption packets dropped due congestion buffer overflow 
particular ubiquitous deployment ecn sufficient development allow nodes interpret packet drops indications corruption congestion 

fragmentation ecn capable packets may df don fragment bit set 
reassembly fragmented packet lose indications congestion 
words fragment ip packet reassembled ce codepoint set actions taken ramakrishnan standards track page rfc addition ecn ip september set ce codepoint reassembled packet 
occur fragments contributing reassembly carries ect codepoint 
packet dropped reassembled reason 
actions applicable may chosen 
reassembly fragmented packet change ecn codepoint fragments carry codepoint 
note rfc specify reassembly behavior older ecn implementations conformant experimental rfc necessarily perform reassembly correctly terms preserving ce codepoint fragment 
sender avoid consequences behavior setting df bit packets 
situations may arise reassembly specification insufficiently precise 
example malicious broken entity path fragmentation point packet fragments carry mixture ect ect ect 
reassembly specification place requirements reassembly fragments case 
situations precise reassembly behavior required protocol specifications specify df set ecn capable packets sent protocol 

support transport protocol ecn requires support transport protocol addition functionality ecn field ip packet header 
transport protocol require negotiation endpoints setup determine endpoints ecn capable sender set ect codepoint transmitted packets 
second transport protocol capable reacting appropriately receipt ce packets 
reaction form data receiver informing data sender received ce packet tcp data receiver layered multicast group rlm action ultimately reduces arrival rate flow congested link 
ce packets indicate persistent transient congestion see section reactions receipt ce packets appropriate persistent congestion 
document addresses addition ecn capability tcp leaving issues ecn transport protocols research 
tcp ecn requires new pieces functionality ramakrishnan standards track page rfc addition ecn ip september negotiation endpoints connection setup determine ecn capable ecn echo ece flag tcp header data receiver inform data sender ce packet received congestion window reduced cwr flag tcp header data sender inform data receiver congestion window reduced 
support required transport protocols different particularly unreliable reliable multicast transport protocols determined transport protocols brought ietf standardization 
mild abuse terminology document refer tcp packets tcp segments 

tcp sections describe detail proposed ecn tcp 
proposal described essentially form floyd 
assume source tcp uses standard congestion control algorithms slow start fast retransmit fast recovery rfc 
proposal specifies new flags reserved field tcp header 
tcp mechanism negotiating ecn capability uses ecn echo ece flag tcp header 
bit reserved field tcp header designated ecn echo flag 
location bit reserved field tcp header shown rfc rfc reproduced completeness 
specification ecn field leaves reserved field bit field bits 
enable tcp receiver determine setting ecn echo flag introduce second new flag tcp header cwr flag 
cwr flag assigned bit reserved field tcp header 
header length reserved old definition bytes tcp header 
ramakrishnan standards track page rfc addition ecn ip september header length reserved new definition bytes tcp header 
ecn uses ect ce flags ip header shown signaling routers connection endpoints uses ecn echo cwr flags tcp header shown tcp endpoint tcp endpoint signaling 
tcp connection typical sequence events ecn reaction congestion follows ect codepoint set packets transmitted sender indicate ecn supported transport entities packets 
ecn capable router detects impending congestion detects ect codepoint set packet drop 
dropping packet router chooses set ce codepoint ip header forwards packet 
receiver receives packet ce codepoint set sets ecn echo flag tcp ack sent sender 
sender receives tcp ack ecn echo set reacts congestion packet dropped 
sender sets cwr flag tcp header packet sent receiver acknowledge receipt reaction ecn echo flag 
negotiation ecn tcp transport entities ecn echo cwr flags described detail sections 
tcp initialization tcp connection setup phase source destination tcps exchange information willingness ecn 
subsequent completion negotiation tcp sender sets ect codepoint ip header data packets indicate network transport capable willing participate ecn packet 
indicates routers may mark ramakrishnan standards track page rfc addition ecn ip september packet ce codepoint method congestion notification 
tcp connection wish ecn notification particular packet sending tcp sets ecn codepoint ect tcp receiver ignores ce codepoint received packet 
discussion designate initiating host host responding host host call syn packet ece cwr flags set ecn setup syn packet call syn packet ece cwr flags set non ecn setup syn packet 
similarly call syn ack packet ece flag set cwr flag set ecn setup syn ack packet call syn ack packet configuration ece cwr flags non ecn setup syn ack packet 
tcp connection ecn host sends ecn setup syn packet host sends ecn setup syn ack packet 
syn packet setting ece cwr ecn setup syn packet defined indication sending tcp ecn capable indication congestion response congestion 
precisely ecn setup syn packet indicates tcp implementation transmitting syn packet participate ecn sender receiver 
specifically receiver respond incoming data packets ce codepoint set ip header setting ece outgoing tcp ack packets 
sender respond incoming packets ece set reducing congestion window setting cwr appropriate 
ecn setup syn packet commit tcp sender setting ect codepoint packets may transmit 
commitment respond appropriately incoming packets ce codepoint set remains tcp sender transmission tcp connection sends syn packet ece cwr set 
host sends ecn setup syn ack packet sets ece flag cwr flag 
ecn setup syn ack packet defined indication tcp transmitting syn ack packet 
syn packet ecn setup syn ack packet commit tcp host setting ect codepoint transmitted packets 
rules apply sending ecn setup packets tcp connection tcp connection defined standard rules tcp connection establishment termination 
host received ecn setup syn packet may send ecn setup syn ack packet 
send ecn setup syn ack packet 
ramakrishnan standards track page rfc addition ecn ip september host set ect data packets sent ecn setup syn ecn setup syn ack packet received ecn setup syn ecn setup syn ack packet sent non ecn setup syn non ecn setup syn ack packet 
host received non ecn setup syn non ecn setup syn ack packet set ect data packets 
host sets ect codepoint data packet host correctly set clear cwr tcp bit subsequent packets connection 
host sent ecn setup syn ecn setup packet received non ecn setup syn non syn ack packet host receives tcp data packets ect ce set ip header host process packets specified connection 
host willing ecn tcp connection clear ece cwr flags non ecn setup syn syn ack packets sends indicate 
receivers correctly handle forms non ecn setup syn syn ack packets 
host set ect syn syn ack packets 
tcp client enters time wait state receiving fin ack transitions closed state timeout 
tcp implementations create new tcp connection receive syn packet time wait state 
tcp host enters time wait closed state ignore previous state negotiation ecn connection 

issues ecn introduces ecn echo cwr flags tcp header shown initialization 
exist faulty firewalls load intrusion detection systems internet drop ecn setup syn packet respond rst belief packet bits set signature port scanning tool service attack 
offending equipment identified web page fixes contains list non compliant products fixes posted vendors available 
web page lists web servers affected faulty equipment 
mention document warning community problem 
ramakrishnan standards track page rfc addition ecn ip september provide robust connectivity presence faulty equipment host receives rst response transmission ecn setup syn packet may resend syn cwr ece cleared 
result tcp connection established ecn 
host receives reply ecn setup syn normal syn retransmission timeout interval may resend syn subsequent syn retransmissions cwr ece cleared 
overcome normal packet loss results original syn lost originating host may retransmit ecn setup syn packets giving retransmitting syn cwr ece bits cleared 
note case example scenario possible host sends ecn setup syn 
host sends ecn setup syn ack packet dropped delayed 
host sends non ecn setup syn 
host sends non ecn setup syn ack 
note case procedures host host may set ect bit data packets 
important consequence rules ecn setup usage section host forbidden reception ect data packets implicit signal host 

robust tcp initialization echoed reserved field question chose tcp sending syn set ecn related flags reserved field tcp header syn packet responding tcp sending syn ack sets ecn related flag syn ack packet 
asymmetry necessary robust negotiation ecn capability deployed tcp implementations 
exists faulty tcp implementation tcp receivers set reserved field tcp header ack packets syn ack simply reflect reserved field tcp header received data packet 
tcp syn packet sets ecn echo cwr flags indicate ecn capability syn ack packet sets flag sending tcp correctly interprets receiver reflection flags reserved field indication receiver ecn capable 
sending tcp mislead faulty tcp implementation sending syn ack packet simply reflects reserved field incoming syn packet 
ramakrishnan standards track page rfc addition ecn ip september 
tcp sender tcp connection ecn new data packets transmitted ect codepoint set ip header 
ect codepoint needed sender packets sent tcp connection ect 
sender receives ecn echo ece ack packet ack packet ecn echo flag set tcp header sender knows congestion encountered network path sender receiver 
indication congestion treated just congestion loss capable tcp 
tcp source halves congestion window cwnd reduces slow start threshold ssthresh 
sending tcp increase congestion window response receipt ecn echo ack packet 
tcp react congestion indications window data loosely round trip time 
tcp sender congestion window reduced response series dropped ce packets single window data 
addition tcp source decrease slow start threshold ssthresh decreased round trip time 
retransmitted packets dropped interpreted source tcp new instance congestion 
source tcp reduces congestion window response ce packet incoming acknowledgments continue arrive clock outgoing packets allowed reduced congestion window 
congestion window consists mss maximum segment size sending tcp receives ecn echo ack packet sending tcp principle reduce congestion window half 
value congestion window bounded value mss 
sending tcp continue send congestion window mss results transmission packet round trip time 
necessary reduce sending rate tcp sender receipt ecn echo packet congestion window 
retransmit timer means reducing rate circumstance 
sending tcp reset retransmit timer receiving ecn echo packet congestion window 
sending tcp able send new packet retransmit timer expires 
ecn capable tcp sender reduces congestion window reason retransmit timeout fast retransmit response ecn notification tcp sender sets cwr flag tcp header new data packet sent window reduction 
data packet dropped network ramakrishnan standards track page rfc addition ecn ip september sending tcp reduce congestion window retransmit dropped packet 
ensure congestion window reduced information reliably delivered tcp receiver 
comes fact new data packet carrying cwr flag dropped tcp sender reduce congestion window send new data packet cwr flag set 
cwr bit tcp header set retransmitted packets 
tcp data sender ready set cwr bit reducing congestion window set cwr bit new data packet transmits 
floyd discusses tcp response ecn detail 
floyd discusses validation test ns simulator illustrates wide range ecn scenarios 
scenarios include ecn followed ecn fast retransmit retransmit timeout retransmit timeout fast retransmit followed ecn congestion window packet followed ecn 
tcp follows existing algorithms sending data packets response incoming acks multiple duplicate acknowledgments retransmit timeouts rfc 
tcp follows normal procedures increasing congestion window receives ack packets ecn echo bit set rfc 

tcp receiver tcp receives ce data packet destination system tcp data receiver sets ecn echo flag tcp header subsequent ack packet 
ack withholding implemented current delayed ack tcp implementations tcp receiver send ack arriving data packets ecn echo flag ack packet set ce codepoint set data packets acknowledged 
received data packets ce packets returning ack ecn echo flag set 
provide robustness possibility dropped ack packet carrying ecn echo flag tcp receiver sets ecn echo flag series ack packets sent subsequently 
tcp receiver uses cwr flag received tcp sender determine setting ecn echo flag 
tcp receiver sends ack packet ecn echo bit set tcp receiver continues set ecn echo flag ack packets sends acknowledge ce data packets non ce ramakrishnan standards track page rfc addition ecn ip september data packets receives cwr packet packet cwr flag set 
receipt cwr packet acknowledgments subsequent non ce data packets ecn echo flag set 
ce packet received data receiver receiver send ack packets ecn echo flag set 
receipt cwr packet guarantee data sender received ecn echo message suggest data sender reduced congestion window point sent data packet ce codepoint set 
specified tcp sender required reduce congestion window window data 
care required tcp sender avoid unnecessary reductions congestion window window data includes dropped packets marked ce packets 
illustrated floyd 

congestion ack path current generation tcp congestion control algorithms pure packets packets contain accompanying data sent ect codepoint 
current tcp receivers mechanisms reducing traffic ack path response congestion notification 
mechanisms responding congestion ack path areas current research 
simple possibility sender reduce congestion window receives pure ack packet ce codepoint set 
current tcp implementations single dropped ack generally small effect tcp sending rate 

retransmitted tcp packets document specifies ecn capable tcp implementations set ect codepoint ect ect ip header retransmitted data packets tcp data receiver ignore ecn field arriving data packets outside receiver current window 
greater security denial service attacks robustness ecn congestion indication packets dropped network 
note tcp sender set ect codepoint retransmitted packet unnecessarily retransmitted packet dropped network nodes receive indication congestion router setting ce codepoint 
setting ect codepoint retransmitted data packets consistent robust delivery congestion indication packets dropped network 
ramakrishnan standards track page rfc addition ecn ip september addition attacker capable spoofing ip source address tcp sender send data packets arbitrary sequence numbers ce codepoint set ip header 
receiving spoofed data packet tcp data receiver determine data lie current receive window return duplicate 
define window packet tcp data receiver data packet lies outside receiver current window 
receiving window packet tcp data receiver decide treat ce codepoint packet header valid indication congestion return ecn echo indications tcp data sender 
tcp data receiver ignored ce codepoint window packet tcp data sender receive indication congestion network resulting violation congestion control 
hand tcp data receiver honors ce indication window packet reports indication congestion tcp data sender malicious node created spoofed packet successfully attacked tcp connection forcing data sender unnecessarily reduce halve congestion window 
prevent denial service attack specify legitimate tcp data sender set ect codepoint retransmitted data packets tcp data receiver ignore ce codepoint window packets 
drawback setting ect ect retransmitted packets denies ecn protection retransmitted packets 
ecn capable tcp connection fully ecn capable environment mild congestion packets rarely dropped due congestion place instances retransmitted packets rarely arise 
packets retransmitted packet losses corruption congestion ecn unable prevent 
note router sets ce codepoint ecn capable data packet tcp connection tcp connection guaranteed receive indication congestion receive indication congestion window data packet dropped reordered network 
consider cases packet retransmitted packet retransmitted 
case packet dropped delayed point retransmitted data sender retransmission result fast retransmit retransmit timeout packet prior packet window data 
case data sender retransmitted packet know data sender responded ramakrishnan standards track page rfc addition ecn ip september indication congestion packet window data original packet 
transmission packet dropped network delayed ce codepoint set ignored data receiver outof window packet problem sender responded indication congestion window data 
second case packet retransmitted data sender data packet copy data received data receiver arrives data receiver window packet regardless packet delayed reordered 
case ce codepoint set packet network treated data receiver valid indication congestion 

tcp window probes 
tcp data receiver advertises zero window tcp data sender sends window probes determine receiver window increased 
window probe packets contain user data sequence number byte 
window probe packet dropped network loss detected receiver 
tcp data sender set ect codepoint cwr bit window probe packets 
window probes exact sequence numbers easily spoofed denial service attacks 
window probe arrives ce codepoint set receiver respond ecn indications 

non compliance nodes section discusses concerns vulnerability ecn non compliant nodes nodes set ect codepoint transmitted packets respond received ce packets 
argue addition ecn ip architecture significantly increase current vulnerability architecture unresponsive flows 
non ecn environments serious concerns damage done non compliant unresponsive flows flows respond congestion control indications reducing arrival rate congested link 
example node turn congestion control reducing congestion window response packet drops 
concern current internet 
argued routers deploy mechanisms detect differentially treat packets ramakrishnan standards track page rfc addition ecn ip september non compliant flows rfc ff 
suggested techniques flow scheduling isolation flow differentiated services reservations remove damaging effects unresponsive flows 
dropping packets adequate deterrent non compliance ecn removes deterrent 
argue response ecn capable routers preserve packet dropping behavior times high congestion times high congestion dropping packets adequate deterrent non compliance 
ecn capable routers mark packets opposed dropping packet marking rate reasonably low 
periods average queue size exceeds upper threshold potential packet marking rate high recommendation routers drop packets set ce codepoint packet headers 
periods low moderate packet marking rates ecn deployed little deterrent effect unresponsive flows dropping marking packets 
example delay insensitive flows reliable delivery incentive increase decrease sending rate presence dropped packets 
similarly delay sensitive flows unreliable delivery increase fec response increased packet drop rate increasing decreasing sending rate 
reasons believe packet dropping effective deterrent non compliance environment high packet drop rates flows sharing packet drop rate 
methods proposed identify restrict unresponsive flows 
addition ecn network environment way increase difficulty designing deploying mechanisms 
addition ecn architecture job identifying unresponsive flows slightly easier 
example ecn capable environment routers limited information packets dropped ce codepoint set router environment routers take note arriving ce packets indicate congestion encountered packet earlier path 
ramakrishnan standards track page rfc addition ecn ip september 
non compliance network section considers issues router operating possibly maliciously modify bits ecn field 
note ipv ip header protected bit errors header checksum case ipv 
ipv ecn field accidentally modified bit errors links routers detected ip header checksum 
tampering bits ecn field adversary broken router falsely report congestion disable ecn capability individual packet erase ecn congestion indication falsely indicate ecn capability 
section systematically examines various cases ecn field modified 
important criterion considered determining consequences modifications lead poorer behavior dimension throughput delay fairness functionality router drop packet 
possible changes falsely reporting congestion disabling ecn capability individual packet worse router simply drop packet 
congestion control point view setting ce codepoint absence congestion non compliant router worse router dropping packet unnecessarily 
erasing ect codepoint packet dropped network router actions result unnecessary packet drop packet network 
discussed section router erases ecn congestion indication falsely indicates ecn capability potentially damage flow simply dropped packet 
rogue broken router erased ce codepoint arriving ce packets prevent indication congestion reaching downstream receivers 
result failure congestion control flow resulting increase congestion network ultimately resulting subsequent packets dropped flow average queue size increased congested gateway 
section considers potential repercussions subverting endto congestion control falsely indicating erasing congestion indication ecn observe section consequence subverting ecn congestion control may lead potential unfairness worse subversion ecn packet congestion control nodes 
ramakrishnan standards track page rfc addition ecn ip september 
complications introduced split paths router network element access packets flow router damage flow altering ecn field simply dropping packets flow 
cases malicious broken router access subset packets flow 
question follows router altering ecn field subset packets damage flow simply dropped set packets 
discussed detail section concludes follows true adversary access subset packets aggregate subverting ecn congestion control able deny benefits ecn packets aggregate 
undesirable sufficient concern result disabling ecn 

encapsulated packets 
ip packets encapsulated ip encapsulation ip packet headers tunnels places including ipsec ip ip rfc 
section considers issues related interactions ecn ip tunnels specifies alternative solutions 
discussion complemented rfc discussion interactions differentiated services ip tunnels various forms rfc differentiated services uses remaining bits ip header octet ecn see section 
ip tunnel modes adding new outer ip header encapsulates original inner ip header associated packet 
cases new outer ip header may added removed intermediate points connection enabling network establish tunnel requiring endpoint participation 
denote tunnels specify outer header discarded tunnel egress simple tunnels 
ecn uses ecn field ip header signaling routers connection endpoints 
ecn interacts ip tunnels treatment ecn field ip header 
simple ip tunnels octet containing ecn field copied mapped inner ip header outer ip header ip tunnel ingress outer header copy field discarded ip tunnel egress 
outer header simply discarded care deal ecn field ecn capable router set ce ramakrishnan standards track page rfc addition ecn ip september congestion experienced codepoint packet simple ip tunnel indication discarded tunnel egress losing indication congestion 
ecn simple ip tunnels result routers attempting outer ip header signal congestion endpoints congestion warnings arriving outer header discarded tunnel egress point 
problem encountered ecn ipsec tunnel mode rfc recommended ecn older simple ipsec tunnels order avoid behavior consequences 
ecn widely deployed simple tunnels carry traffic changed 
ecn capable traffic carried simple tunnel congested ecn capable router result subsequent packets dropped flow average queue size increases congested router discussed section 
security point view ecn outer header ip tunnel raise security concerns adversary tamper ecn information propagates tunnel endpoint 
analysis sections concerns resultant risks approach support ecn option ip tunnels ip tunnel specified configured ecn ecn outer header tunnel 
environments tunneling protocols risks ecn judged outweigh benefits tunnel simply ecn outer header 
indication congestion experienced routers tunnel packet loss 
result viable options behavior ecn capable connections ip tunnel including ipsec tunnels limited functionality option ecn preserved inner header disabled outer header 
mechanism available signaling congestion occurring tunnel case dropped packets 
full functionality option supports ecn inner outer headers propagates congestion warnings nodes tunnel endpoints 
support options requires varying amounts changes ip header processing tunnel ingress egress 
small subset changes sufficient support limited functionality option sufficient eliminate incompatibility ecn ip tunnels 
ramakrishnan standards track page rfc addition ecn ip september goal document give guidance tradeoffs limited functionality full functionality options 
full discussion potential effects adversary modifications ecn field sections 

limited functionality full functionality options limited functionality option ecn encapsulation ip tunnels ect codepoint set outside encapsulating header regardless value ecn field inside encapsulated header 
option ecn field inner header altered de 
disadvantage approach flow ecn support part path ip tunneling encapsulated packet original tcp sender ecn capable 
encapsulated packet arrives congested router router decide drop mark packet indication congestion nodes router permitted set ce codepoint packet header drop packet 
full functionality option ecn encapsulation copy ecn codepoint inside header outside header encapsulation inside header ect ect set ecn codepoint outside header ect ecn codepoint inside header ce 
ce codepoint set outside header ce codepoint set inner header 
ecn codepoint inner header left unchanged 
full ecn support encapsulation processing involves tunnel ingress full functionality option sets ecn codepoint outer header 
ecn codepoint inner header ect ect copied ecn codepoint outer header 
ecn codepoint inner header ce ecn codepoint outer header set ect 
tunnel egress full functionality option sets ce codepoint inner header ce codepoint set outer header 
change field inner header 
full functionality option flow take advantage ecn parts path ip tunneling 
disadvantage full functionality option security perspective ip tunnel protect flow certain modifications ecn bits ip header tunnel 
potential dangers modifications ecn bits ip header described detail sections 
ramakrishnan standards track page rfc addition ecn ip september ip tunnel modify handling ds field octet ip tunnel endpoints implementing full functionality option 
optionally ip tunnel may enable endpoints ip tunnel negotiate choice limited functionality full functionality option ecn tunnel 
minimum required ecn usable ip tunnels limited functionality option prevents ecn enabled outer header tunnel 
full support ecn requires full functionality option 
optional mechanisms tunnel endpoints negotiate choice limited functionality full functionality option pre existing agreement tunnel endpoints support limited functionality full functionality ecn option 
ip tunnels implement limited functionality option support full functionality option 
addition recommended packets ce codepoint outer header dropped arrive tunnel egress point tunnel uses limited functionality option tunnel uses full functionality option ect codepoint set inner header 
motivated backwards compatibility ensure unauthorized modifications ecn field take place discussed section 

changes ecn field ip tunnel 
presence copy ecn field inner header ip tunnel mode packet provides opportunity detection unauthorized modifications ecn field outer header 
comparison ect fields inner outer headers falls categories implementations conform document ip tunnel uses full functionality option ect codepoint set outer header set inner header 
tunnel uses limited functionality option ect codepoint set outer header 
receipt packet satisfying appropriate condition cause concern 
ramakrishnan standards track page rfc addition ecn ip september consider case ip tunnel tunnel ingress point updated document requirements tunnel egress point updated support ecn 
case ip tunnel explicitly configured support full functionality ecn option 
tunnel ingress point behaving identically tunnel ingress point supports full functionality option 
packets ecn capable connection tunnel ect codepoint set outer header tunnel ingress point 
congestion tunnel may result routers setting ce outer header 
tunnel explicitly configured support full functionality option tunnel egress point expects ect codepoint set outer header 
ecn capable tunnel egress point receives packet ect ce codepoint outer header tunnel configured support option packet processed ce codepoint set follows 
recommended tunnel configured support option packets dropped egress point ce codepoint set outer header inner header forwarded 
ip tunnel provide protection erasure congestion indications changing ecn codepoint ce ect 
erasure congestion indications may impact network flows ways possible absence ecn 
important note erasure congestion indications performed congestion indications placed nodes tunnel copy ecn field inner header preserves congestion notifications nodes upstream tunnel ingress inner header erased 
erasure congestion notifications judged security risk exceeds congestion management benefits ecn tunnels specified configured limited functionality option 

ipsec tunnels ipsec supports secure communication potentially insecure network components intermediate routers 
ipsec protocols support operating modes transport mode tunnel mode span wide range security requirements operating environments 
transport mode security protocol header inserted ip ipv ipv header higher layer protocol headers tcp transport mode security connection 
ipsec tunnel mode adding new outer ip header encapsulates original inner ip header associated packet 
tunnel mode security headers inserted ip headers 
contrast transport mode new outer ramakrishnan standards track page rfc addition ecn ip september ip header tunnel mode security headers added removed intermediate points connection enabling security gateways secure vulnerable portions connection requiring endpoint participation security protocols 
important aspect tunnel mode security original specification outer header discarded tunnel egress ensuring security threats modifying ip header propagate tunnel endpoint 
discussion ipsec rfc 
ipsec protocol originally defined esp ah required inner header ecn field changed ipsec processing tunnel egress node ruled possibility full functionality mode ecn 
time ensure adversary modifications ecn field launch theft denial service attacks ipsec tunnel endpoint modifications discarded tunnel endpoint 
principle permitting ecn functionality outer header ipsec tunnel raises security concerns adversary tamper information propagates tunnel endpoint 
analysis included sections concerns associated risks approach provide configuration support ipsec changes remove conflict ecn 
particular tunnel mode ipsec tunnel support limited functionality option outlined section support full functionality option outlined section 
permission ecn functionality outer header ipsec tunnel configurable part corresponding ipsec security association sa disabled situations risks judged outweigh benefits 
result ipsec security administrator alternatives behavior ecn capable connections ipsec tunnel limited functionality alternative alternative described earlier 
addition document specifies endpoints ipsec tunnel negotiate enabling ecn functionality outer headers tunnel security policy 
ability negotiate ecn usage tunnel endpoints enable security administrator disable ecn situations believes risks lost congestion notifications outweigh benefits ecn 
ramakrishnan standards track page rfc addition ecn ip september ipsec protocol defined esp ah include ip header ecn field cryptographic calculations case tunnel mode outer ip header ecn field included 
modification ecn field network node effect ipsec security cause ipsec integrity check fail 
consequence ipsec provide defense adversary modification ecn field man middle attack adversary modification effect ipsec security 
environments ability modify ecn field affecting ipsec integrity checks may constitute covert channel necessary eliminate channel reduce bandwidth ipsec tunnel run limited functionality mode 

negotiation tunnel endpoints section describes detailed changes enable usage ecn ipsec tunnels including negotiation ecn support tunnel endpoints 
supported changes ipsec optional security association database sad field indicating tunnel encapsulation processing allows forbids ecn usage outer ip header 
optional security association attribute enables negotiation sad field endpoints sa supports tunnel mode 
changes tunnel mode encapsulation processing allow forbid ecn usage outer ip header value sad field 
ecn usage allowed outer ip header ect codepoint set outer header ecn capable connections congestion notifications indicated ce codepoint connections propagated inner header tunnel egress 
negotiation ecn usage implemented sad field implemented 
hand negotiation ecn usage optional cases implementations support sad field 
encapsulation processing changes required may implemented changes assuming ecn usage forbidden 
full functionality alternative ecn usage ipsec tunnels consists sad field full version encapsulation processing changes optional negotiation support 
limited functionality alternative consists subset encapsulation changes forbids ecn usage 
ramakrishnan standards track page rfc addition ecn ip september changes covered subsections 

ecn tunnel security association database field full ecn functionality adds new field sad see rfc ecn tunnel allowed forbidden 
indicates ecn capable connections sa tunnel mode permitted receive ecn congestion notifications congestion occurring tunnel 
allowed value enables ecn congestion notifications 
forbidden value disables notifications causing congestion indicated dropped packets 
optional 
value field assumed forbidden implementations support 
attribute implemented sa specification security policy database spd entry support corresponding attribute spd attribute covered spd administrative interface currently described section rfc 

ecn tunnel security association attribute new ipsec security association attribute defined enable support ecn congestion notifications outer ip header negotiated ipsec tunnels see rfc 
attribute optional implementations support support sad field defined section 
attribute type class value type ecn tunnel basic ipsec sa attribute value allocated iana indicate ecn tunnel sa attribute negotiated type attribute basic see section rfc 
class values conduct negotiation 
see rfc rfc rfc information including encoding formats requirements negotiating sa attribute 
ramakrishnan standards track page rfc addition ecn ip september class values ecn tunnel specifies ecn functionality allowed tunnel encapsulation mode 
affects tunnel encapsulation processing see section 
reserved allowed forbidden values reserved iana 
values private 
unspecified default shall assumed forbidden 
ecn tunnel new sa attribute initiators expect encounter responders understand reject proposals containing 
backwards compatibility implementations initiators include proposal ecn tunnel attribute enable responder select transform proposal contain ecn tunnel attribute 
rfc currently requires responders reject proposals proposal contains unknown attribute requirement expected changed require responder select proposals transforms containing unknown attributes 

changes ipsec tunnel header processing full ecn support encapsulation processing ipv tos field ipv traffic class field changed specified rfc outer hdr inner hdr ipv header fields ds field copied inner hdr change ecn field constructed constructed ipv header fields ds field copied inner hdr change ecn field constructed constructed ramakrishnan standards track page rfc addition ecn ip september packet immediately enter domain value outer header appropriate value mapped appropriate value domain rfc 
see rfc information 
value ecn tunnel field sad entry sa allowed ecn field inner header set value ce copy ecn field outer header 
ecn field inner header set ce set ecn field outer header ect 
value ecn tunnel field sad entry sa allowed ecn field inner header set ect ect ecn field outer header set ce copy ecn field outer header inner header 
change ecn field inner header 
identical match usage rfc different rfc 
description applies implementations support ecn tunnel field sad implementations implement processing processing ipv tos octet ipv traffic class octet defined rfc 
constitutes full functionality alternative ecn usage ipsec tunnels 
implementation support ecn tunnel field sad implement processing assuming value ecn tunnel field sad forbidden sa 
case processing ecn field reduces set ecn field ect outer header 
change ecn field inner header 
constitutes limited functionality alternative ecn usage ipsec tunnels 
backwards compatibility packets ce codepoint set outer header dropped arrive sa limited functionality option option ecn codepoint set inner header 
ramakrishnan standards track page rfc addition ecn ip september 
changes ecn field ipsec tunnel 
ecn field changed inappropriately ipsec tunnel change detected tunnel egress receipt packet satisfying appropriate condition sa event 
implementation may create audit records sa counts incorrect packets time period creating audit record erroneous packet 
audit record contain headers erroneous packet need contain headers packet represented entry 

comments ipsec support substantial comments received areas document review ipsec working group 
section describes comments explains proposed changes incorporated 
comment indicated node configuration easier implement sa configuration 
serious thought despite initial encouragement node configuration longer idea 
concern ecn awareness progressively deployed ipsec ecn aware ipsec implementations find communicating mixture ecn aware ecn unaware ipsec tunnel endpoints 
environment node configuration reasonable thing forbid ecn usage ipsec tunnels desired outcome 
second area reviewers noted sa negotiation complex adding non trivial 
reviewer suggested icmp tunnel setup possible alternative 
addition sa negotiation document optional remain implementers free ignore 
authors believe assurance provides useful number situations 
practice implemented deleted subsequent stage standards process 
extending icmp negotiate ecn tunnel setup complex extending sa attribute negotiation 
tunnels permit traffic addressed tunnel egress endpoint icmp packet addressed scanned egress endpoint discarded actual destination 
addition icmp delivery unreliable possibility icmp packet dropped entailing invention ack retransmit mechanism 
better simply specify optional extension existing sa negotiation mechanism 
ramakrishnan standards track page rfc addition ecn ip september 
ip packets encapsulated non ip packet headers 
different set issues raised relative ecn ip packets encapsulated tunnels non ip packet headers 
occurs mpls mpls gre gre tp tp 
protocols conflict ecn just ecn tunnel ecn codepoint specified header encapsulating protocol 
earlier considered preliminary proposal incorporating ecn mpls proposals incorporating ecn gre tp considered need arises 

issues raised monitoring policing devices possibility monitoring policing devices informally penalty boxes installed network monitor best effort flows appropriately responding congestion preferentially drop packets flows determined adequate congestion control procedures 
recommend penalty box detects flow aggregate flows responding congestion control change marking dropping packets flow additional action restrict bandwidth available flow 
initially router may drop packets router set ce codepoint 
include dropping arriving packets flow ecn capable ce codepoint set 
way congestion indications seen router flow guaranteed seen nodes presence malicious broken routers path 
assume action taken penalty box flow drop packets marking way adversary ecn congestion control cause flow characterized non cooperative placed severe action penalty box 
monitoring policing devices deployed fall short ideal monitoring device described monitoring applied single flow aggregate flows sharing single ipsec tunnel 
case switch marking dropping apply flows aggregate denying benefits ecn flows aggregate 
highest level aggregation form disabling ecn happens absence ramakrishnan standards track page rfc addition ecn ip september monitoring policing devices ecn capable red queues switch marking dropping packets indication congestion average queue size exceeded threshold 

evaluations ecn 
related evaluating ecn section discusses related evaluating ecn 
ecn web page ecn pointers papers implementations ecn 
floyd considers advantages drawbacks adding ecn tcp ip architecture 
shown simulation comparisons advantage ecn avoid unnecessary packet drops short delay sensitive tcp connections 
second advantage ecn avoiding unnecessary retransmit timeouts tcp 
discusses detail integration ecn tcp congestion control mechanisms 
possible disadvantages ecn discussed non compliant tcp connection falsely advertise ecn capable tcp ack packet carrying ecn echo message dropped network 
issues discussed appendix document second addressed addition cwr flag tcp header 
experimental evaluations ecn include rfc 
rfc ecn tcp gets moderately better throughput non ecn tcp ecn tcp flows fair non ecn tcp flows ecn tcp robust way traffic congestion directions multiple congested gateways 
experiments short web transfers show short connections similar transfer times ecn small percentage short connections long transfer times non ecn experiments compared ecn experiments 

discussion ecn nonce 
ect ect ect provide ecn nonce packet headers 
primary motivation desire allow mechanisms data sender verify network elements erasing ce codepoint data receivers properly reporting sender receipt packets ce codepoint set required transport protocol 
section discusses issues backwards compatibility ip ecn implementations routers conformant rfc ect codepoint defined 
believe ramakrishnan standards track page rfc addition ecn ip september incremental deployment ecn implementations understand ect codepoint cause significant operational problems 
particularly case deployment ect codepoint begins routers ect codepoint starts nodes 

incremental deployment ect routers 
ecn experimental standard january implementations ecn routers understand ect codepoint 
ect codepoint standardized tcp transport protocols mean data sender ect codepoint codepoint understood congested router path 
allowed transport protocol data sender free ect send ecn capable packets codepoint ect 
ecn capable sender ect congested router path understand ect codepoint router marking ect packets dropping ect packets indications congestion 
tcp required react marked dropped packets behavior dropping packets marked poses significant threat network consistent approach ecn allows routers determine mark packets see fit see section 

summary changes required ip tcp document specified bits ip header ecn 
ect codepoint indicates transport protocol ignore ce codepoint 
default value ecn codepoint 
ect indicate transport protocol willing able participate ecn 
router sets ce codepoint indicate congestion nodes 
ce codepoint packet header reset router 
tcp requires changes ecn setup phase new flags tcp header 
ecn echo flag data receiver inform data sender received ce packet 
congestion window reduced cwr flag data sender inform data receiver congestion window reduced 
ramakrishnan standards track page rfc addition ecn ip september ecn explicit congestion notification required congestion indications generated ip tunnel lost tunnel egress 
specified minor modification ip protocol handling ecn field encapsulation allow flows undergo ip tunneling ecn 
options ecn tunnels specified limited functionality option ecn inside ip tunnel setting ecn field outer header ect altering inner header time 
full functionality option sets ecn field outer header ect ect depending ecn field inner header 
ce codepoint set outer header inner header set ect ce codepoint copied inner header 
ipsec tunnels document defines optional ipsec security association sa attribute enables negotiation ecn usage ipsec tunnels optional field security association database indicate ecn permitted tunnel mode sa 
required changes ipsec tunnels ecn usage modify rfc rfc defines ipsec architecture specifies aspects implementation 
new ipsec sa attribute addition defined section rfc 
document rfc proposal add explicit congestion notification ecn ip defined ecn experimental protocol internet community 
rest section describes relationship document predecessor 
rfc included brief discussion ecn encapsulated packets noted ipsec specifications time january flows safely ecn traverse ipsec tunnels 
rfc described changes ipsec tunnel specifications compatible ecn 
document incorporates done rfc 
describe changes ipsec tunnels detail extensively discuss security implications ecn included sections document 
second extend discussion ipsec tunnels include ip tunnels 
older ip tunnels compatible flow ecn ramakrishnan standards track page rfc addition ecn ip september deployment ecn internet create strong pressure older ip tunnels updated ecn compatible version limited functionality full functionality option 
document address issue including ecn non ip tunnels mpls gre tp 
earlier preliminary document adding ecn support mpls advanced 
third new piece rfc describe ecn procedure retransmitted data packets ect codepoint set retransmitted data packets 
motivation additional specification eliminate possible avenue denial service attacks existing tcp connection 
prior deployments ecn capable tcp conform new requirement set ect codepoint retransmitted packets believe cause significant problems practice 
document expands slightly specification syn packets negotiation ecn 
prior deployments ecn capable tcp conform requirements specified document believe lead performance compatibility problems tcp connections combination tcp implementations endpoints 
document includes specification ect codepoint may tcp part implementation ecn nonce 

current effort implement aqm believe right time deploy congestion avoidance mechanisms depend packet drops 
increased deployment applications transports sensitive delay loss single packet realtime traffic short web transfers depending packet loss normal congestion notification mechanism appears insufficient nonoptimal examined consequence modifications ecn field network analyzing opportunities adversary change ecn field 
cases change ecn field worse dropping packet 
noted changes serious consequence subverting congestion control 
point potential damage limited similar threat posed systems intentionally failing cooperate congestion control 
ramakrishnan standards track page rfc addition ecn ip september 
people contributions document including managed directly acknowledge document 
addition cho proposal tcp mechanism negotiating ecn capability kevin fall proposal cwr bit steve blake material ipv header checksum recalculation salim discussions ecn issues steve bellovin jim bound brian carpenter paul ferguson stephen kent greg vern paxson discussions security issues 
internet research group ongoing discussions issues 
email discussions number people including dax salim venkat addressed issues raised non conformant equipment internet respond tcp syn packets ece cwr flags set 
mark handley padhye discussions tcp initialization procedures 
discussion ecn ip tunnel considerations draws heavily related discussions documents differentiated services working group 
bint feedback ip tunnels 
piper proposing modifications rfc improve usability negotiating ecn tunnel sa attribute 
david wetherall david ely neil spring proposal ecn nonce 
stefan savage discussions issue 
bob briscoe jon crowcroft raising issue fragmentation ip alternate semantics fourth ecn codepoint topics 
richard feedback issues document 
particular transport area directors years feedback standardization ecn 

ah kent atkinson ip authentication header rfc november 
ecn ecn web page url www aciri org floyd ecn html 
informational purposes 
ramakrishnan standards track page rfc addition ecn ip september esp kent atkinson ip encapsulating security payload rfc november 
fixes ecn linux unofficial vendor support page url org ecn 
informational purposes 
fj floyd jacobson random early detection gateways congestion avoidance ieee acm transactions networking august 
floyd floyd tcp explicit congestion notification acm computer communication review october 
floyd floyd ecn validation test ns simulator url www mash cs berkeley edu ns test tcl test test ecn 
informational purposes 
ff floyd fall promoting toend congestion control internet ieee acm transactions networking august 
fred lin morris dynamics random early detection sigcomm september 
gre hanks li farinacci traina generic routing encapsulation gre rfc october 
jacobson jacobson congestion avoidance control proc 
acm sigcomm pp 

jacobson jacobson modified tcp congestion avoidance algorithm message interest mailing list april 
url ftp ftp ee lbl gov email apr txt 
krishnan analyzing explicit congestion notification ecn benefits tcp master thesis ucla 
citation purposes 
tp valencia zorn layer tunneling protocol tp rfc august 
ramakrishnan standards track page rfc addition ecn ip september mccanne jacobson vetterli layered multicast sigcomm august pp 

mpls malcolm dell requirements traffic engineering mpls rfc september 
little zorn point point tunneling protocol rfc july 
rfc postel internet protocol std rfc september 
rfc postel transmission control protocol std rfc september 
rfc mallory incremental updating internet checksum rfc january 
rfc almquist type service internet protocol suite rfc july 
rfc physical link security type service rfc may 
rfc hanks li farinacci traina generic routing encapsulation gre rfc october 
rfc hanks li farinacci traina generic routing encapsulation ipv networks rfc october 
rfc perkins ip encapsulation ip rfc october 
rfc key words rfcs indicate requirement levels bcp rfc march 
rfc braden recommendations queue management congestion avoidance internet rfc april 
rfc kent atkinson security architecture internet protocol rfc november 
ramakrishnan standards track page rfc addition ecn ip september rfc piper internet ip security domain interpretation isakmp rfc november 
rfc schneider turner internet security association key management protocol isakmp rfc november 
rfc internet key exchange ike rfc november 
rfc nichols blake baker black definition differentiated services field ds field ipv ipv headers rfc december 
rfc blake black carlson davies wang weiss architecture differentiated services rfc december 
rfc ramakrishnan floyd proposal add explicit congestion notification ecn ip rfc january 
rfc paxson stevens tcp congestion control rfc april 
rfc salim ahmed performance evaluation explicit congestion notification ecn ip networks rfc july 
rfc black differentiated services tunnels rfc october 
rfc paxson iana allocation guidelines values internet protocol related headers bcp rfc march 
rj ramakrishnan raj jain binary feedback scheme congestion avoidance computer networks acm transactions computer systems vol pp 
may 
stefan savage neal cardwell david wetherall tom anderson tcp congestion control misbehaving receiver acm computer communications review october 
ramakrishnan standards track page rfc addition ecn ip september jitendra padhye sally floyd identifying tcp behavior web servers icsi tr february 
url www aciri org 

security considerations security considerations discussed sections 

ipv header checksum recalculation ipv header checksum recalculation issue high router architectures output buffered switch header manipulation performed input side switch ecn decision need local output buffer 
issue ipv ipv header checksum 
ipv tos octet byte bit half word 
rfc rfc discusses incremental updating ipv checksum ttl field decremented 
incremental updating ipv checksum ce codepoint set follows hc original header checksum ect packet hc new header checksum ce bit set 
ecn field changed 
header checksums calculated complement subtraction hc recalculated follows hc hc hc hc header checksums calculated complement machines hc recalculated follows ce bit set hc hc hc hc similar incremental updating ipv checksum carried ecn field changed ect ce 

possible changes ecn field network section discusses detail possible changes ecn field network falsely reporting congestion disabling individual packet erasing ecn congestion indication falsely indicating ecn capability 
ramakrishnan standards track page rfc addition ecn ip september 
possible changes ip header 
erasing congestion indication consider changes router result effectively erasing congestion indication set router upstream 
convention followed ecn codepoint received packet ecn codepoint packet transmitted 
replacing ce codepoint ect ect codepoint effectively erases congestion indication 
ect router erasing ce codepoint way know original ect codepoint ect ect 
possible transport protocol deploy mechanisms detect erasures ce codepoint 
consequence erasure ce codepoint upstream router potential congestion build time congestion indication reach source 
packet received acknowledged 
potential effect erasing congestion indication complex discussed depth section 
note effect erasing congestion indication different dropping packet network 
data packet dropped drop detected tcp sender interpreted indication congestion 
similarly sufficient number consecutive packets dropped causing cumulative field advanced sender sender limited congestion window sending additional packets ultimately retransmit timer expires 
contrast systematic erasure ce bit downstream router effect causing queue buildup upstream router including possible loss packets due buffer overflow 
potential unfairness flow goes congested router react ce bit set flow ce bit erased see better performance 
limitations potential unfairness discussed detail section 
changes replace ce codepoint ect codepoint erasing congestion indication disabling ecn capability time 
erasure congestion indication effective packet marked dropped downstream router 
ce codepoint replaced ect codepoint ramakrishnan standards track page rfc addition ecn ip september packet remains ecn capable marked dropped downstream router indication congestion 
ce codepoint replaced ect codepoint packet longer ecn capable dropped marked downstream router indication congestion 

falsely reporting congestion change set ce codepoint ect codepoint set congestion 
change affect treatment packet rest path 
particular router examine ce codepoint deciding drop mark arriving packet 
result application unnecessarily invoking congestion control reducing arrival rate 
worse application network tampering router dropped packet 

disabling ecn capability change turn ect codepoint packet 
means packet encounters congestion arriving red queue moderate average queue size dropped marked 
worse application tampering router dropped packet 
saving grace particular case congested router upstream expecting reaction setting ce bit 

falsely indicating ecn capability change incorrectly label packet ecn capable 
packet may sent ecn capable transport transport ecn capable 
packet encounters moderate congestion ecn capable router router set ce codepoint dropping packet 
transport protocol fact ecn capable transport receive indication congestion reduce sending rate response 
potential consequences falsely indicating ecn capability discussed section 
packet encounters congestion ecn capable router changes effect possibly interfering ecn nonce transport protocol 
change effect ramakrishnan standards track page rfc addition ecn ip september giving false reports congestion monitoring device path 
transport protocol ecn capable change effect transport level combining falsely indicating ecn capability falsely reporting congestion 
ecn capable transport cause transport unnecessarily react congestion 
particular case router incorrectly changing ecn field dropped packet 
case ecn capable transport consequence change ecn field worse dropping packet 

information carried transport header tcp ecn capable tcp receiver informs tcp peer ecn capable tcp level conveying information tcp header time connection setup 
document consider potential dangers introduced changes transport header network 
note ipsec transport header protected tunnel transport modes esp ah 
issue concerns tcp packets spoofed ip source address carrying invalid ecn information transport header 
completeness examine possible ways node spoofing ip source address node ecn flags tcp header launch denial service attack 
attacks require ability attacker valid tcp sequence numbers attacker ability ability spoof ip source addresses damage tcp connection ecn flags 
ecn add new vulnerabilities respect 
packet spoofed ip source address tcp data receiver include ece bit set 
accepted tcp data sender valid packet spoofed packet result tcp data sender unnecessarily halving congestion window 
accepted data sender spoofed packet correct bit sequence number valid number 
attacker successfully send spoofed packet send spoofed rst packet equally damaging operations tcp connection 
packets spoofed ip source address tcp data sender include cwr bit set 
accepted packet valid sequence number 
addition spoofed packet limited performance impact 
spoofing data packet cwr bit set result tcp data receiver ramakrishnan standards track page rfc addition ecn ip september sending fewer ece packets data receiver sending ece packets received spoofed cwr packet 

split paths cases malicious broken router access subset packets flow 
question follows router altering ecn field subset packets damage flow simply dropped set packets 
classify packets flow packets packets assume adversary access packets 
assume adversary subverting congestion control path traveled packets falsely indicating ecn capability upstream point congestion occurs erasing congestion indication downstream 
consider exists monitoring device sees packets punish packets total flow determined properly responding indications congestion 
key characteristic believe true monitoring device punishing flow drop packets setting ce codepoint drop arriving packets flow ce codepoint set 
nodes fact congestion control see indications congestion seen monitoring device respond indications congestion 
monitoring device successful providing indications flow early stage 
true adversary access packets subverting ecn congestion control able deny benefits ecn packets aggregate 
unfortunate reason disable ecn 
variant falsely reporting congestion occurs adversaries path adversary falsely reports congestion second adversary erases reports 
packet drops ecn congestion reports reversed network malicious broken router 
ecn nonce help transport detect behavior 
transparent node possible monitoring device second adversaries see false indications congestion 
keep mind recommendation document punishing flow responding appropriately congestion router switch dropping ramakrishnan standards track page rfc addition ecn ip september marking indication congestion flow 
includes dropping arriving packets flow ce codepoint set ensures indications congestion seen nodes 
additional harm able postulate result multiple conflicting adversaries 

implications subverting congestion control section focuses potential repercussions subverting congestion control falsely indicating erasing congestion indication ecn ce codepoint 
subverting congestion control methods consequences application network 
discuss separately 
method subvert congestion control falsely indicating ecn capability effectively congestion control packet encounters congestion results setting ce codepoint 
case transport protocol may ecn capable receive indication congestion downstream congested routers 
second method subvert congestion control erasing ce codepoint packet effectively congestion control ce codepoint packet set earlier congested router 
case transport protocol receive indication congestion upstream congested routers 
methods subverting congestion control potentially introduce damage network possibly flow adversary simply dropped packets flow 
discuss section section potential damage limited 

implications network competing flows ce codepoint ecn field routers indication congestion periods moderate congestion 
ecn capable routers drop mark packets heavy congestion router queue full 
example routers active queue management red router drop mark packets arrive average queue sizes exceed red queue maximum threshold 
ramakrishnan standards track page rfc addition ecn ip september consequence network subverting congestion control flows receive congestion indications network increase sending rate drive network heavier congestion 
congested router drop mark arriving packets 
flows isolated form flow scheduling flow mechanisms aggregated flows single queue undifferentiated fashion packet dropping congested router apply flows share queue 
consequences increase level congestion network 
cases increase level congestion lead substantial buffer buildup congested queue sufficient drive congested queue packet marking packet dropping regime 
transition occur buffer overflow active queue management policy described drops packets average queue red maximum threshold 
point flows including subverted flow see packet drops packet marks malicious broken router longer able erase indications congestion network 
nodes deploying appropriate congestion control subverted flow reduce arrival rate response congestion 
level congestion sufficiently reduced congested queue return packet dropping regime packet marking regime 
steady state pattern congested queue oscillating regimes 
cases consequences subverting congestion control severe drive congested link sufficiently heavy congestion packets dropped marked 
case implications competing flows network slightly increased rate packet marking dropping corresponding decrease bandwidth available flows 
stable state arrival rate subverted flow sufficiently small relative link bandwidth average queue size congested router remains control 
particular subverted flow limited bandwidth demand link router getting fair share link 
limited demand due limited demand data source limitation tcp advertised window lower bandwidth access pipe factors 
subversion ecn congestion control lead unfairness believe appropriate note 
ramakrishnan standards track page rfc addition ecn ip september threat network posed subversion ecn congestion control network essentially threat posed system intentionally fails cooperate congestion control 
deployment mechanisms routers address threat open research question discussed section 
take example described section ce codepoint set packet erased 
consequence congested upstream router set ce codepoint congestion indication reach nodes flow 
source completely cooperative malicious allowed continue increase sending rate tcp flow increasing congestion window 
flow potentially achieves better throughput flows share congested router especially policing mechanisms flow queuing mechanisms router 
consider behavior flows especially cooperative flows experience subverted congestion control 
reduce load reducing window size congested router benefiting subverted flow 
results unfairness 
discussed unfairness transient congested queue driven regime oscillatory congested queue oscillates packet marking packet dropping regime moderate persistent stable state congested queue driven packet dropping regime 
results similar subverted flow intentionally avoiding congestion control 
difference flow intentionally avoiding congestion control nodes avoid congestion control congested queue packet dropping mode refusing reduce sending rate response packet drops network 
problems network subversion ecn congestion control severe problems caused intentional avoidance congestion control nodes 
case considerably difficult control behavior nodes control behavior infrastructure 
say problems network posed network subversion ecn congestion control small just problems network posed subversion ecn currently known packet congestion control mechanisms nodes 
ramakrishnan standards track page rfc addition ecn ip september 
implications subverted flow source indicates ecn capable expectation routers network capable participating ecn ce codepoint indication congestion 
potential benefit ecn reducing amount packet loss addition reduced queuing delays active queue management policies 
packet flows ipsec tunnel nodes tunneled packets traverse untrusted way expectation ipsec protect flow subversion results undesirable consequences 
cases subverted flow benefit subversion congestion control flow network receiving bandwidth relative competing non subverted flows 
congested queue reaches packet dropping stage subversion congestion control benefit subverted flow depending flow relative tradeoffs throughput loss delay 
form subverting congestion control falsely indicate ecn capability setting ect codepoint 
consequence downstream congested routers setting ce codepoint vain 
described section ect codepoint changed ip tunnel detected egress point tunnel long inner header changed tunnel 
second form subverting congestion control erase congestion indication erasing ce codepoint 
case upstream congested routers set ce codepoint vain 
ect codepoint erased ip tunnel detected egress point tunnel long inner header changed tunnel 
ce codepoint set upstream ip tunnel erasure outer header ce codepoint tunnel effect inner header preserves set value ce codepoint 
ce codepoint set tunnel erased downstream tunnel necessarily detected egress point tunnel 
subversion congestion control system transport respond congestion indication 
increased unfairness non subverted flows described ramakrishnan standards track page rfc addition ecn ip september previous section congested router queue continue build resulting packet loss congested router means indicating congestion transport case 
interim flow experience higher queuing delays possibly increased bandwidth relative non subverted flows 
transports inherently assumptions consistently experiencing carefully managed queuing path 
believe forms subverting congestion control worse subverted flow adversary simply dropped packets flow 

non ecn methods subverting congestion control shown cases malicious broken router able change bits ecn field damage simply dropped packet question 
true cases particular cases broken router subverted congestion control falsely indicating ecn capability erasing ecn congestion indication ce codepoint 
ways router harm flow dropping packets router subvert congestion control dropping packets 
example router subvert tcp congestion control dropping data packets packets control packets 
packet dropping subvert congestion control non ecn methods subverting congestion control broken malicious router 
example broken router duplicate data packets effectively negating effects congestion control portion path 
router duplicated packets ipsec tunnel security administrator cause duplicate packets discarded configuring anti replay protection tunnel 
duplication packets network similar implications network subverted flow described sections 

motivation ect 

motivation ect codepoint 
need ect codepoint motivated fact ecn deployed incrementally internet transport protocols routers understand ecn 
ect codepoint router drop packets flows set ce codepoint packets ramakrishnan standards track page rfc addition ecn ip september ecn capable 
ect codepoint allows node ce codepoint set packet having packet dropped node incentive deploy ecn 
ect codepoint router set ce codepoint packets ecn capable non ecn capable flows 
case incentive nodes deploy ecn viable path incremental deployment world ecn capable world 
consider stages incremental deployment subset flows 
onset congestion packet dropping marking rate low routers set ce dropping packets 
flows ecn capable understand respond ce packets 
result ecn capable flows back capable flows unaware ecn signals continue open congestion windows 
case possible outcomes ecn capable flows back non ecn capable flows get bandwidth congestion remains mild ecn capable flows back non ecn capable flows don congestion increases router transitions setting ce codepoint dropping packets 
second outcome evens fairness ecn capable flows receive little benefit ecn capable increased congestion drive router behavior 
flow advertised ecn capable respond ce functionally equivalent flow turns congestion control discussed earlier document 
world subset flows ecn capable ecn capable flows mechanism indicating fact routers effective fair congestion control internet resulting strong incentive nodes deploy ecn 

motivation ect 
primary motivation ect provide bit ecn nonce 
ecn nonce allows development mechanisms sender probabilistically verify network elements erasing ce codepoint data receivers properly reporting sender receipt packets ce codepoint set 
ramakrishnan standards track page rfc addition ecn ip september possibility senders detect misbehaving network elements receivers data sender occasionally send data packet ce codepoint set see receiver reports receiving ce codepoint 
course packets encountered congestion network router change packets ce codepoint set 
packets sent ce codepoint set tcp nodes determine router intended set ce codepoint packets 
reason sending packets ce codepoint done sparingly effective check misbehaving network elements receivers ecn nonce 
assignment fourth ecn codepoint ect precludes codepoint purposes 
clarity briefly list possible purposes 
possibility data sender fourth ecn codepoint indicate alternate semantics ecn 
appropriate signaled differentiated services codepoint ds field 
second possible fourth ecn codepoint give router separate indication congestion ce ce mild severe congestion respectively 
useful cases certainly compelling requirement point 
judged compelling need complications incremental deployment necessitate just codepoint function 
third informally proposed ecn codepoint forms multicast congestion control randomized procedures duplicating marked packets routers 
proposed multicast packet duplication procedures new ecn codepoint conveys fact congestion occurred upstream duplication point marked packet codepoint detect congestion downstream duplication point 
ect serve purpose distinct ect replaced ce ecn marking occurs response congestion incipient congestion 
explanation enhanced version ecn multicast congestion control scope document ecn aware multicast packet duplication procedures processing ecn field multicast receivers cases irrespective multicast packet duplication procedure 
ramakrishnan standards track page rfc addition ecn ip september specification ip tunnel modifications ecn document assumes change outer ip header ecn field tunnel endpoints set ce codepoint indicate congestion 
consistent proposed uses ect multicast duplication procedures previous paragraph procedures deployed inconsistency multicast duplication procedures ip tunnels full ecn functionality resolved 
limited ecn functionality may practice tunnel protocols including ipsec correctly multicast traffic duplication occurs tunnel 
bits ip header 
need ect indication ip header remains question ect ecn capable transport ce congestion experienced overloaded single bit 
overloaded bit alternative explored floyd involved single bit values 
value ect ce represent ecn capable transport value ce ect represent congestion experienced non ecn capable transport 
difference bit bit implementations concerns packets traverse multiple congested routers 
consider ce packet arrives second congested router selected active queue management router marking dropping 
bit implementation second congested router choice drop ce packet distinguish ce packet non ect packet 
bit implementation second congested router choice dropping ce packet leaving ce codepoint set 
difference bit bit implementations comes fact bit implementation receivers single flow distinguish ce non ect packets 
bit implementation ecn capable data sender unambiguously indicate receiver receivers packet sent ecn capable non ecn capable 
possibility sender indicate transport header packet sent ecn capable 
second possibility involve functional limitation implementation sender unambiguously indicate going send packets ecn capable non ecn capable 
multicast transport protocol unambiguous indication apparent receivers joining going multicast session 
ramakrishnan standards track page rfc addition ecn ip september concern described earlier recommended document transports particularly tcp mark pure ack packets retransmitted packets ecn capable 
pure ack packet non ecn capable transport dropped necessarily having impact transport congestion control perspective subsequent acks cumulative 
ecn capable transport reacting ce codepoint pure ack packet reducing window disadvantage comparison non ecn capable transport 
reason reasons described earlier relation retransmitted packets desirable ect codepoint set packet basis 
advantage bit approach somewhat robust 
critical issue discussed section default indication non ecn capable transport 
bit implementation requirement default value simply means ect codepoint default 
bit implementation means single overloaded bit default ce ect position 
clear straightforward possibly open incorrect implementations nodes routers 
summary bit implementation possible implementation significant limitations relative bit implementation 
bit implementation limited functionality treatment ce packets second congested router 
second bit implementation requires extra information carried transport header packets ecn capable flows convey functionality second bit transport header senders ecn capable flows accept limitation receivers able determine priori packets ecn capable ecn capable 
third bit implementation possibly open errors faulty implementations choose wrong default value ecn bit 
believe extra bit ip header ect bit extremely valuable overcome limitations 

historical definitions ipv tos octet rfc rfc defined tos type service octet ip header 
rfc bits tos octet listed reserved shown set zero 
fields tos octet defined precedence type service tos fields 
ramakrishnan standards track page rfc addition ecn ip september precedence tos rfc rfc included bits tos field discuss specific bits precedence tos rfc ipv tos octet redefined rfc rfc follows precedence tos rfc bit tos field defined rfc minimize monetary cost 
addition precedence type service tos fields field zero defined currently unused 
rfc stated originator datagram sets field zero participating internet protocol experiment bit 
rfc rfc defined experimental standard bits tos field request guaranteed level link security 
rfc rfc definition differentiated services field ds field ipv ipv headers rfc bits ds field listed currently unused cu 
rfc rfc specified ecn experimental bit cu field 
rfc updated definition ds field encompass bits octet bits bits defined differentiated services codepoint cu rfcs unstable history definition ecn field document guaranteed backwards compatible past uses bits 
ramakrishnan standards track page rfc addition ecn ip september prior rfc routers permitted modify bits ecn field packets forwarded routers comply rfcs prior effect ecn 
nodes bit second ecn bit transmitted zero implementation compliant rfcs prior 
nodes may transmit bit ecn bit minimize monetary cost provision rfc experiment authorized rfc aspect rfc experiment rfc widely implemented 
damage done broken non conformant router include erasing ce codepoint ecn capable packet arrived router ce codepoint set setting ce codepoint absence congestion 
discussed section non compliance network 
damage done ecn capable environment non ecn capable node transmitting packets ect codepoint set discussed section non compliance nodes 

iana considerations section contains namespaces created specification values assigned existing namespaces managed iana 

ipv tos byte ipv traffic class octet ecn field ip header specified standards action rfc required rfc 
document published rfc iana create new registry ipv tos byte ipv traffic class octet namespace follows ipv tos byte ipv traffic class octet description registrations identical ipv ipv 
bits see differentiated services field registry www iana org assignments registry ramakrishnan standards track page rfc addition ecn ip september bits ecn field binary keyword ect ecn capable transport rfc ect ecn capable transport rfc ect ecn capable transport rfc ce congestion experienced rfc 
tcp header flags cwr ece flags tcp header specified standards action rfc required rfc 
document published rfc iana create new registry tcp header flags namespace follows tcp header flags transmission control protocol tcp included bit reserved field defined rfc reserved bytes tcp header illustrated 
control bits defined separately rfc 
header length reserved rfc defines bits reserved field ecn follows header length reserved ramakrishnan standards track page rfc addition ecn ip september tcp header flags bit name cwr congestion window reduced rfc ece ecn echo rfc 
ipsec security association attributes iana allocated ipsec security association attribute value ecn tunnel described section request david black november 
iana changed allocation david black request rfc 

authors addresses ramakrishnan networks phone email kk com sally floyd aciri phone email floyd aciri org url www aciri org floyd david black emc south st ma phone email black david emc com ramakrishnan standards track page rfc addition ecn ip september 
full copyright statement copyright internet society 
rights reserved 
document translations may copied furnished derivative works comment explain assist implementation may prepared copied published distributed part restriction kind provided copyright notice paragraph included copies derivative works 
document may modified way removing copyright notice internet society internet organizations needed purpose developing internet standards case procedures copyrights defined internet standards process followed required translate languages english 
limited permissions granted perpetual revoked internet society successors assigns 
document information contained provided basis internet society internet engineering task force warranties express implied including limited warranty information rights implied warranties fitness particular purpose 
funding rfc editor function currently provided internet society 
ramakrishnan standards track page 
