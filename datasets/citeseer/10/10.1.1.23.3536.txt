computing visual correspondence occlusions graph cuts vladimir kolmogorov ramin zabih cs cornell edu cs cornell edu computer science department cornell university ithaca ny new algorithms visual correspondence graph cuts developed :10.1.1.118.3857
methods give strong re sults practice handle occlusions properly 
specifically treat input images asymmetrically ensure pixel corresponds pixel image 
new methods properly address occlusions ing advantages graph cut algorithms 
give experimental results stereo motion demonstrate methods perform detecting occlusions computing disparities 
years new class algorithms visual correspondence developed graph cuts :10.1.1.118.3857
methods give strong experimental results example comparative study stereo algorithms algorithm gave best results approximately times fewer errors standard methods normalized correlation 
unfortunately existing graph cut algorithms treat occlusions correctly 
new graph cut algorithms handle occlusions properly maintaining key advantages graph cuts 
occlusions major challenge accurate computation visual correspondence 
occluded pixels visible image corresponding pixel image 
applications partic important obtain results discontinuities places occlusions occur 
ideally pixel image correspond pixel image pixel correspond pixel image labeled occluded 
refer requirement uniqueness 
algorithms visual correspondence enforce uniqueness 
discuss algorithms enforce uniqueness summarize re lated section 
common compute disparity pixel preferred image 
treats images asymmetrically full information images 
algo rithms graph cuts typical regard despite strong performance practice :10.1.1.118.3857
new algorithms proposed energy tion 
methods closely related algorithms find strong local minimum natural class energy functions 
address correspondence problem constructing problem representa tion energy function solution violates uniqueness infinite energy 
constructing appropriate energy function non trivial example natural energy functions np hard compute local minimum 
consider different energy functions show graph cuts compute strong local minimum 
begins algorithms 
give overview algorithms discuss problem rep resentation choice energy functions show enforce uniqueness 
section survey related focusing algorithms guarantee uniqueness 
sections show compute local minimum energy functions strong sense graph cuts 
experimental results section 
expansion moves swap moves set pixels left image pixels right image set pixels 
pixel coordinates px py 
classical approach stereo goal compute pixel left image label fp denotes disparity value pixel energy minimized potts energy dp fp vp fp fq :10.1.1.112.6806
dp fp penalty pixel disparity fp neighborhood system pixels left image argument true 
minimizing energy np hard gives approximation algorithms 
involve notion moves 
consider particular disparity label 
configuration said single expansion move pixels fp 
consider pair disparities 
configuration said single swap move pixels fp implies fp 
crucial fact moves configuration possible efficiently find strong local energy precisely lowest energy configuration single expansion swap move respectively 
local improvement operations rely graph cuts 
expansion algorithm consists entirely sequence expansion local improvement operations different disparities expansion reduce energy 
similarly swap algorithm consists entirely sequence swap local improvement operations pairs disparities swap reduce energy 
formulation unfortunately handle occlusions properly 
easily happen pixels left image mapped fact consider general energy simplest case works practice 
pixel right image 
assumes pixel left image mapped pixel right image reality pixel left image occluded correspond pixel right image 
overview new algorithms problem representation set unordered pairs pixels may potentially corre 
stereo aligned cameras example py qy qx px 
assume disparities lie limited range pixel potentially correspond possible pixels 
situation motion similar set possible disparities dimensional 
goal find subset containing pairs pixels correspond 
equivalently want give assignment pixels correspond 
define unique configurations call assignments value active 
set active assignments configuration set active assignments involve pixel np 
call con figuration unique pixel involved active assignment np 
note pixels np precisely occluded pixels 
possible extend notion expansions representation 
assignment qx px qy py set assignments having disparity 
configuration said single expansion move subset words currently active assignments may deleted assignments having disparity may added 
possible extend notion swap 
configuration said single swap move set assignments having disparity 
words changes adding deleting assignments having disparities 
energy function define energy configuration correctly handle unique configurations assume non unique configurations energy infinity unique configurations energy form edata esmooth 
terms include results differences intensity tween corresponding pixels occlusion term imposes penalty making pixel occluded smoothness term esmooth neighboring pixels image tend similar disparities 
data term edata typically assignment intensity pixel 
occlusion term imposes penalty cp pixel occluded write cp np 
nontrivial part choice smoothness term 
pos sible write expressions smoothness term 
smoothness term involves notion neighborhood assume neighbor hood system assignments obvious choice 
esmooth va neighborhood system consists pairs assignments anda disparities 
include example pairs assignments neighbors neighbors 
impose penalty close assignments having different disparities configuration 
unfortunately show appendix minimizing energy np hard finding minimum function configurations single expansion initial configuration np hard 
show section pos sible minimize function space configurations single swap initial configuration 
promising results obtained different smooth ness term possible graph cuts efficiently find minimum energy configurations single expansion initial configuration 
smoothness term esmooth va 
system consists pairs assignments anda disparities 
include example pairs assignments neighbors 
impose penalty assignment configuration close assignment having disparity 
energy different previous enforces constraint disparities adjacent pixels smoothness penalty zero positive value 
intuition energy allows graph cuts 
similar form potts energy equation 
potts energy assignments pixels consequence previous algorithms graph cuts applied 
related motion stereo explicitly consider occlusions 
example correlation approaches energy minimization methods regularization markov random fields typically labeling problems pixel image assigned disparity 
privileges image permit oc naturally incorporated 
called cross checking 
computes disparity twice left right right left marks occlusions pixels image mapping pixels image map back 
method common easy implement experimental comparison section 
similarly possible incorporate occlusions energy minimization methods adding label represents occluded 
difficulties 
hard design natural energy function incor new label impose uniqueness constraint 
addition labeling problems handle input images asymmetrically 
number papers elegantly handle occlusions stereo energy minimization :10.1.1.42.2575
papers focus compu tational modeling understanding psychophysics stereopsis con trast concerned accurately computing disparity occlusion stereo motion 
major limitation algorithms proposed overcomes :10.1.1.42.2575
algorithms extensive ordering constraint states object left stereo example images pixels 

solid lines indicate current active assignments dashed lines indicated assignments considered 
image left image 
advantage order ing constraint efficiency permits dynamic programming 
ordering constraint limitations 
depending scene geometry true 
second ordering constraint specific stereo motion 
third algorithms ordering constraint essentially solve stereo problem independently scanline 
scanline solved optimally unclear impose kind inter scanline consistency 
method contrast minimizes natural dimensional energy function applied motion stereo 
algorithm graph cuts efficiently minimize wide range energy functions 
originally proved labels global minimum energy efficiently computed single graph cut 
shown graph cuts handle labels :10.1.1.118.3857
resulting algorithms applied problems early vision including image restoration visual correspondence 
graph cuts powerful optimization method methods handle occlusions gracefully :10.1.1.118.3857
addition difficulties just mentioned concerning occlusions en ergy minimization graph cut methods applicable limited set energy functions 
particular previous algorithms minimize energy define equation 
closely related consists algorithms graph cuts 
methods minimize energy uses graph cuts explicitly handle occlusions 
handle input images enforce uniqueness 
graph cut construction computes global minimum single graph cut 
limitation lies smoothness term distance 
smoothness term robust produce 
prove construction applicable convex non robust smoothness terms 
addition prove mini np hard construction clearly applied problem 
expansion move algorithm show efficiently minimize smoothness term esmooth va 
unique configurations graph cuts 
output method local minimum strong sense 
particular consider input configuration disparity 
configuration defined 
start arbitrary unique configuration 
set success 
disparity 
find unique single expansion 
set success 
success goto 
return steps expansion algorithm single expansion assignments inactive assignments disparity active formal definition start section 
algorithm straightforward simply select fixed order random disparity find unique configura tion single expansion move local improvement step 
decreases energy go decreases energy done 
critical step method efficiently compute expansion smallest energy 
section show graph cuts solve problem 
graph cuts weighted graph distinguished terminal vertices called source sink 
cut partition graph corresponding 
links vertices terminals shown 
edges arrows bidirectional edges weight direction edges arrows different weights direction 
vertices sets cost cut denoted equals sum weights edges vertex vertex minimum cut problem find cut smallest cost 
problem solved efficiently computing maximum flow tween terminals theorem due ford fulkerson :10.1.1.112.6806
large number fast algorithms problem see example 
worst case complexity low order polynomial practice running time nearly linear graphs short paths source sink construct 
computing local minimum construct graph give correspondence cuts configurations 
show minimum cut cut equivalently defined set edges sets 
yields configuration minimizes unique configurations expansion 
graph structure expansion active assignments may inactive inactive assignments disparity may active 
suppose start unique configuration active assignments new con figuration expansion subset 
define configuration 
note general unique 
directed graph construct vertices correspond assignments contrast graphs built 
terminals called assignment vertex 
edges follows 
vertex edges 
addition edges 
note case anda consider pair vertices pixel 
note case vice versa 
edges pair assignments 
consider cut configuration corre sponds cut defined vs fc lemma obvious consequence construction 
lemma cut configuration lies single expansion input configuration cost give weights edges define occlusion cp edge entering 
define smoothness cost weights follows 
va 
edge weight va cp np np refer links weight top rows table links 
refer links cost cp links 
small example shown 
current set assignments shown solid lines dashed lines represent new assignments considering 
current configuration pixels occluded proposed expansion move change status 
corresponding graph shown 
nodes top row form nodes bottom row form note forexample edge weight assignments active 
optimality show minimum cut graph thenf configuration minimizes energy unique configurations 
lemma cost cut finite corresponding configuration unique 
proof unique pixel pair assignments np 
loss generality weight cut 
similarly weight infinite edges cut pixel unique 
lemma unique configuration corresponding cut cost links plus links equals plus con stant 
proof cost links cost links constant plus np 
np cp 
cp np cp np np write constant plus terms np np np equals sum equations 
cp np 
cp 
theorem minimum cut unique configuration expansion minimizes energy proof lemma shows lies expansion lemma shows minimum cut unique obviously cuts finite costs links infinite cost included due lemma remains show cost ignoring links links edata esmooth second sum rewritten va 
va va 
ignoring links links cost va 
terms third simply va 
terms involving sumto need show va 
expression 
proof follows definition 

start arbitrary configuration 
set success 
pair disparities 
find swap 
set success 
success goto 
return steps swap algorithm swap move algorithm section algorithm minimizing energy smoothness term esmooth va note possible enforce uniqueness constraint setting va assignments enter common pixel necessary construction constrast expansion algorithm 
assume configurations unique 
general structure swap algorithm similar expansion algorithm 
expansion algorithm critical step minimizing energy space configurations swap section give details graph swap 
graph structure suppose start configuration leta set active assignments configuration disparities different 
swap assignments having disparities may change status 
active assignments new configuration swap subset containing directed graph construct vertices correspond assignments edges follows 
vertex edges 
addition edge 
consider pair vertices enter common pixel assignment enters note case assignments leta edge pair assignments 
consider cut configuration corre sponds cut defined vt lemma obvious consequence construction 
lemma cut configuration lies single swap input configuration cost give weights edges define occlusion cp edge entering 
define smoothness cost weights follows 
va edge weight va cp np configuration row corresponding set condition np means assignments anda assignments entering pixel refer links weight top rows table links 
refer links cost cp links 
optimality show minimum cut graph thenf configuration minimizes energy configurations swap 
lemma configuration corresponds cut cost links plus links equals plus constant 
proof cost links cost links 
np cp 
cp np set pixels active assignments enter pixels occ occluded expression constant plus occ np cp np occ np cp np 
note occ np rewrite expression terms np np np equals sum equations 
cp 
theorem minimum cut thenf configuration swap minimizes energy proof lemma shows lies expansion due lemma remains show cost ignoring links links edata esmooth va 
second sum rewritten constant plus va 
ignoring links links cost va va 
terms involving sum constant plus 
sum terms involving equals term equation 
term equation equals term equation 
experimental results experimental results involve stereo motion 
ove algorithm gives higher quality results swap move algorithm focussed section show result swap move algorithm 
optimization method param eters exact choice selected labels random order started initial solution assignments active 
data term method birchfield tomasi handle sampling artifacts 
choice va designed pair adjacent pixels image similar similar disparities 
va implemented empirically selected decreasing function max follows max va 
occlusion penalty chosen pixels 
energy depends parameter 
different images picked empirically 
compared results expansion algorithm described left image results ground truth correlation results results stereo results tsukuba dataset :10.1.1.112.6806
occluded pixels shown red 
method errors gross errors false negatives false positives results results swap algorithm boykov veksler zabih kanade correlation error statistics tsukuba dataset 
image second image horizontal motion method horizontal motion method vertical motion method vertical motion method motion results flower garden sequence 
occluded pixels shown red 
left image right image horizontal motion method horizontal motion method stereo results meter image 
occluded pixels shown red 
left image right image horizontal motion method horizontal motion method stereo results sri tree sequence 
occluded pixels shown red 
image second image horizontal motion method horizontal motion method vertical motion method vertical motion method motion results cat sequence 
occluded pixels shown red 
additional explicit label occluded closest related 
data ground truth obtained results due kanade 
implemented correlation distance 
occlusions computed cross checking computes matches left right right left marks pixel occluded maps pixel map back 
window correlation experimented window sizes variants correlation gave comparable results 
quantitative comparison various methods stereo image pair university tsukuba hand labeled integer disparities 
left input image ground truth shown results results various methods 
tsukuba images experiments image pair disparities 
computed error statistics shown 
ground truth determine pixels occluded 
columns ignored pixels occluded ground truth 
determined percentage remaining pixels algorithm compute correct disparity errors column disparity correct disparity gross errors 
considered labeling pixel occluded gross error 
columns show error rates occlusions 
experimented number standard sequences 
results flower garden motion sequence shown cmu meter sri tree stereo results shown figures 
comparison shown results expansion algorithm 
addition results shown challenging sequence involving non rigid motion garden 
running times algorithm average slower expansion algorithm order minute 
example tsukuba data set algorithm takes seconds takes seconds 
numbers obtained pentium iii 
experimented parameter sensitivity method 
parameter equation easy experimentally determine algorithm sensitivity 
table shows method relatively insensitive exact choice 
error gross errors false neg 
false pos 
implemented swap move algorithm described sec tion 
suggested swap moves expansion moves give fairly comparable results 
complex energy functions expansion move algorithm gives significantly better results 
sake completeness output swap move algorithm tsukuba imagery 
appears swap moves simply powerful escape local minima class energy functions 
energy minimization formulation correspondence problem occlusions fast approximation algorithm graph cuts 
experimental results stereo motion appear promising 
method easily generalized associate cost labeling particular assignment inactive 
ohta nakamura supplying ground truth imagery university tsukuba providing output method veksler useful comments 
appendix finding local minimum smoothness term single expansion np hard call problem finding local minimum energy equation smoothness term term single expansion expansion problem 
section show np hard problem reducing independent set problem known np hard expansion problem 
undirected graph input independent set problem 
subset vis said independent nodes edge 
goal find independent subset maximum cardinality 
construct instance expansion problem follows 
node create pixels lin left image rin right image assignment way disparities different assignments anda different 

neighboring system assignments constructed connectivity graph edge add pair corresponding penalty discontinuity va sufficiently large constant 
data term assignments occlusion penalty pixels 
consider initial configuration assignments active consider arbitrary disparity 
clearly unique configuration 
obvious correspondence configurations single expansion subsets configuration corresponding subset easy see data cost energy configuration zero occlusion cost smoothness cost zero subset independent 
minimizing energy expansion problem equivalent maximizing cardinality independent subsets appendix minimizing smoothness term np hard shown problem referred potts energy minimization np hard :10.1.1.113.1823
input set pixels neighborhood system set label values non negative function minimizes ep 
sketch proof arbitrary instance potts energy min problem encoded problem minimizing energy defined equation smoothness term 
shows problem minimizing np hard 
start potts energy minimization problem consisting create new instance energy minimization problem follows 
left image label create disparity difference pair disparities greater twice width obviously right image large pixel sand disparity unique pixel set pairs pixels disparity correspond 
note different pixels mapped pixel penalty occlusions cp sufficiently large number ensure pixel occluded solution minimizes energy neighborhood system potts model neighborhood system extended obvious way 
penalty discontinuities va obvious global minimum solution energy mini mization problem effectively assign label pixel energy equal ep plus constant global minimum solve np hard potts energy minimization problem 
ahuja thomas magnanti james orlin 
network flows theory algorithms applications 
prentice hall 
belhumeur mumford 
bayesian treatment stereo correspondence problem half occluded regions 
ieee confer ence computer vision pattern recognition pages 
revised version appears ijcv 
stan birchfield carlo tomasi 
pixel dissimilarity measure insensitive image sampling 
ieee transactions pattern analysis machine intelligence april 
bobick intille 
large occlusion stereo 
international jour nal computer vision september 
robert bolles john woodfill 
spatiotemporal consistency check ing passive range data 
international symposium robotics re search 
pittsburg pa yuri boykov olga veksler ramin zabih 
markov random fields efficient approximations 
ieee conference computer vision pattern recognition pages 
yuri boykov olga veksler ramin zabih 
fast approximate energy minimization graph cuts 
international conference computer vision pages september 
ford fulkerson :10.1.1.112.6806
flows networks 
princeton university press 
geiger yuille 
occlusions binocular stereo 
international journal computer vision april 
geman geman 
stochastic relaxation gibbs distributions bayesian restoration images 
ieee transactions pattern analysis machine intelligence 
greig 
exact maximum posteriori estimation binary images 
series 
ishikawa geiger 
occlusions discontinuities epipolar lines stereo 
european conference computer vision pages 
ishikawa geiger 
segmentation grouping junctions 
ieee conference computer vision pattern recognition pages 
tomaso poggio vincent torre christof koch 
computational vi sion regularization theory 
nature 
potts 
generalized order disorder transformations 
proceedings cambridge philosophical society 
roy 
stereo epipolar lines maximum flow formulation 
international journal computer vision 
rick szeliski ramin zabih 
experimental comparison stereo algorithms 
ieee workshop vision algorithms september 
appear lncs 
olga veksler :10.1.1.113.1823
efficient graph energy minimization methods computer vision 
phd thesis cornell university august 
avail able technical report cucs tr 
lawrence takeo kanade 
cooperative algorithm stereo matching occlusion detection 
ieee transactions pattern analysis machine intelligence july 
earlier version appears technical report cmu ri tr 

