journal vlsi signal processing fl kluwer academic publishers boston 
manufactured netherlands 
parametric analysis polyhedral iteration spaces philippe vincent fr universit louis strasbourg pole api bd 
brant france received march 
revised january 
editors taylor 
area automatic parallelization programs analyzing transforming loop nests parametric affine loop bounds requires fundamental mathematical results 
common geometrical model iteration spaces called polytope model mathematics dealing convex discrete geometry linear programming combinatorics geometry numbers 
automatic methods computing parametric vertices ehrhart polynomial parametric expression number integer points polytope defined set parametric linear constraints 
methods applications analysis transformations nested loop programs 
illustrated exact symbolic array dataflow analysis estimation execution time computation maximum available parallelism loop nests 
keywords integer points parametric polytopes ehrhart polynomials parametric vertices automatic parallelization nested loops optimizing compilers 

systolic algorithm synthesis nested loops parallelization common geometric model called polytope model leading common fundamental mathematical problems dealing discrete convex geometry combinatorics geometry numbers linear programming 
fundamental problems counting integer points points having integer coordinates contained polytope 
counting parameterized scientific algorithms depend size parameters 
counting necessary analyzing parallel algorithm modeled polyhedral iteration space 
kinds analysis reduce problem finding number flops executed loop number memory locations touched loop communication volume maximum parallelism forth 
resulting information estimate execution time code segment compare memory bandwidth requirements vs flops count code segment determine loops flush cache calculate cache rate evaluate message traffic allocate message buffers determine parallel loop load balanced performs amount computation iteration balanced determine number iterations assign processor order balance load balanced chunk scheduling exploit maximum parallelism optimize number needed processors optimize loop data :10.1.1.22.1897
fundamental problem determine parametric bounds index affine combination indices induced nested loop program 
finding parametric latency parallel loop parametric bounds loop scanning polyhedral space parametric indices iteration updating array element exact symbolic array dataflow analysis prob ph 
lems reduce find domains associated stable sets parametric vertices 
generally parametric analysis opportune non parameterized problems example analysis perfect loop nest parallelization achieved considering execution steps parameters 
informations essential optimizing compilers transforming parallel program 
algorithm computing parametric vertices associated domains convex polytope defined set parametric linear constraints automatic method computing exact closed expression number integer points contained convex polytope union convex polytopes 
counting method consists computing parametric vertices computing ehrhart polynomial parametric expression number integer points 
second part results due mathematician ehrhart solved problem parametric polytopes depend positive integral parameter 
propose extension results number parameters showing extension possible new parametric vertices finding algorithm 
algorithm classical representation parametric polytope nonparametric polyhedron combined parameter data space 
computation faces dimension equals number parameters allows expression parametric vertices affine functions parameters 
validity domain partition vertices computed subdomain corresponds certain set vertices parametric polytope 
organized follows 
section dedicated mathematical background 
section algorithm find parametric vertices described 
possible section extension ehrhart results parametric counting integer points 
illustrate methods section example exact symbolic array dataflow analysis section counting number flops executed loop nest section computing parallelism rate iteration space linear parallelization 
rate parameterized size parameter execution step 
section comparisons related works 

definitions assumptions recall basic notions dealing geometry numbers enumerative combinatorics 
specific concepts closely related content introduced 

polyhedra polytopes denote set rational numbers set integers 
convex polyhedron defined finite set linear inequalities fx delta bg rational matrix rational vector 
called implicit representation polyhedron 
bounded convex polyhedron called convex polytope represents convex hull finite number points xm xm affinely independent points means gamma gamma xm gamma linearly independent convex hull xm called dimensional simplex vertices xm goal count number integer points contained polyhedron polytopes considered 
affine span smallest affine subspace entirely containing dimension dimension affine span dimensional polytope called polytope brevity 
definition geometric representation convex polytope dual geometric representation combination vertices fx columns matrix coordinates vertices free vector elements parametric analysis polyhedral iteration spaces polytope unique minimal geometric representation 
procedures exist compute dual representations implicit form compute vice versa see 
nonzero vector fl defined fl maxf delta pg affine hyperplane fx delta flg called supporting hyperplane faces intersections supporting hyperplanes 
face polyhedron called face dimensional 
polyhedron faces dimension gamma called vertices edges facets respectively 
consider polytopes may non convex called normal polyhedra definition 
definition corresponds ehrhart includes unions convex polytopes 
definition normal polyhedron normal polyhedron closed polyhedron admits finite rectilinear simplicial subdivision 
union finite number simplices sn dimension ffl intersection simplices empty common face ffl facet simplices belongs simplex faces belonging simplex border polyhedron ffl simplices ordered intersection empty union common facets border 
parameterized lattice polytopes parameterized convex polytope defined pn fx delta delta cg symbolic vector parameters constant rational matrices size theta theta respectively constant rational vector 
lattice set points fff ff ff ff zg linearly independent vectors called basis lattice 
set integral points called standard lattice denoted matrix columns vectors called matrix 
lattice consists points delta delta get general lattice subjecting standard lattice arbitrary nonsingular transformation 
loss generality standard lattice considered rest 
enumerator set number points intersection lattice polytope called lattice polytope lattice polytope polytope vertices integral polytope 
vertices belong rational coordinates rational polytope 
definition lattice deduced non singular transformation polytope affinely equivalent integral polytope 
results rest concerning integral polytopes directly extended polytopes 
loss generality generic term integral polytopes 
method counting number integer points decomposition parametric polytope homothetic bordered systems associated validity domains definition extension ehrhart definition number parameters 
definition homothetic bordered system hn system defined constraints form integers free variables positive integral parameters 
system homothetic bordered polytope defines vertices coordinates affine combinations parameters 
general multi parametric polytopes parameters described collection homothetic bordered polytopes defined adjacent subdomain parameter values called ph 
validity domain illustrated example 
determination subdomains done parametric vertices finding algorithm described section 
example parameterized dimensional polytopes pn fx pn fx pn fx ng pn homothetic bordered system pn homothetic bordered system 
pn homothetic bordered union homothetic bordered systems qualified certain subdomains parameter space pn ae pn pn example due doran wilde 

pseudo polynomials denote enumerator pn number integer points pn formulated polynomials definitions 
extend ehrhart definition periodic numbers dimension 
definition periodic number onedimensional periodic number equal item rank equal mod called period 
mod mod mod dimensional vector 
periodic number defined dimensional array size theta theta theta mod vector called multi period common multiple called period 
example ffl gamma gamma ffl gamma gammam gamma gamma ehrhart gives basic properties onedimensional periodic numbers easily extended multi dimensional case periodic numbers multiperiod respectively 
reduced multi period ff fi common multiple repeating ff times respectively fi times sequence items th dimension respectively 
reduced period likewise extend ehrhart definition pseudo polynomials 
definition pseudo polynomial polynomial pseudo polynomial coefficients periodic numbers constants 
common multiple periods periodic coefficients pseudo period 
pseudo polynomial characteristics degree pseudo period 

parametric vertices finding algorithm 
parametric vertices algorithm fully explained 
computes vertices parametric polytope defined pn fx ax bn cg vector form 
rational matrices rational vector 
parametric polytopes represented non parametric polyhedra combined data parameter space follows ae fi fi fi fi gammab oe property relates combined polyhedron equivalent parametric polyhedron pn parametric analysis polyhedral iteration spaces pn pn pn min fig 

parameterized polytopes pn pn pn property sn subspace associated value sn ae oe intersection sn fixes parameter constant vector result polyhedron pn extended combined space sn pn pn obtained projecting intersection data space td fig 

face highlighted computation function assume equality form dn non null matrix vector included set constraints defining parametric polyhedron 
equality exists easily detected removed 
verified property true property vertex polyhedron pn exists face denoted corresponds sn proof detailed proof 
definition face pn intersection hyperplane pn combined space intersection sn tangent hyperplane denoted chosen face result follows 
pi function projecting points parameter space pi property vertex corresponding face defined values contained polyhedron pi 
proof range projection parameter space sn validity domain pi 
pi convex polyhedron convex polyhedron 
ph 
face corresponds vertex intersection sn single point basis supporting affine space coordinates basis compute affine transformations td tp tp td transformation tp bijective equality form valid linear non null function 
tp bijective intersection sn single point cf 
corresponds vertex pn equation rewritten gamma replacing value equation find td gamma conversely tp bijective exist single point corresponding value polyhedron 
intersection polyhedron sn correspond vertex pn face pn algorithm consists 
compute faces 
face compute td tp tp non singular compute td ffit gamma report vertex compute pi defining corresponding set constraints 
partitioning parameter space output algorithm set vertices vertex set constraints verified parameters vertex valid 
algorithm computes set distinct parameter subdomains called validity domains 
validity domains separate complete sets parametric vertices single homothetic bordered polytope defined validity domains proved section 
validity domains obtained making partition parameter space projection faces inside validity domain set faces intersected sn 
set parametric vertices pn 
parameter validity domain pn pi projection parameter space projection convex faces forms set polyhedra covers pi entirely defined set faces 
algorithm described computes set polyhedra fd vg number validity domains ffl polyhedron dimension ffl polyhedron dimension lower ffl pi ffl sn yields unique set parametric vertices 
algorithm constructs partition adding successively projected face pi set validity domains 
step new partition newd defined 
intersections domains 
differences gamma 
difference union domains gamma property domains constructed intermediate computations algorithm may non convex algorithm ends resulting validity domain convex 
proof algorithm ends resulting validity domain described finite intersection projections set faces corresponding finite set parameterized vertices domain corresponding set parameterized vertices cut algorithm imply exists face cutting domain set parameterized parametric analysis polyhedral iteration spaces vertices unique validity domain 
projections faces convex projection rational convex polyhedron rational convex polyhedron faces convex 
follows final validity domains finite intersections convex sets convex 
construction validity domains input set faces output set validity domains fg pi newd fg card dimension newd newd fd fg fd gamma fg gamma newd newd fd endif done newd newd ffg endif newd done validity domains essential extension ehrhart results section 

parametric counting ehrhart polynomials extension section recall extend results due ehrhart study enumeration lattice points polyhedra means polynomials lines euler 
initial proofs 
aspects ehrhart corrected streamlined expanded macdonald stanley 
definition denominator denominator rational point lowest common multiple denominators coordinates 
denominator rational polyhedron common multiple denominators vertices 
ehrhart main result consists theorem dealing parametric polytopes depend parameter theorem ehrhart fundamental theorem enumerator homothetic bordered polyhedron pn polynomial degree pn integral pseudo polynomial degree pseudo period denominator pn pn rational 
extend theorem number parameters 
theorem fundamental theorem extended enumerator polytope pn expressed different domains parameters values different multi variable polynomials degree pn integral different multi variable pseudo polynomials degree pseudo period denominator pn pn rational 
parameter validity domains give parameter ranges parametric vertices pn defined 
polynomials pseudo polynomials form periodic numbers dimensions proof theorem parametric polytope decomposed collection polytopes defined adjacent domains parameter values 
polytope pn pn part decomposition prove number integer points multi variable pseudo polynomial degree direct application ehrhart results pn homothetic bordered polytope depending parameter number integer points pseudo polynomial degree applied ph 
pn pn summarized gamma gamma value depending application yields gamma gamma value depending gamma gamma gamma gamma showing pseudo polynomial degree pseudo polynomial degree theorem proven polytope depending parameters 
consider pn pn pn polytopes polytopes depending parameters 
proven number integer points pseudo polynomial degree summarized gamma gamma value depending application yields gamma gamma value depends gamma gamma gamma gamma showing pseudo polynomial degree pseudo polynomial degree theorem proven homothetic bordered polytope depending parameters 
applied way indefinitely number parameters 
theorem proven number integer points homothetic bordered polytope pn multi variate pseudo polynomial degree due theorems form parametric counting formulae known period equal denominator polyhedron pn degree equal determination ehrhart pseudo polynomial done counting initial values enumerator solving systems symbolic rational linear equations 
number equations system equal number unknown values complexity depends number parameters number validity domains dimension denominator 
number unknowns reduced theorem conjectured ehrhart proved stanley 
theorem pn rational polytope ehrhart pseudo polynomial gamma gamma periodic numbers affine span dimensional face contains lattice point constant period 
example consider set linear constraints mg defining rational polytope pn pn gamma delta gamma gamma gamma delta gamma delta pn closed rectangle parametric vertices 
looking observe vertex integer point 
coefficient periodic 
coefficients constant edges obviously polytope contain integer point 
looking observe vertex integer point 
coefficient periodic 
coefficients constant edges obviously polytope contain integer point 
period periodic coefficients equal denominator 
pseudo polynomial determined solving system rational linear equations computed 
example compute parametric analysis polyhedral iteration spaces count 
follows determined gamma theta delta theta theta theta nm theta theta parametric formula evaluated value example number integer points determined theta theta theta theta 
due geometric modeling non convex polytopes considered cases 
non convexity closely related kind handled problem convexity test 
case parametric vertices finding algorithm extended order consider unions convex polytopes extension consists heuristic procedure ffl compute vertices rational polytope vertex vertex pn vertex polytope belong vertex fig 

illustration vertex finding procedure non convex sets 
ffl compute vertices intersection vertex vertex pn vertex example simple dimensional example shown ffl vertex belong vertex ffl vertex vertex vertex ffl vertex belongs vertices 
vertex ffl vertex vertex vertex ehrhart polynomials count integer points non parametric polytopes helpful enumerations large domains strongly reduces cost exhaustive computations 
way introduce artificial parameter compute corresponding ehrhart evaluate polynomial value corresponding initial problem 
consider example example non parametric polytope defined 
artificial parameter introduced replacing yielding parametric polytope definition pn 
method computes ehrhart polynomial pn gamma 
computing obtained number integer points initial non parametric polytope 
observe described calculations independent size parameters considered polytope 
method applied sections exact symbolic array dataflow analysis estimation execution time determination maximum parallelism loop nests 
ph 

application parametric analysis exact symbolic array dataflow analysis proposed dependence tests included vectorization parallelization methods exact able consider true dependences consider dependences value supposed transmitted replaced 
context nested loops analysis methods proposed compute array element read iteration iteration produced 
methods commonly called array dataflow analyses 
tools yield complicated methods handle symbolic answers analyzing nested loop 
analysis allows achieve important goals conversion form linear recurrence equation array expansion dead code elimination method consists computing polytope characterizing iterations executed lexicographic order fi polytope reduced polytope characterizing iterations operations consist updating array element read answer determining iteration max lexicographically maximum reduced polytope max subject describe complete method array dataflow analysis just want show opportunity parametric tools area 
simple example 
consider loop nest question iteration iteration max max max computing value gamma max max read step compute iterations executed execution order lexicographic iterations characterized union disjoint polytopes associated particular subset iterations preceding ffl iterations characterized ffl iterations characterized yields gamma ng gamma ng reducing definition union polytopes characterizing iterations updating gammaj yields gamma gamma ng gamma gamma ng value fixed max max deduced constraint gamma max gamma computing parametric vertices resulting validity domain gives range values max max gamma occurs 
yields intermediate result array element read iteration produced iteration gamma 
parametric vertices finding algorithm considering index parameter 
upper bounds concerning index validity domains maximum values max algorithm computes validity domain gamma gamma ng maximum value taken max gamma yielding max gamma max gammaj yielding max gamma gamma gammaj 
add constraint gamma compute parametric vertices get validity domain value max occurs 
yields validity domain parametric analysis polyhedral iteration spaces way add constraint max gammaj case gamma mod yields fi add constraint max gammaj gamma case gamma mod yields fi conclude results iteration array element gamma read lastly updated iteration max max max max gamma max gamma gamma gamma mod max gammaj gammaj gamma mod max gammaj gamma gammaj undefined array element updated loop final result allows deduce kinds dependence vectors associated reading gamma gamma gamma gamma gamma gamman gammai gamman delta gamma gamman gammai gamman gamma delta disjoint iteration subsets ends vectors convex 
origins vectors overlapped iteration subsets iterations origins kinds dependences 

application parametric analysis estimation nested loop execution time consider loop nest statement want compute number flops order evaluate execution time code segment 
loop nest modeled convex polytope pn fz delta bn cg gamma gamma gamma gamma gamma gamma parametric vertices finding algorithm computes vertices defined polytope pn ffl gamma gamma gamma 
ffl 
ffl gamman gamman 
example compute ehrhart polynomial definition domain 
denominator pn 
count initial values 
lowest initial value consider definition domain initial value initial values considered 
example get initial ph 
line arrays allows resolve system equations determine 
example system dedicated determination resulting gamma 
polynomials allows resolve systems determine 
example system dedicated determination gamma gamma gamma gamma gamma gamma gamma gamma case result obtained mp mp gamma theta theta theta result obtained giving number flops executed loop nest np np mp mp gamma theta gamma theta theta notice number eventually multiplied number statements inside analyzed loop nest 

application parametric analysis maximum parallelism knowledge maximum parallelism essential optimizing nested loop parallelization processes minimum number processors needed exploit inherent parallelism known 
utilisation information shown context optimal mappings systolic algorithms 
minimum number processors reasonably reached mapping process value useful evaluate efficiency parallelization method fixed sized processor array mapping may worse cases result completely sequential programs 
consider loop nest statement loop nest modeled parameter polyhedral iteration space defined pn gamma gamma gamma gamma gamma ng assume dependence analysis loop nest yields optimal linear schedule defined iteration computed instant method determine parametric number simultaneous calculations par occurring instant order determine parametric maximum parallelism max maximum number simultaneous calculations 
multi dimensional linear schedule considered schedules simply modeled lower dimensional hyperplanes 
geometrical point view points pn resulting value parametric analysis polyhedral iteration spaces fig 

second validity domains belong parameters rational polytope defined pn ji number points par 
giving parametric definition input parametric vertices finding algorithm outputs results shown ffl parametric vertices gamma delta gamma delta ffl parametric vertices gamma delta gamma delta gamma gamma 
ffl exist par 
par defined validity domains pseudo polynomials degree pseudo period 
theorem looking deduced coefficients constant par 
determine solving system equations validity domain par par par solving system yields equations par par par 
theorem looking deduced coefficient constant 
example par par par par par par values par par initial 
par 
way determine pseudo polynomials par 
solving system gives parallelism rate instant validity domain par theta theta observe parallelism rate depend validity domain 
ii consider second validity domain 
par par par solving system yields equations par par par 
example par par par par par par ph 
par gamma gamma gamma 
way determine par gamma gamma gamma par gamma gamma gamma solving system gives parallelism rate instant second validity domain par nt gamma gamma theta theta iii results maximum parallelism deduced ffl validity domain par maximum maximum theta theta ffl second validity domain take derivative par respect par gamma theta par gamma theta gamma par increases gamma decreases maximum max gamma max integral case study necessary get exact value par max checking possible values bt max dt max yields answer gamma theta ffl maximum parallelism loop nest maximum previously maxima gamma theta :10.1.1.22.1897
methods computing parametric vertices associated domains polytope defined parametric linear constraints computing exact parametric number integer points ehrhart polynomial convex polytope union convex polytopes 
methods include original algorithm find parametric vertices extension ehrhart results number parameters 
procedures entirely automatic parametric polytope definition system linear constraints parametric vertices ehrhart polynomials 
implemented time 
uses polyhedral library available address 
fr ehrhart program program html 
method proposed enumerates integer rational polytopes single coherent algorithm 
output form ehrhart polynomials simple gives exact parametric expressions number integer points 
dealing problem 
polychronopoulos method volume computation 
form answers different min max expressions introduce 
results tend complicated 
ferrante sarkar thrash methods computing number distinct memory locations cache lines accessed loop nest 
methods handle unions polytopes compute symbolic answers compute approximation expensive methods handle cache lines touched set 
method described pugh consists set techniques dedicated simplifying initial set constraints :10.1.1.22.1897
applying tools expensive important sets constraints rational coefficients 
application intuitive consists cases adding auxiliary variables requires standard formulae sums powers author expects sufficient hard code formulae powers 
facts clearly show limits general techniques 
uses polyhedral splitting technique characterize validity domains elimination variables predetermined order 
method systematically compute exact answers 
illustrated examples possible applications 
lot applications analysis transforma parametric analysis polyhedral iteration spaces tion loop nests works cited 
applications may fields sequential program analysis combinatorics optimization 
works believe computations useful automatic parallelization achieved parametric tools 
currently studying construction opportune models methods 
grateful doran wilde useful comments suggestions 
referees helpful comments 

pugh 
counting solutions presburger formulas 
proc 
acm sigplan conference programming language design implementation 

ferrante sarkar thrash 
estimating enhancing cache effectiveness 
advances languages compilers parallel processing pages 
mit press 

stone 
footprints cache 
proc 
acm sigmetrics pp 
may 

feautrier 
processor allocation loop scheduling multiprocessor computers 
proc 
international conference supercomputing pages july 

polychronopoulos 
symbolic analysis basis parallelization optimization scheduling programs 
banerjee editor languages compilers parallel computing 
springer verlag august 
lncs proc 
th annual programming languages compilers parallel computing 

banerjee 
dependence analysis supercomputing 
kluwer academic publishers boston dordrecht london 

feautrier 
dataflow analysis scalar array 
int 
parallel programming feb 

gruber 
geometry numbers 
north holland amsterdam 

schrijver 
theory linear integer programming 
wiley new york 

sherali shetty 
nonlinear programming theory algorithms second edition 
wiley new york 

stanley 
combinatorics commutative algebra 
birkhauser boston 

stanley 
enumerative combinatorics volume wadsworth brooks cole monterey california 

rubin 
survey comparison methods finding vertices convex polyhedral sets 
mathematics operations research 

ehrhart 
sur un probl eme de eom etrie lin reine angew 
math 

ehrhart 
arithm ethode des poly en 
international series numerical mathematics vol birkhauser verlag basel stuttgart 

wilde 
parameterized polyhedra vertices 
int 
parall 
progr dec 
research report 
fr pub pub ps gz 
ehrhart 
sur les poly dimensions 
acad 
sci 
paris 

ehrhart 
sur un probl eme de eom etrie lin ii 
reine angew 
math 

macdonald 
volume lattice polyhedron 
proc 
camb 
phil 
soc 

macdonald 
polynomials associated finite cell complexes 
london math 
soc 

maydan lam 
array dataflow analysis array privatization 
proc 
acm conf 
principles programming languages pages jan 

duesterwald gupta 
soffa 
practical data flow framework array analysis optimization 
acm sigplan conf 
prog 
lang 
design implementation pages june 


estimation nested loop execution time integer arithmetics convex polyhedra 
proc 
international parallel processing symposium april 

ph 

perrin 
calculus space optimal mappings systolic algorithms processor arrays journal vlsi signal processing pages 

ph 

efficient allocation strategy mapping affine recurrences space time optimal regular processor arrays 
editors int 
conf 
pages potsdam germany sept akademie verlag 
fr pub pub ps 
ph 

perrin 
optimal mapping systolic algorithms regular instruction shifts 
int 
conf 
application specific array processors asap pages san francisco california ieee computer society press 
fr pub pub ps 
wilde 
library doing polyhedral operations 
master thesis oregon state university ph 
corvallis oregon december 
published irisa technical report pi rennes france december 

polychronopoulos 
symbolic analysis basis parallelization optimization scheduling programs 
technical report csrd univ illinois august 

ph 

volume lattice polyhedron enumerate processors parallelism 
research report 
fr pub pub ps gz 
ph 

counting solutions linear nonlinear constraints ehrhart polynomials applications analyze transform scientific programs 
th acm int 
conf 
supercomputing philadelphia may 
available research report 
fr pub pub ps gz philippe assistant professor computer science university louis strasbourg france 
research interests include automatic parallelization programs integer rational geometry non linear mapping functions calculations data 
received phd computer science university 
vincent phd student laboratory university louis strasbourg france 
research interests include automatic parallelization programs communication minimization integer rational geometry 
managing development opera research project 
just received phd computer science university louis strasbourg 
