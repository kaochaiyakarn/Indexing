estimating motion image sequences tutorial modeling computation motion christoph stiller janusz konrad robert bosch gmbh el research advanced development institut national de la recherche scientifique box place du commerce hildesheim germany qc canada christoph stiller fr bosch de konrad telecom ca fl ieee 
personal material permitted 
permission reprint republish material advertising promotional purposes creating new collective works resale redistribution servers lists reuse copyrighted component works obtained ieee 
motion prominent source temporal variations image sequences 
order model compute motion understanding needed images image motion formed 
motion image sequences acquired video camera induced movements objects scene camera motion 
camera parameters motion rotation translation focal length play important role image motion modeling 
parameters known precisely object motion needs recovered 
scenario rare object camera motion usually need computed 
motion objects camera induces motion image plane suitable projection system 
motion called apparent motion optical flow needs recovered intensity color information video sequence 
motion finds diverse applications video processing compression computer vision primarily temporal correlation intensities color image sequence high direction motion 
video compression knowledge motion helps remove temporal data redundancy attain high compression ratios motion estimation fundamental component standards mpeg family 
motion models older standards simple vector block new mpeg standard offers alternative region model permitting increased efficiency flexibility 
video processing motion information standards conversion motion compensated sampling structure conversion noise suppression motion compensated filtering deblurring motion compensated computer vision literature distinction motion optical flow term motion denote apparent motion optical flow 
consistent video compression terminology description variations image direct interest regardless compliance physical cause variation 
detailed information mpeg standards obtained mpeg home page www cselt mpeg 
appear ieee signal processing magazine july tion 
computer vision motion usually serves intermediary recovery camera motion scene structure 
compute motion trajectories basic elements need specified 
underlying models selected motion model representation region support model relating motion image data observation model motion boundary model occlusion model 
choice models parameters application dependent example occlusion model may relevant block compression essential image analysis 
secondly estimation criterion identified 
criterion may take different forms simple mean squared error block robust criterion saturation large errors complex rate distortion bayesian criterion involving multiple terms 
thirdly search strategy implemented determine motion parameters optimize selected criterion 
general suitable selection search strategy trade large extent optimization performance computational load 
strategy may deterministic stochastic nature 
exhaustive simplified search methods deterministic relaxation belong popular schemes include special cases block matching gradient methods 
best known deterministic relaxation methods iterated conditional modes highest confidence 
mean field techniques stemming statistical mechanics important deterministic optimization techniques approximation partition function 
stochastic relaxation techniques including simulated annealing dominant stochastic approaches 
important element optimization strategy hierarchical implementation order avoid violation underlying assumptions local intensity linearity reduce computational complexity algorithm 
ii 
models motion representation consider point object moving space 
position time ir expressed camera coordinates 
defines curve space time refer world motion trajectory 
time instants world motion trajectory identifies displacement position gamma review motion relationship apparent motion interest reader referred 
image acquisition system projects world image plane image coordinates sampling grid usually orthogonal lattice 
projection world motion trajectories result motion trajectories 
adopt definition motion trajectory proposed trajectory defined time interval associated point visible image 
assuming non transparent objects spatio temporal position belongs motion trajectory visible point 
depicted fig 
displacement expressed similarly displacement follows gamma appear ieee signal processing magazine july simplicity notation second subscripts omitted clear context 
fig 

motion trajectory associated displacement vector 
general motion field vector valued function continuous spatial coordinates 
practical applications function described parametric form finite usually small number parameters 
motion results projection moving objects image plane model motion fields derived models describing motion surface function camera projection geometry 
models parametric resulting motion model parametric 
simple example consider planar patch undergoing affine motion orthographic projection 
affine motion written follows gamma general theta matrix ij degrees freedom translational motion vector degrees freedom 
equation includes rigid motion special case 
rotation matrix columns rows orthonormal allowing degrees freedom corresponding rotation axes 
planar patch specified parameters ff fi fl follows ffx fiy camera model provides additional scalar equations mapping world coordinates coordinates image plane 
orthographic projection relationship holds cx cy ir substituting equations camera model surface readily obtains model motion example affine model gamma appear ieee signal processing magazine july gamma ff fl gamma fi fl gamma ff fl gamma fi fl fl cs fl cs model extensively literature motion representation 
clearly motion model uniquely correspond model identical motion models may result different assumptions motion surface camera projection models 
table summarizes parametric models motion provides possible underlying assumptions 
models illustrated fig 
model example motion vector field shown corresponding motion compensated square 
simplest translational model motion existing coding standards 
accounts rigid translational motion orthographic projection resulting spatially constant motion 
clearly motion compensation fields preserves shape 
affine motion parallel lines remain parallel motion compensated image 
affine motion planar patches perspective camera model leads parameter model linear projective coordinates 
easily seen model includes affine model special case lines remain lines motion compensation 
quadratic model proposed describe affine motion parabolic surfaces orthographic projection 
includes special cases affine model close taylor approximation parameter model 
seen fig 
motion compensation model preserve lines 
models discussed far parametric involve fixed number parameters 
models efficiently estimation interpretation transmission certain classes motion fields 
models capable describing arbitrary motion fields 
different description motion fields provided vector fields represented rectangular lattice mesh 
way number parameters varies number considered pixels 
lattice vectors motion field approximated suitable interpolation sampled field 
general interpolation kernel table small support motion vector usually interpolated samples 
frequently bilinear interpolation kernel tensor product horizontal vertical triangular kernels 
interesting generalization model complete multiresolution basis implemented perfect reconstruction non separable subband scheme 
motion sampling lattice involves site image pixel motion fields called dense 
obviously dense motion fields provide fairly general description motion estimation interpretation transmission thereof involve large amounts data 
frequently model employs triangular mesh motion vectors dense field interpolated motion vectors corners triangle 
motion sampled predetermined mesh interpolation general imprecise discontinuities motion field 
adaptive meshes proposed select sampling points way interpolated area motion field contains pixels moving object 
typically points lie intensity edges image 
image intensity patterns motion fields highly correlated spatially 
appear ieee signal processing magazine july table motion models model model number parameters motion field surface function motion camera model translational arbitrary rigid translation orthographic affine planar affine orthographic projective linear gamma planar affine perspective quadratic xy xy parabolic affine orthographic sampled delta pixels ij ij gamma delta delta gamma delta delta smooth specified interpolation kernel arbitrary polynomial jkj motion adaptive ij ij smooth specified arbitrary expected fields efficiently represented linear transforms followed zeroing high frequency components 
example polynomial transform row table includes parametric models special cases relatively coefficients 
polynomial description reduces affine description quadratic model obtained number coefficients adapted actual complexity scene error motion compensated prediction sufficiently small 
clearly sufficiently large set parameters polynomial description allows representation arbitrary motion fields 
definition displacement capture order dynamics moving point constant velocity motion 
shown second order temporal models capturing velocity acceleration substantially improve performance motion compensated predictive coding standards conversion 
capture second order effects motion trajectory modeled explicitly 
example may represented vectors appear ieee signal processing magazine july fig 

examples parametric motion vector fields sampled corresponding motion compensated predictions centered square translational affine projective linear quadratic 
see table model descriptions 
instantaneous velocity acceleration gamma gamma temporal modeling applied addition spatial modeling described far table representation motion trajectory fields displacement fields advantageous certain applications larger amounts motion information processed transmitted 
remainder denote velocity image point horizontal vertical velocity components respectively 
shall omit subscript argument clear context 
region support motion representation discussed preceding section motion image described spatially model table models table differ terms number parameters terms functional dependence parameters 
general higher number parameters higher function order precise description motion field 
time excessive number parameters may result motion excessive number degrees freedom important video processing computer vision increased coding cost important video coding 
case motion estimation accuracy may decrease 
due ill posedness motion estimation example unique solution appear ieee signal processing magazine july may exist 
precision motion field depends region support ae model set image points model applies 
true motion field rarely purely translational divergent exhibits regularity smaller region support better approximation 
quality approximation motion field measured example mean squared error jrj gamma number parameters precision motion field adjusted choosing suitable region support unfortunately error measured known computer generated synthetic images 
sections discuss different support regions proposed literature fixed variable size 
fig 

various regions support motion model global dense block region 
implicit underlying scene head shoulders type captured region model 
global motion constrained simplest case global motion motion image points displaced uniform manner 
region support model consists image fig 
assumed sampling grid orthogonal lattice kg thetaf lg numbers columns lines image 
global motion usually camera appear ieee signal processing magazine july induced case camera pan zoom 
simplest case motion image points described small set parameters affine table related camera parameters 
time constrained case parameters describe motion image points simple motion fields represented manner 
global motion model extensively computer vision applications video coding 
adopted phase ii mpeg standard sequences clear camera pan zoom substantial rate savings achieved compared standard methods solely local block motion estimation 
motion individual image points extreme spectrum region support may consist single image point fig 
fxg motion image point described set parameters displacement case linear motion velocity acceleration case quadratic trajectories equation 
pixel dense motion representation constrained parameters describe movement image point thetak thetal parameters represent motion image 
consequently large number motion fields represented possible combinations parameter values 
time method complex due number parameters involved 
purely computational point view may demanding technique pixel motion estimation definitely demanding approaches 
dense motion representation applications computer vision recovery structure video processing standards conversion deblurring noise reduction 
direct video compression shown reasonable success form pel recursive motion estimation 
approach motion vector image point causally predicted previously estimated transmitted motion vectors 
update prediction computed minimizing motion compensated prediction error 
clearly physical reason causal spatial prediction motion choice particular direction prediction 
noncausal estimation transmission pixel motion fields proved successful date potential gains precise motion description usually need transmit thousands motion parameters 
current continues direction parametric approximations dense motion table motion regions extremes find methods apply motion models table image regions 
motivation insure accurate modeling smaller approximation error motion fields global motion case reduced number parameters comparison dense motion 
simplest image partitioning nonoverlapping rectangular regions appear ieee signal processing magazine july rmn fixed size bk thetab referred blocks union covers image fig 
rmn fx gamma bk mbk gamma nb bk block partitioning simple translational motion today digital video compression standards mpeg mpeg 
successful hardware implementations due simplicity model imprecise images general motion rotation zoom deformation 
increase number degrees freedom affine motion models proposed conjunction rectangular partitioning 
models permit reduction approximation error rectangular block time assure better match intensities motion trajectories 
affine motion rectangular blocks image points hardly precise model arbitrary motion image sequences objects natural scenes rarely result rectangular projections image plane 
general image partitioning necessary 
reasoning objects sufficiently smooth surface motion induced motion fields image plane suitably described models table applied area object projection 
natural image partitioning provided image acquisition process 
typically objects move front camera straightforward group pixels arising surface object region 
objects move independently car driver 
interesting find image partitioning image points region arise objects undergo motion 
motion parameters estimated image points moving region 
cases region described follows fig 
ae arbitrarily shaped regions non overlapping union covers complete image 
find motion induced partition certain knowledge motion necessary vice versa find motion parameters partition needed 
problem solved applying segmentation followed motion estimation estimating motion parameters segmentation 
processes independent appropriate solution carry joint motion estimation motion image segmentation 
done interleaved fashion estimation segmentation steps alternate simultaneous estimation segmentation labels motion parameters location 
problem quite difficult interesting results achieved date 
important realize case arbitrarily shaped regions motion representation region consists set motion parameters region boundary description 
compared models rectangular blocks block models region model capacity perform better image matching cost complex representation 
trade wellknown video compression intensity color residual image matching error motion information transmitted limited capacity channel 
difficulty lies finding compromise precise rate costly motion representation gives small intensity color appear ieee signal processing magazine july residual coarse motion information results increased residual 
active area research today 
resulting region image description similar description language computer graphics somewhat merging worlds long time considered unrelated 
enriches worlds example objects natural imagery added computer graphics functionalities far reserved computer graphics applied natural imagery object image manipulation 
fig 

typical videoconferencing images qcif theta resolution frame america frame 
general image partitioning fixed rectangular blocks translations outperformed terms intensity color residual region affine motion models 
simple implement hardware requires fairly sophisticated image analysis 
compromise partitioning methods rectangular variable size blocks investigated 
approach block size locally reduced smaller block size improves motion compensation reduces intensity color residual 
certainly increases complexity image partition simple tree schemes quadtree block splitting overhead small 
motion estimation variable size blocks shown give substantial gains practice presently video compression standard theta blocks allowed individually split theta blocks 
motion compensation arbitrarily shaped regions adopted mpeg standard 
local translational motion partial blocks exploited higher order parametric motion complete regions approach results substantial compression gains visual quality images significantly improved object boundaries reduced effects 
demonstrate impact various regions support motion estimates fig 
shows results block pixel region motion models computed typical videoconferencing material fig 

note lack detail due low resolution theta blocks block approach approximately correct motion objects 
pixel model results smooth estimate spatial detail cost reduced precision especially window car 
seen region model assures accuracy detail associated segmentation correspond exactly objects perceived humans appear ieee signal processing magazine july block motion pixel motion region motion regions fig 

typical motion fields computed sequence fig 
different regions support theta blocks pixel globally smooth region affine motion model table 
details region algorithm see 
closely delineates object boundaries 
impact various regions support motion compensated prediction prediction error shown fig 

note blocking artifacts block motion model associated db penalty peak prediction error compared model 
db penalty region model small region pixel prediction images virtually identical 
may important video processing region model allow object manipulation significant quality penalty assuming semantically meaningful segmentations available 
region model shows db prediction gain compared block motion offset large extent increased amount data needed model description motion parameters shape regions 
presently various approaches joint motion segmentation estimation developed worldwide 
promising framework video compression video processing 
hierarchical motion models practical concept variable size block motion models regarded special case hierarchical representation exploited computer vision applications 
representation estimate case motion modeled multiple levels detail making possible extract coarse characteristics subsequently add finer appear ieee signal processing magazine july block prediction block prediction error db pixel prediction pixel prediction error db region prediction region prediction error db fig 

typical motion compensated prediction prediction error theta different regions support fig 

numerical measure shown peak prediction gain expressed db 
details 
fig 
show multiresolution representation motion field dual form 
left motion field represented multiple resolutions multiple scales time 
note follow definitions resolution scale proposed 
right shown equivalent representation obtained left representation upsampling interpolation 
representation multiple resolutions single scale 
multiresolution multiscale representation fig 
left captures coarse motion properties higher levels pyramid allowing progressively detail descending pyramid 
due scale change motion vectors located pixels apart lowest resolution pixels apart full resolution level pyramid dyadic subsampling 
consequently appear ieee signal processing magazine july fig 

dual representation motion field multiple resolutions multiple scales left single scale right 
representations equivalent identical information obtained filtering downsampling upsampling interpolation operators 
models imposing spatial interaction neighboring motion vectors smoothness interactions enforced lower resolution higher scale levels shorter range ones recovered higher resolution lower scale levels pyramid 
mentioned representations fig 
equivalent 
multiscale representation left practical estimation algorithms due computational efficiency representation right transparent certain theoretical considerations example assure consistency motion models different resolutions 
discussed section iv 
single scale representation thought motion model adjustable region support 
early example model motion parameters confined large blocks fine tuned smaller blocks shown 
allows early capture macroscopic motion properties subsequent refinement 
approach taken allowing spatially nonuniform adjustment size region support done example quadtree splitting 
interdependence motion image data essence motion estimation algorithm lie assumptions relationship motion parameters image intensity 
image intensity position 
usual reasonable assumption image intensity remains constant motion trajectory 
assumption implies intensity change due motion scene illumination constant object surfaces opaque lambertian surfaces 
constraints satisfied exactly constant intensity assumption approximately describes dominant properties natural image sequences motion estimation methods usually 
variable motion trajectory 
constant intensity assumption translates appear ieee signal processing magazine july constraint equation dg ds applying chain rule equation written known motion constraint equation rg denotes spatial gradient velocity 
constraint equation continuous form discrete approximation served basis algorithms estimating linear motion 
assumption estimate nonlinear motion trajectories multiple images constraint expressed frequency domain applied directly intensities 
note equation applied position underconstrained determines component velocity direction image gradient 
due called aperture problem additional constraints uniquely solve 
color important attribute images possible extension model include chromatic image components constraint equation 
motivation areas uniform intensity substantial color detail inclusion color constraint prove beneficial 
vector attributes associated image example luminance defined itu recommendation 
constant color constraints written jointly vector form follows general estimates obtained constraint reliable calculated equation due additional information exploited 
equation vector equation different components may closely related additional constraints may needed 
return constraints section 
assumption intensity constancy usually approximately satisfied particularly violated scene illumination changes 
alternative constraint spatial gradient constancy direction motion proposed ds equation rewritten follows rg relaxes constant intensity assumption requires amount dilation rotation image negligible limitation satisfied practice note worthwhile noting constant intensity assumption valid intensity gradient changes amplitude dilation direction rotation 
appear ieee signal processing magazine july linear vector equations unknowns practice lend direct computation motion need supported appropriate motion model 
primary reason practice constraints satisfied exactly 
furthermore constraint second order image derivatives 
difficult compute reliably due high pass nature operator usually data smoothing performed 
assure smoothness resulting motion fields post filtering applied 
order alleviate problems associated noise vanishing gradients may lead ill posedness alternative approach minimization norm ds smoothness constraint developed 
approach demonstrated robust presence time varying illumination 
different approach handling nonconstant intensity direction motion explicit modeling illumination 
approach promising requires complex minimization addition motion field illumination fields estimated 
constraints discussed find different applications practice 
discrete version constant intensity constraint applied video compression results small prediction error 
motion computed color vector constraint experience shows small gains achieved justify substantial increase complexity 
motion estimation color data useful video processing tasks motion compensated filtering resampling motion errors may result visible distortions 
vector constraint interesting estimating motion multiple data sources range intensity data 
gradient constraint employed computer vision find true motion despite varying illumination 
iii 
estimation criteria various motion representations relationship motion images discussed previous section formulate estimation criterion 
unique criterion motion estimation 
difficulty establishing criterion primarily caused fact motion images directly observable particular dynamics intensity image sequence may induced motion 
problem models discussed far ideal 
example constant intensity model expressed motion constraint equation underconstrained time violated due factors noise surface reflections occlusions spatio temporally varying illumination 
attempts establish suitable criteria motion estimation require implicit explicit modeling image sequence 
see result motion motion measure motion directly indirect measurements intensity change 
appear ieee signal processing magazine july dfd criteria important class criteria arising constant intensity assumption aims minimization error gamma called motion compensated prediction 
complete image error called displaced frame difference dfd block arbitrarily shaped region corresponding error called displaced block difference displaced region difference 
subscripts may omitted notation clear context 
general real valued intensities positions outside sampling lattice recovered suitable interpolation method 
estimation methods requiring intensity gradients assure continuous interpolated intensity usually sufficient 
case methods employing intensity gradients discussed section iii 
motion fields calculated solely minimization magnitude prediction error general highly sensitive noise number pixels region support large compared number motion parameters estimated region poorly textured chapter 
minimization may yield estimates parametric motion models parameters reasonable region size 
measure magnitude prediction error common choice norm 
norm corresponds mean squared motion compensated prediction error gamma criterion unreliable presence outliers single large error large biases estimate robust mean absolute error criterion jg gamma criterion choice practical video coders today 
criterion sensitive bias due piecewise linear dependence time involved computationally 
median squared error criterion med gamma due median operator criterion differentiable function log gamma gamma oe delta due saturation error function outliers oe scale parameter perform require computations 
interesting discussion robust estimation criteria context motion estimation 
appear ieee signal processing magazine july frequency domain criteria class criteria motion estimation uses transforms fourier transform example due shift property fourier transform image undergoing spatially constant motion satisfies ffg ffg exp denotes spatial frequency 
directly estimated phase standard precautions need taken remove phase ambiguity phase wrapping period 
idea extended constant velocity motion gamma noting ffi gamma vt ffi dirac delta function denotes convolution 
fourier transform easily shown ffg ffg ffi temporal frequency 
clearly case uniformly translating image constant intensity assumption fourier spectrum zero spatio temporal frequency space plane orientation uniquely defined velocity fig 

estimation reduced search maximum occupancy planes spectrum 
done wigner distribution 
unfortunately due lack suitable theorems spectral techniques applied arbitrary motion models table 
xg yg yg xg fig 

nonzero plane fourier spectrum image sequence motion darker plane spatially constant motion brighter plane 
regularization dealing underconstrained nature equation restricting motion model parameters approach explicitly model additional constraints 
done appear ieee signal processing magazine july weak constraint estimate reflecting empirical observation typical motion fields spatially smooth 
pivotal contribution horn schunck penalized squared error resulting motion constraint equation smoothness term yielding continuous gamma kru delta dx practice dealing discrete sampled images integral replaced summation derivatives replaced discrete approximations 
example average order differences computed theta theta cube 
order differences poor derivative approximations severely bias solutions higher order differences necessarily solve problem 
solution produce continuous intensity continuous derivative intensity derivative convolving intensity derivative interpolating kernel 
general small kernel operators preferable operation applied pixels 
results discrete variant obtained bi cubic interpolator developed 
interesting solution discussion problem joint optimization derivative blurring filters frequency domain described 
smoothness term ill posed problem motion estimation aperture effect turning posed problem 
scalar balancing constant intensity assumption motion smoothness termed regularization constant 
practical reasons equation expressed discrete form term replaced second term discrete version laplacian operator 
formulation referred regularized formally term longer quadratic highly irregular irregularity due dependence image data 
criterion may multiple minima making problem ill posed 
formulation terms directly quadratic assuring unique minimum 
due smoothness term equation referred weak membrane model physics describes energy membrane extended reaching minimum steady state 
data term accounts external forces smoothness term accounts elastic forces elasticity constant 
undesired property smoothness term enforces smooth motion image realistic motion fields exhibit discontinuities object boundaries 
order avoid smoothing object boundaries intensity edges may extracted smoothness term may applied edges 
procedure motivated observation object boundaries coincide intensity edges 
reason oriented smoothness constraint proposed applies smoothing direction locally constant intensity 
investigations show oriented smoothness constraint plausible hadamard definition problem called posed unique solution continuously depends data 
appear ieee signal processing magazine july separable constraints order 
proposed preserve boundaries motion fields nonstationary autoregressive modeling line process representing motion discontinuities smoothness suspended line elements switched 
example adaptively smooth motion field associated line process shown fig 

note improved motion discontinuities object boundaries 
line process model discontinuity local better object delineation usually achieved region approach fig 

pixel motion adaptive smoothness line process fig 

typical motion field computed sequence fig 
dense adaptively smooth line process motion model example combination 
bayesian criteria general framework motion field estimation provided bayesian methods 
motion field realization random field posteriori probability distribution 
estimate computed special realization posteriori distribution mean mode 
motion field estimated image realization previous image posteriori probability distribution formally written bayes rule follows djg jd delta probability measure 
notation semicolon indicates subsequent variables deterministic parameters 
pair images denominator normalizing constant 
factors numerator modeled separately observation model priori model respectively 
specific consider maximum posteriori map estimate arg max djg arg max jd delta arg min gamma log jd gamma log term denotes likelihood image motion field previous image 
compute motion compensated prediction common observation appear ieee signal processing magazine july model assume likelihood completely specified random field models displaced frame difference jd various distributions proposed zero mean white gaussian gamma oe delta exp gamma oe laplacian segment wise stationary generalized gaussian 
special consideration violations constant intensity assumption robust estimation suppression outliers modeling varying illumination occlusions examples 
displaced frame difference model formulation related minimum description length mdl estimation 
known coding theory optimal encoder attains code length gammalog coding sample random variable code length referred description length self information 
hybrid video coding schemes motion transmitted receiver displaced frame difference signal 
achieve high compression lossy transmission applied cost reducing image quality 
term minimization denotes description length displaced frame difference second term denotes description length motion field 
data compression point view map estimate motion field minimizes theoretical code length lossless encoding video sequence 
relationship rate constrained motion estimation coding gain resulting transmission motion vector related cost description length 
worthwhile note motion field uniform priori distribution posteriori distribution depends displaced frame difference 
words statistical point view methods minimize displaced frame difference perform maximum likelihood estimation 
incorporate prior knowledge estimate priori distribution displacements selected 
numerous forms distribution proposed literature 
order exploit correlation displacements adjacent sites priori distribution may favor displacements close expected displacement deterministic unknown oe exp gamma kd gamma oe expected displacement may computed causal prediction displacement estimates adjacent sites previous frames 
scalar oe may viewed regularization constant balancing small displaced frame difference high correlation motion fields 
spatially causal model advantageous computationally spatial causality justified displacement fields time dependent signals speech 
elegant noncausal models capturing properties smoothness provided gibbs markov random fields 
random fields require specification neighborhood system neighborhood ae site 
neighborhood systems satisfy conditions appear ieee signal processing magazine july ffl site neighbor ffl neighborhood membership symmetric fig 
depicts second order neighborhood structures image processing consist nearest sites respectively 
important element gibbs random field definition clique 
clique subset different elements neighbors fig 

set cliques denoted denote vector elements associated sites associated cliques order neighbourhood site site sites associated cliques second order neighbourhood site site sites fig 

neighborhoods cliques order second order neighborhood systems 
discrete valued gibbs markov random field respect neighborhood system defined gibbs distribution exp gammah hamiltonian partition sum defined follows exp gammah definitions may real function variables variables sites clique nontrivial condition defined distribution ir finite 
continuous valued gibbs distributions defined way partition sum replaced integral called partition function 
important feature gibbs markov fields markov property jd dy conditional distribution single variable completely specified variables dy neighborhood reason conditional distribution referred local characteristic 
mentioned smoothness constraints easily modeled gibbs markov random fields example second order gibbs markov random field pair potential fx yg kd gamma fx yg appear ieee signal processing magazine july vanishing potential cliques comprising number elements 
model yields discretized version weak membrane model euclidean norm 
constructing priori distribution combining discussed observation models map criterion welldefined 
gibbs markov random fields allow explicit modeling discontinuities 
straightforward way model discontinuities binary valued line field dual lattice fig 

line field incorporated bayesian formulation replacing respectively 
line process influence observation model priori model defined gibbs markov random field fx zg kd gamma gamma fx zg fzg fzg motion smoothness constraint fx zg suspended line process switched 
time fzg defined single element cliques penalizes discontinuities 
model improved extending neighborhood line elements considering cliques depicted fig 
order favor continuity smoothness line process 
extended line process models discontinuities motion vectors element motion vector cliques second order neighborhood model proposed 
resulting line process includes line elements pixel 
pixel site line site neighbourhood line site line lattice neighbourhood pixel site element line cliques single element line clique element mixed clique fig 

line field lattice neighborhood system associated cliques 
way model discontinuities explicitly segmentation 
segmentation represented generic label field pixels region possess label 
region support smoothness constraint limited label sites priori distribution label field modeled appear ieee signal processing magazine july second order gibbs markov random field fx yg kd gamma ffi gamma gamma ffi gamma fx yg delta function term suspends smoothness constraint region boundaries 
second term favors compact regions short boundaries 
formally similar line process segmentation offers advantage images partitioned meaningfully individual segments tend undergo continuous motion 
segments correspond continuous surfaces objects real world segmentation may considered tool estimate discontinuous motion valuable information 
worthwhile note motion smoothness constraint extended temporal direction direction motion trajectories 
extension idea explicit modeling motion trajectories estimation associated parameters 
example motion trajectories modeled second order curves equation parameters velocity acceleration estimated frames deterministic relaxation 
shown fig 
model give gains motion compensated video sequence interpolation reduction reconstruction error due inclusion acceleration evident visually mouth eyes numerically 
possible applications approach video standards conversion low bit rate video coding order reconstruct missing frames receiver transmission usually lower temporal rates 
iv 
search strategies models expressing knowledge motion images specified estimation criterion selected remains done identify estimation procedure 
procedure involves optimization selected criterion respect parameters chosen model 
dense motion fields number unknowns may large may state spaces exhaustive search complete state space rare exceptions computationally prohibitive 
discuss faster search strategies 
matching small number motion parameters small state space common search strategy minimizing prediction error matching 
approach motion compensated predictions various motion candidates compared original image region support motion model 
candidate yielding best match criterion optimal estimate 
small state spaces case block constant motion models today video coding standards full state space motion vector examined 
leads exhaustive search block matching 
assuming estimation criterion varies slowly state space near motion estimate sought hierarchical search strategies applied reduce computational complexity 
strategies aim successive improvement estimate subsequent levels hierarchy 
appear ieee signal processing magazine july interpolation linear error linear db velocity quadratic model interpolation quadratic error quadratic db acceleration quadratic model interpolation image linear error linear db velocity quadratic model interpolation quadratic error quadratic db acceleration quadratic model fig 

interpolated error images velocity acceleration fields motion compensated interpolation sequence america fig 
linear quadratic trajectories equation global smoothness constraint frame frame 
case images estimation details algorithm see 
numerical measure shown interpolation error expressed db 
appear ieee signal processing magazine july level small number motion candidates examined 
fig 
illustrates hierarchical search case step block matching higher level hierarchy lower search resolution 
coarse estimate computed highest level best match motion search positions highest level search positions intermediate level search positions lowest level state space motion vector fig 

step search strategy block matching 
vector candidates 
state space level considered subsampled version motion vector state space full resolution 
lower levels estimate successively refined testing set nearby vector candidates 
clearly hierarchical techniques guarantee finding global optimum may trapped local optimum estimation criterion reduction computational load compromises quality motion estimates 
note example fig 
motion model hierarchical multiscale multiresolution discussed section ii search strategy hierarchical 
hierarchical search strategies discussed section iv 
relaxation dense motion fields noncausal model simultaneous optimization parameters hundreds thousands may computationally prohibitive alleviate problem relaxation techniques construct sequence estimates consecutive estimates differ variable 
lets consider estimation dense motion field series motion fields constructed consecutive estimates gamma differ single site predetermined site visiting order line scanning selected randomly 
step relaxation procedure motion vector single site needs computed vectors sites remain unchanged 
deterministic relaxation motion vector selected respective state space certainty 
example new local estimate computed minimizing criterion variables updated criterion monotonically improved step step 
known deterministic relaxation technique method iterated conditional modes icm 
bayesian estimation criterion optimal motion vector selected full state pel recursive methods causal model dense motion computationally inexpensive accuracy usually lower methods noncausal motion models 
appear ieee signal processing magazine july space follows arg max gamma jg gibbs markov field expression significantly simplified conditional probability distribution single variable completely specified neighborhood 
arg max jd gamma relaxation techniques particularly suitable estimation gibbs markov fields 
computational complexity reduced selecting limited set motion vector candidates proposed bayesian block matching 
deterministic relaxation techniques capable correcting spurious motion vectors initial state major drawback get trapped local optimum near initial state 
availability initial state may include large scale information optimum crucial 
dependence initial state reduced stochastic relaxation 
contrast deterministic techniques motion vector consideration selected randomly allowing small probability momentary deterioration criterion 
earliest stochastic relaxation techniques metropolis algorithm 
adaptation estimation motion vectors candidate vectors considered relaxation step vector previous iteration gamma new candidate vector randomly selected single site state space 
site selected randomly 
new candidate larger probability previous new vector accepted new candidate accepted probability gamma previous estimate gamma kept probability gamma clearly lower probability new candidate lower likelihood acceptance 
important stochastic relaxation technique gibbs markov random fields gibbs sampler selects randomly probability 
shown estimates metropolis algorithm gibbs sampler independent initial state maximize posteriori distribution approaches infinity 
order find map estimate algorithms combined simulated annealing 
optimization technique simulates physical systems large number particles 
equilibrium systems follow boltzmann distribution exp gamma kb kb denotes boltzmann constant absolute temperature hamiltonian system 
writing posteriori distribution form equation selecting appear ieee signal processing magazine july realizations monotonically decreasing annealing schedule annealing physical system simulated 
clearly approaching zero delta converges dirac impulse map estimate 
sufficiently large sufficiently slow annealing schedule simulated annealing metropolis algorithm gibbs sampler shown converge map estimate 
required annealing schedule extremely slow 
practice simulated annealing applied faster annealing schedule yielding suboptimal results 
hcf method deterministic optimization technique markov random fields updates single site step highest confidence hcf algorithm 
contrast relaxation schemes site visiting schedule fixed driven input data 
initially sites marked uncommitted 
new priori probability defined original modifying clique potentials equation follows sites committed 
site influence neighbors committed 
site visiting order controlled non positive stability field opt gamma opt uncommitted opt gamma opt arg min opt arg min opt denote fields best second best vectors respectively site vectors sites 
step site minimum stability updated marked committed 
procedure stops complete field committed complete stability field zero 
hcf algorithm selects sites peaked likelihood function typically case highly structured regions 
algorithm includes sites may possess ideal likelihood function building neighborhood information estimated sites 
variables committed sites influence optimization initially sites uncommitted estimated field independent initial state 
gradient optimization gradient techniques require estimation criterion differentiable 
criterion depends motion parameters image function usually approximated taylor expansion respect motion parameters 
differentiation taylor approximated criterion involves differentiation interpolation image intensities discussed section iii 
due taylor approximation model applicable small appear ieee signal processing magazine july vicinity desired motion estimate 
comes surprise gradient estimation reported yield accurate estimates regions small motion approach fails motion large 
partially compensated low pass filtering image sequences 
due loss image detail accuracy estimates suffers 
solution problem accurate estimate initial state estimation images 
approach discussed section iv 
mean field techniques theoretical analysis gibbs markov random fields performed equilibrium statistical mechanics 
mean field approaches proven powerful tool approximation mean fields 
outlined section iv map estimate field governed distribution equation mean 
fundamental difference mean field annealing stochastic annealing deterministic procedure demonstrated practice converge quickly 
mean field optimization necessitate annealing performed zero temperature right start 
experiments higher temperatures prove beneficial optimization due improved smoothness objective function 
motivation mean field techniques important result statistical mechanics stating mean values gibbs markov random field obtained partition function 
purpose partition function considered function data 
mean field approaches formulate desired mean field partition function approximate partition function assuming sum governed realizations near equilibrium state 
benefit property typical optimization criteria exhibit fewer local optima higher temperatures 
design deterministic optimization procedures find initial estimates high temperatures improve decreasing temperature annealing 
concisely illustrate ideas example see equations deltag oe fx yg kd gamma rg denote spatial image derivatives deltag gamma gamma frame difference prior distribution mean field horizontal displacement temperature defined exp gamma kb denotes expectation rewritten terms partition function gamma oe kb deltag exp gamma kb gamma oe kb deltag mean field vertical component way 
expression mean field partition function directly provide optimization procedure appear ieee signal processing magazine july exact computation partition function general prohibitive task 
mean field optimization approximation partition function saddle point approximation mean field approximation 
assumption influence neighboring motion vectors single motion vector approximated influence mean neighbors 
approximate hamiltonian mf follows deltag oe gx kd gamma mf deltag oe gx kd gamma mfx separable respect mfx depends motion vector site 
partition function mf defined mf separable computation mean field equation mf deltag oe gx kd gamma worth noting mean field calculation site depends mean field values neighboring sites 
iterative schemes similar relaxation procedures optimization 
mean field annealing starts higher temperatures local optima distinctive tends avoid 
contrast simulated annealing guarantee reach global optimum 
hierarchical optimization search strategies preceding sections computationally expensive 
lower computational burden hierarchical motion representations discussed section ii exploited follows 
multiresolution multiscale approach left side fig 
motion field represented multiresolution pyramid 
usually dyadic structure employed 
assuming simplicity orthogonal sampling grid grid level defined follows gamma set integer numbers 
motion field represented grid denoted clearly grid lowest level original image grid motion field level desired estimate 
likewise image sequence may represented multiple resolutions successive low pass filtering subsampling 
multiresolution multiscale motion estimation motion parameters computed lowest resolution 
computational load task low compared estimation full resolution dimension state space motion vector fields reduced appear ieee signal processing magazine july amplitude motion reduced due scale change levels motion pyramid discussed section ii methods spatial smoothness constraint equation converge faster nonhierarchical counterparts 
consequence coarse estimate rapidly highest level especially fast schemes deterministic relaxation 
suitable projection estimate decreased scale serve initial state motion estimate lower level pyramid 
detailed information added level optimization scheme 
procedure repeated estimate lowest level pyramid 
estimation criterion formulated motion fields original image grid appropriate criteria motion levels need defined multiresolution optimization 
performed heuristic modifications consistent way derived recalling equivalence multiresolution representations multiple scales single scale illustrated fig 

field level left pyramid fig 
reduced scale suitable projection oe transferred equivalent field right pyramid 
fields represented single scale estimation criterion naturally formulated levels 
oe equation estimation criterion applied fields oe single scale pyramid 
forms hamiltonian reformulations derived single scale multiscale representation image sequence 
reformulations require explicit scale reduction improve computational efficiency 
fig 
illustrates results multiresolution multiscale motion estimation synthetic image pair 
note smooth increase vector amplitude affine motion true field progressively recovered estimated motion pyramid 
hand fig 
shows results region multiresolution multiscale motion estimation natural image 
underlying estimation criterion gibbs markov random fields details 
estimated fields general consistent human perception 
estimates reveal phenomena frequently observed motion estimation 
local problems persist areas nonunique motion moving reflections table 
furthermore segmentation shows certain degree inaccuracy low texture areas segments similar motion 
effect due low motion contrast phenomenon similar low image contrast intensity segmentation 
note resulting estimate uncovered background regions close reality 
transferring motion information strictly top bottom estimation pyramid methods developed transfer information directions pyramid 
approach top bottom approach implements feedback higher resolution estimates lower resolution levels facilitating recovery motion errors lower resolutions 
control strategy bi directional flow algorithm trivial 
appear ieee signal processing magazine july fig 

synthetic image pair multiple resolutions multiresolution multiscale motion estimate left underlying true motion right 
true motion field inner rectangle example affine motion similar shown fig 
details see 
summary reviewed estimation motion time varying images paying particular attention underlying models estimation criteria optimization strategies 
parametric nonparametric models representation motion vector fields motion trajectory fields discussed 
region support models determine dimensionality estimation problem amount data subsequently interpreted transmitted 
interdependence motion image data addressed 
shown ideal constraints may provide defined estimation criterion 
data term estimation criterion usually supplemented smoothness term may expressed explicitly implicitly constraining motion model 
paid particular attention statistical criteria markov random fields 
optimization estimation criterion typically involves large number unknowns fast search strategies 
cover possible aspects motion estimation believe helpful researchers practitioners working fields video compression processing computer vision 
understanding issues involved computation motion significantly increased decade far generic robust real time motion estimation algorithms 
selection best motion estimator highly dependent application 
broad variety estimation models criteria optimization schemes treated unified framework allowing direct comparison leading deeper understanding properties resulting estimators 
appear ieee signal processing magazine july vi 
prof eric dubois reading commenting early version manuscript 
anonymous reviewer helping improve manuscript 
aggarwal computation motion sequences images review proc 
ieee vol 
pp 
aug 
aisbett optical flow intensity weighted smoothing ieee trans 
pattern anal 
machine intell vol 
pp 
may 
anandan computational framework algorithm measurement visual motion intern 
comput 
vis vol 
pp 

bergeron dubois gradient algorithms block oriented map estimation motion application motion compensated temporal interpolation ieee trans 
circuits syst 
video technol vol 
pp 
mar 
poggio torre ill posed problems early vision proc 
ieee vol 
pp 
aug 
besag statistical analysis dirty pictures journal royal statistical society ser vol 
pp 
aug 
black combining intensity motion incremental segmentation tracking long image sequences proc 
european conf 
computer vision pp 
may 
black robust incremental optical flow 
phd thesis yale university department computer science sept 
blake zisserman visual reconstruction 
mit press 
katsaggelos recursive nonstationary map displacement vector field estimation algorithm ieee trans 
image processing vol 
pp 
apr 
burt smart sensing pyramid vision machine proc 
ieee vol 
pp 
aug 
ccitt recommendation video codec audiovisual services theta kbits com xv 
konrad estimation compensation accelerated motion temporal sequence interpolation signal process image commun vol 
pp 
nov 
chan yu variable size block matching motion compensation applications video coding iee proc 
commun 
speech vis vol 
pp 
aug 
chang tekalp algorithm simultaneous motion estimation scene segmentation proc 
ieee int 
conf 
acoustics speech signal processing vol 
pp 
apr 
chang tekalp simultaneous motion estimation segmentation ieee trans 
image processing vol 
pp 
sept 

chen giannakis spatio temporal approach time varying global image motion estimation ieee trans 
image processing vol 
pp 
oct 
chou brown theory practice bayesian image labelling intern 
comput 
vis vol 
pp 

cover thomas elements information theory 
wiley series telecommunications john wiley sons ed 

dang 
mansouri konrad motion estimation region video coding proc 
ieee int 
conf 
image processing vol 
ii pp 
oct 
de micheli torre uras accuracy computation optical flow recovery motion parameters ieee trans 
pattern anal 
machine intell vol 
pp 
may 
diehl object oriented motion estimation segmentation image sequences signal process image commun vol 
pp 
feb 
motion field estimation complex scenes proc 
spie visual communications image processing vol 
pp 
nov 
dubois konrad estimation motion fields image sequences application motion compensated processing motion analysis image sequence processing eds ch 
pp 
kluwer academic publishers 
nicolas vector quantization motion field segmentation entropy criterion vis 
commun 
image represent vol 
pp 
dec 
motion estimation techniques digital tv review new contribution proc 
ieee vol 
pp 
june 
appear ieee signal processing magazine july katsaggelos nonstationary ar modeling constrained recursive estimation displacement field ieee trans 
circuits syst 
video technol vol 
pp 
dec 
investigations multigrid algorithms estimation optical flow fields image sequences comput 
vis 
graph 
image process vol 
pp 

dubois coding image sequence intensities motion trajectories ec quantization proc 
ieee int 
conf 
image processing pp 
nov 

motion displacement estimation affine model image matching opt 
eng vol 
pp 
july 
geiger girosi parallel deterministic algorithms mrf surface reconstruction ieee trans 
pattern anal 
machine intell vol 
pp 
may 
geman geman dong boundary detection constrained optimization ieee trans 
pattern anal 
machine intell vol 
pp 
july 
geman geman stochastic relaxation gibbs distributions bayesian restoration images ieee trans 
pattern anal 
machine intell vol 
pp 
nov 
relaxing brightness constancy assumption computing optical flow tech 
rep mit artificial intelligence laboratory june 
girod rate constrained motion estimation proc 
spie visual communications image processing vol 
pp 
sept 
multilevel relaxation low level computer vision multiresolution image processing analysis rosenfeld ed pp 
berlin heidelberg springer verlag 
hierarchical motion detection 
phd thesis univ massachusetts dept comp 
inform 
sci feb 
haralick shapiro computer robot vision 
addison wesley 
heitz bouthemy multimodal estimation discontinuous optical flow markov random fields ieee trans 
pattern anal 
machine intell vol 
pp 
dec 
heitz perez bouthemy multiscale minimization global energy functions visual recovery problems cvgip image vol 
pp 
jan 
hildreth computations underlying measurement visual motion artif 
intell vol 
pp 

horn robot vision 
cambridge ma mit press 
horn schunck determining optical flow artif 
intell vol 
pp 

hutchinson koch luo mead computing motion analog binary resistive networks computer vol 
pp 
mar 
iso iec jtc mpeg information technology coding moving pictures associated audio digital storage media mbit 
iso iec jtc mpeg information technology generic coding moving pictures associated audio information 
iso iec jtc sc wg mpeg video verification model version july 
iso iec jtc sc wg mpeg version visual working draft revision feb 
itu recommendation video coding narrow telecommunication channels kbit 
jacobson wechsler derivation optical flow spatiotemporal frequency approach comput 
vis 
graph 
image process vol 
pp 

video coding motion compensation polynomial motion vector fields signal process image commun vol 
pp 
july 
kato parallel image classification multiscale markov random fields proc 
ieee int 
conf 
acoustics speech signal processing vol 
pp 
apr 
keys cubic convolution interpolation digital image processing ieee trans 
acoust 
speech signal process vol 
pp 
dec 
kirkpatrick gelatt jr vecchi optimization simulated annealing science vol 
pp 
may 
konrad bayesian estimation motion fields image sequences 
phd thesis mcgill university dept electr 
eng june 
konrad dubois estimation image motion fields bayesian formulation stochastic solution proc 
ieee int 
conf 
acoustics speech signal processing pp 
apr 
konrad dubois bayesian estimation discontinuous motion images simulated annealing proc 
conf 
vision interface vi pp 
june 
konrad dubois comparison stochastic deterministic solution methods bayesian estimation motion image vis 
comput vol 
pp 
aug 
appear ieee signal processing magazine july konrad dubois bayesian estimation motion vector fields ieee trans 
pattern anal 
machine intell vol 
pp 
sept 
konrad improved global motion estimation 
iso iec jtc sc wg mpeg feb 
nicolas compact motion representation global features semantic image sequence coding proc 
spie visual communications image processing pp 

metropolis rosenbluth rosenbluth teller teller equation state calculations fast computing machines chem 
phys vol 
pp 
june 
computational analysis visual motion 
new york plenum press 
dubois estimation motion fields image sequences illumination variation proc 
ieee int 
conf 
acoustics speech signal processing pp 
may 
moulin krishnamurthy woods multiscale modeling estimation motion fields video coding ieee trans 
image processing vol 
pp 
dec 
hotter ostermann object oriented analysis synthesis coding moving images signal process image commun vol 
pp 
oct 

nagel estimation optical flow relations different approaches new results artif 
intell vol 
pp 


nagel investigation smoothness constraints estimation displacement vector fields image sequences ieee trans 
pattern anal 
machine intell vol 
pp 
sept 
nicolas global motion identification image sequence analysis coding proc 
ieee int 
conf 
acoustics speech signal processing pp 
may 
nicolas region motion estimation deterministic relaxation schemes image sequence coding proc 
ieee int 
conf 
acoustics speech signal processing vol 
pp 
apr 
patti tekalp digital video standards conversion presence accelerated motion signal process image commun vol 
pp 
june 
rissanen universal prior integers estimation minimum description length annals statistics vol 
pp 

robbins netravali recursive motion compensation review image sequence processing dynamic scene analysis huang ed pp 
springer verlag 
price motion estimation frames ieee trans 
pattern anal 
machine intell vol 
pp 
may 
sikora mpeg digital video coding standards ieee signal process 
magazine vol 
pp 
sept 
chellappa lichtenstein pyramid implementation optimal step conjugate search algorithms low level vision problems ieee trans 
pattern anal 
machine intell vol 
pp 
nov 
simoncelli distributed representation analysis visual motion 
phd thesis massachusetts institute technology dept electr 
eng 
comp 
sci jan 
snyder mathematical foundations smoothness constraints determination optical flow surface reconstruction ieee trans 
pattern anal 
machine intell vol 
pp 
nov 
special issue mpeg ieee trans 
circuits syst 
video technol feb 
stiller motion estimation coding moving video kbit gibbs modeled vector field smoothing proc 
spie visual communications image processing vol 
pp 
oct 
stiller 
phd thesis aachen univ techn ber 
vdi ser 
vdi verlag 
german 
stiller object oriented video coding employing dense motion fields proc 
ieee int 
conf 
acoustics speech signal processing vol 
pp 
apr 
stiller object estimation dense motion fields ieee trans 
image processing vol 
pp 
feb 
stiller combined displacement estimation segmentation image sequences proc 
spie video communications pacs medical applications vol 
pp 
apr 
stiller gain cost displacement estimation image sequence coding proc 
ieee int 
conf 
acoustics speech signal processing vol 
iv pp 
may 
tekalp digital video processing 
prentice hall ptr 
tikhonov eds ill posed problems natural sciences 
moscow mir publishers 
pastor velocity estimation image sequences second order differential operators proc 
ieee int 
conf 
pattern recognition pp 
july 
treves konrad motion estimation compensation varying illumination proc 
ieee int 
conf 
image processing vol 
pp 
nov 
appear ieee signal processing magazine july tsai huang estimating dimensional motion parameters rigid planar patch ieee trans 
acoust 
speech signal process vol 
pp 
dec 
vetterli kovacevic wavelets subband coding 
signal processing prentice hall 
wang lee active mesh feature seeking tracking image sequence representation scheme ieee trans 
image processing vol 
pp 
sept 
wu kittler differential method simultaneous estimation rotation change scale translation signal process image commun vol 
pp 
may 
wu kittler gradient method general motion estimation segmentation vis 
commun 
image represent vol 
pp 
mar 
zhang mean field theory em procedures markov random fields ieee transactions signal processing vol 
pp 
oct 
appear ieee signal processing magazine july fig 

results region multiresolution motion estimation applied sequence salesman original frame original frame subsampled motion field estimate segmentation boundaries superimposed frame occlusion areas horizontal vertical motion shown intensity 
