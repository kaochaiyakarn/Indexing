monte carlo techniques direct lighting calculations appear acm transactions graphics peter shirley program computer graphics engineering theory center cornell university ithaca ny wang alias research richmond street east toronto canada kurt zimmerman department computer science lindley hall indiana university bloomington distribution ray tracer crucial part direct lighting calculation sampling strategy shadow ray testing 
monte carlo integration importance sampling carry calculation 
importance sampling involves design integrand specific probability density functions generate sample points numerical quadrature 
probability density functions aid direct lighting calculation luminaires various simple shapes 
method defining probability density function set luminaires allows direct lighting calculation carried sample regardless number luminaires 
cr categories subject descriptors mathematical computing quadrature numerical differentiation computer graphics general computer graphics dimensional graphics realism 
additional key words phrases direct lighting importance sampling luminaires monte carlo integration ray tracing realistic image synthesis 
monte carlo methods extensively image rendering cook landmark distribution ray tracing 
monte carlo techniques classic ray tracing view dependent methods zonal view independent methods hybrid techniques 
implementations handled direct lighting monte carlo integration view dependent manner stored indirect lighting kind spatial lookup table 
extends traditional monte carlo methods carrying direct lighting calculation applied scenes hundreds thousands luminaires light emitting objects 
method designed tens thousands samples numerical quadrature technically low sampling density meaning results traditional asymptotic analysis directly applicable 
follow advice focus design probability lighting separated components image synthesis programs emitted self emitted lighting originates object called luminaire direct lighting consists light emitted luminaire reflected exactly surface reaching viewer indirect lighting consists light emitted luminaire reflects surfaces reaching viewer 
density functions suited particular characteristics arise direct lighting calculations 
shown kajiya radiance point scene written integral equation set points environment direct lighting component radiance dimensional integral opposed integral equation set points scene 
shown cook direct lighting integral natural target monte carlo integration 
difficult question application monte carlo integration probability density function generate sample points domain integration 
especially difficult direct lighting calculation domain typically surfaces complex dimensional environment 
selection density function produces low variance solution key step applying monte carlo integration 
attempt find probability density functions direct lighting calculation 
main contributions careful discussion design probability density functions single luminaires method construction single probability density function set luminaires shadow ray need shot viewing ray regardless number luminaires scene 
ray tracing feasible scenes luminaires 
method suitable images multiple samples taken pixel 
number samples pixel low samples culling method ward preferable method described 
section state direct lighting integral describe basic monte carlo integration 
section design probability density functions shapes commonly approximate luminaires 
section describe design probability density function large sets luminaires 
section speculate techniques fit rendering systems 
mathematical formulation section basic monte carlo solution method definite integrals outlined monte carlo integration applied direct lighting integral 
basic monte carlo material section covered classic texts 
section differs geared classes problems crop realistic image synthesis 
monte carlo integration suppose real valued function ir possibly multidimensional space wish estimate expected value random variable probability density function ir denoted 
probability density function means measure defined 
definition expected value approximate expected value sum samples set instantiations random variable 
need formulation arbitrary dimension measure dimensional discussion monte carlo texts integrate surface areas solid angles simple measure length 
form equation bit awkward usually approximate integral transport equation applies steady state scenes surfaces vacuum obeying geometrical optics 
practice reasonable approximation human observable behavior visible light scenes 
notation means measure equivalent notation 
occasionally symbol isolation 
technically violates measure theoretic notation follow authors violation convenience 
ir set real numbers gamma 
ir set non negative real numbers 
unspecified space examples 
unspecified measure defined examples 
probability density function defined measure canonical random number uniformly random 
function maps elements set elements set expected value random variable variance random variable number samples taken monte carlo integration 
set points surfaces 
point illuminated 
point gamma gamma gamma gamma 
gamma area measure 
gamma gamma gamma 
gamma distance points unit surface normal direction unit surface normal direction omega hemisphere directions pole omega gamma delta 
hemisphere directions pole gamma delta 
oe solid angle measure 
direction unit vector omega viewed 
direction unit vector parallel gamma gamma gamma 
gamma gamma gamma gamma 
gamma ae spectral bidirectional reflectance distribution function brdf 
visibility function surface zero 
surface spectral radiance point direction 
field incident spectral radiance point coming direction surface spectral radiance point direction emitted emitted lighting 
surface spectral radiance point direction caused light coming directly luminaire direct lighting 
probability density function defined measure 
probability density function defined omega measure oe 
nl number luminaires environment 
ith luminaire 
ae max maximum brdf point set luminaires dim set unimportant luminaires 
bright set important luminaires 
estimate average dim number luminaires dim number luminaires bright radiance 
lo type function low variation roughly constant 
hi type function high variation roughly constant 
un type function unknown evaluated points 
table important symbols terms 
single function product get substituting integrand formula valid positive nonzero 
variance sum equation equation implies get low variance estimate want samples possible large want density low variance 
choosing intelligently called importance sampling relatively large relatively large samples important regions 
equation shows fundamental problem monte carlo integration diminishing return 
variance estimate proportional standard deviation proportional error estimate behaves similarly standard deviation need approximately quadruple halve error 
way reduce variance partition domain integral smaller domains evaluate integral sum integrals called stratified sampling 
normally sample taken density case variance estimate typically density chosen proportional functions stratification 
example white noise function variance constant regions 
intuitively stratification pay varies slowly relative distance adjacent sample points 
distribution ray tracing usually phrased application equation researchers replace evenly distributed quasi random samples 
approach shown sound analyzing decreasing error terms discrepancy measure terms variance 
practice convenient develop sampling strategy variance analysis random samples turn non random samples implementation 
approach certainly correct justification implications fully explained 
rest assume random sample points derivations implementation stratified random samples produce higher variance estimates random samples produce 
generating random samples ways generate random samples specified density functions 
methods assume ability generate sequence canonical random numbers identically distributed uniform random number zero formally ir canonical probability density function meaning canonical random number means 
example choose uniform random points ball unit radius centered origin pick uniform point cube sidelength centered origin gamma gamma gamma check inside ball 
ball repeat process gamma gamma gamma find point ball 
called rejection method useful picking random points spaces complex boundaries 
unfortunately obvious apply rejection method nonuniform densities rejection method easy combine stratified sampling 
method suffer problems rejection method pass canonical numbers function 
illustrate notice function ir canonical random number random variable possibly nonuniform density function 
example quantity value near zero nonuniform density function 
reverse engineer get sample desired density function ir 
gamma function called cumulative probability distribution function associated probability density function probability random variable density value equal 
basic method image synthesis ward generate reflection rays cosine density 
note gamma exist may analytical case numerical function inversion 
nice thing generating sequence nonuniform random numbers inverse cumulative distribution function ordering gamma input stratified completely random sequence gamma stratified 
dimensional probability density function theta ir defined respect measure similar transformation marginal density function psi ir psi function psi valid density function represents density values value chosen gamma psi value chosen density psi psi psi conditional probability special case separable meaning expressed ir ir probability density functions chose gamma gamma cumulative probability distribution function associated cumulative probability distribution function associated design strategies importance sampling key step implementation monte carlo integration choice probability density function sample points 
black art goal lowest variance number samples lowest variance execution time 
important distinction samples produce low variance may take times longer generate higher variance samples 
section outline general rules choosing density functions sampling 
apply rules estimating values specific integrals section 
integrals arise lighting calculations form strictly non negative functions 
may vary great deal shape execution cost 
may known priori character may attained point sampling 
section discuss strategies design density functions monte carlo integration integrals form equation categorize general behaviors known low variation lo known priori low variation known high variation hi known priori high variation unknown un known sampling 
grouping terms equation rewrite product functions types listed note grouping terms type hi result term type lo grouping done carefully 
integrals contain integral type un usually evaluated tracing ray weighting function usually representing local properties surface combination functions type lo hi 
consider cases 
integrand product function hi type hi function fun type un ideally set fhi fun 
fun unknown evaluate locations approximate image synthesis applications usually practical evaluations expensive un may quite complex 
assume un want fhi done practice 
limited sense optimal shown appendix 
integrand product function lo type lo function fun type un follow logic fhi fun case just want set constant 
improvements variance caused choice lo probably inconsequential large variance un cause 
certainly want bother making flo add computation time generating random points density summary integrand known weighting function times unknown expensive function proportional components weighting function roughly constant 
expensive proportional approximation components weighting function roughly constant 
formally rewrite lo fhi fun try find way generate samples fhi 
difficult hi hi approximation fhi 
general strategy sections choose density functions 
direct lighting review rendering equation governs approximation light transport separate direct lighting integral solve monte carlo integration 
rendering equation usually written basic ways integral radiometric quantities solid angles integral equation radiometric quantities surfaces 
written terms directions visible done ae gamma delta doe 
surface radiance direction emitted surface radiance direction unit hemisphere incoming directions oriented ae brdf slight variant radiometric terms symbols standardized illumination engineering society ies 
simplify notation drop spectral term radiometric quantities spectral quantities 
denote spectral radiance recommended ies 
radiance quantity defined points space directions fl wavelengths homogeneous material function ir theta fl theta ir 
function defined boundaries materials surfaces light abruptly changes direction 
solve problem authors commonly refer incoming outgoing radiance 
outgoing radiance perceive look surface outgoing radiance called surface radiance incoming radiance field called field radiance 
transparent surfaces surface field defined directions fl 
opaque surfaces surface radiance ls defined outgoing hemisphere directions omega gamma field radiance defined incoming hemisphere directions 
ds da geometry rendering equation field radiance direction incident amd oe solid angle measure 
geometric quantities illustrated 
equation form integral evaluation field radiance typically require evaluation point seen direction gamma leads way rendering equation written integral equation surfaces done kajiya ae gamma delta delta gamma gamma gamma 
gamma da set points surfaces geometry term zero obstruction gamma gamma gamma 
gamma distance area measure 
direct lighting written integral directions dropping reflected light equation ae gamma delta doe 
point seen direction gamma program ray gamma traced direction gamma find direct lighting written integral points dropping reflected light equation ae gamma delta delta gamma gamma gamma 
gamma da geometry term calculated sending shadow ray gamma gamma gamma 
gamma environment 
geometry term surface ray hits 
monte carlo integration approximate equation probability density function 
defined solid angle measure oe built 
applying equation technically kajiya equation written terms radiance mapped equation 
sample gives ae gamma delta 
monte carlo integration approximate equation probability density function defined area measure yields ae gamma delta delta gamma gamma gamma 
gamma done implement direct lighting calculation choose integral evaluate directional integral integral points create density function generate random samples density 
details steps described direct lighting single luminaire section multiple luminaires section 
direct lighting luminaire calculate single luminaire monte carlo integration equation density positive directions subtended luminaire equation probability density function positive visible points luminaire practice positive points luminaire visibility hard establish priori 
large luminaires sky sampling solid angles sense luminaires small angle space seen points calculating direct lighting sun man luminaires integrand zero hard design density functions 
equation usually easier design densities surfaces 
reflection rays specular near specular surfaces usually natural equation address reflection rays 
issues involved choosing equations discussed detail 
examples section authors transformation strategies 
designing probability density functions designing density function equation immediately set points luminaire 
perfect zero variance estimate result cg ae gamma delta delta gamma gamma gamma 
gamma normalization constant 
usually pointed monte carlo literature integral evaluated know practical 
suggested section attempt partition integrand lo fhi fun assume luminaire diffuse radiance vary surface seen directions assume ae roughly constant directions subtended luminaire integrand classified ae lo gamma delta delta gamma gamma gamma 
gamma hi un strategy hi component function guide design get gamma delta delta gamma gamma gamma 
gamma note luminaires components equation roughly constant 
example luminaire small seen gamma delta roughly constant 
luminaire planar 
delta roughly constant 
luminaire extent small compared distance gamma gamma gamma 
gamma gamma roughly constant 
move terms lo component integrand easier design 
remainder section discuss choose simple luminaire shapes 
particular discuss probability density functions luminaires approximated spheres polygons disks cylinders 
case spheres illustrate mechanics choosing random points case triangles example deal non separable densities summarize results shapes 
details derivations material section 
sampling spherical luminaires section discuss different density functions choose samples spherical luminaire radius center 
classify components gamma delta 
delta gamma gamma gamma 
gamma gamma notice small distant luminaires 
deltan varies zero hi component 
terms gamma delta gamma gamma gamma 
gamma gamma lo hi depending parameters sphere location example sphere touches terms hi distant source sun terms lo 
different circumstances different density functions useful 
uniform density purposes debugging constant density function useful 
density function unit volume surface sphere density just inverse sphere area generate random point sphere define density spherical coordinate system polar angle positive axis oe azimuthal angle positive axis oe 
yields density related differential measure da sin doe 
techniques section separate density sin doe density functions oe sin 
gives oe arccos gamma 
converting cartesian coordinates gives cos oe sin sin oe sin cos simplified cos gamma sin gamma gamma immediate optimization take samples portion sphere visible uniform area case ideal debugging leave move nonuniform densities 
sampling uniformly directional space nonuniform density try delta 
turns just complicated sampling delta gamma gamma gamma 
gamma gamma discuss 
observe sampling luminaire 
delta gamma gamma gamma 
gamma gamma density constant function 
defined space directions subtended luminaire seen coordinate system defined origin right handed orthonormal basis gamma gamma gamma 
gamma gamma gamma gamma 
gamma xk theta theta see ds da max geometry spherical luminaire 

define oe azimuthal polar angles respect uv coordinate system 
maximum includes spherical luminaire max arcsin gamma gamma gamma 
gamma ck arccos gamma gamma gamma gamma 
gamma ck uniform density respect solid angle cone directions subtended sphere just reciprocal solid angle gamma cos max subtended sphere 
gamma gamma kx get oe arccos gamma gamma kx gives direction find actual point need find point sphere direction 
ray direction just ta cos oe sin sin oe sin cos calculate probability density function respect area measure recall density function defined solid angle space 
know valid probability density function oe measure know doe 
da delta gamma gamma gamma 
gamma relate probability density function 
associated probability density function 
delta gamma gamma gamma 
gamma solve delta gamma gamma gamma 
gamma gamma gamma kx details sampling sphere see 
cosine weighted solid angle bring gamma delta term density function space directions 
gamma delta 
integrating density function gives constant proportionality case entire sphere horizon seen case different density function stated regions negative values density function 
gamma delta delta sin max direction formulas sin sin max delta sin sin oe delta oe cos delta cos get arcsin sin max numerically invert second formula solve oe implementation simple binary search perform inversion requires tens evaluations equation quite costly practice usually sample spherical luminaires 
getting actual point luminaire handled way section value equation 
spherical luminaire sampled sample pixel cases discussed section uniform sampling visible region sphere shown 
sphere sampled generates smoothest image practice expensive multiple samples edge shadow antialiasing tolerate variance caused sampling planar luminaires planar luminaire quantity gamma delta 
delta gamma gamma gamma 
gamma gamma stays roughly constant provided luminaire relatively small solid angle planar luminaires constant density function generate images 
implementation disks triangles rectangles general polygons 
sampling polygonal luminaires simple polygons polygons holes resorted picking uniformly bounding rectangle polygon rejection technique sample polygon 
test accomplished ray test plane polygon works polygons holes 
probability density function just inverse polygon area theorem 
spherical luminaire sampled top left uniform visible portion top right bottom left bottom right 
disk luminaire sampled sampling disk luminaires choose random sample disk suppose center radius uv coordinate system 
cos sin image disk luminaire sampled sample pixel shown 
sampling rectangular luminaires rectangle defined point side vectors gamma 
gamma 
uniform random point gamma 
gamma 
density gamma 
theta gamma 
luminaire entirely horizon possible choose random point density delta gamma gamma gamma 
gamma gamma gamma delta 
delta gamma gamma gamma 
gamma gamma evaluation costly implementation difficult see details 
sample pixel images shown 
note complex density functions performs better luminaire close expected terms gamma delta 
delta gamma gamma gamma 
gamma gamma vary regions 
sampling triangular luminaires generate uniform random points triangle natural barycentric coordinates triangle note determinant jacobian takes triangle defined barycentric coordinates triangle unnormalized coordinate system constant 
means pick random barycentric coordinates triangle triangle random point uniform 
go detail mechanics choosing uniform uniform density function written terms coordinates triangle separable 
barycentric coordinates point plane containing triangle vertices rectangular luminaire sampled left middle right 
described fi gamma gamma gamma gamma gamma 
gamma fl gamma gamma gamma gamma gamma 
gamma triangle fi fl fi fl 
integrating constant triangle gives fl gammafl fi dfi dfl means value density function barycentric coordinates cartesian space area triangle implying determinant jacobian transforms barycentric cartesian space value 
perform inversion find densities correspond fi fl separately 
fi fl independent simply marginal density 
case fi dependent fl 
marginal density fl fl conditional density fi fl 
definition fl gammafl fi fl dfi gamma fl fi fl fl gamma fl perform inversion letting fg fl fi jfl solving fi fl fg cumulative densities corresponding random variables fl fi jfl respectively 
definition fg fl fl fg fl dfl fl gamma fl solving fl get fl gamma gamma fi fi jfl fi fi jfl dfi fi gamma fl fi gamma fl gamma gamma gamma gamma gamma gamma gamma 
gamma gamma gamma gamma gamma gamma gamma gamma 
gamma triangular luminaire sampled constant gamma delta 
delta gamma gamma gamma 
gamma gamma spheres rectangles works entire luminaire horizon shown 
details 
barycentric coordinates ff gamma gamma gamma gamma 
gamma fi gamma gamma gamma gamma 
gamma fl gamma gamma gamma gamma 
gamma coordinate origin ff fi fl 
just substitution ff gamma fi gamma fl 
triangular luminaire sampled left right 
sampling cylindrical luminaires cylinder radius axis axis boundaries wmax choose point uv coordinate system uniform cylinder cos sin wmax base origin uv coordinate system random point cartesian coordinates cos sin wmax practical lower variance cylinder sampling strategy approximates density function proportional 
delta 
discussion density functions developed section assume ae roughly constant directions subtended luminaire variance increase introduced specular reflection directional luminaires 
ae vary terms methods discussed section may high variance 
example rectangle texture controlling emission represent tv screen variance roughly proportional variance pixels texture 
ae important term want ae key factor want 
luminaire shapes discussed interest 
example neon lights considered swept disks common light modeled surfaces revolution 
practice simple shapes discussed section preference complex shapes real luminaires 
example shows room lit fixtures approximated rectangles lighting calculations surfaces 
idea extensively ward radiance program far field photometry entire known see details getting cie ies standard far field photometry real luminaires luminaire displayed complex geometry 
thought special case geometric simplification rushmeier 
direct lighting luminaires traditionally nl luminaires scene direct lighting integral broken nl separate integrals 
implies nl samples taken approximate direct lighting rectangular luminaires bias introduced done ward small value samples calculated 
leave direct lighting integral intact design probability density function nl luminaires 
example suppose luminaires devise probability functions method described section generating functions combined single mixture density lights applying weighted average ffp gamma ff ff 
see probability density function integral luminaires strictly positive points luminaires 
coefficients ff gamma ff called mixing weights 
estimate direct lighting lighting luminaire choose random canonical pair decide luminaire sampled 
ff estimate methods described section choose evaluate estimate ff 
ff estimate gamma ff 
case decide source sample directly knowledge choose ff choose point random pair ff 
sample ff pair gamma ff gamma ff 
way collection stratified samples remain stratified sense 
note advantage stratified dimension having pair stratified dimensions choose stratified pairs sampling method may helpful 
basic idea estimate extended nl luminaires mixing nl densities ff ff delta delta delta ff nl pnl ff sum ff positive contributes direct lighting 
value ff probability selecting point determine point chosen 
chosen estimate ffi 
pair choose enforcing conditions gamma ff ff sample light pair gamma gamma ff ff basic process shown 
stressed important reuse random samples way keep variance low way stratified sampling jittering random sampling space pixel choose point luminaire types luminaires section 
question remaining ff constant ff simplest way choose values ff proposed lange method implied page weights equal ff nl definitely valid estimator ff sum zero 
unfortunately scenes estimate produce high variance li different occurs night walkthroughs 
important introduce correlated points screen space luminaire space 
typically set sample pairs chosen screen space different set sample pairs chosen luminaire space combined quadruples screen luminaire space 
regularity points generated point particular corner canonical space mapping pairs random 
actual chosen means pick luminaire 
diagram mapping choose resulting remapping new canonical sample linear ff suppose perfect defined luminaires 
zero variance solution result set ff contribution ith luminaire 
ff approximately proportional fairly estimator 
call linear method setting ff time choose sample linearly proportional nl number luminaires 
obtain ff get estimated contribution approximating equation geometry term set 
luminaires directly converted ff scaling sum ff delta delta delta lnl method choosing ff valid potentially visible luminaires positive ff expect highest variance areas shadowing occurs setting geometry term causes ff poor estimate ff shows scene rectangular luminaires sampled linear method rays pixel 
shows scene rectangular luminaires sampled rays pixel linear method 
method setting ff theoretically justified 
implementing linear ff method subtleties 
implemented method type luminaire estimated particular ae 
entire luminaire tangent plane estimate zero 
easy mistake initial implementation set zero center luminaire horizon 
ff take value allowed incorrect zero 
bug obvious pictures spheres illuminated luminaires large solid angles scenes errors noticeable figures bug noticeable 
overcome problem sure polygonal luminaires vertices horizon zero probability sampled 
spherical luminaires check center luminaire distance sphere radius horizon plane zero probability sampled 
spatial subdivision linear method choosing ff estimated contribution requires querying luminaire scene 
acceptable scenes nl large thousands millions slow 
scenes luminaires usually tens contribute significantly image linear method luminaires 
image linear method luminaires 
radiance particular point 
suppose partition nl subsets bright dim bright set luminaires important contribute significantly dim gamma bright 
subsets construct low cost ff suppose size bright bright fb dim fd nl gamma nl large partitioned correctly bright estimate way linear method 
assume members dim contribute approximately amount random element dim pick random element dim rejection method repeatedly choose luminaire random store linear array find light bright faster finding dim expect 

want better estimate average contribution luminaire dim take sample 
appropriate number samples take dim scene dependent studied 
implementation taken sample 
gives estimates contributions luminaires consulting sample taken element dim reasonably accurate important luminaires 
construct probability density function setting ff equal normalized value ff delta delta delta lnl bright estimate contribution random luminaire dim difficult part method deciding luminaires bright particular pointed kok jansen luminaire responsible large fraction radiance responsible large fraction radiance neighboring points implies spatial subdivision scheme precompute bright list spatial cell spatial subdivision structure 
particular cell luminaire put bright contribute threshold average spectral radiance diffuse surface cell 
simple way determine maximum potential contribution luminaire threshold evaluate equation gamma delta set ae set ae max points large number points boundary spatial subdivision cell 
specular surfaces usually handled reflection rays equation 
see details shadow rays expect ae max extremely large 
set luminaires regions importance shown 
stratification scene boxes arbitrary 
easy way choose subdivision cells leaf cells conventional subdivision structure octree leaves glassner style octree ray intersection acceleration maintain separate bright list leaf 
finer needed subdivision scenes number objects greater number luminaires 
advantage luminaire lists need constructed empty cells characteristics reflective objects construct lists objects cell known advance 
implemented separate light octree recursively subdivides leaf maximum allowed depth size bright cell specified limit 
depth size limits similar conventional octree values understood far 
avoid excess subdivision check minimum contribution important luminaire cell threshold 
members bright determined bright possible descendant cell subdivide 
difficulty building light octree average radiance threshold 
program assume know radiance lw map white display device white rgb triple typical bit frame buffer driven crt 
set radiance threshold fraction lw display device typically bits channel usually threshold percent lw threshold ensure luminaire change lw chosen perceptual viewer model model implemented rushmeier 
lw may vary pixel pixel spatially varying mappings 
models increasingly important physically rendering popular 
obstacle region importance luminaire covers cells 
subdivision space luminaire member bright cell potential contribute significantly surface radiance point cell 
pixel color steps included bright lw chosen correctly sum contributions luminaires lw number important luminaires scenes 
characterize important vs unimportant luminaires associate axis aligned influence box luminaire includes points include luminaire bright list 
deciding luminaire important cell just check cell influence box overlap luminaire treated important light source 
avoid important luminaire overlooked influence box contain point reflected radiance larger predefined threshold receiving light luminaire 
gives chance non important luminaire selected important preferred risk missing important luminaire estimate ff blow large ff small just change small component small regardless ff decide luminaire cause object change radiance examine point source point radiant intensity distribution 

potential contribution due source bounded replacing ae ae max gamma delta ae max 
gamma gamma gamma 
gamma sure potential contribution sure distance certain quantity gamma gamma gamma 
gamma ae max 
note set points potential inside influence isosurface depends 
see 
box bounds influence isosurface luminaire influence box 
radiant intensity 
power unit solid angle direction ds distance represents df ds df points outside influence isosurface receive contribution exceeds influence box diagram radiant intensity point source left associated influence isosurface maximum radiance contribution example finding influence isosurface resulting influence box finite sized luminaire consider spherical luminaire directionally isotropic emission pattern emitted power phi resulting far field radiant intensity 
phi 
allowing finite radius just radius sphere influence isosurface expand ae max phi 
luminaire axis symmetry 
depend delta 
define angle function fully describes emission luminaire 
find influence box contains points theta theta note symmetry gammau gammav simplicity assume true analysis analogous analysis 
find note potential isosurface angle value equation cos ae max 
find differentiate maximum maximum respect find derivative zero 
occurs gamma sin cos di similar analysis yields largest inside influence isosurface occurs cos sin di equations help find influence box point phong luminaire power phi located phi cos differentiating yields di gamma phi cos gamma sin implies potential isosurface maximum ae max phi applying equation implies maximum potential isosurface cos sin ae max phi give influence box point phong source uv coordinate system 
extend ths result polygonal luminaires apply point source analysis vertex add maximum distance vertex 
find importance box cartesian coordinates apply conservative strategy finding cartesian axis aligned bounding box uv influence box 
show images pair generated eric haines procedural database software composed spheres 
image luminaires light octree 
cases individual luminaires sampled 
delta gamma gamma gamma 
gamma gamma density function 
single luminaire case samples pixel luminaire case samples pixel took times long sample single luminaire image 
means overhead choosing ray light octree swamp cost sending shadow ray extreme case half objects luminaires 
pathological scenes light octree smaller relative number primitives performance better 
clearly linear light octree methods useful scenes large number luminaires 
scenes increasingly important 
outdoor scenes especially urban settings scenes thousands hundreds thousands luminaires commonplace 
opera theater applications hundreds thousands luminaires common 
infrared scenes surfaces luminaires light octree crucial 
methods easy luminaires defined polygons parametric patches 
matter patches define light bulb surface receive shadow ray 
techniques constructing probability spaces luminaire surfaces direct lighting calculation 
techniques calculation direct lighting thousands luminaires feasible 
chief limitation take account geometry term visibility brdf 
extending methods include terms possible easy 
geometry term particular probably attacked probabilistic methods visibility problem high complexity scenes difficult exact solutions take long 
basic rationale techniques direct lighting calculated higher accuracy necessary 
similar concept kajiya argument expend deep parts ray tree 
certainly true shadow ray viewing ray optimal 
luminaire case shadow ray better shadow rays better 
issue requires investigation 
scenes luminaires linear light octree techniques section useful 
rendering techniques viewed terms replacing surfaces 
example luminaire zero reflectivity shaped reflecting patch emits light roughly distribution intensity reflecting patch reflects light 
concept kok jansen chen rushmeier ward 
adding reduces number patches reflected light needs calculated increases number luminaires 
attractive cost direct lighting increase linearly nl believe techniques radiosity ray tracing programs 
authors wish jim arvo randy andrew glassner holly rushmeier ken torrance bruce walter greg ward help algorithms terminology ken chiu help code single luminaire rays pixel top luminaires rays pixel bottom 
involved project bill dennis gannon bob don hearn initial suggestions directions pushed 
grateful reviewers helped greatly improve particularly difficult read draft version 
supported indiana university faculty start funds national science foundation 
nsf ccr 
appendix proof optimal sampling weighted image synthesis take form product strictly nonnegative function ir strictly nonnegative function ir values attainable point sampling solve equation optimal choice probability function pointed choice requires know value people choose uniform set 
section extends arguments letting sense optimal 
graphics usually repeatedly perform integral member set ff decide try minimize average variance estimate vague definition approximate situation graphics assuming large values particular point 
sense thinking support filter pixel image plane radiance hitting film plane expect exact location features luminance function correlated details pixels arranged 
especially true different images animation 
average variance estimator gamma gamma righthand squared term constant assume average values members correlated evaluation point large expect average value constant average variance estimator just gamma term constant sum term cancel terms minimizing equivalent finding minimizes constraint strictly nonnegative 
find constrained function minimizes quantity calculus variations lagrange multipliers 
replace fffl ff constant fl function 
fffl valid probability density function restrict fl zero volume fl 
define new integral ff ff fffl fffl lagrange multiplier constant 
calculus variations tells stationary extremum partial derivative evaluated zero zero 
ff ff gammafl fffl fl setting ff yields ff fl gamma fl integral vanish valid fl get nonnegative implies intuitively appealing choice theoretical justification 
second derivative ff positive setting ensure minimum variance 
john ming young 
adaptive techniques progressive radiosity outperform traditional radiosity algorithm 
technical report tr university north carolina chapel hill august 
james arvo kenneth torrance brian 
framework analysis error global illumination algorithms 
computer graphics july 
acm siggraph conference proceedings 
eric chen holly rushmeier gavin miller douglass turner 
progressive multi pass method global illumination 
computer graphics july 
acm siggraph conference proceedings 
chiu shirley wang zimmerman 
spatially nonuniform scaling functions high contrast images 
graphics interface pages may 
chiu peter shirley wang 
multi jittered sampling 
paul heckbert editor graphics gems 
academic press new york ny 
robert cook 
stochastic sampling computer graphics 
acm transactions graphics january 
robert cook thomas porter carpenter 
distributed ray tracing 
computer graphics july 
acm siggraph conference proceedings 
julie 
dorsey francois donald greenberg 
design simulation opera lighting projection effects 
computer graphics july 
acm siggraph conference proceedings 
andrew glassner 
space subdivision fast ray tracing 
ieee computer graphics applications 
andrew glassner 
principles digital image synthesis 
morgan kaufman san francisco 
eric haines 
essential ray tracing algorithms 
andrew glassner editor ray tracing pages 
academic press san diego ca 
john 
retrospective prospective monte carlo method 
siam review january 
hammersley 
monte carlo methods 
wiley new york 
david michael cohen donald greenberg 
radiosity method non diffuse environments 
computer graphics august 
acm siggraph conference proceedings 
american national standard institute 
nomenclature definitions illumination engineering 
ansi report 
ansi ies rp 
james kajiya 
rendering equation 
computer graphics august 
acm siggraph conference proceedings 
paula 
monte carlo methods 
john wiley sons new york 
david kirk james arvo 
unbiased variance reduction global illumination 
proceedings second eurographics workshop rendering 
kok jansen 
source selection direct lighting calculation global illumination 
proceedings second eurographics workshop rendering 
kok frederik 
adaptive sampling area light sources ray tracing including diffuse interreflection 
computer graphics forum 
eurographics 
lange 
simulation radiant light transfer stochastic ray tracing 
proceedings second eurographics workshop rendering 
mark lee richard redner samuel 
statistically optimized sampling distributed ray tracing 
computer graphics july 
acm siggraph conference proceedings 
thomas malley 
shading method computer generated images 
master thesis university utah june 
don mitchell 
spectrally optimal sampling distribution ray tracing 
computer graphics july 
siggraph conference proceedings 

computational methods global illumination visualization complex environments 
phd thesis institute technology science february 
werner 
statistical method adaptive stochastic sampling 
computers graphics 
mark rea editor 
illumination engineering society lighting handbook 
illumination engineering society new york ny th edition 
jon 
area simple polygon 
james arvo editor graphics gems ii pages 
academic press san diego ca 
holly rushmeier charles patterson 
geometric simplification indirect illumination calculations 
graphics interface pages may 
holly rushmeier 
realistic image synthesis scenes participating media 
phd thesis cornell university may 
christophe schlick 
problem 
ray tracing news march 
mail edition available anonymous ftp math yale edu 
peter shirley 
physically lighting calculations computer graphics 
phd thesis university illinois urbana champaign november 
peter shirley 
ray tracing algorithm global illumination 
graphics interface pages may 
peter shirley 
discrepancy quality measure sampling distributions 
eurographics pages september 
peter shirley kelvin sung william brown 
ray tracing framework global illumination 
graphics interface pages june 
peter shirley wang 
direct lighting monte carlo integration 
proceedings second eurographics workshop rendering 
peter shirley wang 
distribution ray tracing theory practice 
proceedings third eurographics workshop rendering pages 

monte carlo method 
pergamon press new york 
francois claude puech 
general pass method integrating specular diffuse reflection 
computer graphics july 
acm siggraph conference proceedings 
jerome earl 
quasi random methods estimating integrals relatively small samples 
siam review march 
titterington smith makov 
statistical analysis finite mixture distributions 
john wiley sons new york ny 
jack holly rushmeier 
tone reproduction realistic computer generated images 
ieee computer graphics applications 
wang 
physically correct direct lighting distribution ray tracing 
david kirk editor graphics gems 
academic press new york ny 
wang 
direct lighting calculation global illumination methods 
phd thesis indiana university november 
greg ward 
adaptive shadow testing ray tracing 
proceedings second eurographics workshop rendering 
gregory ward 
radiance lighting simulation rendering system 
computer graphics july 
acm siggraph conference proceedings 
gregory ward francis rubinstein robert clear 
ray tracing solution diffuse interreflection 
computer graphics august 
acm siggraph conference proceedings 

average case complexity multivariate integration 
new series american mathematical society january 
sidney 
computational probability simulation 
addison wesley new york 

mathematical basis monte carlo quasi monte carlo methods 
siam review july 
kurt zimmerman 
direct lighting models ray tracing cylindrical lamps 
graphics gems academic press 

