esorics third european symposium research computer security lncs springerverlag berlin esprit project cafe high security digital payment systems jean paul ronald cramer rolf frank muller torben pedersen birgit pfitzmann peter de berry schoenmakers matthias luc valle michael waidner 
cafe conditional access europe ongoing project european community esprit program 
goal cafe develop innovative systems conditional access particular digital payment systems 
important aspect cafe high security parties concerned possible requirements forced trust parties called multi party security 
give legal certainty everybody times 
electronic money issuer individual users dependent tamper resistance devices usual digital payment systems 
cafe aims market small everyday payments currently dominated cash payments offline privacy important issue 
basic devices cafe called electronic wallets outlook quite similar pocket calculators pdas personal digital assistant 
particular advantages electronic wallets pins entered directly fake terminal attacks prevented 
features loss tolerance user loses electronic wallet wallet breaks stolen user money back payment system 
different currencies 
open architecture system 
aim demonstrate set systems developed field trials project 
note real hardware systems suitable mass production 
concentrates basic techniques cafe protocols 
keywords security applications financial security versus requirements performance fault tolerance 
preliminary version paris june 
ptt research box nl ak netherlands katholieke universiteit leuven dept heverlee belgium cwi kruislaan nl sj amsterdam netherlands sintef trondheim norway aarhus institut ny munkegade dk aarhus denmark universitt hildesheim institut fr informatik postfach hildesheim germany sept rue des bp cedex france universitt karlsruhe institut fr und postfach karlsruhe germany project goals participants cafe conditional access europe project european community program esprit project 
cafe began december probably finished december 
consortium consists groups social market studies institut fr software hardware producers siemens designers secure cryptographic protocols cwi amsterdam ptt research nl sept sintef trondheim universities hildesheim leuven 
project coordinator david chaum cwi 
goal cafe develop innovative systems conditional access digital systems administer certain rights users 
rights may digital forms access confidential data entry buildings important example cafe digital payment systems 
digital payment system information technology system transferring money users 
market demands legal requirements member states european community systems continuously studied evaluations existing comparable systems interviews users experts bank consumer organizations administrations project systems built realistic field trial carried year project 
devices basic device cafe electronic wallet 
small portable computer similar pocket calculator pda personal digital assistant 
battery keyboard display means communicating devices 
cafe communication means infrared channel 
user system owns uses wallet rights guarantees security 
particular advantages electronic wallets pins entered directly fake terminal attacks prevented 
furthermore users agree amount paid device 
feature considered important users surveys liked secure feeling having give wallets hands shop normal wallets containing cash 
able look previous payments wallet 
application different types wallets users different preferences 
compatibility problem infrared communication 
luxury versions combine cafe functions universal pda mobile phone notebook computer 
basic versions just contain cafe functions keyboard consists buttons 
basic functionality basic cafe system offline payment system 
means user buy called electronic money electronic money issuer load wallet payments 
offline means contact central database usually electronic money issuer needed payment 
alternative online payments far costly low value payments communication processing electronic money issuer 
basic system primarily intended payments wallets pos point sale terminals 
allows just transfer electronic money 
means payee deposit electronic money electronic money issuer payments course locally verify electronic money genuine similar traveler 
withdrawals electronic money loading electronic wallet online transactions usually debit normal bank account 
carried public atm machines home terminals 
additional features basic cafe system additional features different currencies possible store different currencies wallet exchange payment 
loss fault tolerance user loses electronic wallet wallet breaks gets stolen user money back payment system 
basic cafe system open system respects cash designed universal payment system user able pay arbitrary services arbitrary service providers wallet 
examples shopping telephone public transport 
interoperability number electronic money issuers guaranteed payments clients different electronic money issuers possible 
new electronic money issuers join select options wishes 
certain protocols fixed precise soft hardware components 
cafe open new hardware platforms integrated systems 
communication particularly useful system payments networks 
restrictions need basic payment system high security 
simple wallets cheap mass production wallets pos terminals simple 
absolutely minimal version wallet displays required amount user user actively confirms pressing ok button wallet 
practical point view excluded system 
special security goals cafe important difference cafe systems universal digital offline payment systems high security standards cafe 
section explain goals section sketch technical measures possible achieve goals simultaneously 
multi party security existing digital payment systems designed systems sided security participants rely trustworthiness single party usually electronic money issuer 
payment systems sided security unsuitable offer legal certainty parties 
instance consider atms automatic teller machines client uses bank card atm security completely dependent trustworthiness bank knows bank knows 
dishonest bank insider 
withdrawal order signed client bank store proof transaction conventional payment systems 
court decide withdrawal client fraudulent bank insider 
parties bank client legal certainty court decide security fraud party 
accepts banks institutions trustworthy clients change situation case decide bank prove internal security measures insider fraud impossible 
currently highly improbable bank show satisfactory degree 
hand cases insider fraud spite seemingly strong security measures reported ande 
hand group relevant insiders just large comprises bank employees institutions employees design production installation maintenance hard software payment system 
hand courts decide bank doubt banks completely insecure dishonest clients 
avoid undecidable situations cafe systems designed systems multi party security chau security requirements party guaranteed forcing party trust parties 
particular mutual trust parties conflicting interests client bank example assumed 
ideally party trust jurisdiction decision court verified 
multi party security beneficial parties increases legal certainty undecidable situations sided security occur 
evidence unambiguous decision 
decreases security bottleneck insider attacks 
system acceptable potential users pr argument electronic money issuers 
multi party security implications design manufacturing process apart implications protocols described designs soft hardware crucial security party available party inspection 
secret algorithms ruled cafe internal procedures electronic money issuers 
ensured parties trust devices 
users produce inspect wallets sufficient number competent independent authorities verify design devices 
means verifies samples wallets handed users near manufacturer 
sufficient means expect user trust authority 
possible authorities state owned certification agencies technical control boards german tv consumer organizations 
data protection cafe payment systems intended mass systems everyday 
particularly suited frequent low value payments daily shopping phone calls public transport 
instance credit card payment credit card obtain extensive profile user behaviour 
know user goes shopping time day buys time phones goes bus point view privacy highly undesirable 
uses cash payer untraceable coins identify payee bank 
different payments user unlinkable see coins paid person 
form untraceability desired users cafe systems basic cafe system payee perfectly untraceable payee electronic money issuer learn identity payer payment different payments unlinkable chau 
just cash exclude payer identified means unintentionally deliberately identification protocol 
particular fix upper limit amounts paid identification 
security measures basic cafe protocols taken limit high ecu security electronic money issuer independent 
useful earlier limit payments online ecu untraceable increases security electronic money issuers privacy 
untraceability required 
reason main cafe purchases goods services providers known anyway 
contrast payments withdrawals deposits electronic money traceable client identified electronic money issuer 
assumptions privacy multi party security fraud user need trust parties untraceability 
improved privacy obviously beneficial users electronic money issuers hand increases acceptability system public pr argument 
hand reduces electronic money issuers problem keeping sensitive client data confidential 
loss fault tolerance users loss tolerance may important special feature basic cafe system 
payer loses wallet stops working gets stolen usual system lose money stored wallet 
loss tolerance means gets money back 
techniques basic question combine security electronic money issuer offline payments privacy little trust tamper resistance 
question arises electronic money just bit strings 
system secure sense users produce new electronic money new bit strings anybody seen bit string copy arbitrarily try spend 
optimal solution follows long certain devices tamper resistant completely impossible spend electronic money 
called strong integrity electronic money issuers 
tamper resistance broken users spend electronic money identified fraud proved 
risk payer disappeared pay money back 
users need trust tamper resistant devices provided electronic money issuers security protect interior users naturally verify protect security privacy 
note online systems achieve attempt spend electronic money detected immediately contact central database 
usually fixes upper limit offline payments 
online systems exist full privacy chau chau 
consider techniques solution 
standard measure digital signatures standard measure applied places payment system multiparty security digital signatures 
schemes simulate handwritten signatures digital messages indispensable systems multiparty security 
assume readers know digital signature schemes important constructions rsa schnorr scheme rsa schn go details stressed symmetric authentication schemes called mac message authentication code des unsuitable replacements handwritten signatures matter principle person signs person tests keys third party court decide produced certain authenticated message 
recipient authenticated message credible evidence sender 
note message legal significance signed payment system provide legal certainty 
particular wallet send signed order withdraw electronic money electronic money issuer get signed receipts deposited money 
furthermore initialization wallets ensure secrets generating signatures known party 
tamper resistant devices guardians tamper resistant devices protect electronic money issuers electronic money wallets payments offline place attempt spend money twice noticed 
users supposed trust devices wallets 
called guardians 
cafe guardian smartcard chip crypto processor placed inside wallet 
guardian fixed wallet mounted smartcard exchanged cafe protocols hardware platforms 
field trial cafe guardian siemens crypto processor 
wallets guardians owner wallet supposed trust electronic money issuer guardian inside guardian allowed communicate devices allowed communicate wallet wallet checks suitably modifies messages guardian sends receives 
scenario wallet protects interests user guardian inside protects interests electronic money issuer service provider chau 
crypto ic battery ecu taxi mller ok ok wallet atm pos terminal infrared communication hardware platform wallet guardian protocol wallet bigger device keyboard display guardian mounted smartcard inserted wallet 
guardian communicate directly wallet wallet takes communication outside world infrared link 
guardians protect electronic money issuer guardian protect electronic money issuer transaction possible cooperation 
particular payment accepted guardian gives okay unit electronic money guardian gives okay 
okay signature guardian restricted version payee electronic money issuer derive guardian information payer 
details seen protocols described 
fall back security protection subsection describe ideas fall back security guaranteed user breaks guardian 
breaking usually means reading secret data keys guardian uses give okay transactions 
note matter guardian destroyed process user build new fake guardians secret information give okay incorrect transactions 
course everybody hopes smartcard chips resist attacks depends resources particular attacker 
cafe protocols provide fallback service electronic money issuer unfortunate case guardian broken user uses guardian spend money allowed identified identity user guardian fraud proved 
note necessary multi party security identity just proved case handled court 
protection electronic money issuer tamper resistant devices protocols 
payment systems honest users privacy double identified described 
efficient variants developed bran bran 
called electronic offline coin systems 
originally scenario user owned wallets guardians 
natural scenario need protocols guardians broken protections electronic money issuer user wallet 
explain protocols starting basic primitives working upwards guardians added 
primitive blind signatures payments untraceable rely blind signature schemes chau 
signing protocol parties signer recipient 
result protocol recipient obtains message signature signer 
message unknown signer blind signer may guaranteed certain form 
efficient constructions blind signatures exist rsa chau schnorr signature scheme 
typical blind signatures payment systems follows chau electronic money represented messages certain form signed electronic money issuer 
signed messages called electronic coins 
message signed called coin number 
withdrawal electronic money issuer device blind signature message unknown issuer appropriate form 
client obtains electronic coin electronic money issuer know looks 
payee deposits electronic coin electronic money issuer recognize know payer went shopping payee 
payment untraceable payments electronic coins denomination 
bank payer payee ecu ecu ecu ecu ecu unlinkable transformation basic payment system blind signatures line coins describe far system blind signatures suitable online payments guarantees clients produce new coins guarantee coin spent central database spent coins coins certain electronic money issuer issue period queried 
idea line payments follows identity payer encoded coin number 
blind signature protocol guarantee zero knowledge proof coin number certain form encoding identity form required 
coin payment payer divulge parts coding identity payee 
coin payments payer divulge different parts coding high probability 
coding constructed way parts identity part give information identity 
simple version coding identity encrypted perfectly time pad coin explicitly contains parts 
encrypted identity contained key part hidden commitment scheme encryption scheme additional property find keys ciphertext decrypted different messages keys 
coin number constructed commitments 
payment payer open commitments content say identity 
part opened payment identity 
order detect cheating electronic money issuer store deposited coins certain time search pairs 
done parallel usual clearing different issuers 
give idea sort system works describing full system scope 
note basic form probability payee payments payer payee cheat 
taken care full system 
efficient versions described bran bran 
furthermore additional signatures hidden payment protocols hand wallet signs pays coin intended payee deposit coin 
hand pure identity contained coin prove anybody constructed coin 
kind signature hidden payer constructed 
cafe protocols system bran bran modifications 
adding guardian line coin systems combined guardian guardian prevents electronic coin spent twice long unbroken 
coins wallet withdrawal 
part held wallet part guardian 
parts form secret key needed sign spending coin 
electronic money issuer ensure guardian fact involved requiring signature guardian holds part secret key key identified way image 
complicated messages wallet electronic money issuer allowed carry secret information wallet ensure covert channel guardian electronic money issuer 
messages transformed transit 
protocols described chau bran bran 
efficiency improvements far described system resembled cash coins respect amount paid usually paid combination electronic coins certain fixed denominations 
solution optimal security privacy long run current smartcard chips bit hard 
problem change non trivial system distinguishes clients wallets pos terminals 
cafe uses mixture additional measures 
related approaches known construct coins split smaller amounts necessary ecu coin ecu coin ecu coins coins spent pay ecu ecu coin guardian measures allow spend times 
measures reduce unlinkability payments integrity 
different measures known 
corresponds coins sense amount entered electronic coin signed payment 
guardian keep counter money play part signing payments cheque written amount 
measure decreases fall back security electronic money issuer case guardian broken 
loss fault tolerance users loss tolerance may important special feature basic cafe system 
usual system payer lost wallet lose money stored wallet 
happen wallet stopped working got stolen 
loss tolerance means gets money back 
basic idea loss tolerance keep backup user electronic money outside wallet 
backup privacy payer backup card user encrypted form electronic money issuer 
user loses wallet backup evaluated cooperation user electronic money issuer electronic money reconstructed part spent credited user account 
spent usually withdrawal loss detected comparing reconstructed electronic money deposits 
note backups security electronic money issuer user copy electronic money payments guardian give okay transaction 
optimal case user gets lost money back 
factor limit loss tolerance lost stolen wallet user identification pin owner get money back finder thief wallet spends 
wallet just broken money back 
limit loss limit amount spent intermediate entry pin 
purpose cafe offer optional payment pins 
withdrawals protected pins anyway 
users urged choose payment pin different withdrawal pin payment pins observed 
user remember pins better easy remember payment pin write 
withdrawal pin contrast kept secure 
payment pins flexible payment unlocking certain amount payments 
useful payment may done hurry place pin observed easily 
user lock amount 
apart tolerating losses faults complete wallets system tolerates interruptions individual transactions communication interrupted devices breaks loses power transaction unintentionally deliberately 
phone ticks basic cafe protocols contain special measures paying phone ticks payments small amounts payee fast succession 
reason require unlinkability payments individual ticks parts coin special way 
outlook mid half project cafe concentrated market social studies design basic cafe system preparations actual implementation 
software package demonstrating cafe features available second half project starts implementation particular hardware components 
particular wallets smartcard chip siemens crypto processors 
field trial follow 
accompanied studies user reactions 
parallel time developments design basic cafe system development conditional access systems basis cafe wallets guardians 
acknowledgment presentation project secure protocols group 
partners project share 
ande ross anderson cryptosystems fail st acm conference computer communications security acm press new york 
peter bauer mit neue siemens zeitschrift special 
jean paul ronald cramer rolf frank muller torben pedersen birgit pfitzmann peter de berry schoenmakers matthias luc valle michael waidner digital payment systems esprit project cafe proc 
paris june 
bos david chaum practical electronic payment system centrum voor wiskunde en informatica computer science departement algorithmics architecture report cs august 
bran stefan brands efficient line electronic cash system representation problem centrum voor wiskunde en informatica computer science departement algorithmics architecture report cs march 
bran stefan brands untraceable line cash wallets observers crypto lncs springer verlag berlin 
chau david chaum security identification transaction systems big brother obsolete communications acm 
chau david chaum privacy protected payments unconditional payer payee untraceability smart card ic cards proceedings ifip wg international conference austria 

north holland amsterdam 
chau david chaum achieving electronic privacy scientific american august 
david chaum amos fiat moni naor untraceable electronic cash crypto lncs springer verlag berlin 
david chaum torben pedersen wallet databases observers crypto lncs springer verlag berlin 
please contact ray cwi phone mail cafe cwi nl 
ronald cramer torben pedersen improved privacy wallets observers extended eurocrypt lncs springer verlag berlin 
diffie martin hellman new directions cryptography ieee transactions information theory 
niels ferguson single term line coins eurocrypt lncs springer verlag berlin 
niels ferguson extensions single term coins crypto lncs springer verlag berlin 
matthew franklin moti yung secure efficient line digital money th international colloquium automata languages programming icalp lncs springer verlag heidelberg 
shafi goldwasser silvio micali ronald rivest digital signature scheme secure adaptive chosen message attacks siam comput 

louis claude michel jean jacques quisquater smart card standardized security device dedicated public cryptology simmons contemporary cryptology science information integrity ieee press lane 
peter neumann inside risks fraud computers communications acm 
okamoto kazuo ohta universal electronic cash crypto lncs springer verlag berlin 
birgit pfitzmann michael waidner andreas pfitzmann systemen und 
rsa rivest shamir adleman method obtaining digital signatures publickey cryptosystems communications acm reprinted 
schn schnorr efficient signature generation smart cards journal cryptology 
michael waidner cafe conditional access europe 
gmd smartcard workshop 
februar gmd darmstadt berlin 
februar 
michael waidner birgit pfitzmann loss tolerance electronic wallets proceedings th international symposium fault tolerant computing ftcs newcastle tyne uk 
michael waidner birgit pfitzmann loss tolerant electronic wallet david chaum ed smart card selected papers second international smart card conference northholland amsterdam 
michael waidner arnd weber und entwickelt published 
franz und pik praxis der und kommunikation 
