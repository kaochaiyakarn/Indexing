validating clustering gene expression data ka yee yeung david walter ruzzo technical report uw cse january department computer science engineering university washington seattle wa validating clustering gene expression data ka yee yeung department computer science engineering university washington seattle wa cs washington edu david department radiology university washington seattle wa washington edu walter ruzzo department computer science engineering university washington seattle wa ruzzo cs washington edu january clustering algorithms proposed analyze gene expression data little guidance available help choose 
provide systematic quantitative framework assess results clustering algorithms 
typical gene expression data set contains measurements expression levels fixed set genes various experimental conditions 
clustering algorithms attempt partition genes groups exhibiting similar patterns variation expression level hopefully revealing biologically meaningful patterns activity control 
methodology apply clustering algorithm data experimental condition 
remaining condition assess predictive power resulting clusters meaningful clusters exhibit variation remaining condition clusters formed coincidence 
successfully applied methodology compare clustering algorithms published gene expression data sets 
particular quantitative measures cluster quality positively correlated external standards cluster quality functional categorizations genes known data sets 
motivation attempt understand complicated biological systems large amounts gene expression data generated researchers see 
large number genes complexity biological networks clustering useful data exploratory technique gene expression analysis 
clustering algorithms proposed gene expression data 
example eisen applied average linkage hierarchical clustering algorithm identify groups regulated yeast genes 
ben dor reported success cast algorithm 
tamayo self organizing maps identify clusters yeast cell cycle human differentiation data sets 
assessing clustering results interpreting clusters important generating clusters 
published clustering gene expression success clustering algorithms assessed visual inspection biological knowledge example 
example illustrated shows importance assessing clustering results 
genes clustered average linkage hierarchical clustering algorithm similar genes placed adjacent vertical axis 
experiments conditions horizontal axis clustered 
color intensity cell proportional measured gene expression ratio bright red representing positive bright green negative 
shows cluster identified eisen 
data set yeast genes conditions 
shows striking pattern obtained simulation data set contain intrinsic pattern 
simulation data set obtained randomly choosing mean expression level gene randomly choosing mean value condition standard normal distributions 
entry simulation data set chosen normal distribution mean variance 
simulation data set contains pattern 
cluster software average linkage hierarchical clustering algorithm applied genes simulation data set 
pattern representing subtree dendrogram identified visual inspection software 
due technical difficulties resolutions figures different 
despite difference resolution figures genes show striking pattern easily interpreted potential cluster validation procedures 
best knowledge systematic data driven method quantitatively evaluate gene expression clustering results 
furthermore clusters obtained different clustering algorithms remarkably different 
biologist gene expression data set faced problem choosing appropriate clustering algorithm data set 
provides quantitative data driven framework evaluate compare different clustering algorithms 
clustering algorithms take similarity matrix raw gene expression data input 
similarity matrix similarity gene expression series raw data reduced single value called pairwise similarity 
pre clustering step choosing similarity metric pairwise similarities computed serious impact clustering results 
general guidelines literature choice similarity metrics 
approach investigate effect similarity metrics quality clustering results 
problem statement basic idea eisen striking pattern simulation data contains intrinsic pattern 
previous cluster validation jain dubes cluster validation refers procedures evaluate results cluster analysis quantitative objective fashion 
statistics literature cluster validation procedures divided main categories external internal criterion analysis 
chapter jain dubes provides detailed discussion various indices proposed validate clustering results 
external criterion analysis validates clustering result comparing clustering result gold standard partition objects 
gold standard obtained independent process information data set 
criterion discussed details section 
internal criterion analysis uses information data set represent goodness fit input data set resulting clustering results 
usually tunable parameters clustering algorithms turn determines number clusters produced 
aspect cluster validation justify number clusters clustering result 
determining optimal number clusters difficult problem 
jain bootstrapping technique estimate optimal number clusters data set 
problem statement basic idea assess quality clustering results motivated jackknife approach 
typical gene expression data set contains measurements expression levels genes measured experimental conditions 
presumably expression levels regulated genes vary similarly conditions experiments clustering genes similarities expression level measurements isolate clusters biologically related genes 
goal compare clustering results clustering algorithms say algorithm algorithm idea apply clustering algorithm data conditions remaining condition assess predictive power clustering algorithm 
clustering algorithm said predictive power genes cluster tend similar expression levels condition produce clusters 
define scalar quantity called merit fom estimate predictive power clustering algorithm 
idea illustrated clustering algorithm applied data conditions 

condition estimate predictive power algorithm 
suppose clusters 
obtained cluster sizes 
expression level gene condition raw data matrix 
fom merit clusters condition validation 
possible definitions merit see section 
example possible definition fom average squared distance mean expression level cluster written fom average expression level condition genes cluster conditions turn validation condition 
aggregate merit fom tot fom estimate total predictive power algorithm conditions clusters data set 
conditions genes raw data matrix 
algorithm fom tot number clusters algorithm comparison algorithms case average squared distance mean merit small aggregate merit indication high predictive power clustering algorithm 
example algorithm higher predictive power algorithm different algorithms typically different tunable parameters 
compare quality clusters produced different algorithms adjust parameters number clusters cases 
simply producing smaller clusters produce smaller fom 
determining optimal number clusters difficult problem 
determine optimal number clusters data set produce clustering results optimal number clusters 
methodology comparing clustering algorithms range number clusters reasonable way get problem determining optimal number clusters 
approach different leave cross validation machine learning 
leave oneout cross validation machine learning objective estimate accuracy classifier algorithm maps unlabelled instance label supervised learning 
clustering algorithms labels objects clustered assumed known 
idea hide label object turn estimate label object classifier 
contrast approach assume prior information genes evaluate quality clustering results 
define figures merit estimators predictive power clustering algorithms assess quality clustering results 
demonstrated technique clustering algorithms cast means iterative algorithm gene expression data sets rat central nervous system cns data set yeast cell cycle data set human differentiation data set 
section describes clustering algorithms section discusses different definitions merit 
section provides methodology measure correspondence clustering result partial categorization genes 
show performance clustering algorithms depends specific data set number clusters definition merit 
clustering algorithms clear winner results 
general means algorithm comparable average performance cast algorithm 
provide evidence merit estimator predictive power clustering algorithms external validation known functional categories genes 
show predictive power cast algorithm euclidean distance correlation coefficient similarity metrics comparable rat cns data set 
detailed results described section 
main contribution comparison specific algorithms metrics development simple quantitative data driven methodology allowing comparisons clustering algorithms similarity metrics 
clustering algorithms implemented clustering algorithms cluster affinity search technique cast iterative partition algorithm means algorithm 
comparison random clustering algorithm implemented 
cast implemented pseudo code cast additional heuristics added implementation cast authors 
please refer details algorithm 
heuristic choose gene maximum number neighbors start new cluster 
cast algorithm converges additional iterative step clusters considered time genes moved cluster highest average similarity 
iterative partition algorithm input iterative partition algorithm consists similarity matrix parameter 
varying parameter produces clustering results different number clusters 
total similarity gene cluster sim tot defined sum pairwise similarities gene sim tot pairwise similarity iterative algorithm suggested richard karp university california berkeley 
means gene gene excess similarity gene cluster excess sim defined excess total similarity multiplied size cluster excess sim sim tot 
initially gene cluster 
random order selected genes iterative step 
iteration gene excess similarity gene existing cluster computed 
max cluster maximum excess similarity gene gene currently cluster max gene removed cluster inserted cluster max process repeated genes moved clusters 
note cast cluster open time clusters open time iterative algorithm 
means number clusters input means clustering algorithm 
clusters described centroids cluster centers algorithm 
implementation means initial centroids consist randomly chosen genes 
gene assigned centroid cluster closest euclidean distance 
new centroids clusters computed genes assigned 
steps assigning genes centroids computing new centroids repeated genes moved clusters 
random clustering evaluate performance clustering algorithm compare clustering algorithm random clustering 
random clustering clusters condition obtained randomly putting data values condition bins 
merit obtained clustering algorithm considerably lower random clustering evidence clustering algorithm higher predictive power random clustering 
merit merit estimate predictive power clustering algorithm 
suppose clustering algorithm applied conditions condition clusters 
merit fom considered section estimate mean error predicting expression levels average expression levels clusters condition expression level gene condition average expression level condition genes cluster norm merit fom defined fom similarly define norm merit fom average manhattan distance mean expression level cluster expression levels genes cluster condition fom external validation fom define range condition cluster difference maximum expression level maxc minimum expression level minc condition cluster range measures diameter cluster 
average range clusters defined range fom maxc minc minimum achievable merit condition minimum possible fom data values condition 
minimum achievable merit represents lower bound merit clustering algorithm 
theorem minimum achievable merit range fom fom min computed log time 
proof outline proved contradiction optimal solution partition sorted data values 
second part proof showed cluster boundaries placed largest gaps sorted data values condition fom min minimized gap values sorted data values maximized 
fom min computed sorting data values condition placing cluster boundaries largest gaps sorted data values 
done log time 
norm norm range fom estimate predictive power clustering algorithm measuring dispersion gene expression levels left condition intuitively genes clusters expected similar expression levels 
disjoint clusters expected relatively far apart 
define ratio fom ratio cluster dispersion cluster separation 
cluster dispersion represented norm fom 
cluster separation represented distance centers clusters condition average gene expression level cluster condition denote maximum average gene expression level condition max maxc 
similarly minimum average gene expression level condition min minc 
average cluster separation estimated average manhattan distance cluster means max min ratio fom written fom ratio max min external validation fom section describe methodology justify figures merit measure predictive power clustering algorithms 
suppose functional categories subset genes data set known 
functional categorization may derived information gene expression data gene expression data set expected reflect functional categories certain degree 
idea compare clustering result known functional categorization genes 
genes classified allow jaccard indices partial functional categorization gold standard compare clustering results 
methodology applied determine similarity clustering results 
jaccard indices chapter jain dubes external indices assess degree partitions number objects agree defined 
clustering algorithms assign object exactly cluster clustering results considered partitions 
suppose partitions compared 
jain dubes define number pairs objects appear cluster partitions number pairs objects cluster number pairs objects cluster number pairs objects different clusters partitions 
known indices measure similarity partitions example jaccard index jaccard define number pairs objects group similarly number pairs objects group statistic defined ma statistic essentially correlation matrices object object group partition 
similarly defined 
jaccard index lies statistic lies 
high jaccard statistic means high correspondence functional categorization 
generalization jain dubes assume partitions compared complete partitions objects 
generalize indices section compare partial partitions genes fall known functional categories 
main observation jaccard statistics depend values idea count number pairs genes genes exist known categorization 
suppose clustering result genes partial functional categorization genes define number pairs genes genes exist genes appear group cluster similarly define high jaccard statistic indicates high similarity clustering result functional categorization 
recall low merit indicates high predictive power 
idea apply clustering algorithm conditions condition produce clusters fom jaccard statistic clustering result conditions computed 
repeat process different clustering algorithm plot statistics fom different algorithms 
points show trend downward negative slope shows clustering result low fom tend high correspondence functional categorization 
provides evidence predictive power fom comparing clustering algorithms 
results discussion results discussion section describe performance iterative cast means clustering algorithms rat cns data set yeast cell cycle data set human differentiation data set 
justify figures merit estimate predictive power clustering algorithms known biological classes genes rat cns data set yeast cell cycle data set 
gene expression data sets available world wide web 
experiments random clustering step repeated times iterative algorithm run times means algorithm run times obtain reliable fom 
rat cns data set figures show performance iterative means cast clustering algorithms terms aggregate norm norm range ratio fom rat cns data set 
raw data set published wen consists genes time points 
suggested raw data normalized maximum expression level gene 
data set augmented slopes differences consecutive time points capture parallel trajectories time course data 
results data set genes conditions 
correlation coefficient compute pairwise similarities genes 
clustering algorithms iterative means cast achieve lower aggregate figures merit random clustering norm norm range ratio fom 
iterative means random clustering algorithms randomized run multiple times obtain reliable fom 
figures solid lines iterative means random algorithms represent sum average fom conditions show error bars 
error bars randomized algorithms obtained computing percentile fom multiple runs algorithms summing conditions obtain aggregate fom 
similarly error bars obtained computing percentile multiple runs 
chosen error bars maximum minimum maximum minimum sensitive outliers 
see spread fom iterative algorithm smaller means random clustering algorithms 
error bars norm range fom show similar behavior 
behavior clustering algorithms aggregate norm fom similar norm 
number clusters small cast means clustering algorithms comparable aggregate norm norm fom lower iterative algorithm 
number clusters large clustering algorithms comparable aggregate norm norm fom 
minimum fom corresponds aggregate minimum achievable range fom 
fom min computed theorem 
iterative algorithm lower aggregate range fom cast means algorithms number clusters small 
number clusters large clustering algorithms similar aggregate range fom 
algorithms produce aggregate range fom lying roughly halfway random clustering aggregate minimum achievable range fom 
norm norm range fom expected monotonically decreasing number clusters increases 
case ratio fom measures ratio rat cns data set cluster dispersion cluster dispersion 
small ratio fom desirable 
ratio fom may monotonic 
jain applied bootstrap technique determine optimal number clusters 
defined similar ratio cluster dispersion separation plotted ratio number clusters argued significant knee graph corresponds optimal number clusters 
matter fact plotting evaluation index number clusters standard technique 
knee clusters iterative means cast clustering algorithms 
ratio cluster dispersion cluster separation minimum clusters rat cns data set 
genes rat cns data set classified categories biological knowledge 
ratio fom may give estimate optimal number clusters inherent data 
norm fom rat cns data number clusters avg iterative avg means cast avg random aggregate norm fom clustering algorithms rat cns data set 
wen categorized genes rat cns data set families biological knowledge 
table shows aggregate norm norm fom clusters identified comparable iterative means cast algorithms 
means algorithm achieves lowest aggregate norm norm fom clusters results 
interesting observe aggregate range fom iterative algorithm significantly lower clusters identified wen 
fact aggregate range fom wen clusters slightly lower random clustering 
definition range fom depends maximum minimum expression levels cluster range fom expected sensitive outliers 
wen clusters data set fitch software 
cast algorithm achieves lowest aggregate norm norm fom clusters results 
aggregate norm norm fom data shown clusters slightly lower cast algorithm 
take fact figures merit clusters chosen wen similar algorithmically indication methodology providing meaningful results discussion norm fom rat cns data number clusters avg iterative avg means cast avg random aggregate norm fom clustering algorithms rat cns data set 
range fom rat cns data number clusters avg iterative avg means cast avg random aggregate range fom clustering algorithms rat cns data set 
rat cns data set ratio fom rat cns data number clusters fom avg iterative avg means cast aggregate ratio fom clustering algorithms rat cns data set 
fom definition wen clustering iterative means cast random norm norm range table aggregate fom wen clusters clustering algorithms 
estimate cluster quality 
addition fom calculation evaluated similarity clustering results functional categories genes rat cns data set wen methodology section 
show jaccard index fom statistic fom respectively 
iterative means cast random algorithms applied conditions condition left genes rat cns data set produce clusters 
fom computed gene expression levels left condition 
iterative random algorithms run times respectively 
cast algorithm run exactly deterministic 
means algorithm run times show intermediate results means cast successive iterations 
fom random algorithm standard deviations higher clustering algorithms jaccard statistics standard deviations lower clustering algorithms 
obvious downward negative slope trend figures showing clustering results low fom tend high correspondence functional categorization 
shows results runs means run cast algorithm 
run means represented color 
points color represent successive iterations run 
successive iterations algorithm show fom results discussion jaccard index fom rat cns data set 
index fom rat cns data set 
rat cns data set index fom successive iterations means cast rat cns data set 
statistics change algorithm proceed desirable clustering result 
runs means cast algorithm proceed iteration see trend lower fom higher correspondence functional categorization 
investigated effect leaving conditions shown figures leaving condition typical results 
furthermore computed average jaccard statistics conditions data set clustering algorithms shown table multiple runs algorithms 
iterative random algorithms run times means algorithm run times results table 
jaccard statistics conditions applied comparable condition left 
shows leaving condition significant effect quality clustering results 
algorithm jaccard iterative means cast random table average jaccard statistics conditions clusters rat cns data set 
conclude clustering results low fom tend high correspondence functional categorization wen rat cns data set 
results discussion yeast cell cycle data set yeast cell cycle data set cho consists approximately genes conditions 
cho identified genes visual inspection raw data 
data set normalized 
conditions divided panels correspond cell cycles normalized mean variance panel 
correlation coefficient compute similarity matrix 
shows performance clustering algorithms processed yeast cell cycle data set 
number clusters large iterative cast algorithms lower aggregate norm fom means algorithm 
norm fom yeast cell cycle data number clusters avg iterative avg means cast avg random aggregate norm fom clustering algorithms yeast cell cycle data set 
cho categorized approximately genes phases cell cycle web site 
genes identified visual inspection gene expression data peak times genes expect clustering results correspond known categories genes 
methodology section validate fom estimate predictive power clustering algorithms 
results leaving time point shown 
studied effects leaving time points data set shown figures typical results shown 
randomized algorithms run times intermediate results successive iterations means cast shown 
obvious downward negative slope 
iterative means cast algorithms show significantly lower fom higher jaccard statistics random algorithm 
shows fom statistics successive iterations means cast algorithms 
successive iterations run represented color 
iteration means cast fom tend lower higher correspondence functional categories 
computed average jaccard statistics time points yeast cell cycle data set jaccard index fom yeast cell cycle data set 
index fom yeast cell cycle data set 
results discussion index fom successive iterations means yeast cell cycle data set 
clustering algorithms multiple runs algorithms shown table 
average jaccard statistics time points comparable time point left 
evidence leaving condition seriously affect clustering quality data set 
algorithm jaccard iterative means cast random table average jaccard statistics conditions clusters yeast cell cycle data set 
cho looked functional categorizations genes mips database 
approximately genes divided categories 
genes chosen due functional categories mips mips database annotated just gene expression data expect clustering results gene expression data lower jaccard statistics mips functional categories stages cell cycle 
typical result shown 
expected statistics lower values 
note obvious downward negative slope graph showing low fom correspond high correspondence mips functional categories 
human data set aggregate norm fom clustering algorithms human differentiation data set shown 
variation filter software human data set index fom yeast cell cycle data set 
norm fom human data number clusters avg iterative avg means cast avg random aggregate norm fom clustering algorithms human differentiation data set 
results discussion applied raw data genes pass filter 
data normalized cell lines making conditions suggested 
correlation coefficient compute similarity matrix 
close inspection shows cast achieves lower aggregate norm fom algorithms number clusters small 
number clusters large means algorithm achieves lower aggregate norm fom iterative cast algorithms 
analysis isolated exceptions data sets considered exhibit declining figures merit algorithms number clusters increases 
factors contribute 
algorithms may finding higher quality clusterings subdivide large coarse clusters smaller homogeneous ones 
second simply increasing number clusters tend decrease fom 
simple analysis estimates effect second factor 
suppose measured expression levels 
genes cluster independent identically distributed normal random variables variance expected contribution fom expected value subdividing smaller nonempty sub clusters reduce genes expected contribution fom aggregate norm fom collection homogeneous clusters 
fact rat cns data set formula agrees measured norm fom tot random clustering fraction percent despite fact real data sets violate key assumptions analysis 
presumably relatively steep decline norm fom tot achieved clustering algorithms rat cns data set reflect genuine progress producing homogeneous clusters gradual declines larger roughly paralleling random curves largely reflect purely statistical effect increasing wen identified clusters rat cns data set analysis suggests data may support refined sub clustering 
effect similarity metrics approach evaluate effect similarity metrics clustering results 
general guidelines literature choice similarity metrics 
shows aggregate norm fom cast iterative algorithms rat cns data set correlation coefficient euclidean distance information entropy similarity metrics 
proposed information entropy similarity metric compared biological knowledge clustering results information entropy euclidean distance similarity metrics fitch software 
showed clustering results euclidean distance information entropy high degree correspondence 
order compute information entropy gene expression sequence expression levels discretized equidistant bins 
gene expression series 
information entropy mutual information computed probabilities occurrence discretized expression levels log 
normalized mutual information norm defined norm max 
norm measure pairwise similarity gene expression series 
cast algorithm different similarity metrics number clusters cast correlation cast distance cast entropy iterative algorithm different similarity metrics number clusters fom iterative correlation iterative distance iterative entropy aggregate norm fom cast iterative algorithms different similarity metrics 
number clusters large aggregate norm fom algorithms correlation coefficient euclidean distance similar lower information entropy 
similarity metrics give clearly superior fom especially number clusters small 
cast algorithm correlation coefficient gives lowest aggregate norm fom clusters 
experiments data shown observed significant difference aggregate norm fom iterative cast algorithms bins discretization expression levels information entropy computation rat cns data set 
provide simple quantitative methodology compare predictive power clustering algorithms similarity metrics data set 
demonstrated technique iterative means cast algorithms rat cns data set yeast cell cycle data set human differentiation data set 
showed performance clustering algorithms depends specific data set number clusters definition fom 
rat cns data set yeast cell cycle data set showed low fom tend correspond high similarities known partial functional categorizations genes 
indication definitions figures merit provide estimate cluster quality 
norm norm fom similar performance data sets 
range fom sensitive outliers aggregate range fom iterative algorithm tend significantly lower algorithms especially number clusters small suggests iterative algorithm may suited handle data lot outliers 
methodology verify existence clusters data set 
plot fom number clusters simulation data set section diagram shows different trend data sets intrinsic patterns diagram shown 
simulation data intrinsic pattern trend clustering algorithms follow closely random clustering algorithm 
clustering algorithm emerged clear cut winner suggest flexibility speed reliability ease implementation may equally important differentiating clustering algorithms 
implementation means substantially faster iterative cast algorithms 
takes seconds pentium ii run means human data set genes conditions 
average running times iterative cast algorithms seconds data set 
terms reliability cast implemented deterministic algorithm iterative means algorithms randomized algorithms 
error bars showed standard deviations iterative algorithm tend smaller means algorithm 
needs done confirm apparent small effect predictive power similarity metric measure similarity gene expression levels 
directions compare similarity clustering results different algorithms 
example genes cluster obtained algorithm interesting compute probability cluster algorithm applied 
important pre clustering step standardization variables data set 
effect different variable standardization methods predictive power clustering algorithms interesting direction 
summarize clustering difficult problem 
nice single universally superior clustering method 
observed variability solutions produced different algorithms different data sets varying similarity metrics solution sight 
lacking feel simple methodology introduced quantitative comparison predictive power clustering algorithms prove valuable ingredient clustering studies 
richard karp suggesting iterative algorithm 
amir ben dor sharing additional heuristics implemented software 
addition lue ping zhao fred hutchinson cancer research centre suggestions modelling simulation data sets 
colleagues friends university washington provided valuable suggestions anderson mathieu blanchette jeremy buhler jared andrew siegel martin tompa array analysis group 
whitehead institute granting academic site license software 
michael eisen stanford university granting permission cluster softwares 
ben dor yakhini 
clustering gene expression patterns 
proceedings third international conference computational biology recomb pp 

cho campbell steinmetz conway lockhart davis 
genome wide transcriptional analysis mitotic cell cycle 
molecular cell vol pp 
july 
derisi iyer brown 
exploring metabolic genetic control gene expression genomic scale 
science vol 
pp 

efron 
jackknife bootstrap resampling plans 
society industrial applied mathematics 
eisen spellman brown botstein 
cluster analysis display genome wide expression patterns 
pnas vol pp 
dec 

phylogeny inference package version distributed author department genetics university washington seattle 
jain dubes 
algorithms clustering data 
prentice hall englewood cliffs nj 
jain moreau 
bootstrap technique cluster analysis 
pattern recognition vol pp 

kohavi 
study cross validation bootstrap accuracy estimation model selection 
ijcai pp 

mayer pfeiffer man mips database protein sequences complete genomes 
nucleic acids research pp 

carr fuhrman wen somogyi 
cluster analysis data visualization large scale gene expression data 
pacific symposium biocomputing pp 

milligan 
clustering validation results implications applied analysis 
clustering classification 
tamayo slonim mesirov zhu lander golub 
interpreting patterns gene expression self organizing maps methods application differentiation 
pnas vol pp 
march 
wen fuhrman carr smith barker som 
large scale temporal gene expression mapping central nervous system development 
pnas vol pp 
jan 
web sites data sources rat cns data set rsb info nih gov mol physiol pnas html yeast cell cycle data set genomics stanford edu yeast html human differentiation data set www genome wi mit edu mpr 
