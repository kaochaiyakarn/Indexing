fully automatic segmentation brain mri stella atkins blair ken school computing science simon fraser university burnaby british columbia canada department radiology vancouver hospital ubc site research partially funded natural sciences engineering research council canada 
robust fully automatic method segmenting brain head images developed works presence rf inhomogeneities 
successful segmenting brain slice head images acquired different mri scanners different resolution images different echo sequences 
method uses integrated approach employs image processing techniques anisotropic filters snakes contouring techniques priori knowledge remove eyes tricky remove image intensity 
multi stage process involving removal background noise leaving head mask finding rough outline brain refinement rough brain outline final mask 
describes main features method gives results brain studies 
keywords magnetic resonance imaging intracranial boundary detection nonlinear anisotropic diffusion active contour models magnetic resonance imaging mri provides detailed images living tissues brain body human studies 
data obtained images detecting tissue injuries functional mri measuring function blood flow 
example mri brain images multiple sclerosis ms patients studies evaluate effect drugs 
mri scans ms patients show bright spots proton density pd images correspond ms lesions 
volume lesions changes time shown size lesions corresponds progress disease 
order perform quantitative studies regions interest defined 
traditional methods radiologist manually outlines region interest mouse cursor 
computer assisted methods methods surveyed 
describe new fully automatic method segmenting brain head images 
key automatic method robust produces reliable results image acquired particular scanner echo sequence 
method robust successfully able segment brain slice head images different mri scanners different resolution images different echo sequences 
method works presence radio frequency rf inhomogeneity addresses partial volume effect consistent reasonable manner 
remainder describes method gives results 
compare method published methods provide summary outline including extending method segment lungs chest images 
method brain mask pd image generate initial brain mask generate final brain mask segment head image initial brain mask diffused image head mask simplified data flow diagram representing automatic intracranial boundary detection 
method overview stage method segment images shown fig 

remove background noise generate initial mask region interest refine mask final segmentation 
stage bubble diagram implemented wit visual programming environment aids prototype development enables experimentation 
stage segment head uses intensity histogram analysis remove background noise provide head mask defining head 
second stage generate initial brain mask produces mask approximately identifies intracranial boundary 
uses nonlinear anisotropic diffusion weighted data set spatial information provided head mask identify regions corresponding brain 
nonlinear anisotropic diffusion effectively counters rf inhomogeneity attenuating non brain method regions 
initial brain mask seed third step generate final brain mask locates intracranial boundary active contour model algorithm 
active contour model algorithm consistently tracks edge brain presence partial volume effects 
stages require priori information organ segmented 
knowledge organ interest second stage initial brain mask generated 
expert pieces information 
allows eliminate non brain tissues eyes morphology exploiting simple fact brain centroid near centroid slice 
item knowledge brain tissues appear images relatively high intensity pd image filtered special anisotropic diffusion filter non brain tissues attenuated brain tissues segmented simple threshold 
methodology described detail full detail 
seemingly complex method proven robust works presence rf inhomogeneity case simple threshold technique identify brain tissue non brain tissue 
similar techniques applied chest mri segment lungs 
segment head head mask generated method suggested determine best threshold level removing background noise pd weighted images 
assuming scanner produces normally distributed white noise show background noise reconstructed pd weighted volumes rayleigh distribution noise oe exp gamma oe noise intensity oe standard deviation white noise 
fig 
shows distribution easily visible low intensity range uncorrected mri histogram 
subtraction best fit rayleigh curve volume histogram produces bimodal distribution gamma method frequency intensity truncated histogram best fit rayleigh curve truncated histogram pd weighted volume 
background noise low histogram characterized rayleigh distribution 
head mask produced automatic thresholding morphology 
original image 
initial head mask 
final head mask morphology 
minimum error threshold determined minimizing error term gamma fig 
shows results automatically thresholding volume method 
binary image fig 
produced thresholding volume contains speckle outside head region misclassified regions head 
noise easily removed standard morphological operations 
method generate initial brain mask generate initial brain mask step process 
uses nonlinear anisotropic diffusion attenuate non brain regions mri slice 
automatically thresholds diffused volume produce binary mask 
misclassified non brain regions removed binary mask morphology spatial information provided brain mask 
nonlinear anisotropic diffusion nonlinear anisotropic diffusion filters iterative tunable filters introduced perona malik 
gerig filters enhance images 
sapiro tannenbaum similar technique perform edge preserving smoothing images 
shown diffusion filters enhance detect object edges images 
perona malik formulate anisotropic diffusion filter diffusion process encourages smoothing inhibiting smoothing ffl ri case image 
refers image axes refers iteration step 
called diffusion function monotonically decreasing function image gradient magnitude 
allows locally adaptive diffusion strengths edges selectively smoothed enhanced evaluation diffusion function 
diffusion function algorithm exp gamma jri 
referred diffusion constant flow constant behavior filter depends greatest flow produced image gradient magnitude close value choosing correspond gradient magnitudes produced noise diffusion process reduce noise images 
assuming image contains discontinuities object edges enhanced choosing value slightly gradient magnitude edges 
similarly edge smoothed choosing value slightly larger gradient magnitude edge 
method discrete diffusion process consists updating pixel image amount equal flow contributed nearest neighbors 
nonlinear anisotropic diffusion attenuate non brain regions mri slice illustrated fig 
attenuation enables brain segmented simple threshold 
attenuation threshold segmentation difficult impossible 
automatic threshold weighted mri slice diffused attenuate non brain voxels segment brain single automatic threshold 
threshold level determined fitting gaussian curve histogram diffused volume choosing level standard deviations mean 
fig 
shows voxel intensity histogram diffused volume best fit gaussian curve threshold level overlaid 
fig 
shows slice binary mask produced threshold 
mask refinement binary mask produced automatic thresholding contains misclassified regions eyes see fig 

regions removed slice morphology spatial information provided head mask 
holes filled region mask 
binary erosion performed separate weakly connected regions 
erosion regions centroids fall outside bounding box defined head mask eliminated 
bounding box illustrated fig 

binary dilation performed remaining regions return original size 
results steps shown fig 

similar techniques obtain initial lung segmentation masked chest just different morphology parameters ensure centroid lung appropriately located chest 
details section results 
nearest neighbors flow contribution diagonal neighbors scaled relative distance pixel interest 
anisotropic data handled similarly 
attempted attenuate non brain tissues nonlinear anisotropic diffusion entire mri volume 
diffusion increased partial volume effect blurring edges brain 
method intracranial boundary detection nonlinear anisotropic diffusion filtering 
original image 
diffused image 
diffusion attenuates non brain tissues enabling simple threshold segment brain 
method best fit gaussian curve histogram threshold relative frequency intensity histogram diffused weighted scan best fit gaussian curve threshold levels overlaid 
binary mask produced automatic thresholding 
diffused image slice 
corresponding binary mask 
method head mask centroid head mask bounding box head mask brain region bounding box maxy miny minx maxx minx maxx miny maxy spatial information head mask eliminate regions correspond brain tissue 
features centroids fall outside brain region bounding box discarded 
dimensions brain region bounding box chosen experimentally produce results data sets 
generate final brain mask initial brain mask seed active contour model algorithm extended snakes algorithm introduced kass locate boundary brain intracranial cavity :10.1.1.124.5318
algorithm deforms contours defined perimeter initial brain mask lock edge brain 
active contour defined ordered collection points image plane fv delta delta delta delta delta delta ng points contour iteratively approach intracranial boundary solution energy minimization problem 
point energy matrix computed ffe cont fie bal fle int grad cont continuity energy function influences contour take shape circle bal adaptive balloon force pushes contour outward reaches method elimination misclassified regions initial brain mask 
mask produced thresholding regions filled binary erosion elimination non brain regions binary dilation 
shows initial brain mask overlaid pd weighed slice 
method refinement intracranial contour 
contour defined perimeter initial brain mask 
intracranial contour detected active contour model algorithm 
strong gradient int intensity energy function computed pd weighted mri volume influences contour move low intensity regions grad gradient energy function computed diffused weighted mri volume influences contour move regions strong gradient 
ff fi fl scalar constants providing relative weightings energy terms 
iteratively moved point minimum energy neighborhood corresponds smallest element 
combination energy functions described enables active contour model algorithm detect intracranial boundary image slices relative energy weightings 
diffusion process ensures initial brain mask falls completely inside brain 
adaptive balloon force cases initial brain mask poor 
intensity energy term helps active contour algorithm produce consistent results partial volume effects particularly severe 
computing gradient energy term diffused weighted volume greatly stabilizes active contour algorithm gradient derivatives small diffused volume 
fig 
illustrates result applying active contour model algorithm slice shown fig 

ff fi fl experimentally chosen produce results 
results results brain studies fig 
shows intracranial contour detected automatically algorithm overlaid selected slices pd weighted mri data set 
pd data sets acquired ge tesla mri scanner repetition time tr ms echo times ms ms respectively 
data consists slices bit pixels slice 
pixel size mm slice thickness mm 
intracranial boundary shown fig 
accurate slices apparent slight overshoot top slices 
careful examination shows partial volume effect slices dealt consistent way apparent overshoot problem subsequent analysis brain data 
algorithm produced comparable results data sets scanners 
cases algorithm successfully detected intracranial boundary user interaction parameter modification 
previous automatic thresholding suzuki iterative thresholding distinguish brain tissues axial slices 
starting set values thresholds head brain iteratively adjusted geometry resulting masks 
head mask includes brain mask 
method ineffective presence rf inhomogeneity slices brain homogeneous region closely surrounded skull 
li knowledge thresholding multimodal mri data classify voxels multiple intensity categories 
axial slice compute centroid voxels categorized brain 
points defining quadrangle edge brain tracing left right centroid transition tissue categories 
voxels outside quadrangle categorized brain tissue masked define results slice slice slice slice slice slice slice slice slice slice slice slice slice slice slice slice automatically detected intracranial contour overlaid selected slices mri scan 
results contour 
obviously method works slices brain constitutes fairly homogeneous region 
histogram analysis morphology generate brain mask 
model background noise automatically generate mask head perform intensity correction masked volume 
create initial brain mask automatic threshold presupposed brain voxel intensity distribution 
eliminate regions brain mask close edge head 
novel morphological operations clean resulting mask 
method misses brain tissue extreme slices includes non brain tissues 
cases produces errors near eyes 
method relies priori intensity correction deal rf inhomogeneity retroactively 
region growing boundary detection detect intracranial boundary axial mri slices tracing horizontal line outwards center image 
point direction voxel intensity line drops threshold considered point intracranial boundary 
running average voxel intensities line computed 
intracranial boundary points relocated voxels intensity far average 
running average procedure repeated rows image 
entire process repeated columns 
result sequence points defining intracranial contour 
method detect intracranial slices brain homogeneous region may cope rf inhomogeneity 
lim trace lines radially outward approximate center head approach similar proposed impose smoothness criterion resulting contour refine location intracranial boundary 
fit surface voxel intensities contour produced order produce local threshold 
radial line tracing algorithm repeated threshold choose voxels intracranial boundary 
method robust presence rf inhomogeneity partial volume effects 
clearly methods works slices brain separated disjoint regions 
results statistical segmentation cline segment brain images head statistical classification 
segment brain samples brain voxels non brain voxels interactively identified 
bivariate normal distributions corresponding different tissue types pd weighted weighted images fitted sampled intensities 
image voxels classified intensities lie distributions 
results smoothed remove discontinuities classified regions 
method requires user interaction fails presence rf inhomogeneity falsely classifies non brain regions eyes brain 
barillot isolate brain tissues mri slices texture analysis methods 
texture information create initial voxel classification 
cluster analysis bayesian relaxation refine classification 
barillot show results slices containing eyes mouth 
bayesian relaxation techniques confuse features brain tissue 
statistical relaxation method incorporates gradient magnitude voxel intensity brain segmentation 
segmentation algorithm robust presence rf inhomogeneity confuses tissues eyes brain tissue 
user interaction required seed relaxation process 
probabilistic image segmentation 
hierarchical stack decreasing resolution images produced progressively low pass filtering original 
pixels high resolution images children probabilistically linked voxels low resolution images parents objective criterion 
features interest identified low resolution image propagated siblings weighted linked probabilities 
statistical segmentation produced 
identifying features interest thresholding final segmentation performed manually method 
active contour models chakraborty combine statistical segmentation boundary detection isolate features images 
segment images method similar icm algorithm 
parametrically deformable shape model algorithm find boundary inter features segmented image 
shape model algorithm modifies shape pre defined closed contour match shape region interest 
method requires user interaction seed segmentation provide initial shape contour 
segmentation may fail due rf inhomogeneity 
snell active surface template find intracranial boundary mri volumes head 
method active contour model algorithm snakes proposed kass :10.1.1.124.5318
initial estimate object boundary snakes approaches actual boundary solving energy minimization problem 
snell method user identifies points image correspond points standard active surface template brain 
points template registered image 
snakes algorithm attract surface template intracranial boundary 
snell method appears better methods discussed 
snell high resolution isotropic mri data test algorithm 
mri scans generally performed clinically 
method requires user interaction may fail images contain entire brain 
introduced novel fully automatic intracranial boundary detection algorithm proven effective clinical mri data sets acquired different scanners 
algorithm consists incremental steps 
step uses histogram analysis localize head providing region completely surround brain 
second step uses nonlinear anisotropic diffusion automatic thresholding create mask isolates brain detected head region 
mask seed final step employs active contour model algorithm detect intracranial boundary 
algorithm proven robust presence rf inhomogeneity partial volume effects 
mri brain segmentation algorithm regular studies multiple sclerosis lesions studies involving image compression non brain region automatically higher compression ration brain region images 
initial lung outline final lung outline initial lung boundary final automatically detected lung boundary 
lung segmentation principles generated automatic brain segmentation extended problem lung segmentation studies lung diseases cystic fibrosis volume lungs needed 
reliable consistent method outlining lungs required chest images 
early results images shown fig 
shows results applying algorithm segment lungs chest image 
data multiple spin echo images sequence repetition time ms images ms image just slice mm thick 
images pixels acquired bits pixel 
pixel size mm echoes heart boundaries dark leads misclassification empty heart chambers lung 
lung healthy athlete show abnormalities 
initial segmenting lung provide way remove background noise high lung images flow artifacts heart 
removed noise subtracting echo ms echo ms clipping negative values zero noise pixels ms echo 
image contains noise ms echo plus reduced intensity data points 
subtracted noise image original ms echo obtain image contained noise center 
remaining noise thresholded identical technique segmenting background noise head images 
thresholded image eroded dilated head mask giving initial chest mask ready step 
problem finding initial lung mask transformed initial brain mask problem chest mask remove background inverting lung data lung tissue appeared bright 
initial lung mask obtained fitting gaussian brightest intensity peak histogram obtained anisotropic blurring masked inverted data 
echoes 
lung threshold standard deviations mean provide initial lung mask 
applying threshold removed non lung tissue heart morphology technique similar separating non brain tissue brain case specifying centroid lung appropriately located chest 
initial lung mask sensitive threshold long threshold high initial lung contour inside lung final step usually nullified effect seen fig 

research workers identifying lung volumes ct lung data obtain lung outlines resemble major blood vessels included lung 
problem inclusion blood vessels calculation lung volume subject ongoing research 
method provides consistent objective measure lung volume may supplemented necessary calculation blood volume 
acknowledgment authors wish dr don dr david li dr alex mackay andrew keith cover university british columbia ms mri group charlie nih providing mri data algorithms tested 
wish dr alex mackay helpful comments preparation manuscript 
luis alvarez pierre louis lions jean michel morel 
image selective smoothing edge detection nonlinear diffusion 
siam number 
anal june 
arden poon 
wit user guide 
logical vision burnaby canada october 
version 
atkins johnston arden 
role visual languages developing image analysis algorithms 
proceedings ieee conference visual languages pages st louis mo october 
ieee 
sullivan baker 
recognizing cortical sulci gyri images 
editor proceedings british machine vision conference 
russell robert eisner richard 
automatic detection brain contours mri data sets 
ieee transactions medical imaging june 
amit chakraborty lawrence staib james duncan 
integrated approach boundary finding medical images 
proceedings ieee workshop biomedical image analysis pages los alamos ca june 
ieee computer society press 
vikram wendy costa kim 
integrating region growing edge detection regularization 
spie conference medical imaging 
spie 
harvey cline william lorensen ron kikinis jolesz 
dimensional segmentation images head probability connectivity 
journal computer assisted tomography november december 
beta treatment multiple sclerosis final outcome randomized controlled trial 
neurology july 
guido gerig olaf ron kikinis jolesz 
nonlinear anisotropic filtering mri data 
ieee transactions medical imaging june 
johnston 
multispectral stochastic image segmentation 
master thesis university british columbia computer science department vancouver january 
johnston atkins booth 
partial volume segmentation lesions tissues magnetic resonance images 
proceedings spie medical imaging volume pages bellingham wa 
spie international society optical engineering 
johnston atkins anderson 
segmentation multiple sclerosis lesions intensity corrected multispectral mri 
ieee transactions medical imaging april 
kamber louis collins gordon francis alan evans 
model segmentation multiple sclerosis lesions magnetic resonance brain images 
ieee transactions medical imaging pages 
kanazawa 
computer assisted lung cancer helical ray ct ieee workshop biomedical image analysis pages june 
michael kass andrew witkin demetri terzopoulos 
snakes active contour models 
international journal computer vision pages 
barillot 
brain tissue classification mri data means texture analysis 
proceedings spie medical imaging vi image processing volume pages chapel hill 
li hall 
knowledge classification tissue labeling images human brain 
ieee transactions medical imaging december 
lim 
segmentation brain images fluid spaces white gray matter 
journal computer assisted tomography july august 
blair 
intracranial boundary detection radio frequency correction magnetic resonance images 
master thesis simon fraser university computer science department burnaby august 
nordstrom 
biased anisotropic diffusion unified generalization edge detection 
image vision comput 
friedman zimmerman cahill 
quantitative mri studies assessment multiple sclerosis 
magnetic resonance medicine 
li 
beta effective multiple sclerosis 
ii 
mri analysis results randomized double blind controlled trial 
neurology april 
pietro perona jitendra malik 
scale space edge detection anisotropic diffusion 
ieee trans 
pattern analysis machine intelligence july 
guillermo sapiro allen tannenbaum 
edge preserving geometric smoothing mri data 
technical report university april 
dept electrical engineering 
snell ortega goble 
segmentation brain mri hierarchical active surface template 
proceedings spie conference medical imaging 
spie 
staib duncan 
boundary finding parametrically models 
ieee trans pami november 
barrett taylor 
probabilistic segmentation edge detection region growing 
proceedings spie visualization biomedical computing volume pages chapel hill 
suzuki jun 
automatic segmentation head mri images knowledge guided thresholding 
computerized medical imaging graphics july august 
koen andr koster max viergever 
probabilistic multiscale image segmentation set results 
proceedings spie medical imaging vi image processing volume pages chapel hill 
alex 
mri segmentation quantification white matter lesions 
phd thesis vanderbilt university electrical engineering department nashville tennessee december 
alex benoit richard andrew palmer 
analysis white matter lesions images method validation 
ieee transactions medical imaging december 
