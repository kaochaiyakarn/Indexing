cassandra flexible trust management applied electronic health records becker peter sewell computer laboratory university cambridge jj thomson avenue cambridge united kingdom becker peter sewell cl cam ac uk study specification access control policy large scale distributed systems 
cassandra language system expressing policy results substantial case study security policy national electronic health record system requirements ongoing uk national health service procurement exercise 
cassandra policies expressed language datalog constraints 
expressiveness language computational complexity tuned choosing appropriate constraint domain 
cassandra role supports credential access control administrative domains rules refer remote policies automatic credential retrieval trust negotiation 
policy language small formal semantics query evaluation access control engine 
case study choose constraint domain sufficiently expressive encode policy idioms 
case study turns require subtle variants important express variety smoothly add ad hoc features 
ensuring constraint compact fragment guarantee finite computable fixed point model 
top evaluation algorithm efficiency guarantee termination 
case study rules roles demonstrates language expressive realworld application preliminary results suggest performance acceptable 

study specification enforcement security policy large scale distributed systems 
previous trust management role access control systems argued desirable factor policy application code easily understood changed time express policy terms individuals indirection roles express policy language formally defined semantics ease precise understanding support static analysis verify sanity properties support distributed access control basing authorisation digital credentials policies express automatic credential retrieval network strategies establish mutual trust strangers scalable large numbers sites entities cover different administrative domains independent policies local adaptations default policy 
tension design policy languages expressive intended policies written naturally small elegant ad hoc features policies easily understood efficiently computable practical examples 
address designed trust management system cassandra expressiveness language tuned selecting appropriate constraint domain policies expressed extension datalog constraints 
ground research working substantial real world example security policy national electronic health record ehr system requirements ongoing uk national health service procurement exercise 
best knowledge complex policy examples discussed literature 
rules roles shall see demands full expressiveness cassandra 
case study choose constraint domain sufficiently expressive encode policy idioms role hierarchy separation duties role appointment cardinality constraints role validity periods distributed trust negotiation 
interestingly case study turns require subtle variants idioms expressed languages important express variety smoothly add ad hoc feature 
static groundness analysis restrict policies constraint compact fragment required guaranteeing finite computable fixed point model 
top evaluation algorithm efficiency guarantee termination 
cassandra role parameterised roles actions supporting concise policies declarative making policies clear possible express powerful role revocation policies including cascading revocation supports credential access control decisions administrative domains rules refer remote policies providing automatic credential retrieval trust negotiation 
policy language small system formal semantics query evaluation access control engine 
existing trust management systems possess subsets features combination features cassandra tunable expressiveness unique powerful express policies case study 
discuss background case study outline example scenario ehr system 
discuss policies specified cassandra including brief outlines semantics evaluation algorithm 
lack space omit full technical definitions theoretical results 
cassandra needs just language expressing policies api operational semantics access control engine 
demonstrate classic policy idioms expressed particular forms role hierarchy separation duties delegation 
return case study outlining main features paying careful attention idioms expressiveness demands policy language 
full policy available line 
describe prototype implementation time writing cover aspects preliminary experiments suggest performance reasonable policy 
discuss related conclude 

background electronic health records electronic health record ehr schemes developed europe canada australia provide grave summaries patients records linking clinical information entire health system 
england national health service nhs planning develop nationwide integrated care records service providing health care providers patients hour line access central data spine 
deployment largest complex projects public sector world wide scheduled 
potential benefits system obviously huge government plans subject controversial public debate see 
main issue concern confidentiality patient health information 
stake just privacy sensitive personal information success entire project 
patients refuse share data trust system sufficient control data 
equally important gain clinician buy fail system cumbersome access restrictions strict response times high 
ehr access control policy compromise conflicting interests 
general framework policy comply relevant legislation regulations data protection act mental health act human embryology act abortion regulations diseases regulations 
health organisation required privacy data protection officer called guardian named recommendation committee chaired dame responsible organisation security policy investigating breaches confidentiality 
highly contentious 
example committee recommended access patient identifiable information strict need know basis 
contrast common medical code ethics professional practice goes requires patient consent accessing personal information 
anderson stresses point security policy commissioned british medical association demands patients automatically receive notifications data accessed 
current consensus patient consent basis access decisions clear explicit consent sought implicit consent assumed 
sufficiently clear access control policy national ehr system undergo frequent changes public debate evolves 
furthermore health organisations customised policies compatible different national 
necessary able specify policy independently implementation having hard coded access control engine 

scenario national data spine expected hold records patients including deceased patients patients moved abroad 
large scale data spine propose level architecture recommended single physical database 
top level national master patient index mpi central service stores bindings linking patient identifiers ehr service second level location ehr 
local nhs health organisations hospitals doctors practices constitute third level 
records kept level called electronic patient records epr 
shared central ehr items typically summaries local epr items 
registration authorities ras issue credentials nhs clinical administrative staff health organisations authentication purposes 
scenario illustrates challenging requirements security policies national ehr architecture 
discussion case study discuss requirements met example policy role action names policy text 
anson goes see dr zoe zimmer family general practitioner gp hiv test 
dr zimmer records visit local epr item performing item action suitable parameters send information ehr data spine anson request 
time bob anson father visits dr zimmer heart problems 
visit tells believes son anson may 
dr zimmer adds record item bob epr heart condition item anson epr father comments 
item marked containing third party information father long father guardian behalf activate matching third party consent role anson able read 
note roles just model job positions organisation indicate state changes giving third party consent 
dr zimmer attempts submit summary bob new epr item shared ehr 
need query mpi knows location ehr 
activates clinician role ehr service submitting ra issued nhs role credential activation request 
subsequently add ehr record item action succeeds ehr service deduce bob bob explicitly treatment years ago withdrawn consent treatment role 
dr zimmer decides refer bob local hospital cardiologist dr hannah hassan 
bob treating clinician ehr service dr zimmer enter referrer role enabling dr hassan treating clinician 
bob consent needed power deactivate referral 
hospital receptionist registers bob patient activating register patient role 
visit dr hassan receptionist registers surgical team hospital heart bypass operation 
purpose receptionist activates appropriate register team episode register roles establishing legitimate treating clinician relationship bob surgical team ward nurses 
surgery abnormal liver values 
years ago bob activated access denied role conceal contents items ehr concerning alcohol related liver problem everybody clinicians treating gp 
head surgical team dr lily littlewood decides break seal view bob restricted ehr item performing action ehr item 
done clinician legitimate relationship marked audit investigated hospital guardian 
unfortunately team encounters complications operation bob needs kept artificial coma 
dr zimmer agrees appoint bob wife carol agent activating register agent role ehr service 
carol requests activate agent role hospital service 
succeeds trust negotiation hospital ehr service hospital responds carol request requesting agent registration credential bob ehr service ehr service replies requesting health organisation credential hospital agrees sending ra issued health organisation credential ehr service ehr service sends originally requested register agent credential hospital certifying carol bob agent 
bob woken released attempts revoke agent registration wife fails dr zimmer registered carol 
bob request dr zimmer deactivates register agent role carol 
carol active agent role ehr service moment cascading revocation causes role deactivated immediately 

policy specification cassandra access control large scale heterogeneous distributed computing environments fundamentally different access control single administrative domain 
case users known authorisation identity authentication 
case entities single users entire organisations wish share resources previously unknown entities 
trust management approach credentials asserting attributes holders basis access control decisions example clinician may granted access ehr service basis clinician employment credential issued registration authority 
access control policies environments complex best described high level policy specification language 
cassandra language summarised section gives informal language query semantics predicate names hasactivated permits user defined predicate names policy rule loc iss 
issn pn en credential rule aggregation rule agg op iss agg op group count ceq expressions ceq constraints true false expressions en en en en en constraints true false derivable constraints 
types entity int const unit 
role action set access control operations activate deactivate ev es 
collected syntax evaluation algorithm language formal definition lack space give supporting theorems 
section describes semantics access control operations defining precisely terms query semantics 
roles actions cassandra policy language access control administration simpler scalable 
roles actions generalised privileges parameterised higher expressiveness role clinician org parameters health organisation specialty clinician action read record item pat id parameters specifying item identifier patient pat health record 
note cassandra notion role general rbac model role typically job position enterprise hierarchy example entering parameterised access denied patient role may indicate record item concealed patient depending surrounding policy 
predicates role access control rbac relations define role membership session activations role permissions 
cassandra access control relations specified implicitly rules defining special predicates precise operational semantics formalised 
expresses fact entity activate role member 

hasactivated indicates entity activated role distinction predicates hasactivated corresponds distinction role membership session activation traditional rbac 

permits says entity permitted perform action differs standard notion role permission assignment ways 
firstly parameter allows constraints refer directly subject activation 
secondly permits parameter role associated action allowing flexible permission specifications permission conditioned activation merely membership single role 

cassandra rules specify role deactivation holds entity power deactivate role activation 
deactivation role trigger local roles 
form cascading revocation especially important context delegated appointed roles 
deactivation role predicates form true indicating triggered deactivation entity role 
access control different administrative domains attribute asserting credentials 
cassandra attributes simply constrained cassandra predicates 
protect information contained predicates say entity allowed request credentials issued entity asserting predicate 
apart predicates special access control meaning policy writers introduce user defined auxiliary predicates 
rules existing policy languages datalog horn clauses function symbols rule declarative language widely understood 
standard datalog expressive systems extend language ad hoc features 
take different approach base language recursive datalog expressiveness conversely computational complexity parameterised chosen constraint domain 
language adapted wide range applications changing base semantics 
datalog extends datalog rules constraint fixed constraint domain may contain variables occuring head predicate body predicates rule may contain predicate names 
constraint domain language order formulae containing true false identity predicate expressions variables entities possibly constructs including function symbols 
furthermore closed variable renaming conjunction disjunction 
policy rule language cassandra extends predicates purpose trust management 
credential seen constrained predicate issuing entity stored location entity 
correspondingly cassandra predicates prefixed location issuer 
policy rule form loc iss 
issn pn en pi predicate names ei possibly empty expression tuples may contain variables matching parameter types predicate 
constraint fixed constraint domain may contain variables occurring head predicate body predicates rule may contain predicate names 
location issuer rule entities loci entities entity typed variables 
policy rule simple form called credential rule just credential 
sent network thought certificate asserting signed issued belonging stored 
location issuer rule usually identical case credential rule different may hold foreign credential signed different entity 
cassandra policy entity finite set rules including credentials location 
standard datalog predicate deduced rule matching head rule body predicates deduced satisfying constraint rule 
cassandra body predicate refer remote location equal local entity say deduce predicate contact network delegate authority deduce predicate 
remote query amounts credential request try deduce attempting deduce requested predicate 
illustrate consider example likes user defined predicate 
suppose policy contains rules likes likes likes true foreign credential policy contains likes true foreign credential 
intuitively means likes entity policy proves entity says likes formally deduce likes deduce likes service provided equal context evaluation turns body likes deduced locally finding matching credential foreign 
credential proved likes 
turns different say automatically requests credential form likes point cassandra trust negotiation mechanism comes play tries prove likes policy see allowed request credential 
result deduction false request credential constraint variable say allowed get credential provided 
case try prove likes satisfied reply answer likes prove likes 
remainder omit rule location clear context 
omit location issuer prefixes loci body predicates equal rule location 
constraint domains cassandra entities network agree common constraint domain example expressive constraint domain ceq atomic constraints equalities variables entities 
choosing trivial constraint domain reduces expressiveness language standard datalog horn clauses function symbols 
design richer constraint domain guided ehr case study 
atomic expressions variables entities integers constants various types empty set universal set 
compound expressions built atomic ones recursively tuples en tuple projections roles en actions en function applications en set expressions en 
constraints include equalities inequalities integer orders set containments course finite conjunctions disjunctions 
function symbols interpreted fixed set side effect free functions may return environment dependent data 
example case study functions access data fields health record items get ehr item author pat id function current time returns current time 
type system types form int entity const unit 
role action set ensures expressions constraints wellformed 
typing trivially encode undecidable properties policies perform arithmetic unary encoded integers 
allow constraints defined terms existing ones non membership integer ranges range containments 
aggregation rules policies require negative conditions premise rule entity activated particular role entity activated role 
example expressed introducing negated body predicates method express example implicitly involves universal quantification 
introduce rules aggregation operators examples expressed 
aggregation useful grouping cardinality constraints constraints set role activations particular entity number activations 
aggregation constraint domain required contain equalities set integer constants variables 
aggregation rule form agg op iss aggregation operator agg op group count 
predicate iss satisfied finitely different parameters contain argument instantiated finite set different values satisfy body 
agg op count instantiated cardinality set 
example group active doctors group hasactivated doctor finds set active doctors specialty 
similarly count specialties count hasactivated doctor counts number different specialties active doctor 
restriction body predicate aggregation rule local location equal necessary aggregation requires complete knowledge predicate 
answers remote entities sound may incomplete subject restrictions 
restriction body predicate satisfied finitely different parameters mentioned ensures aggregation finite 
terms negation corresponds semi positive policies avoiding negation related issues undecidability semantic ambiguity 
separation duties example shows aggregation express universally quantified negation 
note kind negation express aggregation occur body rule head 
particular express explicit prohibitions halpern weissman logic ponder faf assume prohibited explicitly permitted closed world assumption 

semantics evaluation cassandra provides direct support access control decisions access control engine issues policy queries bases decisions query answers specified 
typical query issued access control engine queries directly users hasactivated doctor gp 
answer query constraint describing potentially infinitely variable instantiations satisfy query policy 
example answer constraint specifying non gp doctors associated specialties 
completely ground query variables forced unique value answer constraint true false 
general query form credential rule answer constraint query may depend policies different entities rules refer remote policies 
policy evaluation algorithm takes query input returns answer constraint 
require algorithm terminate queries policies efficient course sound complete respect language semantics 
define language semantics immediate consequence operator tc global constraint domain naturally disjoint union policy rules entities 
tc extension immediate consequence operator standard datalog deductive closure set deducible ground facts datalog program computed 
cassandra credential rules correspond datalog facts deductive closure contains set deducible credentials rules 
tc function sets credential rules tc set credential rules deduced single step 
omit formal definition due lack space point tc assumes existence certain operations satisfiability test subsumption implication test existential quantifier elimination procedure independent deductive closure fixed point model unique fixed point tc computed usual iterative bottom fashion finite 
obvious fixed point model finite 
easy show simple looking constraint domains supports untyped tuple constructors negative gap order constraints positive integer constant enable construction undecidable policies 
constraint compactness sufficient condition constraint domains guarantee finite computable fixed point model finite global policy set constraint domain said constraint compact infinite set constraints finitely variables constants occur finite subset subsuming entire set constraint infinite set constraint finite set implies unfortunately constraint compactness severely restricts expressiveness constraint language hard prove 
static groundness analysis restrict policies way variables occuring specific constructs grounded unique value deduced time existential quantifier elimination performed query patterns constructs ignored 
case require variables occuring function arguments set expressions ground quantifier elimination time 
reduces constraint domain proved constraint compact 
static groundness analysis ensure location prefix body predicates ground time evaluate evaluator query different entities worst case clearly 
context constraint logic databases queries usually evaluated complete fixed point model pre computed iteratively bottom fashion 
acceptable evaluation strategy cassandra firstly constraints may contain side effect free function calls depend environment example getting current time pre computed secondly fact rule bodies refer remote predicates require distributed form bottom evaluation highly thirdly model re computed activation deactivation roles role activation deactivation modify policies 
cassandra uses modified version toman top clp evaluation algorithm slg resolution memoization strategy 
usual top algorithms sld resolution prolog systems unsuitable guarantee termination cases fixed point model finite 
slg algorithm hand preserves termination properties bottom evaluation method 
extended algorithm deal goals referring remote entities 
evaluation algorithm sound complete respect fixed point semantics far efficient bottom method especially queries fully instantiated case cassandra 

access control semantics way query policy interface access control engine 
define operational semantics operations entity er request entity es acting cassandra service performing action activating role deactivating role requesting credential 
operations may side effects policies semantics naturally specified labelled transition system transitions global policy sets labels transition system parameterised requester er service es requested operation set credentials cr belonging requester submitted es request 
implementation signed certificates 
fact credentials belong es expressed renaming location es 
write submit es cr es cr renamed set credentials 
performing action er attempts perform ground action service es 
er es cr valid transition es es permits er deducible submit es cr 
note deduction may involve transition effect state 
role activation er attempts activate ground role service es 
er es activate cr es es hasactivated er valid transition role activated es es er deducible submit es cr 
result transition new hasactivated credential rule added es policy 
role deactivation er requests deactivate victim ev role service es 
transition rule implements cascading deactivation 
er es deactivate ev cr victims valid transition ev activated es es er ev deducible submit es cr 
set victims set hasactivated credential rules es policy corresponding credential derived assumption predicate es es ev holds 
result transition role activations victims removed es policy 
note victims contains role activations location es cassandra support distributed cascading revocation network proposed oasis 
mechanism hard implement wide scale require reliable event infrastructure management bigger state recording entities notified deactivation events 
requesting credentials er requests credential es service es 
es identical es computes exact answer requested predicate sends freshly signed certificate er 
es sends foreign certificates matching request er 
note credentials er receives result constraints general restricted requested constraint 
formally er es es cr valid transition provided satisfiable answer query es es er submit es cr 
es contains credential er es satisfiable answer query es es submit es cr 
es case set foreign credentials belonging es issued constraints restrictive 
credential locations course renamed es er 

expressing policy idioms cassandra powerful express common rbac policy idioms role hierarchy separation duties role delegation need support specifically ad hoc language extensions 
approach keeps language definition simpler uniform enables policy designer express variants combinations idioms expressed policy languages 
naturally advantages come cost rules may look complicated languages built application tailored features 
give encodings mentioned idioms pure forms 
ehr case study exhibits variants role appointment idioms cardinality constraints role validity periods distributed trust negotiation 
role hierarchy project leader senior production engineer quality engineer 
production engineer quality engineer senior engineer role 
example taken 
hierarchy graph directly represented dependencies 
extend example roles department parameter prod eng dep proj leader dep qual eng dep proj leader dep eng dep prod eng dep eng dep qual eng dep separation duties encode separation duties constraints necessary able express negated conditions activated role instantiated time condition processed 
write condition body hasactivated shorthand user defined aggregation condition defined rule count hasactivated clearly holds activated 
example dynamic wise parameter centric separation duties suppose projects time belong set pairwise mutually conflicting projects 
function conflict returns set conflicting projects encoded hasactivated conflict delegation appointment delegation viewed special case general appointment mechanism required member appointed role 
appointment easily encoded cassandra 
possible encode different versions delegation transitive delegation delegatee able delegate role finitely transitive delegation delegation chain fixed finite length cf 

show encoding simple version appointment 
manager appoint employee activating role 
enables activate employee appointed role employee 
mgr emp hasactivated mgr manager emp employee hasactivated emp furthermore employee role revoked automatically deactivated emp employee emp specify allowed revoke appointment role 
dependent revocation revoke emp independent revocation hand allows manager revoke employee roles emp hasactivated manager cases roles appointed revoked revoked role case manager role 
encode cascading chain revocations follows mgr emp mgr 
expressing case study cassandra complete cassandra policy national ehr system mainly output specification page document potential suppliers current procurement process reports nhs pilot projects electronic records development implementation programme various department health documents 
policy comprises rules roles actions 
rules rules permits rules 
remaining user defined aggregate rules 
case study suggests common policy idioms appointment hardly occur pure forms practice necessary able express different variants 
interestingly commonly mentioned policy idioms literature separation duties encountered case study 
rules roughly divided categories permissions assignment permits rules straightforward parameterised role action assignments patients annotate record items 
require role related prerequisite condition clinicians force read record items concealed patient activated clinician role member workgroup clinical team ward currently treating patient 
condition example auxiliary derived role group role need activated rule sufficient activated 
permits rules concerning reading record items typically conditioned consent absence access denial role activations activated entities rules easily expressed languages subject parameters head body rt oasis 
consent access health records primarily explicit patient consent 
consent may required initial treatment referrals disclosure third party information 
implement consent form appointment activating consent role patient clinician treating clinician legitimate relationship 
prevent users activating consent roles user requested activate role 
consent requests implemented form appointment way round activating consent request role clinician enables patient activate consent role 
consent implemented stage appointment mechanism 
registration administrative task takes forms case study mpi administrators enter newly born patients mpi register new patients human resource managers employ clinicians staff head nurses assign nurses wards heads clinical teams assign clinicians respective teams 
easy see registration implemented variants appointment encoding 
variants include combinations cardinality restrictions patients register distinct agents acting behalf uniqueness constraints patient registered activated registration role patient 
mentioned variants cassandra aggregation operators 
referral implemented form delegation 
case study exhibits kinds patient referral 
ehr service patient consent required referral chains unbounded length 
level local health organisation decided implement stricter alternative local treating clinician refer patient external clinician restricted rights read local epr record items explicit patient consent delegation chain length 
access denial policy idiom motivated requirement patients may conceal data 
activating access denial role patients fine tune rights access records 
corresponding permits rules need check access denial role activated requires universally quantified negation expressed help aggregation operators 
deactivation rules specify deactivate roles 
rules straightforward important deactivation specified flexibly 
example revocation patient agent registrations asymmetric sense patients revoke agents appointed revocation guardians revoke agents appointed patient appointed patient variant revocation 
cascading deactivation specified rules automatically deactivate role role deactivated 
example revocation patient registration hospital triggers deactivation roles patient including agent registrations episode registrations legitimate relationships clinicians access denial roles consent roles 
credential management credential trust negotiation credential protection governed interaction rules rules remote body predicates 
scenario gives example multi phase automatic trust negotiation 
rules regulating direct credential requests entities 
example agent credentials requested certified health organisations agent 
location parameter cassandra predicates facilitates flexible forms automatic credential retrieval systems credential locations restricted issuer credential subject 
example credential form ra hasactivated ra adm nhs health org cred org start may location org issuer ra subject ra adm 
users system patients clinicians administrative staff modelled entities policies consist credentials acquire time 
assume existence infrastructure identification individuals 
nhs number identifies patients uniquely specify exact authentication mechanism password name certificate smartcard stored key 
assume network communication secured 
outline policy ehr architecture proposed illustrated scenario give examples policy rules illustrate particular features cassandra express variant interesting policy idiom 
master patient index recall mpi central national service patient stores location ehr 
mpi patient ehr service binding queried patients health professionals organisations retrieve ehr items ehr service 
approach keeps size central service manageable cope high access rates mpi policy simple amount transferred data small 
estimated number gp appointments episodes patient hospital health episodes encounters year 
events mpi typically consulted times expected number accesses year 
service needs able handle accesses second take peak times account 
mpi policy defines roles rules 
new patient ehr service binding entered mpi administrator activating pat ehr srv role binding patient exists 
negative condition holds aggregation parameter user defined aggregation predicate regs 
patient registration seen variant appointment patients appointed registered 
adm register patient pat ehr srv hasactivated adm mpi admin count patient regs pat count patient regs count pat hasactivated register patient pat ehr srv mpi policy contains rules removing patient ehr service bindings various rules requesting credentials containing binding 
examples credential request 
rule health organisations request credential asserting binding turn willing provide ra approved nhs health organisation credential 
example encoding particular distributed trust negotiation strategy cassandra 
cassandra evaluation algorithm ensures trust negotiation strategies terminate presence mutually recursive rules 
org mpi hasactivated register patient pat ehr srv org ra hasactivated nhs health org cred org start ra nhs registration authorities current time start ehr services ehr records physically stored ehr services deployed strategic health authority sha level 
england covering living patients 
ehr services sha keep complete health records patients including deceased moved abroad 
ehr service policy defines roles actions rules 
patient associated exactly health record consisting set items indexed item id health professionals create new items patients annotate existing items 
system function get author pat id returns author record item id patient pat 
similar functions exist getting health organisation author set subjects item relates time item created set third parties consent sought patient may view item 
clinician generally read read ehr item patient record item item author currently treating patient 
rule case specifies treating patient specialty allows read subjects item 
furthermore denied access patient activated matching access denied patient role 
parameters role specify items affected access denied validity date range access restriction 
recall scenario bob conceals record items concerning alcohol related liver problem everybody clinicians treating gp 
accomplished activating role access denied patient bob liver drugs gp 
complex userdefined aggregation rule count access denied pat permits rule ensure activated matching access denial role 
condition holds aggregation parameter 
permits cli read ehr item pat id hasactivated cli clinician org cli treating clinician pat org count access denied pat pat id org cli get ehr item subjects pat id permitted subjects count access denied pat count pat id org reader hasactivated access denied patient start pat ids orgs authors subjects time time orgs readers get ehr item org pat id orgs get ehr item author pat id authors get ehr item subjects pat id subjects get ehr item time pat id time time id ids org orgs reader readers current time start clinician role activated submitting currently valid clinician approval credential issued registration authority ehr service 
clinicians legitimate relationship patient activate treating clinician role example auxiliary role need activated condition hasactivated permits rule 
permitted patient agent previously consent treatment activated treatment role case emergency active emergency clinician patient clinician referred treating clinician activated referrer 
health organisation clinician supports cassandra nhs approved simply submit credential proves member workgroup involved treatment patient 
allows local hospitals manage workgroup memberships 
rule case shown example distributed delegation authority 
note rule specifies clinician group role credential submitted directly ehr service nhs health org cred role credential retrieved automatically different automatic credential retrieval strategies rule 
cli treating clinician pat org org cli group treating clinician pat group org ra hasactivated nhs health org cred org start ra nhs registration authorities current time start patients similarly agents read record items concealed clinician activated matching access denied clinician role patient patient want see items concerning cancer 
furthermore third parties affected item explicit consent disclosure 
set third parties consent registered group aggregation operator actual permits rule patient access shown third party consent group party pat id hasactivated third party consent party pat id patient agents registered patient ehr service patient gp 
registered agent act behalf patient ehr service request agent credential local cassandra supporting hospital 
revocation policy agents combination dependent patients deactivate agent registrations independent revocation gp deactivate patients registrations patient deemed 
agent registration rule patients variant appointment restriction number appointments patients may appoint different agents 
aggregation rule agent regs pat counts number agent registrations shown 
pat register agent agent pat hasactivated pat patient agent regs pat patient centred issues consent treatment managed ehr service level 
policy designed way users forced activate main roles ehr service admin clinician emergency clinician patient agent third party perform action activate registration consent access configuration role 
local health organisations epr services expected local health organisations gradually migrate electronic systems conform national standards compatible nation wide services 
process may take long time national services puts policy related requirements local systems running health organisations 
reason ehr deployed level 
ehr service policy designed way health organisation produce credentials compatible system working ehr service efficient 
health organisations small single gp practices entire nhs acute trusts half registered patients 
policy model hospital defines roles actions rules 
mainly concerned staff patient registration receptionist register new patients activating register patient pat trust management local electronic patient records epr 
rules accessing local epr similar shared ehr ehr services give explicit examples policy rules 
difference model hospital workgroup kinds workgroups teams wards 
patients treated clinical teams usually headed consultant episodes patients belong ward usually headed head nurse 
legitimate relationship patient clinician explicit consent treatment case ehr services requires receptionist head workgroup register patient workgroup activating register team episode register ward episode 
clinician belonging workgroup automatically treating clinician 
clinicians request workgroup credentials supporting requests access patient ehr item ehr service 
registration authorities ras located nhs cluster level england 
typical cluster comprises primary care practices acute hospital trusts health organisations 
ra able cope registered health professionals 
policy model ra ra east defines roles rules 
example person cli registered clinician specialty working health organisation org somebody activates appointment role cred org cli start 
ra credentials required time limited ra roles start date parameters 
role activated local administrators org registered current health organisation ra 
furthermore validity period covered validity period organisation registration adm nhs clinician cred org cli start hasactivated adm ra admin hasactivated nhs health org cred org start start start registration revoked deactivating role 
example variant time limited appointment independent revocation deactivation done active administrator note occurs head rule adm nhs clinician cred org cli start hasactivated adm ra admin registration cancelled automatically health organisation loses registration relevant period 
rule implements complex variant cascading deactivation expressed oasis cancellation proceed registration health organisation valid relevant period 
negative condition ensured user defined aggregation predicate nhs regs parameter condition holds 
adm nhs clinician cred org cli start nhs health org cred org start nhs health org regs org start start start nhs health org regs count org start hasactivated nhs health org cred org start start start start start registered clinician request credential asserting activated corresponding registration role period 
similarly ehr services ras health organisation employing clinician request credential 
rule case shown 
org ra hasactivated nhs clinician cred org cli start hasactivated nhs health org cred org start current time start see variant appointment clinician activates appointed role nhs health org cred 
ra admin enables request credential certifying appointment 
similar rules exist guardians nhs guardian cred health organisation authentication nhs health org cred credentials 
ra policy contains rules appointment new administrators 

discussion implementation performance prototype cassandra implemented ocaml 
access control engine forms core implementation 
provides simple user interface reading policies handling user requests concerning actions credentials role activation deactivation 
request access control engine uses policy evaluation engine implementation top evaluation algorithm decide deny access 
access granted state global set policies changed specified 
globally chosen constraint domain plugged access control policy evaluation engines independent module 
constraint domain modules provide implementations standard functions conjunction satisfiability implication checking existential quantifier elimination 
implemented constraint domain including type inference mechanism allows omit explicit variable typing 
time writing role deactivation credential requests static groundness analyser process implemented 
furthermore current prototype simulates distributed system issued credentials implemented encryption public key signatures 
prototype tested ehr policies going various scenarios 
initial test results promising complex requests handled fractions second 
believe feasible cassandra enforce ehr policy nationwide system despite relative complexity 
course authoritative results produced completion naive implementation realistic settings example far tested system patients 
queries may theoretically intractable test results ehr policy suggest worst case occur practice policy complex closer analysis reveals recursion shallow nearly variables ground early stage 
means evaluation engine constraint solving procedures need hard 
current implementation inefficient credential rules role activations stored linear list 
hashtable cost requests nearly independent number patients system rest cost linear number patients 
related large amount done policy specification non trust management context ponder faf rcl just name languages support credential authorisation credential retrieval distributed trust negotiation focus distributed resource sharing 
notion credential trust management introduced blaze policymaker successor keynote 
policymaker credentials policies fully programmable choice policy specification language left open user 
flexible policy compliance checking undecidable general 
keynote policies written specific assertion language containing simple string arithmetic constraints environment variables 
policymaker keynote handle credential retrieval 
cassandra systems act protective layer resources just called application check policy compliance 
application responsible interpreting answer actual policy enforcement 
distinctive aspects cassandra policy language access control semantics formally specified exact definitions conditions consequences role activation deactivation action credential requests 
policy language access control semantics provide rigorous framework unifying dynamic rbac role revocation distributed trust management trust negotiation 
existing distributed trust management systems narrower scope specify policy specification language access control semantics 
cassandra policy specification language inspired oasis role trust management system datalog rules specify credentials prerequisite role activation deactivation 
oasis retrieve credentials automatically guarantee termination queries 
main contributions oasis development concept appointment generalisation delegation 
previous systems concentrated delegation rule language built role delegation case study suggests far useful practice 
standard appointment expressed oasis built appointment mechanism 
subject role activation prerequisites equal subject rule impossible encode different variants appointment encountered 
express role revocation policies including revocation authorisation cascading revocation way cassandra 
oasis trust management system aware supports rulebased cascading role revocation 
revocation mechanism expressive revocation policies case study 
particular oasis revocation triggers restricted role activations activate role furthermore revocation triggered role membership condition ceases hold current conditions allow activation stay alive 
cassandra mechanism expressive capture policies 
oasis revocations automatically propagated network event infrastructure 
contrast cassandra revocations explicitly restricted local role activations 
believe distributed revocation difficult implement reliably securely wide scale example services need keep state services notify revocations need apply services right receive particular revocations 
rt family role trust management languages bears similarities system 
rt seen extension combination spki sdsi delegation logic 
rt datalog rules credentials called specify role membership relation directly role hierarchy direct attribute delegation authority combination 
oasis subjects rule head body conditions implicitly sufficient express delegation convenient appointment policies 
rt youngest offspring rt rules translated constraints define range role parameter constraints parameters permitted order keep policies comprehensible guarantee tractability 
find liberal constraints useful necessary ehr policy shows efficient practice 
rt roles prefixed issuing entity just cassandra predicates specify location matching credential may 
rt solves statically specifying role name credentials defining roles stored issuer subject 
ehr policy rules predicates locations different issuer subject entity 
sd datalog trust management system 
similar cassandra sd predicates issuer location case sd ip address 
sd general system specify access control meaning predicates viewed cassandra constraints roles access control semantics automatic credential retrieval trust negotiation 
sd passes proof tree highly optimised policy evaluation engine simple small proof checker reduce size trusted computing base 
technique applied cassandra 
problem trust negotiation addressed various different strategies discussed 
credential access policy cap corresponds cassandra rules 
cassandra uniform treatment rules evaluation gives trust negotiation free strategy similar parsimonious strategy 
pointed strategy may leak information policy disclosing credentials 
prevents problem adding policy protection layer 
developed policy specification system access control distributed system cassandra expressiveness tuned need 
combination constraint domain cassandra expressiveness surpasses existing systems preserving strong termination property 
language truly policy neutral express subtle variants known policy idioms 
express trust management related policies credential authorisation automatic trust negotiation automatic credential retrieval strategies 
policy national ehr system substantial trust management case studies aware demonstrates cassandra expressive large scale real world applications highly complex policy requirements 
gather reliable test results complete implementation role deactivation credential requests static groundness analyser 
step plan build prototype truly distributed uses digital certificates sending credentials network uses relational database accelerate look role activations 
implementation enable test ehr policy realistic setting policy entries 
produce web ehr user interfaces illustrate applications build cassandra 
cassandra designed satisfy complex policy requirements time simple language access control semantics formally specified 
plan formal framework prove highlevel meta properties specific policies policy idioms 
lines wish formalise lowlevel model cassandra specifies underlying network protocols public key infrastructure design certificates 
acknowledgments acknowledge support gates cambridge scholarship becker royal society university research fellowship sewell epsrc grn ec fet gc project ist 
authors mukherjee insight discussion hospital management arne matthew parkinson corrections 
reviewers valuable comments 
abiteboul hull vianu 
foundations databases 
addison wesley 

ahn sandhu 
role authorization constraints specification 
acm transactions information system security 
anderson 
security policy model clinical information systems 
proceedings ieee symposium research security privacy pages 
baker 
definiteness analysis clp 
australian computer science conference pages 
becker 
cassandra policies national ehr architecture 
www cl cam ac uk users policy 
becker sewell 
cassandra distributed access control policies tunable expressiveness 
policy workshop june 
blaze feigenbaum ioannidis keromytis 
rfc keynote trust management system version 
blaze feigenbaum keromytis 
keynote trust management public key infrastructures position 
lecture notes computer science 
blaze feigenbaum keromytis 
role trust management distributed systems security 
secure internet programming pages 
blaze feigenbaum lacy 
decentralized trust management 
ieee symposium security privacy pages 
chen warren 
effective evaluation general logic programs 
technical report state university new york stony brook 
clarke 
ellison rivest 
certificate chain discovery spki sdsi 
journal computer security 
collins 
doctors express alarm plans store patient data consent 
computer weekly 
collins 
national programme came health service project 
computer weekly 
collins simons 
nhs plan 
computer weekly 

electronic health records international perspective 
health issues 
cross 
nhs revealed 
guardian 
damianou dulay lupu sloman 
ponder policy specification language 
policy workshop 
department health uk 
building information core implementing nhs plan 

department health uk 
building information core protecting confidential patient information 

department health uk 
legal policy constraints electronic records 

foundation information policy research 
nhs confidentiality consultation response 
february 
www cl cam ac uk users rja html 

confidentiality consent cases applicable shared electronic health record 
project 

role templates content access control 
proceedings nd acm workshop role access control rbac pages 
halpern weissman 
order logic reason policies 
proceedings computer security foundations workshop csfw 
hayton bacon moody 
oasis access control open distributed environment 
proceedings ieee symposium security privacy pages 
jaffar maher 
constraint logic programming survey 
journal logic programming 
jajodia samarati subrahmanian 
flexible support multiple access control policies 
acm transactions database systems 
jim 
sd trust management system certified evaluation 
proceedings ieee symposium security privacy pages 
joshi bertino 
dependencies separation duty constraints 
proceedings eighth acm symposium access control models technologies pages 
acm press 
li grosof feigenbaum 
delegation logic logic approach distributed authorization 
acm transactions information system security pages 
li mitchell 
datalog constraints foundation trust management languages 
proceedings th international symposium practical aspects declarative languages pages 
li mitchell winsborough 
design role trust management framework 
proceedings ieee symposium security privacy pages 
lupu sloman 
reconciling role management role access control 
acm workshop role access control pages 
national health service uk 
committee report review patient identifiable information 

national health service uk 
information health information strategy modern nhs 

national health service uk 
evaluation technical options implementation electronic health record 

national health service uk 
integrated care records service output specification version 

palmer 
complex operation nhs spine 
computer weekly 
revesz 
constraint databases 
springer verlag 
rogers 
gps voice patient confidentiality concerns 
computer weekly 
sandhu 
rationale rbac family access control models 
proceedings st acm workshop role access control 
sandhu coyne 
model role administration roles preliminary description outline 
proceedings nd acm workshop role access control pages 
sommerville 
macdonald weston 
medical ethics today practice philosophy 
british medical association publishing group 
toman 
memoing evaluation constraint extensions datalog 
constraints 
winsborough seamons jones 
automated trust negotiation 
darpa information survivability conference exposition volume pages 
winsborough li 
practical automated trust negotiation 
proceedings rd international workshop policies distributed systems networks pages 
yao moody bacon 
model oasis access control support active security 
acm transactions information system security 
zhang 
ahn 
chu 
rule framework role delegation revocation 
acm transactions information system security 
