adapting active shape models segmentation tubular structures medical images de van max viergever image sciences institute university medical center utrecht netherlands 
active shape models asm proven effective approach image segmentation 
applications linear model gray level appearance contour asm sufficient accurate boundary localization 
furthermore statistical shape model may restricted training set limited 
describes modifications shape appearance model original asm formulation 
shape model flexibility increased tubular objects modeling axis deformation independent cross sectional deformation adding supplementary cylindrical deformation modes 
furthermore novel appearance modeling scheme effectively deals highly varying background developed 
contrast conventional asm approach new appearance model trained boundary non boundary points probability point belongs boundary estimated non parametrically 
methods evaluated complex task segmenting abdominal aortic aaa 
shape approximation errors successfully reduced shape model extensions 
segmentation new appearance model significantly outperformed original asm scheme average volume errors respectively 
segmentation methods trained examples increasingly popular medical image analysis 
techniques model shape gray level appearance object active shape models asm active appearance models reps produce correct results case missing confusing boundary evidence 
shall concentrate frequently asms consist landmark linear shape model linear gray value appearance models landmarks iterative optimization scheme 
asms applied various segmentation tasks medical imaging successfully segmentation objects fairly consistent shape gray level appearance 
segmentation problems medical imaging gray levels may variable 
training data available build correct model 
model constrained generalize new shapes class 
furthermore object segment lies variable anatomy landmark different tissue types boundary appearance may vary largely 
case linear model gray value appearance may produce unreliable results 
show asms adapted deal problems 
focus segmentation tubular structures adaptations generally applicable 
propose main modifications conventional asms 
elongated structures modeled flexible modeling axis cross sectional shape deformation separately assuming types variation uncorrelated 
models combined model describing deformations fitted regular asm optimization scheme 
second supplementary smooth deformation introduced adding synthetic covariance 
approach similar wang staib differs decouple smooth deformation approach feasible 
third linear class gray value model asm replaced novel non parametric multi class model deal arbitrary gray value distributions effective prior information gray level structure object contour 
evaluated method segmentation abdominal aortic aaa cta data 
publications computerized aaa segmentation concentrated segmentation contrast filled 
segmentation difficult problem complicated regions low boundary contrast neighboring structures close proximity wall 
previously reported approaches yield inaccurate results need extensive user interaction 
leave experiments performed routinely acquired cta scans different patients compare proposed modifications conventional asm approach 
images segmented manually expert 
methods original asm segmentation scheme briefly described section 
section presents extensions shape model 
new appearance model discussed section 
active shape models asms shape variations training set described point distribution model pdm 
shape model generate new shapes similar training set fitted data model local gray value structure 
point distribution models statistical model object shape shape variation derived set training examples 
training example described shape vector containing coordinates landmark points correspond shapes 
variations coordinates landmark points describe variation shape pose training set 
shape vectors aligned procrustes analysis transformed tangent space mean shape 
principal component analysis pca applied aligned shape vectors 
mean shape covariance matrix eigensystem computed 
eigenvectors provide modes shape variation data 
eigenvectors corresponding largest eigenvalues account largest variation small number modes usually explains variation 
shape set approximated consists eigenvectors corresponding largest eigenvalues model parameter vector weighs contribution modes 
appearance model fitting shape model new image requires measure probability image point belongs boundary 
original asm formulation linear model constructed gray value profiles sampled landmarks training set perpendicular object contour 
effect global intensity changes reduced sampling derivative normalizing profile 
normalized samples assumed distributed multivariate gaussian mean covariance matrix sg computed 
measure dissimilarity new profile gs profiles distribution squared mahalanobis distance gs sample model mean gs gs gs 
optimization shape model fitted new images fast deterministic optimization scheme 
process initializes plausible shape usually mean 
appearance model determines landmark optimal new position ns candidate positions line perpendicular contour sides 
iteratively shape translated rotated scaled deformed squared distance landmarks optimal positions minimized 
ensure plausible shapes shape parameters bi constrained lie process adjusting landmark positions shape parameters repeated fixed number times repeated level resolution 
extending pdms common problem statistical shape modeling model specific fit new shapes properly owing limited amount training data 
case dimensional models large number landmarks needed describe shape properly 
section describes different approaches generalizing models curvilinear structures 
automatic landmarking experiments needs explained 
landmarking strategy fixed number slices nz interpolated object 
aaa segmentation original ct slices perpendicular body axis give approximately perpendicular cross sectional views aorta 
alternatively reformatted slices perpendicular object axis 
equal number landmarks xy placed slice contours drawn manually expert 
starting point contour posterior point coordinate center mass fig 

shape models built input shapes top left 
axis input shapes straight diameter cross section increases vertical center 
input shape constant circular cross section curved axis 
pdm built directly input shapes contains mode shape variation varying thin shapes curved left fat shapes curved right 
combined model finds modes variation describes object axis second describes increase decrease diameter ends center 
model cylindrical shape variations restricting deformation slice landmark displacements 
model fitted new image user indicates desired segmentation removing need scaling direction 
consequence shape vectors contain coordinates 
modeling axis cross sections separately ability model generalize unseen shapes increased modeling axes cross sections separately assuming types shape variation uncorrelated 
subsequently models combined model describing deformations 
central axes straightened shapes extracted aligned training shapes 
axis contains landmark slice defined centroid contour slice 
straightened shapes formed translating contour centroid origin 
pdms derived shape distributions described section 
combine mode vectors models need equal dimensions 
axis modes nz coordinates straightened modes dimension 
extend mode axis variation shape vector constructed landmarks slice positioned axis points 
deformation applied shape landmarks slice translated centroid coincides deformed axis 
general models linearly independent 
second pca performed remove correlation axis cross sectional st mode nd mode th mode fig 

examples synthetic deformation cylinder 
frequency deformation increases left right deformation top bottom 
modes 
modes shape variation combined model principal components cross axis concatenations mode vectors diagonal weight matrices corresponding resulting model contains maximum modes provided model built shapes directly contain modes 
illustrates effect generalization 
additional smooth variation authors investigated combination statistical deformation modes synthetic smooth deformation obtained finite element method fem models shape instances smooth deformation independent object shape 
instance wang staib apply smoothness constraints form smoothness covariance matrix consists positive numbers diagonal diagonal elements representing neighboring points point allowed variation neighboring points vary 
added covariance matrix obtained training data extended shape model obtained computing eigenvectors new covariance matrix 
disadvantage procedure eigenvectors full covariance matrix computed case number samples smaller dimensionality shape vectors pca requires eigenvectors matrix 
eigenvector decomposition problem impractical high dimensions 
approach similar wang staib circumvent computation eigenvectors full covariance matrix decoupling deformation directions 
deformation modes cylindrical object built smooth deformations cyclic sequences coordinates sequence coordinates 
cyclic sequences circulant fore sinusoidal eigenvectors 
eigenvector constant corresponding translation entire object subsequent eigenvectors correspond sine cosine pairs increasing number full periods 
non cyclic sequence eigenvector approximates half period sine 
subsequent eigenvectors correspond approximate sines increasing number half periods 
set elements synthetic covariance matrix gaussian 
deformation eigensystem circulant xy matrix elements matrix row column indices xy number landmarks slice min 
deformation eigensystem similar non circulant nz matrix nz number slices model di 
denote eigenvectors xy deformation respectively 
deformations xy plane entire shape shape vectors elements corresponding coordinates slice set smooth deformation modes elements zero way 
include possible variations axis xy modes combined modes multiplying elements slice xy mode corresponding element mode xi yi xi yi slice index number landmark slice 
resulting deformation vectors centered origin normalized unit length 
eigenvalues weighting modes obtained multiplication eigenvalues correspond original xy modes 
result orthonormal set vectors describing smooth cylindrical deformations 
practice smaller number harmonics chosen low frequency deformations remain 
eigenvalues multiplied weight factor model combined statistical model way axis cross section models combined previous subsection 
shows examples smooth deformation modes applied cylinder 
parameters involved augmented model smoothing scale number synthetic modes retained weight factor 
scale mainly weighs modes different frequencies larger increases eigenvalues low frequencies decreases eigenvalues high frequency variation favoring smoother deformation 
weight factor weighs synthetic model respect statistical model decrease training shapes added 
parameters instance selected defining threshold maximum reconstruction error allowed leave experiments training data 
nonlinear appearance model previously showed mahalanobis distance average training profile perform aaa boundary localization 
shortcoming gray value model appearance correct boundary learned training set 
furthermore underlying assumption normal profile distribution hold 
deal non linear profile distribution bosch performed non linear normalization transform asymmetric unimodal distribution gaussian 
sonka applied fuzzy means clustering feature vectors derived intensity profiles allowing known number separate normal distributions 
van authors intensity profiles applied local texture features knn classification determine boundary object background allowing arbitrary distributions long texture object background different 
medical image segmentation tasks surrounding structures similar object gray value texture ordering gray values profile important 
propose treat position evaluation step asm optimization classification boundary profiles 
original asm formulation gray value profiles sampled training set classifier trained correct incorrect boundary profiles 
raw intensity profiles normalized derivative profiles linear model 
landmark boundary profile sampled landmark perpendicular contour shift non boundary profiles sampled direction displaced outwards displaced inwards 
new image probability profile lies boundary posterior probability classifier profile 
knn classifier posterior probability boundary gs number boundary samples nearest neighbors 
original asm formulation separate models built different resolutions 
experiments results series leave experiments performed routinely acquired cta images including pre operative post operative scans 
scan resolution mm 
parameter settings selected set parameters basis pilot experiments keep settings fixed experiments 
shapes described nz slices containing landmarks total landmark coordinates 
number modes axis cross section models chosen models describe total variance training set 
smooth deformation modes built smoothness matrix scale strongest xy deformation modes strongest deformation modes selected allowing sine periods directions 
weight factor set contribution synthetic model total variance statistical model 
statistical shape model applied obtain initial estimate reconstruction error mm pdm axis cross sections smooth dataset number segmentation error mm asm knn dataset number fig 

root mean squared reconstruction error datasets modes variation normal dimensional pdm white combined model axis cross sections gray combined model additional smooth deformation black 
root mean squared segmentation error datasets linear model gray knn model black 
second highest resolution 
fit refined smallest scale model extended synthetic deformation 
profiles gray value models consist samples 
knn appearance model contains addition correct boundary profile examples shifted shift voxels inwards outwards landmark 
number neighbors considered knn probability estimation 
fitting algorithm evaluates possible new positions sides landmark position performs iterations resolution levels 
shape model evaluation validity shape model tested fitting model directly manual segmentations gives upper bound accuracy obtained model fitted new image data 
shows root mean squared landmark contour error datasets 
modeling axis cross section separately reduced reconstruction leave error cases average error reduced mm 
average error decreases mm smooth deformation modes added model 
appearance model evaluation vascular images true anatomical correspondence landmarks different shapes 
appearance model landmarks building separate models commonly done asm 
pilot experiments image slices shown approach gives slightly better results linear knn model training examples available 
shows error optimal position selection function size search region manual contour 
knn rms error mm scale scale scale scale random search region mm rms error mm scale scale scale scale random search region mm fig 

root mean squared error landmark positioning fitting shape model function length search region side contour original asm gray value model knn gray value model 
dotted line corresponds expected error random landmark selection 
model performs significantly better conventional asm gray value model resolutions 
initialization constrained optimization complexity images local nature asm optimization require accurate initialization 
segmentation system user draws top bottom contours manually 
aid model establishing correct object axis additional point placed approximate center central slice 
initial estimate obtained iteratively fitting shape model points 
iteration landmarks manually drawn slices replaced original position landmarks central slice translated average position coincides manually identified center point 
alternatively automatic estimate axis easily automated segmentation initialization 
subsequently fixed number slices interpolated image shape model fitted multiple resolutions optimally match local image structure manually drawn contours 
segmentation process constrained keeping manually drawn slices fixed 
fitting process resistant outliers applied dynamic programming regularization followed weighted squares fit weights posterior probability obtained gray value model 
segmentation results initialization constrained optimization scheme segmentation method extended shape model knn gray value fig 

image slices taken randomly successful segmentations manually drawn contour dots segmentation obtained original asm pluses segmentation obtained knn gray value model continuous line 
knn model obtains segmentation near manual contour cases original asm gray value model finds satisfactory segmentation third image 
model converged successfully cases 
examples segmented slices randomly chosen datasets shown 
shows segmentation errors obtained gray value models 
knn model yields significantly better results original asm model paired test 
average root mean squared errors mm voxels 
relative volumes overlap average volume errors 
datasets error obtained knn model larger half centimeter 
combines extremely wide usually boundary inside dataset embedded structures similar gray value adjacent slices total region comprised surrounding structures forms plausible shape 
problematic datasets left consideration average error remaining datasets mm 
corresponding volume overlap relative volume error 
reported inter observer reproducibility coefficient rc intra observer rc measurement total volume cta 
rc altman defined times standard deviation differences measurements 
rc automated measurements respect expert measurements 
automated segmentations initialized second observer yield rc respect manual segmentations rc compared set automated measurements 
discussion segmentation methods linear statistical models asm obtain results applications 
cases shape model statistics specific linear gray value model able find correct contour 
application aaa segmentation conventional asm find suitable segmentation 
shown shape models elongated objects flexible modeling object axis cross sections independently 
idea decoupling different types shape variation treating independent applied generally 
instance modeling vascular trees different segments modeled separately 
multiple object models object modeled separately objects joined combined model 
general relations different objects retained correlation shape variation different objects removed 
model flexible increases risk producing invalid shapes overlapping objects 
orthonormal basis smooth deformation modes constructed eigenvectors small matrices 
approach valid tubular objects shape described stack contours equal number landmarks contour 
arbitrary shapes decoupling deformation direction require computation eigenvectors matrix greatly reducing computation time 
aaa segmentation contours original ct slices build model deformation restricted slice landmark displacements 
believe approach valid case cta images general highly anisotropic images study voxels times larger direction 
methods applied reformatted slices perpendicular object axis 
improvement gray value model original asm gray value model twofold 
appearance boundary appearance points near boundary learned training set 
second assume gaussian intensity profile distribution estimate distribution knn probability density estimation 
responsible dramatic increase computation time full segmentation took average seconds ghz pentium pc original asm gray value model seconds knn model 
computation time issue method sped fewer shifted examples pruning knn tree classifiers 
instance quadratic discriminant classifier equivalent extending original asm gray value modeling scheme classes 
leave experiments datasets shape approximation error successfully reduced modeling axis cross section deformation independently adding supplementary smooth deformation modes 
knn appearance model significantly outperforms original class linear gray value model 
obtained volume errors respect expert segmentations comparable errors reported literature inter observer agreement automated segmentation initialized different observers better manual segmentation 
acknowledgments research funded netherlands organization scientific research nwo 
colleagues van der department vascular surgery providing datasets expert segmentations 

cootes taylor cooper graham active shape models training application computer vision image understanding pp 


cootes edwards taylor active appearance models ieee transactions pattern analysis machine intelligence pp 


joshi pizer fletcher marron multiscale deformable model segmentation statistical shape analysis medial descriptions ieee transactions medical imaging pp 


sonka segmentation interpretation brain images improved active shape model ieee transactions medical imaging pp 


van ter haar romeny viergever active shape model segmentation optimal features ieee transactions medical imaging pp 


maes suetens evaluation image features search strategies segmentation bone structures radiographs active shape models medical image analysis pp 


de van maintz viergever active shape model segmentation abdominal aortic cta images medical imaging image processing sonka fitzpatrick eds proceedings spie pp 
spie press 

rogers graham robust active shape model search proceedings european conference computer vision eccv nielsen johansen eds lecture notes computer science pp 
springer 

wang staib statistical shape smoothness models boundary finding correspondence ieee transactions pattern analysis machine intelligence pp 


image analysis abdominal aortic medical imaging image processing sonka fitzpatrick eds proceedings spie pp 
spie press 

bosch mitchell kamp sonka active appearance motion models contour detection time sequences medical imaging image processing sonka hanson eds proceedings spie spie press 

sonka object localization border detection criteria design image segmentation automated learning examples ieee transactions medical imaging pp 


van rijn mali intra observer variability cta measurements obtained repair abdominal aortic american journal pp 


altman statistical methods assessing agreement methods clinical measurement lancet pp 


jain duin mao statistical pattern recognition review ieee transactions pattern analysis machine intelligence pp 

